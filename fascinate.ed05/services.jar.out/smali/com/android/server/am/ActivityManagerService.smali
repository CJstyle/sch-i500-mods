.class public final Lcom/android/server/am/ActivityManagerService;
.super Landroid/app/ActivityManagerNative;
.source "ActivityManagerService.java"

# interfaces
.implements Lcom/android/server/Watchdog$Monitor;


# annotations
.annotation system Ldalvik/annotation/MemberClasses;
    value = {
        Lcom/android/server/am/ActivityManagerService$ServiceRestarter;,
        Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;,
        Lcom/android/server/am/ActivityManagerService$PermissionController;,
        Lcom/android/server/am/ActivityManagerService$CpuBinder;,
        Lcom/android/server/am/ActivityManagerService$MemBinder;,
        Lcom/android/server/am/ActivityManagerService$AThread;,
        Lcom/android/server/am/ActivityManagerService$AppDeathRecipient;,
        Lcom/android/server/am/ActivityManagerService$Identity;,
        Lcom/android/server/am/ActivityManagerService$ForegroundToken;,
        Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;,
        Lcom/android/server/am/ActivityManagerService$ActivityState;
    }
.end annotation


# static fields
.field static final ACTIVITY_INACTIVE_RESET_TIME:J = 0x1b7740L

.field static final APP_SWITCH_DELAY_TIME:J = 0x1388L

#the value of this static final field might be set in the static constructor
.field static final BACKUP_APP_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final BACKUP_APP_MEM:I = 0x0

.field static final BATTERY_STATS_TIME:J = 0x1b7740L

.field static final BROADCAST_INTENT_MSG:I = 0x7

.field static final BROADCAST_TIMEOUT:I = 0x4e20

.field static final BROADCAST_TIMEOUT_MSG:I = 0x8

.field static final CONTENT_APP_IDLE_OFFSET:J = 0x3a98L

.field static final CORE_SERVER_ADJ:I = -0xc

.field static final DEBUG:Z = false

.field static final DEBUG_BACKUP:Z = false

.field static final DEBUG_BROADCAST:Z = false

.field static final DEBUG_BROADCAST_LIGHT:Z = false

.field static final DEBUG_CONFIGURATION:Z = false

.field static final DEBUG_OOM_ADJ:Z = false

.field static final DEBUG_PAUSE:Z = false

.field static final DEBUG_PROCESSES:Z = false

.field static final DEBUG_PROVIDER:Z = false

.field static final DEBUG_RESULTS:Z = false

.field static final DEBUG_SERVICE:Z = false

.field static final DEBUG_SWITCH:Z = false

.field static final DEBUG_TASKS:Z = false

.field static final DEBUG_TRANSITION:Z = false

.field static final DEBUG_URI_PERMISSION:Z = false

.field static final DEBUG_USER_LEAVING:Z = false

.field static final DEBUG_VISBILITY:Z = false

.field static final DESTROY_TIMEOUT:I = 0x2710

.field static final DESTROY_TIMEOUT_MSG:I = 0x11

.field static final DO_PENDING_ACTIVITY_LAUNCHES_MSG:I = 0x15

#the value of this static final field might be set in the static constructor
.field static final EMPTY_APP_ADJ:I = 0x0

.field static final EMPTY_APP_IDLE_OFFSET:J = 0x1d4c0L

#the value of this static final field might be set in the static constructor
.field static final EMPTY_APP_MEM:I = 0x0

.field static final EMPTY_STRING_ARRAY:[Ljava/lang/String; = null

.field static final ENFORCE_PROCESS_LIMIT:Z = false

.field static final FINALIZE_PENDING_INTENT_MSG:I = 0x17

.field private static final FINISH_AFTER_PAUSE:I = 0x1

.field private static final FINISH_AFTER_VISIBLE:I = 0x2

.field private static final FINISH_IMMEDIATELY:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final FOREGROUND_APP_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final FOREGROUND_APP_MEM:I = 0x0

.field static final GC_BACKGROUND_PROCESSES_MSG:I = 0x5

.field static final GC_MIN_INTERVAL:I = 0xea60

.field static final GC_TIMEOUT:I = 0x1388

#the value of this static final field might be set in the static constructor
.field static final HIDDEN_APP_MAX_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final HIDDEN_APP_MEM:I = 0x0

.field static HIDDEN_APP_MIN_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final HOME_APP_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final HOME_APP_MEM:I = 0x0

.field static final IDLE_NOW_MSG:I = 0xb

.field static final IDLE_TIMEOUT:I = 0x4e20

.field static final IDLE_TIMEOUT_MSG:I = 0xa

.field static final IM_FEELING_LUCKY_MSG:I = 0xf

.field static final INSTRUMENTATION_KEY_DISPATCHING_TIMEOUT:I = 0xea60

.field static final KEY_DISPATCHING_TIMEOUT:I = 0x4e20

.field static final KILL_APPLICATION_MSG:I = 0x16

.field static final LAUNCH_TIMEOUT:I = 0x4e20

.field static final LAUNCH_TIMEOUT_MSG:I = 0x10

.field static final MAX_ACTIVITIES:I = 0x14

.field static final MAX_BROADCAST_HISTORY:I = 0x64

.field static final MAX_HIDDEN_APPS:I = 0xf

.field static final MAX_PROCESSES:I = 0x2

.field static final MAX_RECENT_TASKS:I = 0x14

.field static final MAX_SERVICE_INACTIVITY:I = 0x1b7740

.field static final MIN_CRASH_INTERVAL:I = 0xea60

.field static final MIN_HIDDEN_APPS:I = 0x2

.field static final MONITOR_CPU_MAX_TIME:J = 0xfffffffL

.field static final MONITOR_CPU_MIN_TIME:J = 0x1388L

.field static final MONITOR_CPU_USAGE:Z = true

.field static final MONITOR_THREAD_CPU_USAGE:Z = false

#the value of this static final field might be set in the static constructor
.field static final MY_PID:I = 0x0

.field static final PAGE_SIZE:I = 0x1000

.field static final PAUSE_TIMEOUT:I = 0x1f4

.field static final PAUSE_TIMEOUT_MSG:I = 0x9

.field static final PROC_START_TIMEOUT:I = 0x4e20

.field static final PROC_START_TIMEOUT_MSG:I = 0x14

.field static final RESUME_TOP_ACTIVITY_MSG:I = 0x13

#the value of this static final field might be set in the static constructor
.field static final SECONDARY_SERVER_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final SECONDARY_SERVER_MEM:I = 0x0

.field static final SERVICE_MIN_RESTART_TIME_BETWEEN:I = 0x2710

.field static final SERVICE_RESET_RUN_DURATION:I = 0xea60

.field static final SERVICE_RESTART_DURATION:I = 0x1388

.field static final SERVICE_RESTART_DURATION_FACTOR:I = 0x4

.field static final SERVICE_TIMEOUT:I = 0x7530

.field static final SERVICE_TIMEOUT_MSG:I = 0xc

.field static final SHOW_ACTIVITY_START_TIME:Z = true

.field static final SHOW_APP_STARTING_ICON:Z = true

.field static final SHOW_ERROR_MSG:I = 0x1

.field static final SHOW_FACTORY_ERROR_MSG:I = 0x3

.field static final SHOW_NOT_RESPONDING_MSG:I = 0x2

.field static final SHOW_UID_ERROR_MSG:I = 0xe

.field static final STOCK_PM_FLAGS:I = 0x400

.field static final SYSTEM_ADJ:I = -0x10

.field private static final SYSTEM_SECURE:Ljava/lang/String; = "ro.secure"

.field static final TAG:Ljava/lang/String; = "ActivityManager"

.field static final UPDATE_CONFIGURATION_MSG:I = 0x4

.field static final UPDATE_TIME_ZONE:I = 0xd

.field static final VALIDATE_TOKENS:Z = false

#the value of this static final field might be set in the static constructor
.field static final VISIBLE_APP_ADJ:I = 0x0

#the value of this static final field might be set in the static constructor
.field static final VISIBLE_APP_MEM:I = 0x0

.field static final WAIT_FOR_DEBUGGER_MSG:I = 0x6

.field static final localLOGV:Z

.field static mSelf:Lcom/android/server/am/ActivityManagerService;

.field static mSystemThread:Landroid/app/ActivityThread;

.field private static sCallerIdentity:Ljava/lang/ThreadLocal;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/lang/ThreadLocal",
            "<",
            "Lcom/android/server/am/ActivityManagerService$Identity;",
            ">;"
        }
    .end annotation
.end field


# instance fields
.field final GL_ES_VERSION:I

.field mAdjSeq:I

.field mAlwaysFinishActivities:Z

.field mAppBindArgs:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Landroid/os/IBinder;",
            ">;"
        }
    .end annotation
.end field

.field mAppSwitchesAllowedTime:J

.field mBackupAppName:Ljava/lang/String;

.field mBackupTarget:Lcom/android/server/am/BackupRecord;

.field final mBadProcesses:Lcom/android/server/ProcessMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/ProcessMap",
            "<",
            "Ljava/lang/Long;",
            ">;"
        }
    .end annotation
.end field

.field final mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

.field mBooted:Z

.field mBooting:Z

.field final mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

.field mBroadcastsScheduled:Z

.field final mCancelledThumbnails:Ljava/util/ArrayList;

.field mCheckedForSetup:Z

.field mConfigWillChange:Z

.field mConfiguration:Landroid/content/res/Configuration;

.field mConfigurationSeq:I

.field mContext:Landroid/content/Context;

.field mController:Landroid/app/IActivityController;

.field mCurTask:I

.field mDebugApp:Ljava/lang/String;

.field mDebugTransient:Z

.field mDidAppSwitch:Z

.field mDidDexOpt:Z

.field mDidUpdate:Z

.field mFactoryTest:I

.field final mFinishingActivities:Ljava/util/ArrayList;

.field mFocusedActivity:Lcom/android/server/am/HistoryRecord;

.field final mForegroundProcesses:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray",
            "<",
            "Lcom/android/server/am/ActivityManagerService$ForegroundToken;",
            ">;"
        }
    .end annotation
.end field

.field mGoingToSleep:Landroid/os/PowerManager$WakeLock;

.field private final mGrantedUriPermissions:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray",
            "<",
            "Ljava/util/HashMap",
            "<",
            "Landroid/net/Uri;",
            "Lcom/android/server/am/UriPermission;",
            ">;>;"
        }
    .end annotation
.end field

.field final mHandler:Landroid/os/Handler;

.field final mHistory:Ljava/util/ArrayList;

.field private mHomeProcess:Lcom/android/server/am/ProcessRecord;

.field mInitialStartTime:J

.field final mIntentSenderRecords:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Lcom/android/server/am/PendingIntentRecord$Key;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Lcom/android/server/am/PendingIntentRecord;",
            ">;>;"
        }
    .end annotation
.end field

.field private final mLRUActivities:Ljava/util/ArrayList;

.field final mLastCpuTime:Ljava/util/concurrent/atomic/AtomicLong;

.field mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

.field mLastWriteTime:J

.field mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

.field final mLaunchingProviders:Ljava/util/ArrayList;

.field final mLruProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field mLruSeq:I

.field final mNoAnimActivities:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/HistoryRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mOrderedBroadcasts:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/BroadcastRecord;",
            ">;"
        }
    .end annotation
.end field

.field mOrigDebugApp:Ljava/lang/String;

.field mOrigWaitForDebugger:Z

.field final mParallelBroadcasts:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/BroadcastRecord;",
            ">;"
        }
    .end annotation
.end field

.field mPausingActivity:Lcom/android/server/am/HistoryRecord;

.field final mPendingActivityLaunches:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;",
            ">;"
        }
    .end annotation
.end field

.field mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

.field final mPendingResultRecords:Ljava/util/HashSet;

.field final mPendingServices:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mPendingThumbnails:Ljava/util/ArrayList;

.field final mPersistentStartingProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mPidsSelfLocked:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field mProcDeaths:[I

.field final mProcessCrashTimes:Lcom/android/server/ProcessMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/ProcessMap",
            "<",
            "Ljava/lang/Long;",
            ">;"
        }
    .end annotation
.end field

.field mProcessLimit:I

.field final mProcessNames:Lcom/android/server/ProcessMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/ProcessMap",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mProcessStats:Lcom/android/server/ProcessStats;

.field final mProcessStatsMutexFree:Ljava/util/concurrent/atomic/AtomicBoolean;

.field final mProcessStatsThread:Ljava/lang/Thread;

.field final mProcessesOnHold:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mProcessesToGc:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mProvidersByClass:Ljava/util/HashMap;

.field final mProvidersByName:Ljava/util/HashMap;

.field final mReceiverResolver:Lcom/android/server/IntentResolver;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/IntentResolver",
            "<",
            "Lcom/android/server/am/BroadcastFilter;",
            "Lcom/android/server/am/BroadcastFilter;",
            ">;"
        }
    .end annotation
.end field

.field final mRecentTasks:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/TaskRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mRegisteredReceivers:Ljava/util/HashMap;

.field final mRemovedProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field mRequestPssCallback:Ljava/lang/Runnable;

.field final mRequestPssList:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mRestartingServices:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field mResumedActivity:Lcom/android/server/am/HistoryRecord;

.field final mServiceConnections:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Landroid/os/IBinder;",
            "Lcom/android/server/am/ConnectionRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mServices:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Landroid/content/ComponentName;",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mServicesByIntent:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Landroid/content/Intent$FilterComparison;",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field mShuttingDown:Z

.field mSimpleProcessManagement:Z

.field mSleeping:Z

.field mStartRunning:Z

.field final mStartingProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mStickyBroadcasts:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Ljava/util/ArrayList",
            "<",
            "Landroid/content/Intent;",
            ">;>;"
        }
    .end annotation
.end field

.field final mStoppingActivities:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/HistoryRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mStoppingServices:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mStringBuilder:Ljava/lang/StringBuilder;

.field mSystemReady:Z

.field mTopAction:Ljava/lang/String;

.field mTopComponent:Landroid/content/ComponentName;

.field mTopData:Ljava/lang/String;

.field mUidAlert:Landroid/app/AlertDialog;

.field final mUsageStatsService:Lcom/android/server/am/UsageStatsService;

.field mUserLeaving:Z

.field mWaitForDebugger:Z

.field final mWaitingActivityLaunched:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Landroid/app/IActivityManager$WaitResult;",
            ">;"
        }
    .end annotation
.end field

.field final mWaitingActivityVisible:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Landroid/app/IActivityManager$WaitResult;",
            ">;"
        }
    .end annotation
.end field

.field mWaitingUpdate:Z

.field final mWaitingVisibleActivities:Ljava/util/ArrayList;

.field final mWatchers:Landroid/os/RemoteCallbackList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/os/RemoteCallbackList",
            "<",
            "Landroid/app/IActivityWatcher;",
            ">;"
        }
    .end annotation
.end field

.field mWindowManager:Lcom/android/server/WindowManagerService;


# direct methods
.method static constructor <clinit>()V
    .locals 2

    .prologue
    .line 333
    const-string v0, "ro.FOREGROUND_APP_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 335
    const-string v0, "ro.VISIBLE_APP_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    .line 337
    const-string v0, "ro.SECONDARY_SERVER_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    .line 339
    const-string v0, "ro.BACKUP_APP_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    .line 341
    const-string v0, "ro.HOME_APP_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    .line 343
    const-string v0, "ro.HIDDEN_APP_MIN_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    .line 345
    const-string v0, "ro.EMPTY_APP_ADJ"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    .line 347
    sget v0, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    const/4 v1, 0x1

    sub-int/2addr v0, v1

    sput v0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    .line 348
    const-string v0, "ro.FOREGROUND_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_MEM:I

    .line 350
    const-string v0, "ro.VISIBLE_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_MEM:I

    .line 352
    const-string v0, "ro.SECONDARY_SERVER_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_MEM:I

    .line 354
    const-string v0, "ro.BACKUP_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_MEM:I

    .line 356
    const-string v0, "ro.HOME_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    .line 358
    const-string v0, "ro.HIDDEN_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MEM:I

    .line 360
    const-string v0, "ro.EMPTY_APP_MEM"

    invoke-static {v0}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v0

    mul-int/lit16 v0, v0, 0x1000

    sput v0, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_MEM:I

    .line 364
    invoke-static {}, Landroid/os/Process;->myPid()I

    move-result v0

    sput v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    .line 366
    const/4 v0, 0x0

    new-array v0, v0, [Ljava/lang/String;

    sput-object v0, Lcom/android/server/am/ActivityManagerService;->EMPTY_STRING_ARRAY:[Ljava/lang/String;

    .line 765
    new-instance v0, Ljava/lang/ThreadLocal;

    invoke-direct {v0}, Ljava/lang/ThreadLocal;-><init>()V

    sput-object v0, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    return-void
.end method

.method private constructor <init>()V
    .locals 10

    .prologue
    const-wide/16 v8, 0x0

    const/4 v7, 0x1

    const/4 v5, 0x0

    const/4 v6, 0x0

    .line 1412
    invoke-direct {p0}, Landroid/app/ActivityManagerNative;-><init>()V

    .line 384
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    .line 398
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    .line 404
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityLaunched:Ljava/util/ArrayList;

    .line 410
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityVisible:Ljava/util/ArrayList;

    .line 419
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    .line 427
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    .line 434
    const/16 v3, 0x64

    new-array v3, v3, [Lcom/android/server/am/BroadcastRecord;

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

    .line 440
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    .line 446
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 452
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 457
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 462
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    .line 469
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    .line 476
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    .line 483
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    .line 490
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    .line 496
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    .line 504
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    .line 512
    new-instance v3, Lcom/android/server/ProcessMap;

    invoke-direct {v3}, Lcom/android/server/ProcessMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    .line 518
    new-instance v3, Lcom/android/server/ProcessMap;

    invoke-direct {v3}, Lcom/android/server/ProcessMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    .line 528
    new-instance v3, Lcom/android/server/ProcessMap;

    invoke-direct {v3}, Lcom/android/server/ProcessMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    .line 537
    new-instance v3, Landroid/util/SparseArray;

    invoke-direct {v3}, Landroid/util/SparseArray;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    .line 549
    new-instance v3, Landroid/util/SparseArray;

    invoke-direct {v3}, Landroid/util/SparseArray;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    .line 557
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    .line 566
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    .line 573
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    .line 579
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    .line 588
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    .line 594
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    .line 608
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    .line 613
    new-instance v3, Ljava/util/HashSet;

    invoke-direct {v3}, Ljava/util/HashSet;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingResultRecords:Ljava/util/HashSet;

    .line 618
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    .line 628
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 635
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    .line 641
    new-instance v3, Lcom/android/server/am/ActivityManagerService$1;

    invoke-direct {v3, p0}, Lcom/android/server/am/ActivityManagerService$1;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    .line 661
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    .line 667
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    .line 673
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    .line 680
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    .line 689
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    .line 695
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    .line 701
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    .line 707
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    .line 708
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    .line 714
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    .line 720
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    .line 729
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    .line 736
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    .line 743
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    .line 748
    new-instance v3, Landroid/util/SparseArray;

    invoke-direct {v3}, Landroid/util/SparseArray;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    .line 783
    new-instance v3, Landroid/content/res/Configuration;

    invoke-direct {v3}, Landroid/content/res/Configuration;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    .line 789
    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    .line 811
    new-instance v3, Ljava/lang/StringBuilder;

    const/16 v4, 0x100

    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(I)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    .line 816
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    .line 820
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    .line 821
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 822
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingUpdate:Z

    .line 823
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mDidUpdate:Z

    .line 847
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    .line 852
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    .line 875
    iput v7, p0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 880
    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    .line 885
    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    .line 893
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    .line 899
    const/16 v3, 0x14

    new-array v3, v3, [I

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    .line 907
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 908
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 909
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    .line 910
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    .line 911
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    .line 912
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    .line 913
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 915
    new-instance v3, Landroid/os/RemoteCallbackList;

    invoke-direct {v3}, Landroid/os/RemoteCallbackList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    .line 927
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    .line 940
    new-instance v3, Lcom/android/server/ProcessStats;

    invoke-direct {v3, v6}, Lcom/android/server/ProcessStats;-><init>(Z)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    .line 942
    new-instance v3, Ljava/util/concurrent/atomic/AtomicLong;

    invoke-direct {v3, v8, v9}, Ljava/util/concurrent/atomic/AtomicLong;-><init>(J)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:Ljava/util/concurrent/atomic/AtomicLong;

    .line 943
    new-instance v3, Ljava/util/concurrent/atomic/AtomicBoolean;

    invoke-direct {v3, v7}, Ljava/util/concurrent/atomic/AtomicBoolean;-><init>(Z)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsMutexFree:Ljava/util/concurrent/atomic/AtomicBoolean;

    .line 945
    iput-wide v8, p0, Lcom/android/server/am/ActivityManagerService;->mLastWriteTime:J

    .line 947
    iput-wide v8, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    .line 952
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    .line 954
    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    .line 1012
    new-instance v3, Lcom/android/server/am/ActivityManagerService$2;

    invoke-direct {v3, p0}, Lcom/android/server/am/ActivityManagerService$2;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    .line 1413
    const-string v3, "ANDROID_SIMPLE_PROCESS_MANAGEMENT"

    invoke-static {v3}, Ljava/lang/System;->getenv(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 1414
    .local v2, v:Ljava/lang/String;
    if-eqz v2, :cond_0

    invoke-static {v2}, Ljava/lang/Integer;->getInteger(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    if-eqz v3, :cond_0

    .line 1415
    iput-boolean v7, p0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    .line 1417
    :cond_0
    const-string v3, "ANDROID_DEBUG_APP"

    invoke-static {v3}, Ljava/lang/System;->getenv(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 1418
    if-eqz v2, :cond_1

    .line 1419
    iput-boolean v7, p0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    .line 1422
    :cond_1
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Memory class: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/app/ActivityManager;->staticGetMemoryClass()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 1424
    invoke-static {}, Landroid/os/Environment;->getDataDirectory()Ljava/io/File;

    move-result-object v0

    .line 1425
    .local v0, dataDir:Ljava/io/File;
    new-instance v1, Ljava/io/File;

    const-string v3, "system"

    invoke-direct {v1, v0, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 1426
    .local v1, systemDir:Ljava/io/File;
    invoke-virtual {v1}, Ljava/io/File;->mkdirs()Z

    .line 1427
    new-instance v3, Lcom/android/server/am/BatteryStatsService;

    new-instance v4, Ljava/io/File;

    const-string v5, "batterystats.bin"

    invoke-direct {v4, v1, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v4}, Ljava/io/File;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Lcom/android/server/am/BatteryStatsService;-><init>(Ljava/lang/String;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    .line 1429
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v3}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/internal/os/BatteryStatsImpl;->readLocked()V

    .line 1430
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v3}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/internal/os/BatteryStatsImpl;->writeLocked()V

    .line 1432
    new-instance v3, Lcom/android/server/am/UsageStatsService;

    new-instance v4, Ljava/io/File;

    const-string v5, "usagestats"

    invoke-direct {v4, v1, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v4}, Ljava/io/File;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Lcom/android/server/am/UsageStatsService;-><init>(Ljava/lang/String;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    .line 1435
    const-string v3, "ro.opengles.version"

    invoke-static {v3, v6}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I

    move-result v3

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->GL_ES_VERSION:I

    .line 1438
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-virtual {v3}, Landroid/content/res/Configuration;->setToDefaults()V

    .line 1439
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-static {}, Ljava/util/Locale;->getDefault()Ljava/util/Locale;

    move-result-object v4

    iput-object v4, v3, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    .line 1440
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    invoke-virtual {v3}, Lcom/android/server/ProcessStats;->init()V

    .line 1443
    invoke-static {}, Lcom/android/server/Watchdog;->getInstance()Lcom/android/server/Watchdog;

    move-result-object v3

    invoke-virtual {v3, p0}, Lcom/android/server/Watchdog;->addMonitor(Lcom/android/server/Watchdog$Monitor;)V

    .line 1445
    new-instance v3, Lcom/android/server/am/ActivityManagerService$3;

    const-string v4, "ProcessStats"

    invoke-direct {v3, p0, v4}, Lcom/android/server/am/ActivityManagerService$3;-><init>(Lcom/android/server/am/ActivityManagerService;Ljava/lang/String;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    .line 1473
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    invoke-virtual {v3}, Ljava/lang/Thread;->start()V

    .line 1474
    return-void
.end method

.method synthetic constructor <init>(Lcom/android/server/am/ActivityManagerService$1;)V
    .locals 0
    .parameter "x0"

    .prologue
    .line 129
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;-><init>()V

    return-void
.end method

.method static synthetic access$000(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V
    .locals 0
    .parameter "x0"
    .parameter "x1"
    .parameter "x2"
    .parameter "x3"

    .prologue
    .line 129
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/am/ActivityManagerService;->appDiedLocked(Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V

    return-void
.end method

.method static synthetic access$100(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I
    .locals 1
    .parameter "x0"
    .parameter "x1"
    .parameter "x2"
    .parameter "x3"
    .parameter "x4"
    .parameter "x5"
    .parameter "x6"
    .parameter "x7"
    .parameter "x8"
    .parameter "x9"
    .parameter "x10"
    .parameter "x11"
    .parameter "x12"
    .parameter "x13"

    .prologue
    .line 129
    invoke-direct/range {p0 .. p13}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    move-result v0

    return v0
.end method

.method static synthetic access$200(Lcom/android/server/am/ActivityManagerService;Z)V
    .locals 0
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 129
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->processNextBroadcast(Z)V

    return-void
.end method

.method static synthetic access$300(Lcom/android/server/am/ActivityManagerService;)V
    .locals 0
    .parameter "x0"

    .prologue
    .line 129
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->broadcastTimeout()V

    return-void
.end method

.method static synthetic access$400(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/HistoryRecord;)Z
    .locals 1
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 129
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-result v0

    return v0
.end method

.method static synthetic access$500(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;)V
    .locals 0
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 129
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->processStartTimedOutLocked(Lcom/android/server/am/ProcessRecord;)V

    return-void
.end method

.method static synthetic access$600(Lcom/android/server/am/ActivityManagerService;Z)V
    .locals 0
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 129
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->doPendingActivityLaunchesLocked(Z)V

    return-void
.end method

.method static synthetic access$700(Lcom/android/server/am/ActivityManagerService;Ljava/lang/String;IZZZ)Z
    .locals 1
    .parameter "x0"
    .parameter "x1"
    .parameter "x2"
    .parameter "x3"
    .parameter "x4"
    .parameter "x5"

    .prologue
    .line 129
    invoke-direct/range {p0 .. p5}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    move-result v0

    return v0
.end method

.method private final addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V
    .locals 5
    .parameter "r"

    .prologue
    const/4 v4, 0x0

    .line 13051
    iget v0, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    if-gez v0, :cond_0

    .line 13059
    :goto_0
    return-void

    .line 13055
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

    const/4 v2, 0x1

    const/16 v3, 0x63

    invoke-static {v0, v4, v1, v2, v3}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    .line 13057
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p1, Lcom/android/server/am/BroadcastRecord;->finishTime:J

    .line 13058
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

    aput-object p1, v0, v4

    goto :goto_0
.end method

.method private final addRecentTaskLocked(Lcom/android/server/am/TaskRecord;)V
    .locals 5
    .parameter "task"

    .prologue
    .line 3988
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 3989
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_0
    if-ge v1, v0, :cond_3

    .line 3990
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/TaskRecord;

    .line 3991
    .local v2, tr:Lcom/android/server/am/TaskRecord;
    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    if-eqz v3, :cond_0

    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    iget-object v4, v2, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_1

    :cond_0
    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v3, :cond_2

    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    iget-object v4, v2, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v3, v4}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v3

    if-eqz v3, :cond_2

    .line 3993
    :cond_1
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 3994
    add-int/lit8 v1, v1, -0x1

    .line 3995
    add-int/lit8 v0, v0, -0x1

    .line 3996
    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-nez v3, :cond_2

    .line 3999
    move-object p1, v2

    .line 3989
    :cond_2
    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    .line 4003
    .end local v2           #tr:Lcom/android/server/am/TaskRecord;
    :cond_3
    const/16 v3, 0x14

    if-lt v0, v3, :cond_4

    .line 4004
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    const/4 v4, 0x1

    sub-int v4, v0, v4

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 4006
    :cond_4
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    const/4 v4, 0x0

    invoke-virtual {v3, v4, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 4007
    return-void
.end method

.method private final appDiedLocked(Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V
    .locals 10
    .parameter "app"
    .parameter "pid"
    .parameter "thread"

    .prologue
    .line 4719
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    const/4 v7, 0x0

    aget v8, v6, v7

    add-int/lit8 v8, v8, 0x1

    aput v8, v6, v7

    .line 4722
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v6, p2, :cond_8

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v6, :cond_8

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v6}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v6

    invoke-interface {p3}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v7

    if-ne v6, v7, :cond_8

    .line 4724
    iget-boolean v6, p1, Lcom/android/server/am/ProcessRecord;->killedBackground:Z

    if-nez v6, :cond_0

    .line 4725
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Process "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " (pid "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ") has died."

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4728
    :cond_0
    const/16 v6, 0x753b

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    iget v9, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4732
    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    if-nez v6, :cond_3

    const/4 v6, 0x1

    move v0, v6

    .line 4733
    .local v0, doLowMem:Z
    :goto_0
    const/4 v6, 0x0

    invoke-direct {p0, p1, v6}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 4735
    if-eqz v0, :cond_7

    .line 4739
    const/4 v1, 0x0

    .line 4740
    .local v1, haveBg:Z
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x1

    sub-int v2, v6, v7

    .local v2, i:I
    :goto_1
    if-ltz v2, :cond_1

    .line 4741
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ProcessRecord;

    .line 4742
    .local v5, rec:Lcom/android/server/am/ProcessRecord;
    iget-object v6, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v6, :cond_4

    iget v6, v5, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v6, v7, :cond_4

    .line 4743
    const/4 v1, 0x1

    .line 4748
    .end local v5           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_1
    if-nez v1, :cond_7

    .line 4749
    const-string v6, "ActivityManager"

    const-string v7, "Low Memory: No more background processes."

    invoke-static {v6, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4750
    const/16 v6, 0x7541

    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v7

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(II)I

    .line 4751
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    .line 4752
    .local v3, now:J
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x1

    sub-int v2, v6, v7

    :goto_2
    if-ltz v2, :cond_6

    .line 4753
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ProcessRecord;

    .line 4754
    .restart local v5       #rec:Lcom/android/server/am/ProcessRecord;
    if-eq v5, p1, :cond_2

    iget-object v6, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v6, :cond_2

    iget-wide v6, v5, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    const-wide/32 v8, 0xea60

    add-long/2addr v6, v8

    cmp-long v6, v6, v3

    if-gtz v6, :cond_2

    .line 4759
    iget v6, v5, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-gt v6, v7, :cond_5

    .line 4760
    const-wide/16 v6, 0x0

    iput-wide v6, v5, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    .line 4764
    :goto_3
    const/4 v6, 0x1

    iput-boolean v6, v5, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    .line 4765
    iput-wide v3, v5, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    .line 4766
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4767
    invoke-virtual {p0, v5}, Lcom/android/server/am/ActivityManagerService;->addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 4752
    :cond_2
    add-int/lit8 v2, v2, -0x1

    goto :goto_2

    .line 4732
    .end local v0           #doLowMem:Z
    .end local v1           #haveBg:Z
    .end local v2           #i:I
    .end local v3           #now:J
    .end local v5           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_3
    const/4 v6, 0x0

    move v0, v6

    goto :goto_0

    .line 4740
    .restart local v0       #doLowMem:Z
    .restart local v1       #haveBg:Z
    .restart local v2       #i:I
    .restart local v5       #rec:Lcom/android/server/am/ProcessRecord;
    :cond_4
    add-int/lit8 v2, v2, -0x1

    goto :goto_1

    .line 4762
    .restart local v3       #now:J
    :cond_5
    iget-wide v6, v5, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    iput-wide v6, v5, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    goto :goto_3

    .line 4770
    .end local v5           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_6
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    .line 4782
    .end local v0           #doLowMem:Z
    .end local v1           #haveBg:Z
    .end local v2           #i:I
    .end local v3           #now:J
    :cond_7
    :goto_4
    return-void

    .line 4773
    :cond_8
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eq v6, p2, :cond_7

    .line 4775
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Process "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " (pid "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ") has died and restarted (pid "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget v8, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ")."

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4777
    const/16 v6, 0x753b

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    iget v9, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_4
.end method

.method private final attachApplicationLocked(Landroid/app/IApplicationThread;I)Z
    .locals 32
    .parameter "thread"
    .parameter "pid"

    .prologue
    .line 5464
    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v0, p2

    move v1, v5

    if-eq v0, v1, :cond_0

    if-ltz p2, :cond_0

    .line 5465
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    monitor-enter v5

    .line 5466
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    move-object v0, v6

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Lcom/android/server/am/ProcessRecord;

    .line 5467
    .local v21, app:Lcom/android/server/am/ProcessRecord;
    monitor-exit v5
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5475
    :goto_0
    if-nez v21, :cond_3

    .line 5476
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "No pending application record for pid "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (IApplicationThread "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "); dropping process"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5478
    const/16 v5, 0x7551

    move v0, v5

    move/from16 v1, p2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(II)I

    .line 5479
    if-lez p2, :cond_2

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v0, p2

    move v1, v5

    if-eq v0, v1, :cond_2

    .line 5480
    invoke-static/range {p2 .. p2}, Landroid/os/Process;->killProcess(I)V

    .line 5488
    :goto_1
    const/4 v5, 0x0

    .line 5673
    :goto_2
    return v5

    .line 5467
    .end local v21           #app:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v6

    :try_start_1
    monitor-exit v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v6

    .line 5468
    :cond_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_1

    .line 5469
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Lcom/android/server/am/ProcessRecord;

    .line 5470
    .restart local v21       #app:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, v21

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Lcom/android/server/am/ProcessRecord;->setPid(I)V

    goto :goto_0

    .line 5472
    .end local v21           #app:Lcom/android/server/am/ProcessRecord;
    :cond_1
    const/16 v21, 0x0

    .restart local v21       #app:Lcom/android/server/am/ProcessRecord;
    goto :goto_0

    .line 5483
    :cond_2
    :try_start_2
    invoke-interface/range {p1 .. p1}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_2
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0

    goto :goto_1

    .line 5484
    :catch_0
    move-exception v5

    goto :goto_1

    .line 5493
    :cond_3
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v5, v0

    if-eqz v5, :cond_4

    .line 5494
    const/4 v5, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 5502
    :cond_4
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    .line 5504
    .local v6, processName:Ljava/lang/String;
    :try_start_3
    invoke-interface/range {p1 .. p1}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v5

    new-instance v7, Lcom/android/server/am/ActivityManagerService$AppDeathRecipient;

    move-object v0, v7

    move-object/from16 v1, p0

    move-object/from16 v2, v21

    move/from16 v3, p2

    move-object/from16 v4, p1

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService$AppDeathRecipient;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V

    const/4 v8, 0x0

    invoke-interface {v5, v7, v8}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V
    :try_end_3
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_1

    .line 5512
    const/16 v5, 0x753a

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    move-object/from16 v0, v21

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v9, v0

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v9, v0

    aput-object v9, v7, v8

    invoke-static {v5, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 5514
    move-object/from16 v0, p1

    move-object/from16 v1, v21

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    .line 5515
    const/16 v5, -0x64

    move v0, v5

    move-object/from16 v1, v21

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    move v0, v5

    move-object/from16 v1, v21

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 5516
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v21

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    .line 5517
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v21

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    .line 5518
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v21

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 5519
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v21

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 5520
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v21

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->debugging:Z

    .line 5522
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v7, 0x14

    move-object v0, v5

    move v1, v7

    move-object/from16 v2, v21

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5524
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v5, v0

    if-nez v5, :cond_5

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->isAllowedWhileBooting(Landroid/content/pm/ApplicationInfo;)Z

    move-result v5

    if-eqz v5, :cond_e

    :cond_5
    const/4 v5, 0x1

    move/from16 v29, v5

    .line 5525
    .local v29, normalMode:Z
    :goto_3
    if-eqz v29, :cond_f

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->generateApplicationProvidersLocked(Lcom/android/server/am/ProcessRecord;)Ljava/util/List;

    move-result-object v5

    move-object v8, v5

    .line 5527
    .local v8, providers:Ljava/util/List;
    :goto_4
    if-nez v29, :cond_6

    .line 5528
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Launching preboot mode app: "

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v5, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 5535
    :cond_6
    const/4 v13, 0x0

    .line 5536
    .local v13, testMode:I
    :try_start_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v5, v0

    if-eqz v5, :cond_7

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_7

    .line 5537
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    move v5, v0

    if-eqz v5, :cond_10

    const/4 v5, 0x2

    move v13, v5

    .line 5540
    :goto_5
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v21

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->debugging:Z

    .line 5541
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    move v5, v0

    if-eqz v5, :cond_7

    .line 5542
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 5543
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    move v5, v0

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 5548
    :cond_7
    const/16 v28, 0x0

    .line 5549
    .local v28, isRestrictedBackupMode:Z
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    if-eqz v5, :cond_9

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_9

    .line 5550
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/BackupRecord;->backupMode:I

    const/4 v7, 0x2

    if-eq v5, v7, :cond_8

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/BackupRecord;->backupMode:I

    const/4 v7, 0x1

    if-ne v5, v7, :cond_11

    :cond_8
    const/4 v5, 0x1

    move/from16 v28, v5

    .line 5554
    :cond_9
    :goto_6
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    if-eqz v5, :cond_12

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    :goto_7
    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 5557
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v5, v0

    if-eqz v5, :cond_a

    .line 5558
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 5562
    :cond_a
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    if-eqz v5, :cond_13

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    move-object v7, v5

    :goto_8
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v9, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationProfileFile:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationArguments:Landroid/os/Bundle;

    move-object v11, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    move-object v12, v0

    if-nez v28, :cond_b

    if-nez v29, :cond_14

    :cond_b
    const/4 v5, 0x1

    move v14, v5

    :goto_9
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v15, v0

    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->getCommonServicesLocked()Ljava/util/HashMap;

    move-result-object v16

    move-object/from16 v5, p1

    invoke-interface/range {v5 .. v16}, Landroid/app/IApplicationThread;->bindApplication(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;Ljava/util/List;Landroid/content/ComponentName;Ljava/lang/String;Landroid/os/Bundle;Landroid/app/IInstrumentationWatcher;IZLandroid/content/res/Configuration;Ljava/util/Map;)V

    .line 5568
    const/4 v5, 0x0

    const/4 v7, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move v2, v5

    move v3, v7

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 5569
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v9

    move-wide v0, v9

    move-object/from16 v2, v21

    iput-wide v0, v2, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    move-wide v0, v9

    move-object/from16 v2, v21

    iput-wide v0, v2, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J
    :try_end_4
    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_2

    .line 5582
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5583
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5585
    const/16 v22, 0x0

    .line 5586
    .local v22, badApp:Z
    const/16 v24, 0x0

    .line 5589
    .local v24, didSomething:Z
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 5590
    .local v26, hr:Lcom/android/server/am/HistoryRecord;
    if-eqz v26, :cond_c

    if-eqz v29, :cond_c

    .line 5591
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-nez v5, :cond_15

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v5, v7, :cond_15

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v6, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_15

    .line 5594
    const/4 v5, 0x1

    const/4 v7, 0x1

    :try_start_5
    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object/from16 v2, v21

    move v3, v5

    move v4, v7

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->realStartActivityLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/ProcessRecord;ZZ)Z
    :try_end_5
    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_3

    move-result v5

    if-eqz v5, :cond_c

    .line 5595
    const/16 v24, 0x1

    .line 5608
    .end local v8           #providers:Ljava/util/List;
    :cond_c
    :goto_a
    if-nez v22, :cond_17

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_17

    .line 5609
    const/16 v30, 0x0

    .line 5611
    .local v30, sr:Lcom/android/server/am/ServiceRecord;
    const/16 v27, 0x0

    .local v27, i:I
    :goto_b
    :try_start_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    move/from16 v0, v27

    move v1, v5

    if-ge v0, v1, :cond_17

    .line 5612
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v27

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v31

    move-object/from16 v0, v31

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object/from16 v30, v0

    .line 5613
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, v30

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    move-object v7, v0

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v5, v7, :cond_d

    move-object/from16 v0, v30

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v6, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
    :try_end_6
    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_6} :catch_4

    move-result v5

    if-nez v5, :cond_16

    .line 5611
    :cond_d
    :goto_c
    add-int/lit8 v27, v27, 0x1

    goto :goto_b

    .line 5506
    .end local v13           #testMode:I
    .end local v22           #badApp:Z
    .end local v24           #didSomething:Z
    .end local v26           #hr:Lcom/android/server/am/HistoryRecord;
    .end local v27           #i:I
    .end local v28           #isRestrictedBackupMode:Z
    .end local v29           #normalMode:Z
    .end local v30           #sr:Lcom/android/server/am/ServiceRecord;
    :catch_1
    move-exception v5

    move-object/from16 v25, v5

    .line 5507
    .local v25, e:Landroid/os/RemoteException;
    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/ProcessRecord;->resetPackageList()V

    .line 5508
    const-string v5, "link fail"

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move-object v2, v5

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 5509
    const/4 v5, 0x0

    goto/16 :goto_2

    .line 5524
    .end local v25           #e:Landroid/os/RemoteException;
    :cond_e
    const/4 v5, 0x0

    move/from16 v29, v5

    goto/16 :goto_3

    .line 5525
    .restart local v29       #normalMode:Z
    :cond_f
    const/4 v5, 0x0

    move-object v8, v5

    goto/16 :goto_4

    .line 5537
    .restart local v8       #providers:Ljava/util/List;
    .restart local v13       #testMode:I
    :cond_10
    const/4 v5, 0x1

    move v13, v5

    goto/16 :goto_5

    .line 5550
    .restart local v28       #isRestrictedBackupMode:Z
    :cond_11
    const/4 v5, 0x0

    move/from16 v28, v5

    goto/16 :goto_6

    .line 5554
    :cond_12
    :try_start_7
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    goto/16 :goto_7

    .line 5562
    :cond_13
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0
    :try_end_7
    .catch Ljava/lang/Exception; {:try_start_7 .. :try_end_7} :catch_2

    move-object v7, v5

    goto/16 :goto_8

    :cond_14
    const/4 v5, 0x0

    move v14, v5

    goto/16 :goto_9

    .line 5570
    .end local v28           #isRestrictedBackupMode:Z
    :catch_2
    move-exception v5

    move-object/from16 v25, v5

    .line 5574
    .local v25, e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    const-string v7, "Exception thrown during bind!"

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v25

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5576
    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/ProcessRecord;->resetPackageList()V

    .line 5577
    const-string v5, "bind fail"

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move-object v2, v5

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 5578
    const/4 v5, 0x0

    goto/16 :goto_2

    .line 5597
    .end local v25           #e:Ljava/lang/Exception;
    .restart local v22       #badApp:Z
    .restart local v24       #didSomething:Z
    .restart local v26       #hr:Lcom/android/server/am/HistoryRecord;
    .restart local v28       #isRestrictedBackupMode:Z
    :catch_3
    move-exception v25

    .line 5598
    .restart local v25       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Exception in new application when starting activity "

    .end local v8           #providers:Ljava/util/List;
    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v8, v0

    invoke-virtual {v8}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v8

    invoke-virtual {v8}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v25

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5600
    const/16 v22, 0x1

    .line 5601
    goto/16 :goto_a

    .line 5603
    .end local v25           #e:Ljava/lang/Exception;
    .restart local v8       #providers:Ljava/util/List;
    :cond_15
    const/4 v5, 0x0

    const/4 v7, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    move-object v3, v6

    move v4, v7

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    goto/16 :goto_a

    .line 5618
    .end local v8           #providers:Ljava/util/List;
    .restart local v27       #i:I
    .restart local v30       #sr:Lcom/android/server/am/ServiceRecord;
    :cond_16
    :try_start_8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v27

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 5619
    add-int/lit8 v27, v27, -0x1

    .line 5620
    move-object/from16 v0, p0

    move-object/from16 v1, v30

    move-object/from16 v2, v21

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->realStartServiceLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_8
    .catch Ljava/lang/Exception; {:try_start_8 .. :try_end_8} :catch_4

    .line 5621
    const/16 v24, 0x1

    goto/16 :goto_c

    .line 5623
    :catch_4
    move-exception v5

    move-object/from16 v25, v5

    .line 5624
    .restart local v25       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    .end local v6           #processName:Ljava/lang/String;
    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception in new application when starting service "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v30

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v25

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5626
    const/16 v22, 0x1

    .line 5631
    .end local v25           #e:Ljava/lang/Exception;
    .end local v27           #i:I
    .end local v30           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_17
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v23, v0

    .line 5632
    .local v23, br:Lcom/android/server/am/BroadcastRecord;
    if-nez v22, :cond_18

    if-eqz v23, :cond_18

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v21

    if-ne v0, v1, :cond_18

    .line 5634
    const/4 v5, 0x0

    :try_start_9
    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 5635
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    move-object/from16 v2, v21

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_9
    .catch Ljava/lang/Exception; {:try_start_9 .. :try_end_9} :catch_5

    .line 5636
    const/16 v24, 0x1

    .line 5651
    :cond_18
    :goto_d
    if-nez v22, :cond_19

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    if-eqz v5, :cond_19

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/BackupRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v5, v6, :cond_19

    .line 5653
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/BackupRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 5655
    :try_start_a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/BackupRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v6, v0

    iget v6, v6, Lcom/android/server/am/BackupRecord;->backupMode:I

    move-object/from16 v0, p1

    move-object v1, v5

    move v2, v6

    invoke-interface {v0, v1, v2}, Landroid/app/IApplicationThread;->scheduleCreateBackupAgent(Landroid/content/pm/ApplicationInfo;I)V
    :try_end_a
    .catch Ljava/lang/Exception; {:try_start_a .. :try_end_a} :catch_6

    .line 5662
    :cond_19
    :goto_e
    if-eqz v22, :cond_1a

    .line 5665
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 5666
    const/4 v5, 0x0

    goto/16 :goto_2

    .line 5637
    :catch_5
    move-exception v5

    move-object/from16 v25, v5

    .line 5638
    .restart local v25       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception in new application when starting receiver "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    move-object v7, v0

    invoke-virtual {v7}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v25

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5640
    const/16 v22, 0x1

    .line 5641
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 5642
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v15, v0

    move-object/from16 v0, v23

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move/from16 v16, v0

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object/from16 v17, v0

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object/from16 v18, v0

    move-object/from16 v0, v23

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move/from16 v19, v0

    const/16 v20, 0x1

    move-object/from16 v14, p0

    invoke-direct/range {v14 .. v20}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 5644
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 5646
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v23

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    goto/16 :goto_d

    .line 5656
    .end local v25           #e:Ljava/lang/Exception;
    :catch_6
    move-exception v5

    move-object/from16 v25, v5

    .line 5657
    .restart local v25       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    const-string v6, "Exception scheduling backup agent creation: "

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5658
    invoke-virtual/range {v25 .. v25}, Ljava/lang/Exception;->printStackTrace()V

    goto :goto_e

    .line 5669
    .end local v25           #e:Ljava/lang/Exception;
    :cond_1a
    if-nez v24, :cond_1b

    .line 5670
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 5673
    :cond_1b
    const/4 v5, 0x1

    goto/16 :goto_2
.end method

.method private final bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V
    .locals 12
    .parameter "r"
    .parameter "force"

    .prologue
    .line 11259
    if-nez p2, :cond_1

    iget-boolean v8, p1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    if-eqz v8, :cond_1

    .line 11374
    :cond_0
    :goto_0
    return-void

    .line 11262
    :cond_1
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->size()I

    move-result v8

    if-lez v8, :cond_4

    .line 11263
    if-nez p2, :cond_3

    .line 11266
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v8

    invoke-interface {v8}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v6

    .line 11267
    .local v6, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_2
    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_3

    .line 11268
    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ConnectionRecord;

    .line 11269
    .local v2, cr:Lcom/android/server/am/ConnectionRecord;
    iget v8, v2, Lcom/android/server/am/ConnectionRecord;->flags:I

    and-int/lit8 v8, v8, 0x1

    if-eqz v8, :cond_2

    goto :goto_0

    .line 11277
    .end local v2           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v6           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_3
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v8

    invoke-interface {v8}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v6

    .line 11278
    .restart local v6       #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_1
    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_4

    .line 11279
    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ConnectionRecord;

    .line 11282
    .local v1, c:Lcom/android/server/am/ConnectionRecord;
    :try_start_0
    iget-object v8, v1, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    const/4 v10, 0x0

    invoke-interface {v8, v9, v10}, Landroid/app/IServiceConnection;->connected(Landroid/content/ComponentName;Landroid/os/IBinder;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_1

    .line 11283
    :catch_0
    move-exception v8

    move-object v3, v8

    .line 11284
    .local v3, e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Failure disconnecting service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " to connection "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v1, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v10}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " (in "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v10, v10, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v10, v10, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ")"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_1

    .line 11292
    .end local v1           #c:Lcom/android/server/am/ConnectionRecord;
    .end local v3           #e:Ljava/lang/Exception;
    .end local v6           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_4
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->size()I

    move-result v8

    if-lez v8, :cond_6

    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v8, :cond_6

    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_6

    .line 11293
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v8

    invoke-interface {v8}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v7

    .line 11294
    .local v7, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :cond_5
    :goto_2
    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_6

    .line 11295
    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/IntentBindRecord;

    .line 11298
    .local v5, ibr:Lcom/android/server/am/IntentBindRecord;
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v8, :cond_5

    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_5

    iget-boolean v8, v5, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    if-eqz v8, :cond_5

    .line 11300
    :try_start_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11301
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11302
    const/4 v8, 0x0

    iput-boolean v8, v5, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    .line 11303
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v9, v5, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v9}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v9

    invoke-interface {v8, p1, v9}, Landroid/app/IApplicationThread;->scheduleUnbindService(Landroid/os/IBinder;Landroid/content/Intent;)V
    :try_end_1
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1

    goto :goto_2

    .line 11305
    :catch_1
    move-exception v8

    move-object v3, v8

    .line 11306
    .restart local v3       #e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Exception when unbinding service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 11308
    const/4 v8, 0x1

    invoke-virtual {p0, p1, v8}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto :goto_2

    .line 11316
    .end local v3           #e:Ljava/lang/Exception;
    .end local v5           #ibr:Lcom/android/server/am/IntentBindRecord;
    .end local v7           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :cond_6
    const/16 v8, 0x754f

    const/4 v9, 0x3

    new-array v9, v9, [Ljava/lang/Object;

    const/4 v10, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v11

    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v11

    aput-object v11, v9, v10

    const/4 v10, 0x1

    iget-object v11, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    aput-object v11, v9, v10

    const/4 v10, 0x2

    iget-object v11, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v11, :cond_8

    iget-object v11, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v11, v11, Lcom/android/server/am/ProcessRecord;->pid:I

    :goto_3
    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v11

    aput-object v11, v9, v10

    invoke-static {v8, v9}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 11320
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v8, v9}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11321
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v8, v9}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11323
    const/4 v8, 0x0

    iput v8, p1, Lcom/android/server/am/ServiceRecord;->totalRestartCount:I

    .line 11324
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z

    .line 11327
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 11328
    .local v0, N:I
    const/4 v4, 0x0

    .local v4, i:I
    :goto_4
    if-ge v4, v0, :cond_9

    .line 11329
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v8, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v8

    if-ne v8, p1, :cond_7

    .line 11330
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v8, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 11333
    add-int/lit8 v4, v4, -0x1

    .line 11334
    add-int/lit8 v0, v0, -0x1

    .line 11328
    :cond_7
    add-int/lit8 v4, v4, 0x1

    goto :goto_4

    .line 11316
    .end local v0           #N:I
    .end local v4           #i:I
    :cond_8
    const/4 v11, -0x1

    goto :goto_3

    .line 11338
    .restart local v0       #N:I
    .restart local v4       #i:I
    :cond_9
    invoke-virtual {p1}, Lcom/android/server/am/ServiceRecord;->cancelNotification()V

    .line 11339
    const/4 v8, 0x0

    iput-boolean v8, p1, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    .line 11340
    const/4 v8, 0x0

    iput v8, p1, Lcom/android/server/am/ServiceRecord;->foregroundId:I

    .line 11341
    const/4 v8, 0x0

    iput-object v8, p1, Lcom/android/server/am/ServiceRecord;->foregroundNoti:Landroid/app/Notification;

    .line 11344
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->clear()V

    .line 11345
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->clear()V

    .line 11347
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v8, :cond_0

    .line 11348
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v8}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v8

    monitor-enter v8

    .line 11349
    :try_start_2
    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v9}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopLaunchedLocked()V

    .line 11350
    monitor-exit v8
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 11351
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v8, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11352
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_0

    .line 11356
    :try_start_3
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11357
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v8, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11358
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11359
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v8, p1}, Landroid/app/IApplicationThread;->scheduleStopService(Landroid/os/IBinder;)V
    :try_end_3
    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_2

    .line 11365
    :goto_5
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v9, 0x0

    invoke-virtual {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V

    goto/16 :goto_0

    .line 11350
    :catchall_0
    move-exception v9

    :try_start_4
    monitor-exit v8
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v9

    .line 11360
    :catch_2
    move-exception v8

    move-object v3, v8

    .line 11361
    .restart local v3       #e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Exception when stopping service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 11363
    const/4 v8, 0x1

    invoke-virtual {p0, p1, v8}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto :goto_5
.end method

.method private final bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z
    .locals 10
    .parameter "r"
    .parameter "intentFlags"
    .parameter "whileRestarting"

    .prologue
    .line 11204
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_0

    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_0

    .line 11205
    const/4 v0, 0x0

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->sendServiceArgsLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11206
    const/4 v0, 0x1

    .line 11251
    :goto_0
    return v0

    .line 11209
    :cond_0
    if-nez p3, :cond_1

    iget-wide v2, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    const-wide/16 v4, 0x0

    cmp-long v0, v2, v4

    if-lez v0, :cond_1

    .line 11211
    const/4 v0, 0x1

    goto :goto_0

    .line 11219
    :cond_1
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 11221
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    .line 11222
    .local v1, appName:Ljava/lang/String;
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v1, v0}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v8

    .line 11223
    .local v8, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v8, :cond_2

    iget-object v0, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_2

    .line 11225
    :try_start_0
    invoke-direct {p0, p1, v8}, Lcom/android/server/am/ActivityManagerService;->realStartServiceLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 11226
    const/4 v0, 0x1

    goto :goto_0

    .line 11227
    :catch_0
    move-exception v9

    .line 11228
    .local v9, e:Landroid/os/RemoteException;
    const-string v0, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Exception when starting service "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 11237
    .end local v9           #e:Landroid/os/RemoteException;
    :cond_2
    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v3, 0x1

    const-string v5, "service"

    iget-object v6, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    const/4 v7, 0x0

    move-object v0, p0

    move v4, p2

    invoke-direct/range {v0 .. v7}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    if-nez v0, :cond_3

    .line 11239
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    .end local v1           #appName:Ljava/lang/String;
    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to launch app "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, "/"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " for service "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v2}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ": process is bad"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11243
    const/4 v0, 0x1

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11244
    const/4 v0, 0x0

    goto/16 :goto_0

    .line 11247
    .restart local v1       #appName:Ljava/lang/String;
    :cond_3
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_4

    .line 11248
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11251
    :cond_4
    const/4 v0, 0x1

    goto/16 :goto_0
.end method

.method private final broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I
    .locals 61
    .parameter "callerApp"
    .parameter "callerPackage"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "map"
    .parameter "requiredPermission"
    .parameter "ordered"
    .parameter "sticky"
    .parameter "callingPid"
    .parameter "callingUid"

    .prologue
    .line 12354
    new-instance v44, Landroid/content/Intent;

    move-object/from16 v0, v44

    move-object/from16 v1, p3

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    .line 12359
    .end local p3
    .local v44, intent:Landroid/content/Intent;
    if-eqz p5, :cond_0

    if-nez p10, :cond_0

    .line 12360
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Broadcast "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v44

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " not ordered but result callback requested!"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12366
    :cond_0
    const-string v5, "android.intent.action.UID_REMOVED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v60

    .line 12368
    .local v60, uidRemoved:Z
    const-string v5, "android.intent.action.PACKAGE_REMOVED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_1

    const-string v5, "android.intent.action.PACKAGE_CHANGED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_1

    const-string v5, "android.intent.action.EXTERNAL_APPLICATIONS_UNAVAILABLE"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_1

    if-eqz v60, :cond_2

    .line 12372
    :cond_1
    const-string v5, "android.permission.BROADCAST_PACKAGE_REMOVED"

    const/4 v6, -0x1

    move-object/from16 v0, p0

    move-object v1, v5

    move/from16 v2, p12

    move/from16 v3, p13

    move v4, v6

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v5

    if-nez v5, :cond_a

    .line 12376
    if-eqz v60, :cond_6

    .line 12377
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getExtras()Landroid/os/Bundle;

    move-result-object v45

    .line 12378
    .local v45, intentExtras:Landroid/os/Bundle;
    if-eqz v45, :cond_5

    const-string v5, "android.intent.extra.UID"

    move-object/from16 v0, v45

    move-object v1, v5

    invoke-virtual {v0, v1}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I

    move-result v5

    move/from16 v59, v5

    .line 12380
    .local v59, uid:I
    :goto_0
    if-ltz v59, :cond_2

    .line 12381
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v37

    .line 12382
    .local v37, bs:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v37

    .line 12383
    :try_start_0
    move-object/from16 v0, v37

    move/from16 v1, v59

    invoke-virtual {v0, v1}, Lcom/android/internal/os/BatteryStatsImpl;->removeUidStatsLocked(I)V

    .line 12384
    monitor-exit v37
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 12429
    .end local v37           #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v45           #intentExtras:Landroid/os/Bundle;
    .end local v59           #uid:I
    :cond_2
    :goto_1
    const-string v5, "android.intent.action.TIMEZONE_CHANGED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_3

    .line 12430
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0xd

    invoke-virtual {v5, v6}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    .line 12437
    :cond_3
    const/16 v5, 0x3e8

    move/from16 v0, p13

    move v1, v5

    if-eq v0, v1, :cond_4

    const/16 v5, 0x3e9

    move/from16 v0, p13

    move v1, v5

    if-eq v0, v1, :cond_4

    const/16 v5, 0x7d0

    move/from16 v0, p13

    move v1, v5

    if-eq v0, v1, :cond_4

    if-nez p13, :cond_b

    .line 12457
    :cond_4
    if-eqz p11, :cond_12

    .line 12458
    const-string v5, "android.permission.BROADCAST_STICKY"

    move-object/from16 v0, p0

    move-object v1, v5

    move/from16 v2, p12

    move/from16 v3, p13

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkPermission(Ljava/lang/String;II)I

    move-result v5

    if-eqz v5, :cond_d

    .line 12461
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: broadcastIntent() requesting a sticky broadcast from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p12

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p13

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " requires "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "android.permission.BROADCAST_STICKY"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v51

    .line 12464
    .local v51, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12465
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 12378
    .end local v51           #msg:Ljava/lang/String;
    .restart local v45       #intentExtras:Landroid/os/Bundle;
    :cond_5
    const/4 v5, -0x1

    move/from16 v59, v5

    goto/16 :goto_0

    .line 12384
    .restart local v37       #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v59       #uid:I
    :catchall_0
    move-exception v5

    :try_start_1
    monitor-exit v37
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v5

    .line 12389
    .end local v37           #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v45           #intentExtras:Landroid/os/Bundle;
    .end local v59           #uid:I
    :cond_6
    const-string v5, "android.intent.action.EXTERNAL_APPLICATIONS_UNAVAILABLE"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_8

    .line 12390
    const-string v5, "android.intent.extra.changed_package_list"

    move-object/from16 v0, v44

    move-object v1, v5

    invoke-virtual {v0, v1}, Landroid/content/Intent;->getStringArrayExtra(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v49

    .line 12391
    .local v49, list:[Ljava/lang/String;
    if-eqz v49, :cond_2

    move-object/from16 v0, v49

    array-length v0, v0

    move v5, v0

    if-lez v5, :cond_2

    .line 12392
    move-object/from16 v36, v49

    .local v36, arr$:[Ljava/lang/String;
    move-object/from16 v0, v36

    array-length v0, v0

    move/from16 v48, v0

    .local v48, len$:I
    const/16 v43, 0x0

    .local v43, i$:I
    :goto_2
    move/from16 v0, v43

    move/from16 v1, v48

    if-ge v0, v1, :cond_7

    aget-object v6, v36, v43

    .line 12393
    .local v6, pkg:Ljava/lang/String;
    const/4 v7, -0x1

    const/4 v8, 0x0

    const/4 v9, 0x1

    const/4 v10, 0x1

    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v10}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 12392
    add-int/lit8 v43, v43, 0x1

    goto :goto_2

    .line 12395
    .end local v6           #pkg:Ljava/lang/String;
    :cond_7
    const/4 v5, 0x1

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, v49

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->sendPackageBroadcastLocked(I[Ljava/lang/String;)V

    goto/16 :goto_1

    .line 12399
    .end local v36           #arr$:[Ljava/lang/String;
    .end local v43           #i$:I
    .end local v48           #len$:I
    .end local v49           #list:[Ljava/lang/String;
    :cond_8
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v40

    .line 12401
    .local v40, data:Landroid/net/Uri;
    if-eqz v40, :cond_2

    invoke-virtual/range {v40 .. v40}, Landroid/net/Uri;->getSchemeSpecificPart()Ljava/lang/String;

    move-result-object v8

    .local v8, ssp:Ljava/lang/String;
    if-eqz v8, :cond_2

    .line 12402
    const-string v5, "android.intent.extra.DONT_KILL_APP"

    const/4 v6, 0x0

    move-object/from16 v0, v44

    move-object v1, v5

    move v2, v6

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->getBooleanExtra(Ljava/lang/String;Z)Z

    move-result v5

    if-nez v5, :cond_9

    .line 12403
    const-string v5, "android.intent.extra.UID"

    const/4 v6, -0x1

    move-object/from16 v0, v44

    move-object v1, v5

    move v2, v6

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I

    move-result v9

    const/4 v10, 0x0

    const/4 v11, 0x1

    const/4 v12, 0x1

    move-object/from16 v7, p0

    invoke-direct/range {v7 .. v12}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 12406
    :cond_9
    const-string v5, "android.intent.action.PACKAGE_REMOVED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_2

    .line 12407
    const/4 v5, 0x0

    const/4 v6, 0x1

    new-array v6, v6, [Ljava/lang/String;

    const/4 v7, 0x0

    aput-object v8, v6, v7

    move-object/from16 v0, p0

    move v1, v5

    move-object v2, v6

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->sendPackageBroadcastLocked(I[Ljava/lang/String;)V

    goto/16 :goto_1

    .line 12414
    .end local v8           #ssp:Ljava/lang/String;
    .end local v40           #data:Landroid/net/Uri;
    :cond_a
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " broadcast from "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p12

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p13

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " requires "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "android.permission.BROADCAST_PACKAGE_REMOVED"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v51

    .line 12419
    .restart local v51       #msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12420
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 12440
    .end local v51           #msg:Ljava/lang/String;
    :cond_b
    if-eqz p1, :cond_c

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v5, v0

    if-nez v5, :cond_4

    .line 12442
    :cond_c
    :try_start_2
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-interface {v5, v6}, Landroid/content/pm/IPackageManager;->isProtectedBroadcast(Ljava/lang/String;)Z

    move-result v5

    if-eqz v5, :cond_4

    .line 12444
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: not allowed to send broadcast "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p12

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p13

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v51

    .line 12447
    .restart local v51       #msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12448
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v51

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5
    :try_end_2
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 12450
    .end local v51           #msg:Ljava/lang/String;
    :catch_0
    move-exception v5

    move-object/from16 v41, v5

    .line 12451
    .local v41, e:Landroid/os/RemoteException;
    const-string v5, "ActivityManager"

    const-string v6, "Remote exception"

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v41

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 12452
    const/4 v5, 0x0

    .line 12664
    .end local v41           #e:Landroid/os/RemoteException;
    .end local p1
    :goto_3
    return v5

    .line 12467
    .restart local p1
    :cond_d
    if-eqz p9, :cond_e

    .line 12468
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Can\'t broadcast sticky intent "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v44

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " and enforce permission "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p9

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12470
    const/4 v5, -0x1

    goto :goto_3

    .line 12472
    :cond_e
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    if-eqz v5, :cond_f

    .line 12473
    new-instance v5, Ljava/lang/SecurityException;

    const-string v6, "Sticky broadcasts can\'t target a specific component"

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 12476
    :cond_f
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    move-object v5, v0

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v50

    check-cast v50, Ljava/util/ArrayList;

    .line 12477
    .local v50, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    if-nez v50, :cond_10

    .line 12478
    new-instance v50, Ljava/util/ArrayList;

    .end local v50           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    invoke-direct/range {v50 .. v50}, Ljava/util/ArrayList;-><init>()V

    .line 12479
    .restart local v50       #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    move-object v5, v0

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v50

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 12481
    :cond_10
    invoke-virtual/range {v50 .. v50}, Ljava/util/ArrayList;->size()I

    move-result v32

    .line 12483
    .local v32, N:I
    const/16 v42, 0x0

    .local v42, i:I
    :goto_4
    move/from16 v0, v42

    move/from16 v1, v32

    if-ge v0, v1, :cond_11

    .line 12484
    move-object/from16 v0, v50

    move/from16 v1, v42

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p3

    check-cast p3, Landroid/content/Intent;

    move-object/from16 v0, v44

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v5

    if-eqz v5, :cond_1a

    .line 12486
    new-instance v5, Landroid/content/Intent;

    move-object v0, v5

    move-object/from16 v1, v44

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    move-object/from16 v0, v50

    move/from16 v1, v42

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->set(ILjava/lang/Object;)Ljava/lang/Object;

    .line 12490
    :cond_11
    move/from16 v0, v42

    move/from16 v1, v32

    if-lt v0, v1, :cond_12

    .line 12491
    new-instance v5, Landroid/content/Intent;

    move-object v0, v5

    move-object/from16 v1, v44

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    move-object/from16 v0, v50

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 12496
    .end local v32           #N:I
    .end local v42           #i:I
    .end local v50           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    :cond_12
    const/16 v24, 0x0

    .line 12497
    .local v24, receivers:Ljava/util/List;
    const/16 v16, 0x0

    .line 12499
    .local v16, registeredReceivers:Ljava/util/List;,"Ljava/util/List<Lcom/android/server/am/BroadcastFilter;>;"
    :try_start_3
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    if-eqz v5, :cond_1b

    .line 12501
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v6

    const/16 v7, 0x400

    invoke-interface {v5, v6, v7}, Landroid/content/pm/IPackageManager;->getReceiverInfo(Landroid/content/ComponentName;I)Landroid/content/pm/ActivityInfo;

    move-result-object v35

    .line 12503
    .local v35, ai:Landroid/content/pm/ActivityInfo;
    if-eqz v35, :cond_13

    .line 12504
    new-instance v53, Ljava/util/ArrayList;

    invoke-direct/range {v53 .. v53}, Ljava/util/ArrayList;-><init>()V
    :try_end_3
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_1

    .line 12505
    .end local v24           #receivers:Ljava/util/List;
    .local v53, receivers:Ljava/util/List;
    :try_start_4
    new-instance v56, Landroid/content/pm/ResolveInfo;

    invoke-direct/range {v56 .. v56}, Landroid/content/pm/ResolveInfo;-><init>()V

    .line 12506
    .local v56, ri:Landroid/content/pm/ResolveInfo;
    move-object/from16 v0, v35

    move-object/from16 v1, v56

    iput-object v0, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 12507
    move-object/from16 v0, v53

    move-object/from16 v1, v56

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_4
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_2

    move-object/from16 v24, v53

    .line 12523
    .end local v35           #ai:Landroid/content/pm/ActivityInfo;
    .end local v53           #receivers:Ljava/util/List;
    .end local v56           #ri:Landroid/content/pm/ResolveInfo;
    .restart local v24       #receivers:Ljava/util/List;
    :cond_13
    :goto_5
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getFlags()I

    move-result v5

    const/high16 v6, 0x2000

    and-int/2addr v5, v6

    if-eqz v5, :cond_1d

    const/4 v5, 0x1

    move/from16 v54, v5

    .line 12529
    .local v54, replacePending:Z
    :goto_6
    if-eqz v16, :cond_1e

    invoke-interface/range {v16 .. v16}, Ljava/util/List;->size()I

    move-result v5

    move/from16 v33, v5

    .line 12530
    .local v33, NR:I
    :goto_7
    if-nez p10, :cond_16

    if-lez v33, :cond_16

    .line 12534
    new-instance v9, Lcom/android/server/am/BroadcastRecord;

    const/16 v23, 0x0

    move-object/from16 v10, v44

    move-object/from16 v11, p1

    move-object/from16 v12, p2

    move/from16 v13, p12

    move/from16 v14, p13

    move-object/from16 v15, p9

    move-object/from16 v17, p5

    move/from16 v18, p6

    move-object/from16 v19, p7

    move-object/from16 v20, p8

    move/from16 v21, p10

    move/from16 v22, p11

    invoke-direct/range {v9 .. v23}, Lcom/android/server/am/BroadcastRecord;-><init>(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;IILjava/lang/String;Ljava/util/List;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;ZZZ)V

    .line 12541
    .local v9, r:Lcom/android/server/am/BroadcastRecord;
    const/16 v55, 0x0

    .line 12542
    .local v55, replaced:Z
    if-eqz v54, :cond_14

    .line 12543
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    const/4 v6, 0x1

    sub-int v42, v5, v6

    .restart local v42       #i:I
    :goto_8
    if-ltz v42, :cond_14

    .line 12544
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v42

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p3

    check-cast p3, Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, v44

    move-object v1, v5

    invoke-virtual {v0, v1}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v5

    if-eqz v5, :cond_1f

    .line 12547
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v42

    move-object v2, v9

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->set(ILjava/lang/Object;)Ljava/lang/Object;

    .line 12548
    const/16 v55, 0x1

    .line 12553
    .end local v42           #i:I
    :cond_14
    if-nez v55, :cond_15

    .line 12554
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 12555
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 12557
    :cond_15
    const/16 v16, 0x0

    .line 12558
    const/16 v33, 0x0

    .line 12562
    .end local v9           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v55           #replaced:Z
    :cond_16
    const/16 v46, 0x0

    .line 12563
    .local v46, ir:I
    if-eqz v24, :cond_27

    .line 12570
    const/16 v58, 0x0

    .line 12571
    .local v58, skipPackages:[Ljava/lang/String;
    const-string v5, "android.intent.action.PACKAGE_ADDED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_17

    const-string v5, "android.intent.action.PACKAGE_RESTARTED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_17

    const-string v5, "android.intent.action.PACKAGE_DATA_CLEARED"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_20

    .line 12574
    :cond_17
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v40

    .line 12575
    .restart local v40       #data:Landroid/net/Uri;
    if-eqz v40, :cond_18

    .line 12576
    invoke-virtual/range {v40 .. v40}, Landroid/net/Uri;->getSchemeSpecificPart()Ljava/lang/String;

    move-result-object v52

    .line 12577
    .local v52, pkgName:Ljava/lang/String;
    if-eqz v52, :cond_18

    .line 12578
    const/4 v5, 0x1

    move v0, v5

    new-array v0, v0, [Ljava/lang/String;

    move-object/from16 v58, v0

    .end local v58           #skipPackages:[Ljava/lang/String;
    const/4 v5, 0x0

    aput-object v52, v58, v5

    .line 12584
    .end local v40           #data:Landroid/net/Uri;
    .end local v52           #pkgName:Ljava/lang/String;
    .restart local v58       #skipPackages:[Ljava/lang/String;
    :cond_18
    :goto_9
    if-eqz v58, :cond_22

    move-object/from16 v0, v58

    array-length v0, v0

    move v5, v0

    if-lez v5, :cond_22

    .line 12585
    move-object/from16 v36, v58

    .restart local v36       #arr$:[Ljava/lang/String;
    move-object/from16 v0, v36

    array-length v0, v0

    move/from16 v48, v0

    .restart local v48       #len$:I
    const/16 v43, 0x0

    .restart local v43       #i$:I
    :goto_a
    move/from16 v0, v43

    move/from16 v1, v48

    if-ge v0, v1, :cond_22

    aget-object v57, v36, v43

    .line 12586
    .local v57, skipPackage:Ljava/lang/String;
    if-eqz v57, :cond_21

    .line 12587
    invoke-interface/range {v24 .. v24}, Ljava/util/List;->size()I

    move-result v34

    .line 12588
    .local v34, NT:I
    const/16 v47, 0x0

    .local v47, it:I
    :goto_b
    move/from16 v0, v47

    move/from16 v1, v34

    if-ge v0, v1, :cond_21

    .line 12589
    move-object/from16 v0, v24

    move/from16 v1, v47

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v39

    check-cast v39, Landroid/content/pm/ResolveInfo;

    .line 12590
    .local v39, curt:Landroid/content/pm/ResolveInfo;
    move-object/from16 v0, v39

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object v0, v5

    move-object/from16 v1, v57

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_19

    .line 12591
    move-object/from16 v0, v24

    move/from16 v1, v47

    invoke-interface {v0, v1}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 12592
    add-int/lit8 v47, v47, -0x1

    .line 12593
    add-int/lit8 v34, v34, -0x1

    .line 12588
    :cond_19
    add-int/lit8 v47, v47, 0x1

    goto :goto_b

    .line 12483
    .end local v16           #registeredReceivers:Ljava/util/List;,"Ljava/util/List<Lcom/android/server/am/BroadcastFilter;>;"
    .end local v24           #receivers:Ljava/util/List;
    .end local v33           #NR:I
    .end local v34           #NT:I
    .end local v36           #arr$:[Ljava/lang/String;
    .end local v39           #curt:Landroid/content/pm/ResolveInfo;
    .end local v43           #i$:I
    .end local v46           #ir:I
    .end local v47           #it:I
    .end local v48           #len$:I
    .end local v54           #replacePending:Z
    .end local v57           #skipPackage:Ljava/lang/String;
    .end local v58           #skipPackages:[Ljava/lang/String;
    .restart local v32       #N:I
    .restart local v42       #i:I
    .restart local v50       #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    :cond_1a
    add-int/lit8 v42, v42, 0x1

    goto/16 :goto_4

    .line 12511
    .end local v32           #N:I
    .end local v42           #i:I
    .end local v50           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    .restart local v16       #registeredReceivers:Ljava/util/List;,"Ljava/util/List<Lcom/android/server/am/BroadcastFilter;>;"
    .restart local v24       #receivers:Ljava/util/List;
    :cond_1b
    :try_start_5
    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getFlags()I

    move-result v5

    const/high16 v6, 0x4000

    and-int/2addr v5, v6

    if-nez v5, :cond_1c

    .line 12513
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    const/16 v6, 0x400

    move-object v0, v5

    move-object/from16 v1, v44

    move-object/from16 v2, p4

    move v3, v6

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->queryIntentReceivers(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;

    move-result-object v24

    .line 12517
    :cond_1c
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    move-object v5, v0

    const/4 v6, 0x0

    move-object v0, v5

    move-object/from16 v1, v44

    move-object/from16 v2, p4

    move v3, v6

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/IntentResolver;->queryIntent(Landroid/content/Intent;Ljava/lang/String;Z)Ljava/util/List;
    :try_end_5
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_5} :catch_1

    move-result-object v16

    goto/16 :goto_5

    .line 12523
    :cond_1d
    const/4 v5, 0x0

    move/from16 v54, v5

    goto/16 :goto_6

    .line 12529
    .restart local v54       #replacePending:Z
    :cond_1e
    const/4 v5, 0x0

    move/from16 v33, v5

    goto/16 :goto_7

    .line 12543
    .restart local v9       #r:Lcom/android/server/am/BroadcastRecord;
    .restart local v33       #NR:I
    .restart local v42       #i:I
    .restart local v55       #replaced:Z
    :cond_1f
    add-int/lit8 v42, v42, -0x1

    goto/16 :goto_8

    .line 12581
    .end local v9           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v42           #i:I
    .end local v55           #replaced:Z
    .restart local v46       #ir:I
    .restart local v58       #skipPackages:[Ljava/lang/String;
    :cond_20
    const-string v5, "android.intent.action.EXTERNAL_APPLICATIONS_AVAILABLE"

    invoke-virtual/range {v44 .. v44}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_18

    .line 12582
    const-string v5, "android.intent.extra.changed_package_list"

    move-object/from16 v0, v44

    move-object v1, v5

    invoke-virtual {v0, v1}, Landroid/content/Intent;->getStringArrayExtra(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v58

    goto/16 :goto_9

    .line 12585
    .restart local v36       #arr$:[Ljava/lang/String;
    .restart local v43       #i$:I
    .restart local v48       #len$:I
    .restart local v57       #skipPackage:Ljava/lang/String;
    :cond_21
    add-int/lit8 v43, v43, 0x1

    goto/16 :goto_a

    .line 12600
    .end local v36           #arr$:[Ljava/lang/String;
    .end local v43           #i$:I
    .end local v48           #len$:I
    .end local v57           #skipPackage:Ljava/lang/String;
    :cond_22
    if-eqz v24, :cond_25

    invoke-interface/range {v24 .. v24}, Ljava/util/List;->size()I

    move-result v5

    move/from16 v34, v5

    .line 12601
    .restart local v34       #NT:I
    :goto_c
    const/16 v47, 0x0

    .line 12602
    .restart local v47       #it:I
    const/16 v39, 0x0

    .line 12603
    .restart local v39       #curt:Landroid/content/pm/ResolveInfo;
    const/16 v38, 0x0

    .line 12604
    .local v38, curr:Lcom/android/server/am/BroadcastFilter;
    :goto_d
    move/from16 v0, v47

    move/from16 v1, v34

    if-ge v0, v1, :cond_27

    move/from16 v0, v46

    move/from16 v1, v33

    if-ge v0, v1, :cond_27

    .line 12605
    if-nez v39, :cond_23

    .line 12606
    move-object/from16 v0, v24

    move/from16 v1, v47

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v39

    .end local v39           #curt:Landroid/content/pm/ResolveInfo;
    check-cast v39, Landroid/content/pm/ResolveInfo;

    .line 12608
    .restart local v39       #curt:Landroid/content/pm/ResolveInfo;
    :cond_23
    if-nez v38, :cond_24

    .line 12609
    move-object/from16 v0, v16

    move/from16 v1, v46

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v38

    .end local v38           #curr:Lcom/android/server/am/BroadcastFilter;
    check-cast v38, Lcom/android/server/am/BroadcastFilter;

    .line 12611
    .restart local v38       #curr:Lcom/android/server/am/BroadcastFilter;
    :cond_24
    invoke-virtual/range {v38 .. v38}, Lcom/android/server/am/BroadcastFilter;->getPriority()I

    move-result v5

    move-object/from16 v0, v39

    iget v0, v0, Landroid/content/pm/ResolveInfo;->priority:I

    move v6, v0

    if-lt v5, v6, :cond_26

    .line 12613
    move-object/from16 v0, v24

    move/from16 v1, v47

    move-object/from16 v2, v38

    invoke-interface {v0, v1, v2}, Ljava/util/List;->add(ILjava/lang/Object;)V

    .line 12614
    add-int/lit8 v46, v46, 0x1

    .line 12615
    const/16 v38, 0x0

    .line 12616
    add-int/lit8 v47, v47, 0x1

    .line 12617
    add-int/lit8 v34, v34, 0x1

    goto :goto_d

    .line 12600
    .end local v34           #NT:I
    .end local v38           #curr:Lcom/android/server/am/BroadcastFilter;
    .end local v39           #curt:Landroid/content/pm/ResolveInfo;
    .end local v47           #it:I
    :cond_25
    const/4 v5, 0x0

    move/from16 v34, v5

    goto :goto_c

    .line 12620
    .restart local v34       #NT:I
    .restart local v38       #curr:Lcom/android/server/am/BroadcastFilter;
    .restart local v39       #curt:Landroid/content/pm/ResolveInfo;
    .restart local v47       #it:I
    :cond_26
    add-int/lit8 v47, v47, 0x1

    .line 12621
    const/16 v39, 0x0

    goto :goto_d

    .line 12625
    .end local v34           #NT:I
    .end local v38           #curr:Lcom/android/server/am/BroadcastFilter;
    .end local v39           #curt:Landroid/content/pm/ResolveInfo;
    .end local v47           #it:I
    .end local v58           #skipPackages:[Ljava/lang/String;
    :cond_27
    :goto_e
    move/from16 v0, v46

    move/from16 v1, v33

    if-ge v0, v1, :cond_29

    .line 12626
    if-nez v24, :cond_28

    .line 12627
    new-instance v24, Ljava/util/ArrayList;

    .end local v24           #receivers:Ljava/util/List;
    invoke-direct/range {v24 .. v24}, Ljava/util/ArrayList;-><init>()V

    .line 12629
    .restart local v24       #receivers:Ljava/util/List;
    :cond_28
    move-object/from16 v0, v16

    move/from16 v1, v46

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    move-object/from16 v0, v24

    move-object v1, v5

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 12630
    add-int/lit8 v46, v46, 0x1

    goto :goto_e

    .line 12633
    :cond_29
    if-eqz v24, :cond_2a

    invoke-interface/range {v24 .. v24}, Ljava/util/List;->size()I

    move-result v5

    if-gtz v5, :cond_2b

    :cond_2a
    if-eqz p5, :cond_2d

    .line 12635
    :cond_2b
    new-instance v9, Lcom/android/server/am/BroadcastRecord;

    const/16 v31, 0x0

    move-object/from16 v17, v9

    move-object/from16 v18, v44

    move-object/from16 v19, p1

    move-object/from16 v20, p2

    move/from16 v21, p12

    move/from16 v22, p13

    move-object/from16 v23, p9

    move-object/from16 v25, p5

    move/from16 v26, p6

    move-object/from16 v27, p7

    move-object/from16 v28, p8

    move/from16 v29, p10

    move/from16 v30, p11

    invoke-direct/range {v17 .. v31}, Lcom/android/server/am/BroadcastRecord;-><init>(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;IILjava/lang/String;Ljava/util/List;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;ZZZ)V

    .line 12646
    .restart local v9       #r:Lcom/android/server/am/BroadcastRecord;
    const/16 v55, 0x0

    .line 12647
    .restart local v55       #replaced:Z
    if-eqz v54, :cond_2c

    .line 12648
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    const/4 v6, 0x1

    sub-int v42, v5, v6

    .end local p1
    .restart local v42       #i:I
    :goto_f
    if-ltz v42, :cond_2c

    .line 12649
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v42

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, v44

    move-object v1, v5

    invoke-virtual {v0, v1}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v5

    if-eqz v5, :cond_2e

    .line 12652
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v42

    move-object v2, v9

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->set(ILjava/lang/Object;)Ljava/lang/Object;

    .line 12653
    const/16 v55, 0x1

    .line 12658
    .end local v42           #i:I
    :cond_2c
    if-nez v55, :cond_2d

    .line 12659
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 12660
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 12664
    .end local v9           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v55           #replaced:Z
    :cond_2d
    const/4 v5, 0x0

    goto/16 :goto_3

    .line 12648
    .restart local v9       #r:Lcom/android/server/am/BroadcastRecord;
    .restart local v42       #i:I
    .restart local v55       #replaced:Z
    :cond_2e
    add-int/lit8 v42, v42, -0x1

    goto :goto_f

    .line 12519
    .end local v9           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v33           #NR:I
    .end local v42           #i:I
    .end local v46           #ir:I
    .end local v54           #replacePending:Z
    .end local v55           #replaced:Z
    .restart local p1
    :catch_1
    move-exception v5

    goto/16 :goto_5

    .end local v24           #receivers:Ljava/util/List;
    .restart local v35       #ai:Landroid/content/pm/ActivityInfo;
    .restart local v53       #receivers:Ljava/util/List;
    :catch_2
    move-exception v5

    move-object/from16 v24, v53

    .end local v53           #receivers:Ljava/util/List;
    .restart local v24       #receivers:Ljava/util/List;
    goto/16 :goto_5
.end method

.method private final broadcastTimeout()V
    .locals 20

    .prologue
    .line 12864
    const/4 v13, 0x0

    .line 12865
    .local v13, app:Lcom/android/server/am/ProcessRecord;
    const/4 v12, 0x0

    .line 12867
    .local v12, anrMessage:Ljava/lang/String;
    monitor-enter p0

    .line 12868
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-nez v5, :cond_1

    .line 12869
    monitor-exit p0

    .line 12925
    :cond_0
    :goto_0
    return-void

    .line 12871
    :cond_1
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v17

    .line 12872
    .local v17, now:J
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v19

    check-cast v19, Lcom/android/server/am/BroadcastRecord;

    .line 12873
    .local v19, r:Lcom/android/server/am/BroadcastRecord;
    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    move-wide v5, v0

    const-wide/16 v7, 0x4e20

    add-long/2addr v5, v7

    cmp-long v5, v5, v17

    if-lez v5, :cond_2

    .line 12877
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x8

    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v16

    .line 12878
    .local v16, msg:Landroid/os/Message;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    move-wide v6, v0

    const-wide/16 v8, 0x4e20

    add-long/2addr v6, v8

    move-object v0, v5

    move-object/from16 v1, v16

    move-wide v2, v6

    invoke-virtual {v0, v1, v2, v3}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 12879
    monitor-exit p0

    goto :goto_0

    .line 12920
    .end local v16           #msg:Landroid/os/Message;
    .end local v17           #now:J
    .end local v19           #r:Lcom/android/server/am/BroadcastRecord;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 12882
    .restart local v17       #now:J
    .restart local v19       #r:Lcom/android/server/am/BroadcastRecord;
    :cond_2
    :try_start_1
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Timeout of broadcast "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " - receiver="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12883
    move-wide/from16 v0, v17

    move-object/from16 v2, v19

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    .line 12884
    move-object/from16 v0, v19

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->anrCount:I

    move v5, v0

    add-int/lit8 v5, v5, 0x1

    move v0, v5

    move-object/from16 v1, v19

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->anrCount:I

    .line 12887
    move-object/from16 v0, v19

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v5, v0

    if-gtz v5, :cond_3

    .line 12888
    const-string v5, "ActivityManager"

    const-string v6, "Timeout on receiver with nextReceiver <= 0"

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12889
    monitor-exit p0

    goto/16 :goto_0

    .line 12892
    :cond_3
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    move-object/from16 v0, v19

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v6, v0

    const/4 v7, 0x1

    sub-int/2addr v6, v7

    invoke-interface {v5, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v15

    .line 12893
    .local v15, curReceiver:Ljava/lang/Object;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Receiver during timeout: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12894
    move-object/from16 v0, p0

    move-object/from16 v1, v19

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 12895
    instance-of v5, v15, Lcom/android/server/am/BroadcastFilter;

    if-eqz v5, :cond_7

    .line 12896
    move-object v0, v15

    check-cast v0, Lcom/android/server/am/BroadcastFilter;

    move-object v14, v0

    .line 12897
    .local v14, bf:Lcom/android/server/am/BroadcastFilter;
    iget-object v5, v14, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v5, v5, Lcom/android/server/am/ReceiverList;->pid:I

    if-eqz v5, :cond_4

    iget-object v5, v14, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v5, v5, Lcom/android/server/am/ReceiverList;->pid:I

    sget v6, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v5, v6, :cond_4

    .line 12899
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    monitor-enter v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 12900
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    iget-object v7, v14, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v7, v7, Lcom/android/server/am/ReceiverList;->pid:I

    invoke-virtual {v6, v7}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v14

    .end local v14           #bf:Lcom/android/server/am/BroadcastFilter;
    move-object v0, v14

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    move-object v13, v0

    .line 12902
    monitor-exit v5
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 12908
    :cond_4
    :goto_1
    if-eqz v13, :cond_5

    .line 12909
    :try_start_3
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Broadcast of "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    invoke-virtual {v6}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    .line 12912
    :cond_5
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v19

    if-ne v0, v1, :cond_6

    .line 12913
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 12917
    :cond_6
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v6, v0

    move-object/from16 v0, v19

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move v7, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object v8, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object v9, v0

    move-object/from16 v0, v19

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move v10, v0

    const/4 v11, 0x1

    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 12919
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 12920
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 12922
    if-eqz v12, :cond_0

    .line 12923
    const/4 v5, 0x0

    const/4 v6, 0x0

    move-object/from16 v0, p0

    move-object v1, v13

    move-object v2, v5

    move-object v3, v6

    move-object v4, v12

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->appNotResponding(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;)V

    goto/16 :goto_0

    .line 12902
    :catchall_1
    move-exception v6

    :try_start_4
    monitor-exit v5
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    :try_start_5
    throw v6

    .line 12905
    :cond_7
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v13, v0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    goto :goto_1
.end method

.method private static buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;
    .locals 2
    .parameter "prefix"
    .parameter "space"
    .parameter "val"
    .parameter "base"

    .prologue
    .line 10239
    if-ne p2, p3, :cond_1

    .line 10240
    if-nez p1, :cond_0

    move-object v0, p0

    .line 10243
    :goto_0
    return-object v0

    .line 10241
    :cond_0
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, "  "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    goto :goto_0

    .line 10243
    :cond_1
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, "+"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    sub-int v1, p2, p3

    invoke-static {v1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    goto :goto_0
.end method

.method private final bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V
    .locals 6
    .parameter "r"

    .prologue
    .line 10937
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    .line 10938
    .local v1, now:J
    iget v3, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    if-nez v3, :cond_1

    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_1

    .line 10939
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v3}, Ljava/util/HashSet;->size()I

    move-result v3

    if-nez v3, :cond_0

    .line 10940
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0xc

    invoke-virtual {v3, v4}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 10941
    .local v0, msg:Landroid/os/Message;
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iput-object v3, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 10942
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v4, 0x7530

    add-long/2addr v4, v1

    invoke-virtual {v3, v0, v4, v5}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 10944
    .end local v0           #msg:Landroid/os/Message;
    :cond_0
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v3, p1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 10946
    :cond_1
    iget v3, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    add-int/lit8 v3, v3, 0x1

    iput v3, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    .line 10947
    iput-wide v1, p1, Lcom/android/server/am/ServiceRecord;->executingStart:J

    .line 10948
    return-void
.end method

.method private final canGcNowLocked()Z
    .locals 1

    .prologue
    .line 14115
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    if-nez v0, :cond_1

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    if-nez v0, :cond_1

    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v0, :cond_0

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v0, :cond_1

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->idle:Z

    if-eqz v0, :cond_1

    :cond_0
    const/4 v0, 0x1

    :goto_0
    return v0

    :cond_1
    const/4 v0, 0x0

    goto :goto_0
.end method

.method private final checkContentProviderPermissionLocked(Landroid/content/pm/ProviderInfo;Lcom/android/server/am/ProcessRecord;I)Ljava/lang/String;
    .locals 11
    .parameter "cpi"
    .parameter "r"
    .parameter "mode"

    .prologue
    const/high16 v10, 0x1000

    const/4 v9, 0x0

    const/4 v8, -0x1

    .line 7776
    if-eqz p2, :cond_2

    iget v6, p2, Lcom/android/server/am/ProcessRecord;->pid:I

    move v0, v6

    .line 7777
    .local v0, callingPid:I
    :goto_0
    if-eqz p2, :cond_3

    iget-object v6, p2, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    move v1, v6

    .line 7778
    .local v1, callingUid:I
    :goto_1
    iget-object v6, p1, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_4

    move v7, v8

    :goto_2
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_0

    if-eq p3, v10, :cond_1

    :cond_0
    if-ne p3, v8, :cond_5

    :cond_1
    move-object v6, v9

    .line 7815
    :goto_3
    return-object v6

    .line 7776
    .end local v0           #callingPid:I
    .end local v1           #callingUid:I
    :cond_2
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    move v0, v6

    goto :goto_0

    .line 7777
    .restart local v0       #callingPid:I
    :cond_3
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    move v1, v6

    goto :goto_1

    .line 7778
    .restart local v1       #callingUid:I
    :cond_4
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_2

    .line 7784
    :cond_5
    iget-object v6, p1, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_6

    move v7, v8

    :goto_4
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_7

    move-object v6, v9

    .line 7787
    goto :goto_3

    .line 7784
    :cond_6
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_4

    .line 7790
    :cond_7
    iget-object v5, p1, Landroid/content/pm/ProviderInfo;->pathPermissions:[Landroid/content/pm/PathPermission;

    .line 7791
    .local v5, pps:[Landroid/content/pm/PathPermission;
    if-eqz v5, :cond_e

    .line 7792
    array-length v2, v5

    .line 7793
    .local v2, i:I
    :cond_8
    if-lez v2, :cond_e

    .line 7794
    add-int/lit8 v2, v2, -0x1

    .line 7795
    aget-object v4, v5, v2

    .line 7796
    .local v4, pp:Landroid/content/pm/PathPermission;
    invoke-virtual {v4}, Landroid/content/pm/PathPermission;->getReadPermission()Ljava/lang/String;

    move-result-object v6

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_b

    move v7, v8

    :goto_5
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_9

    if-eq p3, v10, :cond_a

    :cond_9
    if-ne p3, v8, :cond_c

    :cond_a
    move-object v6, v9

    .line 7800
    goto :goto_3

    .line 7796
    :cond_b
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_5

    .line 7802
    :cond_c
    invoke-virtual {v4}, Landroid/content/pm/PathPermission;->getWritePermission()Ljava/lang/String;

    move-result-object v6

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_d

    move v7, v8

    :goto_6
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_8

    move-object v6, v9

    .line 7805
    goto :goto_3

    .line 7802
    :cond_d
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_6

    .line 7810
    .end local v2           #i:I
    .end local v4           #pp:Landroid/content/pm/PathPermission;
    :cond_e
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: opening provider "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " from "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    if-eqz p2, :cond_f

    move-object v7, p2

    :goto_7
    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (pid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", uid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ") requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " or "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 7814
    .local v3, msg:Ljava/lang/String;
    const-string v6, "ActivityManager"

    invoke-static {v6, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    move-object v6, v3

    .line 7815
    goto/16 :goto_3

    .line 7810
    .end local v3           #msg:Ljava/lang/String;
    :cond_f
    const-string v7, "(null)"

    goto :goto_7
.end method

.method private final checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z
    .locals 3
    .parameter "pm"
    .parameter "pi"
    .parameter "uid"
    .parameter "modeFlags"

    .prologue
    const/4 v2, 0x0

    .line 6383
    and-int/lit8 v1, p4, 0x1

    if-eqz v1, :cond_0

    .line 6384
    :try_start_0
    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    if-eqz v1, :cond_0

    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    invoke-interface {p1, v1, p3}, Landroid/content/pm/IPackageManager;->checkUidPermission(Ljava/lang/String;I)I

    move-result v1

    if-eqz v1, :cond_0

    move v1, v2

    .line 6399
    :goto_0
    return v1

    .line 6390
    :cond_0
    and-int/lit8 v1, p4, 0x2

    if-eqz v1, :cond_1

    .line 6391
    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    if-eqz v1, :cond_1

    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    invoke-interface {p1, v1, p3}, Landroid/content/pm/IPackageManager;->checkUidPermission(Ljava/lang/String;I)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v1

    if-eqz v1, :cond_1

    move v1, v2

    .line 6394
    goto :goto_0

    .line 6397
    :cond_1
    const/4 v1, 0x1

    goto :goto_0

    .line 6398
    :catch_0
    move-exception v1

    move-object v0, v1

    .local v0, e:Landroid/os/RemoteException;
    move v1, v2

    .line 6399
    goto :goto_0
.end method

.method private final checkUriPermissionLocked(Landroid/net/Uri;II)Z
    .locals 5
    .parameter "uri"
    .parameter "uid"
    .parameter "modeFlags"

    .prologue
    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 6406
    if-eqz p2, :cond_0

    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v2

    if-nez v2, :cond_1

    :cond_0
    move v2, v4

    .line 6413
    :goto_0
    return v2

    .line 6409
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v2, p2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/util/HashMap;

    .line 6410
    .local v1, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    if-nez v1, :cond_2

    move v2, v3

    goto :goto_0

    .line 6411
    :cond_2
    invoke-virtual {v1, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/UriPermission;

    .line 6412
    .local v0, perm:Lcom/android/server/am/UriPermission;
    if-nez v0, :cond_3

    move v2, v3

    goto :goto_0

    .line 6413
    :cond_3
    iget v2, v0, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/2addr v2, p3

    if-ne v2, p3, :cond_4

    move v2, v4

    goto :goto_0

    :cond_4
    move v2, v3

    goto :goto_0
.end method

.method private final cleanUpActivityLocked(Lcom/android/server/am/HistoryRecord;Z)V
    .locals 6
    .parameter "r"
    .parameter "cleanServices"

    .prologue
    const/4 v5, 0x0

    const/4 v4, 0x0

    .line 4436
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v3, p1, :cond_0

    .line 4437
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4439
    :cond_0
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v3, p1, :cond_1

    .line 4440
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4443
    :cond_1
    iput-boolean v4, p1, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    .line 4444
    iput-boolean v4, p1, Lcom/android/server/am/HistoryRecord;->frozenBeforeDestroy:Z

    .line 4449
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4450
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4453
    iget-boolean v3, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_4

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    if-eqz v3, :cond_4

    .line 4454
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    invoke-virtual {v3}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .local v1, i$:Ljava/util/Iterator;
    :cond_2
    :goto_0
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_3

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/lang/ref/WeakReference;

    .line 4455
    .local v0, apr:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    invoke-virtual {v0}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/PendingIntentRecord;

    .line 4456
    .local v2, rec:Lcom/android/server/am/PendingIntentRecord;
    if-eqz v2, :cond_2

    .line 4457
    invoke-virtual {p0, v2, v4}, Lcom/android/server/am/ActivityManagerService;->cancelIntentSenderLocked(Lcom/android/server/am/PendingIntentRecord;Z)V

    goto :goto_0

    .line 4460
    .end local v0           #apr:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    .end local v2           #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_3
    iput-object v5, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    .line 4463
    .end local v1           #i$:Ljava/util/Iterator;
    :cond_4
    if-eqz p2, :cond_5

    .line 4464
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityServicesLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4467
    :cond_5
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_6

    .line 4471
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4475
    :cond_6
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0x9

    invoke-virtual {v3, v4, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 4476
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0xa

    invoke-virtual {v3, v4, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 4477
    return-void
.end method

.method private final cleanUpActivityServicesLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 4
    .parameter "r"

    .prologue
    const/4 v3, 0x0

    .line 4418
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    if-eqz v2, :cond_1

    .line 4419
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 4420
    .local v1, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_0
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_0

    .line 4421
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ConnectionRecord;

    .line 4422
    .local v0, c:Lcom/android/server/am/ConnectionRecord;
    invoke-direct {p0, v0, v3, p1}, Lcom/android/server/am/ActivityManagerService;->removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V

    goto :goto_0

    .line 4424
    .end local v0           #c:Lcom/android/server/am/ConnectionRecord;
    :cond_0
    iput-object v3, p1, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    .line 4426
    .end local v1           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_1
    return-void
.end method

.method private final cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V
    .locals 12
    .parameter "app"
    .parameter "restarting"
    .parameter "index"

    .prologue
    const/4 v11, 0x0

    const/4 v10, 0x0

    .line 10526
    if-ltz p3, :cond_0

    .line 10527
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 10530
    :cond_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10533
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->crashDialog:Landroid/app/Dialog;

    if-eqz v7, :cond_1

    .line 10534
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->crashDialog:Landroid/app/Dialog;

    invoke-virtual {v7}, Landroid/app/Dialog;->dismiss()V

    .line 10535
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->crashDialog:Landroid/app/Dialog;

    .line 10537
    :cond_1
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    if-eqz v7, :cond_2

    .line 10538
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    invoke-virtual {v7}, Landroid/app/Dialog;->dismiss()V

    .line 10539
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    .line 10541
    :cond_2
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    if-eqz v7, :cond_3

    .line 10542
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    invoke-virtual {v7}, Landroid/app/Dialog;->dismiss()V

    .line 10543
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    .line 10546
    :cond_3
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    .line 10547
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 10549
    invoke-virtual {p1}, Lcom/android/server/am/ProcessRecord;->resetPackageList()V

    .line 10550
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    .line 10551
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 10552
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 10554
    const/4 v7, 0x1

    invoke-direct {p0, p1, v7}, Lcom/android/server/am/ActivityManagerService;->killServicesLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 10556
    const/4 v6, 0x0

    .line 10558
    .local v6, restart:Z
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 10561
    .local v0, NL:I
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->isEmpty()Z

    move-result v7

    if-nez v7, :cond_9

    .line 10562
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v7

    invoke-interface {v7}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v4

    .line 10563
    .local v4, it:Ljava/util/Iterator;
    :cond_4
    :goto_0
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_8

    .line 10564
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 10565
    .local v2, cpr:Lcom/android/server/am/ContentProviderRecord;
    iput-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    .line 10566
    iput-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 10570
    const/4 v3, 0x0

    .line 10571
    .local v3, i:I
    iget-boolean v7, p1, Lcom/android/server/am/ProcessRecord;->bad:Z

    if-nez v7, :cond_7

    .line 10572
    :goto_1
    if-ge v3, v0, :cond_5

    .line 10573
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    if-ne v7, v2, :cond_6

    .line 10574
    const/4 v6, 0x1

    .line 10582
    :cond_5
    :goto_2
    if-lt v3, v0, :cond_4

    .line 10583
    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->removeDyingProviderLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/ContentProviderRecord;)V

    .line 10584
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_0

    .line 10572
    :cond_6
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 10579
    :cond_7
    move v3, v0

    goto :goto_2

    .line 10587
    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v3           #i:I
    :cond_8
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->clear()V

    .line 10591
    .end local v4           #it:Ljava/util/Iterator;
    :cond_9
    invoke-virtual {p0, p1, v11}, Lcom/android/server/am/ActivityManagerService;->checkAppInLaunchingProvidersLocked(Lcom/android/server/am/ProcessRecord;Z)Z

    move-result v7

    if-eqz v7, :cond_a

    .line 10592
    const/4 v6, 0x1

    .line 10596
    :cond_a
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->isEmpty()Z

    move-result v7

    if-nez v7, :cond_c

    .line 10597
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->keySet()Ljava/util/Set;

    move-result-object v7

    invoke-interface {v7}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v4

    .line 10598
    .restart local v4       #it:Ljava/util/Iterator;
    :goto_3
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_b

    .line 10599
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 10600
    .restart local v2       #cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v7, v2, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    invoke-virtual {v7, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    goto :goto_3

    .line 10602
    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_b
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->clear()V

    .line 10623
    .end local v4           #it:Ljava/util/Iterator;
    :cond_c
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->skipCurrentReceiverLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 10626
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->size()I

    move-result v7

    if-lez v7, :cond_e

    .line 10627
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .line 10628
    .local v5, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ReceiverList;>;"
    :goto_4
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_d

    .line 10629
    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ReceiverList;

    invoke-virtual {p0, v7}, Lcom/android/server/am/ActivityManagerService;->removeReceiverLocked(Lcom/android/server/am/ReceiverList;)V

    goto :goto_4

    .line 10631
    :cond_d
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->clear()V

    .line 10635
    .end local v5           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ReceiverList;>;"
    :cond_e
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    if-eqz v7, :cond_f

    iget v7, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    iget-object v8, v8, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v8, v8, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v7, v8, :cond_f

    .line 10638
    :try_start_0
    const-string v7, "backup"

    invoke-static {v7}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v7

    invoke-static {v7}, Landroid/app/backup/IBackupManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/app/backup/IBackupManager;

    move-result-object v1

    .line 10640
    .local v1, bm:Landroid/app/backup/IBackupManager;
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v1, v7}, Landroid/app/backup/IBackupManager;->agentDisconnected(Ljava/lang/String;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 10648
    .end local v1           #bm:Landroid/app/backup/IBackupManager;
    :cond_f
    :goto_5
    if-eqz p2, :cond_11

    .line 10687
    :cond_10
    :goto_6
    return-void

    .line 10652
    :cond_11
    iget-boolean v7, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v7, :cond_14

    .line 10655
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v7, v8, v9}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 10668
    :cond_12
    :goto_7
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10670
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    if-ne p1, v7, :cond_13

    .line 10671
    iput-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    .line 10674
    :cond_13
    if-eqz v6, :cond_15

    .line 10677
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v7, v8, v9, p1}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 10678
    const-string v7, "restart"

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-direct {p0, p1, v7, v8}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_6

    .line 10656
    :cond_14
    iget-boolean v7, p1, Lcom/android/server/am/ProcessRecord;->removed:Z

    if-nez v7, :cond_12

    .line 10660
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    .line 10661
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 10662
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 10663
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v7

    if-gez v7, :cond_12

    .line 10664
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 10665
    const/4 v6, 0x1

    goto :goto_7

    .line 10679
    :cond_15
    iget v7, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v7, :cond_10

    iget v7, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v8, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v7, v8, :cond_10

    .line 10681
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v7

    .line 10682
    :try_start_1
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    iget v9, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v8, v9}, Landroid/util/SparseArray;->remove(I)V

    .line 10683
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v9, 0x14

    invoke-virtual {v8, v9, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 10684
    monitor-exit v7
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 10685
    invoke-virtual {p1, v11}, Lcom/android/server/am/ProcessRecord;->setPid(I)V

    goto :goto_6

    .line 10684
    :catchall_0
    move-exception v8

    :try_start_2
    monitor-exit v7
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v8

    .line 10641
    :catch_0
    move-exception v7

    goto :goto_5
.end method

.method private final completePauseLocked()V
    .locals 13

    .prologue
    const-wide/16 v11, 0x0

    .line 2193
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2196
    .local v4, prev:Lcom/android/server/am/HistoryRecord;
    if-eqz v4, :cond_1

    .line 2197
    iget-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_6

    .line 2199
    const/4 v6, 0x2

    invoke-direct {p0, v4, v6}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;I)Lcom/android/server/am/HistoryRecord;

    move-result-object v4

    .line 2232
    :cond_0
    :goto_0
    const/4 v6, 0x0

    iput-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2235
    :cond_1
    iget-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v6, :cond_a

    iget-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-nez v6, :cond_a

    .line 2236
    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 2246
    :cond_2
    :goto_1
    if-eqz v4, :cond_3

    .line 2247
    invoke-virtual {v4}, Lcom/android/server/am/HistoryRecord;->resumeKeyDispatchingLocked()V

    .line 2250
    :cond_3
    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_5

    iget-wide v6, v4, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    cmp-long v6, v6, v11

    if-lez v6, :cond_5

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->isOnBattery()Z

    move-result v6

    if-eqz v6, :cond_5

    .line 2251
    const-wide/16 v1, 0x0

    .line 2252
    .local v1, diff:J
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    monitor-enter v6

    .line 2253
    :try_start_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    iget-object v8, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v8, v8, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v7, v8}, Lcom/android/server/ProcessStats;->getCpuTimeForPid(I)J

    move-result-wide v7

    iget-wide v9, v4, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    sub-long v1, v7, v9

    .line 2254
    monitor-exit v6
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 2255
    cmp-long v6, v1, v11

    if-lez v6, :cond_5

    .line 2256
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v0

    .line 2257
    .local v0, bsi:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v0

    .line 2258
    :try_start_1
    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v6, v7}, Lcom/android/internal/os/BatteryStatsImpl;->getProcessStatsLocked(ILjava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-result-object v5

    .line 2261
    .local v5, ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    if-eqz v5, :cond_4

    .line 2262
    invoke-virtual {v5, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addForegroundTimeLocked(J)V

    .line 2264
    :cond_4
    monitor-exit v0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 2267
    .end local v0           #bsi:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v1           #diff:J
    .end local v5           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    :cond_5
    iput-wide v11, v4, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    .line 2268
    return-void

    .line 2200
    :cond_6
    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_9

    .line 2202
    iget-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-eqz v6, :cond_7

    .line 2203
    const/4 v6, 0x0

    iput-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    .line 2204
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2208
    :cond_7
    iget-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    if-eqz v6, :cond_8

    .line 2215
    const/4 v6, 0x1

    invoke-direct {p0, v4, v6}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    goto :goto_0

    .line 2217
    :cond_8
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2218
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x3

    if-le v6, v7, :cond_0

    .line 2223
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v3

    .line 2224
    .local v3, msg:Landroid/os/Message;
    const/16 v6, 0xb

    iput v6, v3, Landroid/os/Message;->what:I

    .line 2225
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v3}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    goto/16 :goto_0

    .line 2230
    .end local v3           #msg:Landroid/os/Message;
    :cond_9
    const/4 v4, 0x0

    goto/16 :goto_0

    .line 2238
    :cond_a
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v6}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v6

    if-eqz v6, :cond_b

    .line 2239
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v6}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 2241
    :cond_b
    iget-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-eqz v6, :cond_2

    .line 2242
    invoke-virtual {p0}, Ljava/lang/Object;->notifyAll()V

    goto/16 :goto_1

    .line 2254
    .restart local v1       #diff:J
    :catchall_0
    move-exception v7

    :try_start_2
    monitor-exit v6
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v7

    .line 2264
    .restart local v0       #bsi:Lcom/android/internal/os/BatteryStatsImpl;
    :catchall_1
    move-exception v6

    :try_start_3
    monitor-exit v0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    throw v6
.end method

.method private final completeResumeLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 6
    .parameter "next"

    .prologue
    const/4 v5, 0x0

    const/4 v4, 0x0

    .line 2276
    iput-boolean v5, p1, Lcom/android/server/am/HistoryRecord;->idle:Z

    .line 2277
    iput-object v4, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 2278
    iput-object v4, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 2281
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v2, 0xa

    invoke-virtual {v1, v2}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 2282
    .local v0, msg:Landroid/os/Message;
    iput-object p1, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 2283
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v2, 0x4e20

    invoke-virtual {v1, v0, v2, v3}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2295
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->reportResumedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 2297
    iput-object v4, p1, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    .line 2298
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 2299
    invoke-virtual {p1}, Lcom/android/server/am/HistoryRecord;->resumeKeyDispatchingLocked()V

    .line 2300
    invoke-direct {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 2301
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v1}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2302
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->clear()V

    .line 2307
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_0

    .line 2308
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    monitor-enter v1

    .line 2309
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v3, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v2, v3}, Lcom/android/server/ProcessStats;->getCpuTimeForPid(I)J

    move-result-wide v2

    iput-wide v2, p1, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    .line 2310
    monitor-exit v1

    .line 2314
    :goto_0
    return-void

    .line 2310
    :catchall_0
    move-exception v2

    monitor-exit v1
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2

    .line 2312
    :cond_0
    const-wide/16 v1, 0x0

    iput-wide v1, p1, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    goto :goto_0
.end method

.method private final computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;Z)I
    .locals 25
    .parameter "app"
    .parameter "hiddenAdj"
    .parameter "TOP_APP"
    .parameter "recursed"

    .prologue
    .line 13790
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v21, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    move/from16 v22, v0

    move/from16 v0, v21

    move/from16 v1, v22

    if-ne v0, v1, :cond_1

    .line 13795
    if-nez p4, :cond_0

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->hidden:Z

    move/from16 v21, v0

    if-eqz v21, :cond_0

    .line 13796
    move/from16 v0, p2

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 13798
    :cond_0
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->curAdj:I

    move/from16 v21, v0

    .line 14089
    .end local p4
    :goto_0
    return v21

    .line 13801
    .restart local p4
    :cond_1
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v21, v0

    if-nez v21, :cond_2

    .line 13802
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v21, v0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    .line 13803
    const/16 v21, 0x1

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    .line 13804
    sget v21, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    goto :goto_0

    .line 13807
    :cond_2
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v21, v0

    sget v22, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v0, v21

    move/from16 v1, v22

    if-gt v0, v1, :cond_3

    .line 13810
    const-string v21, "fixed"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13811
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v21, v0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    .line 13812
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v21, v0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    .line 13813
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    .line 13814
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v21, v0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    goto :goto_0

    .line 13817
    :cond_3
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjTypeCode:I

    .line 13818
    const/16 v21, 0x0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 13819
    const/16 v21, 0x0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    .line 13820
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->empty:Z

    .line 13821
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13828
    move-object/from16 v0, p1

    move-object/from16 v1, p3

    if-ne v0, v1, :cond_11

    .line 13830
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13831
    .local v7, adj:I
    const/16 v20, 0x0

    .line 13832
    .local v20, schedGroup:I
    const-string v21, "top-activity"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13906
    .end local p4
    :cond_4
    :goto_1
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v21, v0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    .line 13907
    move v0, v7

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    .line 13909
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object/from16 v21, v0

    if-eqz v21, :cond_5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, p1

    move-object/from16 v1, v21

    if-ne v0, v1, :cond_5

    .line 13911
    sget v21, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_5

    .line 13913
    sget v7, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    .line 13914
    const-string v21, "backup"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13915
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13919
    :cond_5
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashSet;->size()I

    move-result v21

    if-eqz v21, :cond_1f

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-gt v0, v1, :cond_6

    const/16 v21, 0x1

    move/from16 v0, v20

    move/from16 v1, v21

    if-ne v0, v1, :cond_1f

    .line 13921
    :cond_6
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v17

    .line 13924
    .local v17, now:J
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .line 13925
    .local v13, jt:Ljava/util/Iterator;
    :cond_7
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v21

    if-eqz v21, :cond_1e

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_1e

    .line 13926
    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v19

    check-cast v19, Lcom/android/server/am/ServiceRecord;

    .line 13927
    .local v19, s:Lcom/android/server/am/ServiceRecord;
    move-object/from16 v0, v19

    iget-boolean v0, v0, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    move/from16 v21, v0

    if-eqz v21, :cond_9

    .line 13928
    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    move-wide/from16 v21, v0

    const-wide/32 v23, 0x1b7740

    add-long v21, v21, v23

    cmp-long v21, v17, v21

    if-gez v21, :cond_8

    .line 13932
    sget v21, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_8

    .line 13933
    sget v7, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    .line 13934
    const-string v21, "started-services"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13935
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13941
    :cond_8
    sget v21, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_9

    .line 13942
    const-string v21, "started-bg-services"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13945
    :cond_9
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashMap;->size()I

    move-result v21

    if-lez v21, :cond_7

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-gt v0, v1, :cond_a

    const/16 v21, 0x1

    move/from16 v0, v20

    move/from16 v1, v21

    if-ne v0, v1, :cond_7

    .line 13947
    :cond_a
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v21

    invoke-interface/range {v21 .. v21}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v14

    .line 13949
    .local v14, kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_b
    :goto_2
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v21

    if-eqz v21, :cond_7

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_7

    .line 13952
    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/am/ConnectionRecord;

    .line 13953
    .local v11, cr:Lcom/android/server/am/ConnectionRecord;
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    if-eq v0, v1, :cond_b

    .line 13957
    move-object v0, v11

    iget v0, v0, Lcom/android/server/am/ConnectionRecord;->flags:I

    move/from16 v21, v0

    and-int/lit8 v21, v21, 0x1

    if-eqz v21, :cond_f

    .line 13958
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object v8, v0

    .line 13959
    .local v8, client:Lcom/android/server/am/ProcessRecord;
    move/from16 v16, p2

    .line 13960
    .local v16, myHiddenAdj:I
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v21, v0

    move/from16 v0, v16

    move/from16 v1, v21

    if-le v0, v1, :cond_c

    .line 13961
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v21, v0

    sget v22, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move/from16 v0, v21

    move/from16 v1, v22

    if-le v0, v1, :cond_1c

    .line 13962
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v16, v0

    .line 13967
    :cond_c
    :goto_3
    const/16 v21, 0x1

    move-object/from16 v0, p0

    move-object v1, v8

    move/from16 v2, v16

    move-object/from16 v3, p3

    move/from16 v4, v21

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;Z)I

    move-result v9

    .line 13969
    .local v9, clientAdj:I
    if-le v7, v9, :cond_e

    .line 13970
    sget v21, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move v0, v9

    move/from16 v1, v21

    if-le v0, v1, :cond_1d

    move v7, v9

    .line 13972
    :goto_4
    move-object v0, v8

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->hidden:Z

    move/from16 v21, v0

    if-nez v21, :cond_d

    .line 13973
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13975
    :cond_d
    const-string v21, "service"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13976
    const/16 v21, 0x2

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjTypeCode:I

    .line 13978
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 13979
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    .line 13981
    :cond_e
    move-object v0, v11

    iget v0, v0, Lcom/android/server/am/ConnectionRecord;->flags:I

    move/from16 v21, v0

    and-int/lit8 v21, v21, 0x4

    if-nez v21, :cond_f

    .line 13982
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    move/from16 v21, v0

    if-nez v21, :cond_f

    .line 13983
    const/16 v20, 0x0

    .line 13987
    .end local v8           #client:Lcom/android/server/am/ProcessRecord;
    .end local v9           #clientAdj:I
    .end local v16           #myHiddenAdj:I
    :cond_f
    iget-object v6, v11, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    .line 13991
    .local v6, a:Lcom/android/server/am/HistoryRecord;
    if-eqz v6, :cond_b

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_b

    move-object v0, v6

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v21, v0

    sget-object v22, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v0, v21

    move-object/from16 v1, v22

    if-eq v0, v1, :cond_10

    move-object v0, v6

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v21, v0

    sget-object v22, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v0, v21

    move-object/from16 v1, v22

    if-ne v0, v1, :cond_b

    .line 13994
    :cond_10
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13995
    const/16 v20, 0x0

    .line 13996
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13997
    const-string v21, "service"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13998
    const/16 v21, 0x2

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjTypeCode:I

    .line 14000
    move-object v0, v6

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 14001
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    goto/16 :goto_2

    .line 13833
    .end local v6           #a:Lcom/android/server/am/HistoryRecord;
    .end local v7           #adj:I
    .end local v11           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v13           #jt:Ljava/util/Iterator;
    .end local v14           #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .end local v17           #now:J
    .end local v19           #s:Lcom/android/server/am/ServiceRecord;
    .end local v20           #schedGroup:I
    .restart local p4
    :cond_11
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object/from16 v21, v0

    if-eqz v21, :cond_12

    .line 13835
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13836
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13837
    .restart local v20       #schedGroup:I
    const-string v21, "instrumentation"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13838
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_12
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    move/from16 v21, v0

    if-lez v21, :cond_13

    .line 13840
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13841
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13842
    .restart local v20       #schedGroup:I
    const-string v21, "persistent"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13843
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_13
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v21, v0

    if-nez v21, :cond_14

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v21, v0

    if-eqz v21, :cond_15

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    if-ne v0, v1, :cond_15

    .line 13847
    :cond_14
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13848
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13849
    .restart local v20       #schedGroup:I
    const-string v21, "broadcast"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13850
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_15
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashSet;->size()I

    move-result v21

    if-lez v21, :cond_16

    .line 13853
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 13854
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13855
    .restart local v20       #schedGroup:I
    const-string v21, "exec-service"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13856
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_16
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    move/from16 v21, v0

    if-eqz v21, :cond_17

    .line 13858
    sget v7, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    .line 13859
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13860
    .restart local v20       #schedGroup:I
    const-string v21, "foreground-service"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13861
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_17
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    move-object/from16 v21, v0

    if-eqz v21, :cond_18

    .line 13863
    sget v7, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    .line 13864
    .restart local v7       #adj:I
    const/16 v20, 0x0

    .line 13865
    .restart local v20       #schedGroup:I
    const-string v21, "force-foreground"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13866
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    goto/16 :goto_1

    .line 13867
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_18
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v21, v0

    move-object/from16 v0, p1

    move-object/from16 v1, v21

    if-ne v0, v1, :cond_19

    .line 13870
    sget v7, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    .line 13871
    .restart local v7       #adj:I
    const/16 v20, 0x1

    .line 13872
    .restart local v20       #schedGroup:I
    const-string v21, "home"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13873
    .end local v7           #adj:I
    .end local v20           #schedGroup:I
    :cond_19
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/ArrayList;->size()I

    move-result v5

    .local v5, N:I
    if-eqz v5, :cond_1b

    .line 13875
    const/16 v21, 0x1

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13876
    move/from16 v7, p2

    .line 13877
    .restart local v7       #adj:I
    const/16 v20, 0x1

    .line 13878
    .restart local v20       #schedGroup:I
    const-string v21, "bg-activities"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 13879
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/ArrayList;->size()I

    move-result v5

    .line 13880
    const/4 v12, 0x0

    .end local p4
    .local v12, j:I
    :goto_5
    if-ge v12, v5, :cond_4

    .line 13881
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move v1, v12

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p4

    check-cast p4, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v0, p4

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->visible:Z

    move/from16 v21, v0

    if-eqz v21, :cond_1a

    .line 13883
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13884
    sget v7, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    .line 13885
    const/16 v20, 0x0

    .line 13886
    const-string v21, "visible"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13880
    :cond_1a
    add-int/lit8 v12, v12, 0x1

    goto :goto_5

    .line 13893
    .end local v7           #adj:I
    .end local v12           #j:I
    .end local v20           #schedGroup:I
    .restart local p4
    :cond_1b
    const/16 v21, 0x1

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 13894
    const/16 v21, 0x1

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->empty:Z

    .line 13895
    const/16 v20, 0x1

    .line 13896
    .restart local v20       #schedGroup:I
    move/from16 v7, p2

    .line 13897
    .restart local v7       #adj:I
    const-string v21, "bg-empty"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_1

    .line 13964
    .end local v5           #N:I
    .end local p4
    .restart local v8       #client:Lcom/android/server/am/ProcessRecord;
    .restart local v11       #cr:Lcom/android/server/am/ConnectionRecord;
    .restart local v13       #jt:Ljava/util/Iterator;
    .restart local v14       #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .restart local v16       #myHiddenAdj:I
    .restart local v17       #now:J
    .restart local v19       #s:Lcom/android/server/am/ServiceRecord;
    :cond_1c
    sget v16, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    goto/16 :goto_3

    .line 13970
    .restart local v9       #clientAdj:I
    :cond_1d
    sget v21, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move/from16 v7, v21

    goto/16 :goto_4

    .line 14012
    .end local v8           #client:Lcom/android/server/am/ProcessRecord;
    .end local v9           #clientAdj:I
    .end local v11           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v14           #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .end local v16           #myHiddenAdj:I
    .end local v19           #s:Lcom/android/server/am/ServiceRecord;
    :cond_1e
    move v0, v7

    move/from16 v1, p2

    if-le v0, v1, :cond_1f

    .line 14013
    move/from16 v7, p2

    .line 14014
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 14015
    const-string v21, "bg-services"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 14019
    .end local v13           #jt:Ljava/util/Iterator;
    .end local v17           #now:J
    :cond_1f
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashMap;->size()I

    move-result v21

    if-eqz v21, :cond_2a

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-gt v0, v1, :cond_20

    const/16 v21, 0x1

    move/from16 v0, v20

    move/from16 v1, v21

    if-ne v0, v1, :cond_2a

    .line 14021
    :cond_20
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v21

    invoke-interface/range {v21 .. v21}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .line 14022
    .restart local v13       #jt:Ljava/util/Iterator;
    :cond_21
    :goto_6
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v21

    if-eqz v21, :cond_2a

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-gt v0, v1, :cond_22

    const/16 v21, 0x1

    move/from16 v0, v20

    move/from16 v1, v21

    if-ne v0, v1, :cond_2a

    .line 14024
    :cond_22
    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/am/ContentProviderRecord;

    .line 14025
    .local v10, cpr:Lcom/android/server/am/ContentProviderRecord;
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashSet;->size()I

    move-result v21

    if-eqz v21, :cond_29

    .line 14026
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v15

    .line 14027
    .local v15, kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ProcessRecord;>;"
    :cond_23
    :goto_7
    invoke-interface {v15}, Ljava/util/Iterator;->hasNext()Z

    move-result v21

    if-eqz v21, :cond_29

    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_29

    .line 14028
    invoke-interface {v15}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/am/ProcessRecord;

    .line 14029
    .restart local v8       #client:Lcom/android/server/am/ProcessRecord;
    move-object v0, v8

    move-object/from16 v1, p1

    if-eq v0, v1, :cond_23

    .line 14033
    move/from16 v16, p2

    .line 14034
    .restart local v16       #myHiddenAdj:I
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v21, v0

    move/from16 v0, v16

    move/from16 v1, v21

    if-le v0, v1, :cond_24

    .line 14035
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v21, v0

    sget v22, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v0, v21

    move/from16 v1, v22

    if-le v0, v1, :cond_27

    .line 14036
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v16, v0

    .line 14041
    :cond_24
    :goto_8
    const/16 v21, 0x1

    move-object/from16 v0, p0

    move-object v1, v8

    move/from16 v2, v16

    move-object/from16 v3, p3

    move/from16 v4, v21

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;Z)I

    move-result v9

    .line 14043
    .restart local v9       #clientAdj:I
    if-le v7, v9, :cond_26

    .line 14044
    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v9

    move/from16 v1, v21

    if-le v0, v1, :cond_28

    move v7, v9

    .line 14046
    :goto_9
    move-object v0, v8

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->hidden:Z

    move/from16 v21, v0

    if-nez v21, :cond_25

    .line 14047
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 14049
    :cond_25
    const-string v21, "provider"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 14050
    const/16 v21, 0x1

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjTypeCode:I

    .line 14052
    move-object v0, v8

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 14053
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    .line 14055
    :cond_26
    move-object v0, v8

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    move/from16 v21, v0

    if-nez v21, :cond_23

    .line 14056
    const/16 v20, 0x0

    goto/16 :goto_7

    .line 14038
    .end local v9           #clientAdj:I
    :cond_27
    sget v16, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    goto :goto_8

    .line 14044
    .restart local v9       #clientAdj:I
    :cond_28
    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v7, v21

    goto :goto_9

    .line 14063
    .end local v8           #client:Lcom/android/server/am/ProcessRecord;
    .end local v9           #clientAdj:I
    .end local v15           #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ProcessRecord;>;"
    .end local v16           #myHiddenAdj:I
    :cond_29
    move-object v0, v10

    iget v0, v0, Lcom/android/server/am/ContentProviderRecord;->externals:I

    move/from16 v21, v0

    if-eqz v21, :cond_21

    .line 14064
    sget v21, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_21

    .line 14065
    sget v7, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 14066
    const/16 v20, 0x0

    .line 14067
    const/16 v21, 0x0

    move/from16 v0, v21

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->hidden:Z

    .line 14068
    const-string v21, "provider"

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 14069
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    goto/16 :goto_6

    .line 14075
    .end local v10           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v13           #jt:Ljava/util/Iterator;
    :cond_2a
    move v0, v7

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    .line 14079
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v21, v0

    move v0, v7

    move/from16 v1, v21

    if-le v0, v1, :cond_2b

    .line 14080
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move v7, v0

    .line 14081
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v21, v0

    sget v22, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move/from16 v0, v21

    move/from16 v1, v22

    if-gt v0, v1, :cond_2b

    .line 14082
    const/16 v20, 0x0

    .line 14086
    :cond_2b
    move v0, v7

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 14087
    move/from16 v0, v20

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    move/from16 v21, v7

    .line 14089
    goto/16 :goto_0
.end method

.method private crashApplication(Lcom/android/server/am/ProcessRecord;Landroid/app/ApplicationErrorReport$CrashInfo;)V
    .locals 25
    .parameter "r"
    .parameter "crashInfo"

    .prologue
    .line 9308
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v10

    .line 9309
    .local v10, timeMillis:J
    move-object/from16 v0, p2

    iget-object v0, v0, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionClassName:Ljava/lang/String;

    move-object v8, v0

    .line 9310
    .local v8, shortMsg:Ljava/lang/String;
    move-object/from16 v0, p2

    iget-object v0, v0, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionMessage:Ljava/lang/String;

    move-object v9, v0

    .line 9311
    .local v9, longMsg:Ljava/lang/String;
    move-object/from16 v0, p2

    iget-object v0, v0, Landroid/app/ApplicationErrorReport$CrashInfo;->stackTrace:Ljava/lang/String;

    move-object/from16 v22, v0

    .line 9312
    .local v22, stackTrace:Ljava/lang/String;
    if-eqz v8, :cond_2

    if-eqz v9, :cond_2

    .line 9313
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v5, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ": "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    .line 9318
    :cond_0
    :goto_0
    new-instance v21, Lcom/android/server/am/AppErrorResult;

    invoke-direct/range {v21 .. v21}, Lcom/android/server/am/AppErrorResult;-><init>()V

    .line 9319
    .local v21, result:Lcom/android/server/am/AppErrorResult;
    monitor-enter p0

    .line 9320
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    if-eqz v5, :cond_5

    .line 9322
    if-eqz p1, :cond_3

    :try_start_1
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    move-object v6, v5

    .line 9323
    .local v6, name:Ljava/lang/String;
    :goto_1
    if-eqz p1, :cond_4

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    move v7, v5

    .line 9324
    .local v7, pid:I
    :goto_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    move-object/from16 v0, p2

    iget-object v0, v0, Landroid/app/ApplicationErrorReport$CrashInfo;->stackTrace:Ljava/lang/String;

    move-object v12, v0

    invoke-interface/range {v5 .. v12}, Landroid/app/IActivityController;->appCrashed(Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;JLjava/lang/String;)Z

    move-result v5

    if-nez v5, :cond_5

    .line 9326
    const-string v5, "ActivityManager"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "Force-killing crashed app "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v12

    invoke-virtual {v12, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    .end local v6           #name:Ljava/lang/String;
    const-string v12, " at watcher\'s request"

    invoke-virtual {v6, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9328
    invoke-static {v7}, Landroid/os/Process;->killProcess(I)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 9329
    :try_start_2
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 9390
    .end local v7           #pid:I
    .end local v8           #shortMsg:Ljava/lang/String;
    :cond_1
    :goto_3
    return-void

    .line 9314
    .end local v21           #result:Lcom/android/server/am/AppErrorResult;
    .restart local v8       #shortMsg:Ljava/lang/String;
    :cond_2
    if-eqz v8, :cond_0

    .line 9315
    move-object v9, v8

    goto :goto_0

    .line 9322
    .restart local v21       #result:Lcom/android/server/am/AppErrorResult;
    :cond_3
    const/4 v5, 0x0

    move-object v6, v5

    goto :goto_1

    .line 9323
    .restart local v6       #name:Ljava/lang/String;
    :cond_4
    :try_start_3
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0

    move-result v5

    move v7, v5

    goto :goto_2

    .line 9331
    .end local v6           #name:Ljava/lang/String;
    :catch_0
    move-exception v5

    move-object v15, v5

    .line 9332
    .local v15, e:Landroid/os/RemoteException;
    const/4 v5, 0x0

    :try_start_4
    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 9336
    .end local v15           #e:Landroid/os/RemoteException;
    :cond_5
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v18

    .line 9339
    .local v18, origId:J
    if-eqz p1, :cond_8

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v5, v0

    if-eqz v5, :cond_8

    .line 9340
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Error in app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " running instrumentation "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ":"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9342
    if-eqz v8, :cond_6

    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "  "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9343
    :cond_6
    if-eqz v9, :cond_7

    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "  "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9344
    :cond_7
    new-instance v16, Landroid/os/Bundle;

    invoke-direct/range {v16 .. v16}, Landroid/os/Bundle;-><init>()V

    .line 9345
    .local v16, info:Landroid/os/Bundle;
    const-string v5, "shortMsg"

    move-object/from16 v0, v16

    move-object v1, v5

    move-object v2, v8

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 9346
    const-string v5, "longMsg"

    move-object/from16 v0, v16

    move-object v1, v5

    move-object v2, v9

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 9347
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move v2, v5

    move-object/from16 v3, v16

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V

    .line 9348
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 9349
    monitor-exit p0

    goto/16 :goto_3

    .line 9368
    .end local v16           #info:Landroid/os/Bundle;
    .end local v18           #origId:J
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v5

    .line 9354
    .restart local v18       #origId:J
    :cond_8
    if-eqz p1, :cond_9

    :try_start_5
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object v2, v8

    move-object v3, v9

    move-object/from16 v4, v22

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->makeAppCrashingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Z

    move-result v5

    if-nez v5, :cond_a

    .line 9355
    :cond_9
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 9356
    monitor-exit p0

    goto/16 :goto_3

    .line 9359
    :cond_a
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v17

    .line 9360
    .local v17, msg:Landroid/os/Message;
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v17

    iput v0, v1, Landroid/os/Message;->what:I

    .line 9361
    new-instance v14, Ljava/util/HashMap;

    invoke-direct {v14}, Ljava/util/HashMap;-><init>()V

    .line 9362
    .local v14, data:Ljava/util/HashMap;
    const-string v5, "result"

    move-object v0, v14

    move-object v1, v5

    move-object/from16 v2, v21

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 9363
    const-string v5, "app"

    move-object v0, v14

    move-object v1, v5

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 9364
    move-object v0, v14

    move-object/from16 v1, v17

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 9365
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v17

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 9367
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 9368
    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 9370
    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/AppErrorResult;->get()I

    move-result v20

    .line 9372
    .local v20, res:I
    const/4 v13, 0x0

    .line 9373
    .local v13, appErrorIntent:Landroid/content/Intent;
    monitor-enter p0

    .line 9374
    if-eqz p1, :cond_b

    .line 9375
    :try_start_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v7, v0

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v23

    invoke-static/range {v23 .. v24}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v8

    .end local v8           #shortMsg:Ljava/lang/String;
    invoke-virtual {v5, v6, v7, v8}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 9378
    :cond_b
    const/4 v5, 0x1

    move/from16 v0, v20

    move v1, v5

    if-ne v0, v1, :cond_c

    .line 9379
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-wide v2, v10

    move-object/from16 v4, p2

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->createAppErrorIntentLocked(Lcom/android/server/am/ProcessRecord;JLandroid/app/ApplicationErrorReport$CrashInfo;)Landroid/content/Intent;

    move-result-object v13

    .line 9381
    :cond_c
    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    .line 9383
    if-eqz v13, :cond_1

    .line 9385
    :try_start_7
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v5, v0

    invoke-virtual {v5, v13}, Landroid/content/Context;->startActivity(Landroid/content/Intent;)V
    :try_end_7
    .catch Landroid/content/ActivityNotFoundException; {:try_start_7 .. :try_end_7} :catch_1

    goto/16 :goto_3

    .line 9386
    :catch_1
    move-exception v5

    move-object v15, v5

    .line 9387
    .local v15, e:Landroid/content/ActivityNotFoundException;
    const-string v5, "ActivityManager"

    const-string v6, "bug report receiver dissappeared"

    invoke-static {v5, v6, v15}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_3

    .line 9381
    .end local v15           #e:Landroid/content/ActivityNotFoundException;
    :catchall_1
    move-exception v5

    :try_start_8
    monitor-exit p0
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_1

    throw v5
.end method

.method private createAppErrorReportLocked(Lcom/android/server/am/ProcessRecord;JLandroid/app/ApplicationErrorReport$CrashInfo;)Landroid/app/ApplicationErrorReport;
    .locals 4
    .parameter "r"
    .parameter "timeMillis"
    .parameter "crashInfo"

    .prologue
    const/4 v3, 0x0

    const/4 v2, 0x1

    .line 9407
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    if-nez v1, :cond_0

    move-object v1, v3

    .line 9434
    :goto_0
    return-object v1

    .line 9411
    :cond_0
    iget-boolean v1, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-nez v1, :cond_1

    iget-boolean v1, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-nez v1, :cond_1

    move-object v1, v3

    .line 9412
    goto :goto_0

    .line 9415
    :cond_1
    new-instance v0, Landroid/app/ApplicationErrorReport;

    invoke-direct {v0}, Landroid/app/ApplicationErrorReport;-><init>()V

    .line 9416
    .local v0, report:Landroid/app/ApplicationErrorReport;
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v1, v0, Landroid/app/ApplicationErrorReport;->packageName:Ljava/lang/String;

    .line 9417
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    invoke-virtual {v1}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v1

    iput-object v1, v0, Landroid/app/ApplicationErrorReport;->installerPackageName:Ljava/lang/String;

    .line 9418
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iput-object v1, v0, Landroid/app/ApplicationErrorReport;->processName:Ljava/lang/String;

    .line 9419
    iput-wide p2, v0, Landroid/app/ApplicationErrorReport;->time:J

    .line 9420
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v1, v1, 0x1

    if-eqz v1, :cond_3

    move v1, v2

    :goto_1
    iput-boolean v1, v0, Landroid/app/ApplicationErrorReport;->systemApp:Z

    .line 9422
    iget-boolean v1, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-eqz v1, :cond_4

    .line 9423
    iput v2, v0, Landroid/app/ApplicationErrorReport;->type:I

    .line 9424
    iput-object p4, v0, Landroid/app/ApplicationErrorReport;->crashInfo:Landroid/app/ApplicationErrorReport$CrashInfo;

    :cond_2
    :goto_2
    move-object v1, v0

    .line 9434
    goto :goto_0

    .line 9420
    :cond_3
    const/4 v1, 0x0

    goto :goto_1

    .line 9425
    :cond_4
    iget-boolean v1, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-eqz v1, :cond_2

    .line 9426
    const/4 v1, 0x2

    iput v1, v0, Landroid/app/ApplicationErrorReport;->type:I

    .line 9427
    new-instance v1, Landroid/app/ApplicationErrorReport$AnrInfo;

    invoke-direct {v1}, Landroid/app/ApplicationErrorReport$AnrInfo;-><init>()V

    iput-object v1, v0, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    .line 9429
    iget-object v1, v0, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    iget-object v2, v2, Landroid/app/ActivityManager$ProcessErrorStateInfo;->tag:Ljava/lang/String;

    iput-object v2, v1, Landroid/app/ApplicationErrorReport$AnrInfo;->activity:Ljava/lang/String;

    .line 9430
    iget-object v1, v0, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    iget-object v2, v2, Landroid/app/ActivityManager$ProcessErrorStateInfo;->shortMsg:Ljava/lang/String;

    iput-object v2, v1, Landroid/app/ApplicationErrorReport$AnrInfo;->cause:Ljava/lang/String;

    .line 9431
    iget-object v1, v0, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    iget-object v2, v2, Landroid/app/ActivityManager$ProcessErrorStateInfo;->longMsg:Ljava/lang/String;

    iput-object v2, v1, Landroid/app/ApplicationErrorReport$AnrInfo;->info:Ljava/lang/String;

    goto :goto_2
.end method

.method private final decPersistentCountLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 2
    .parameter "app"

    .prologue
    .line 4958
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    const/4 v1, 0x1

    sub-int/2addr v0, v1

    iput v0, p1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    .line 4959
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-lez v0, :cond_1

    .line 4971
    :cond_0
    :goto_0
    return-void

    .line 4963
    :cond_1
    iget-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v0, :cond_0

    .line 4970
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    goto :goto_0
.end method

.method private final deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V
    .locals 6
    .parameter "r"
    .parameter "intent"

    .prologue
    .line 3105
    const/4 v2, 0x0

    .line 3106
    .local v2, sent:Z
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v4, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v3, v4, :cond_0

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_0

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_0

    .line 3109
    :try_start_0
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 3110
    .local v0, ar:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    new-instance v3, Landroid/content/Intent;

    invoke-direct {v3, p2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    invoke-virtual {v0, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 3111
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v3, v0, p1}, Landroid/app/IApplicationThread;->scheduleNewIntent(Ljava/util/List;Landroid/os/IBinder;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 3112
    const/4 v2, 0x1

    .line 3117
    .end local v0           #ar:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    :cond_0
    :goto_0
    if-nez v2, :cond_1

    .line 3118
    new-instance v3, Landroid/content/Intent;

    invoke-direct {v3, p2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    invoke-virtual {p1, v3}, Lcom/android/server/am/HistoryRecord;->addNewIntentLocked(Landroid/content/Intent;)V

    .line 3120
    :cond_1
    return-void

    .line 3113
    :catch_0
    move-exception v3

    move-object v1, v3

    .line 3114
    .local v1, e:Ljava/lang/Exception;
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Exception thrown sending new intent to "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_0
.end method

.method private final deliverToRegisteredReceiver(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V
    .locals 11
    .parameter "r"
    .parameter "filter"
    .parameter "ordered"

    .prologue
    .line 12974
    const/4 v10, 0x0

    .line 12975
    .local v10, skip:Z
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->requiredPermission:Ljava/lang/String;

    if-eqz v0, :cond_0

    .line 12976
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->requiredPermission:Ljava/lang/String;

    iget v1, p1, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    iget v2, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    const/4 v3, -0x1

    invoke-virtual {p0, v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v9

    .line 12978
    .local v9, perm:I
    if-eqz v9, :cond_0

    .line 12979
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Permission Denial: broadcasting "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " from "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " (pid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p1, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ", uid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ")"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " requires "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->requiredPermission:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " due to registered receiver "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12985
    const/4 v10, 0x1

    .line 12988
    .end local v9           #perm:I
    :cond_0
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    if-eqz v0, :cond_1

    .line 12989
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    iget-object v1, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v1, v1, Lcom/android/server/am/ReceiverList;->pid:I

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v2, v2, Lcom/android/server/am/ReceiverList;->uid:I

    const/4 v3, -0x1

    invoke-virtual {p0, v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v9

    .line 12991
    .restart local v9       #perm:I
    if-eqz v9, :cond_1

    .line 12992
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Permission Denial: receiving "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " to "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v2, v2, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " (pid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v2, v2, Lcom/android/server/am/ReceiverList;->pid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ", uid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v2, v2, Lcom/android/server/am/ReceiverList;->uid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ")"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " requires "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " due to sender "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " (uid "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ")"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13000
    const/4 v10, 0x1

    .line 13004
    .end local v9           #perm:I
    :cond_1
    if-nez v10, :cond_3

    .line 13008
    if-eqz p3, :cond_2

    .line 13009
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    invoke-interface {v0}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 13010
    iput-object p2, p1, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 13011
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iput-object p1, v0, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 13012
    const/4 v0, 0x2

    iput v0, p1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13013
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_2

    .line 13019
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 13020
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iput-object p1, v0, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 13021
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 13030
    :cond_2
    :try_start_0
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v1, v1, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    new-instance v2, Landroid/content/Intent;

    iget-object v3, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-direct {v2, v3}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    iget v3, p1, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v4, p1, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v6, p1, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    iget-boolean v7, p1, Lcom/android/server/am/BroadcastRecord;->initialSticky:Z

    invoke-static/range {v0 .. v7}, Lcom/android/server/am/ActivityManagerService;->performReceive(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V

    .line 13033
    if-eqz p3, :cond_3

    .line 13034
    const/4 v0, 0x3

    iput v0, p1, Lcom/android/server/am/BroadcastRecord;->state:I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 13048
    :cond_3
    :goto_0
    return-void

    .line 13036
    :catch_0
    move-exception v0

    move-object v8, v0

    .line 13037
    .local v8, e:Landroid/os/RemoteException;
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Failure sending broadcast "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v8}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 13038
    if-eqz p3, :cond_3

    .line 13039
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 13040
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 13041
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    const/4 v1, 0x0

    iput-object v1, v0, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 13042
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_3

    .line 13043
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v1, 0x0

    iput-object v1, v0, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    goto :goto_0
.end method

.method private final destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z
    .locals 12
    .parameter "r"
    .parameter "removeFromApp"

    .prologue
    const/4 v11, 0x1

    const/4 v10, 0x0

    .line 4504
    const/16 v6, 0x7542

    const/4 v7, 0x3

    new-array v7, v7, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v8

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v7, v10

    iget-object v8, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v8, v8, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v7, v11

    const/4 v8, 0x2

    iget-object v9, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4508
    const/4 v4, 0x0

    .line 4510
    .local v4, removedFromHistory:Z
    invoke-direct {p0, p1, v10}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityLocked(Lcom/android/server/am/HistoryRecord;Z)V

    .line 4512
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_5

    move v1, v11

    .line 4514
    .local v1, hadApp:Z
    :goto_0
    if-eqz v1, :cond_7

    .line 4515
    if-eqz p2, :cond_2

    .line 4516
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v6, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v2

    .line 4517
    .local v2, idx:I
    if-ltz v2, :cond_0

    .line 4518
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 4520
    :cond_0
    iget-boolean v6, p1, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-eqz v6, :cond_1

    .line 4521
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v6}, Lcom/android/server/am/ActivityManagerService;->decPersistentCountLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 4523
    :cond_1
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    if-nez v6, :cond_2

    .line 4526
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v6, v11, v10}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 4530
    .end local v2           #idx:I
    :cond_2
    const/4 v5, 0x0

    .line 4534
    .local v5, skipDestroy:Z
    :try_start_0
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-boolean v7, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    iget v8, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-interface {v6, p1, v7, v8}, Landroid/app/IApplicationThread;->scheduleDestroyActivity(Landroid/os/IBinder;ZI)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 4548
    :cond_3
    :goto_1
    const/4 v6, 0x0

    iput-object v6, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 4549
    iput-boolean v10, p1, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    .line 4551
    iget-boolean v6, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_6

    if-nez v5, :cond_6

    .line 4552
    sget-object v6, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v6, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4553
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v7, 0x11

    invoke-virtual {v6, v7}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v3

    .line 4554
    .local v3, msg:Landroid/os/Message;
    iput-object p1, v3, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 4555
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v7, 0x2710

    invoke-virtual {v6, v3, v7, v8}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 4569
    .end local v3           #msg:Landroid/os/Message;
    .end local v5           #skipDestroy:Z
    :goto_2
    iput v10, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    .line 4571
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v6, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    move-result v6

    if-nez v6, :cond_4

    if-eqz v1, :cond_4

    .line 4572
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Activity "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " being finished, but not in LRU list"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4575
    :cond_4
    return v4

    .end local v1           #hadApp:Z
    :cond_5
    move v1, v10

    .line 4512
    goto/16 :goto_0

    .line 4536
    .restart local v1       #hadApp:Z
    .restart local v5       #skipDestroy:Z
    :catch_0
    move-exception v6

    move-object v0, v6

    .line 4541
    .local v0, e:Ljava/lang/Exception;
    iget-boolean v6, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_3

    .line 4542
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4543
    const/4 v4, 0x1

    .line 4544
    const/4 v5, 0x1

    goto :goto_1

    .line 4557
    .end local v0           #e:Ljava/lang/Exception;
    :cond_6
    sget-object v6, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v6, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    goto :goto_2

    .line 4561
    .end local v5           #skipDestroy:Z
    :cond_7
    iget-boolean v6, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_8

    .line 4562
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4563
    const/4 v4, 0x1

    goto :goto_2

    .line 4565
    :cond_8
    sget-object v6, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v6, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    goto :goto_2
.end method

.method private final doPendingActivityLaunchesLocked(Z)V
    .locals 11
    .parameter "doResume"

    .prologue
    const/4 v10, 0x1

    .line 3286
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v7

    .line 3287
    .local v7, N:I
    if-gtz v7, :cond_0

    .line 3297
    :goto_0
    return-void

    .line 3290
    :cond_0
    const/4 v8, 0x0

    .local v8, i:I
    :goto_1
    if-ge v8, v7, :cond_2

    .line 3291
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    invoke-virtual {v0, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;

    .line 3292
    .local v9, pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    iget-object v1, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->r:Lcom/android/server/am/HistoryRecord;

    iget-object v2, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->sourceRecord:Lcom/android/server/am/HistoryRecord;

    iget-object v3, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedUriPermissions:[Landroid/net/Uri;

    iget v4, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedMode:I

    iget-boolean v5, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->onlyIfNeeded:Z

    if-eqz p1, :cond_1

    sub-int v0, v7, v10

    if-ne v8, v0, :cond_1

    move v6, v10

    :goto_2
    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->startActivityUncheckedLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;[Landroid/net/Uri;IZZ)I

    .line 3290
    add-int/lit8 v8, v8, 0x1

    goto :goto_1

    .line 3292
    :cond_1
    const/4 v0, 0x0

    move v6, v0

    goto :goto_2

    .line 3296
    .end local v9           #pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    :cond_2
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->clear()V

    goto :goto_0
.end method

.method static final dumpApplicationMemoryUsage(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;[Ljava/lang/String;)V
    .locals 10
    .parameter "fd"
    .parameter "pw"
    .parameter "list"
    .parameter "prefix"
    .parameter "args"

    .prologue
    .line 10313
    const-string v8, "--checkin"

    invoke-static {p4, v8}, Lcom/android/server/am/ActivityManagerService;->scanArgs([Ljava/lang/String;Ljava/lang/String;)Z

    move-result v2

    .line 10314
    .local v2, isCheckinRequest:Z
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v6

    .line 10315
    .local v6, uptime:J
    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v4

    .line 10317
    .local v4, realtime:J
    if-eqz v2, :cond_2

    .line 10319
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v8, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, ","

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v4, v5}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10320
    invoke-virtual {p1}, Ljava/io/PrintWriter;->flush()V

    .line 10325
    :goto_0
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result v8

    const/4 v9, 0x1

    sub-int v1, v8, v9

    .local v1, i:I
    :goto_1
    if-ltz v1, :cond_3

    .line 10326
    invoke-interface {p2, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 10327
    .local v3, r:Lcom/android/server/am/ProcessRecord;
    iget-object v8, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_1

    .line 10328
    if-nez v2, :cond_0

    .line 10329
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "\n** MEMINFO in pid "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    iget v9, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " ["

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    iget-object v9, v3, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, "] **"

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10330
    invoke-virtual {p1}, Ljava/io/PrintWriter;->flush()V

    .line 10333
    :cond_0
    :try_start_0
    iget-object v8, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v8}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v8

    invoke-interface {v8, p0, p4}, Landroid/os/IBinder;->dump(Ljava/io/FileDescriptor;[Ljava/lang/String;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 10325
    :cond_1
    :goto_2
    add-int/lit8 v1, v1, -0x1

    goto :goto_1

    .line 10322
    .end local v1           #i:I
    .end local v3           #r:Lcom/android/server/am/ProcessRecord;
    :cond_2
    const-string v8, "Applications Memory Usage (kB):"

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10323
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Uptime: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " Realtime: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v4, v5}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto :goto_0

    .line 10334
    .restart local v1       #i:I
    .restart local v3       #r:Lcom/android/server/am/ProcessRecord;
    :catch_0
    move-exception v8

    move-object v0, v8

    .line 10335
    .local v0, e:Landroid/os/RemoteException;
    if-nez v2, :cond_1

    .line 10336
    const-string v8, "Got RemoteException!"

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10337
    invoke-virtual {p1}, Ljava/io/PrintWriter;->flush()V

    goto :goto_2

    .line 10342
    .end local v0           #e:Landroid/os/RemoteException;
    .end local v3           #r:Lcom/android/server/am/ProcessRecord;
    :cond_3
    return-void
.end method

.method private static final dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V
    .locals 8
    .parameter "pw"
    .parameter "list"
    .parameter "prefix"
    .parameter "label"
    .parameter "complete"

    .prologue
    const/4 v6, 0x1

    const-string v7, "  "

    .line 10216
    const/4 v2, 0x0

    .line 10217
    .local v2, lastTask:Lcom/android/server/am/TaskRecord;
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v4

    sub-int v1, v4, v6

    .local v1, i:I
    :goto_0
    if-ltz v1, :cond_6

    .line 10218
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 10219
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    if-nez p4, :cond_0

    iget-boolean v4, v3, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    if-nez v4, :cond_3

    :cond_0
    move v0, v6

    .line 10220
    .local v0, full:Z
    :goto_1
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v2, v4, :cond_1

    .line 10221
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 10222
    invoke-virtual {p0, p2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10223
    if-eqz v0, :cond_4

    const-string v4, "* "

    :goto_2
    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10224
    invoke-virtual {p0, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10225
    if-eqz v0, :cond_1

    .line 10226
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "  "

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v2, p0, v4}, Lcom/android/server/am/TaskRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10229
    :cond_1
    invoke-virtual {p0, p2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    if-eqz v0, :cond_5

    const-string v4, "  * "

    :goto_3
    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p0, p3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10230
    const-string v4, " #"

    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p0, v1}, Ljava/io/PrintWriter;->print(I)V

    const-string v4, ": "

    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10231
    invoke-virtual {p0, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10232
    if-eqz v0, :cond_2

    .line 10233
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "      "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, p0, v4}, Lcom/android/server/am/HistoryRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10217
    :cond_2
    add-int/lit8 v1, v1, -0x1

    goto :goto_0

    .line 10219
    .end local v0           #full:Z
    :cond_3
    const/4 v4, 0x0

    move v0, v4

    goto :goto_1

    .line 10223
    .restart local v0       #full:Z
    :cond_4
    const-string v4, "  "

    move-object v4, v7

    goto :goto_2

    .line 10229
    :cond_5
    const-string v4, "    "

    goto :goto_3

    .line 10236
    .end local v0           #full:Z
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_6
    return-void
.end method

.method private static final dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I
    .locals 8
    .parameter "pw"
    .parameter "service"
    .parameter "list"
    .parameter "prefix"
    .parameter "normalLabel"
    .parameter "persistentLabel"
    .parameter "inclOomAdj"

    .prologue
    .line 10250
    const/4 v0, 0x0

    .line 10251
    .local v0, numPers:I
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result p1

    .end local p1
    const/4 v1, 0x1

    sub-int/2addr p1, v1

    .local p1, i:I
    :goto_0
    if-ltz p1, :cond_f

    .line 10252
    invoke-interface {p2, p1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 10257
    .local v2, r:Lcom/android/server/am/ProcessRecord;
    if-eqz p6, :cond_d

    .line 10259
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    if-lt v1, v3, :cond_3

    .line 10260
    const-string v1, "empty"

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .line 10281
    .local v1, oomAdj:Ljava/lang/String;
    :goto_1
    iget v3, v2, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    packed-switch v3, :pswitch_data_0

    .line 10289
    iget v3, v2, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    invoke-static {v3}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

    move-result-object v3

    .line 10292
    .local v3, schedGroup:Ljava/lang/String;
    :goto_2
    const-string v4, "%s%s #%2d: adj=%s/%s %s (%s)"

    const/4 v5, 0x7

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    aput-object p3, v5, v6

    const/4 v6, 0x1

    iget-boolean v7, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v7, :cond_c

    move-object v7, p5

    :goto_3
    aput-object v7, v5, v6

    const/4 v6, 0x2

    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x3

    aput-object v1, v5, v6

    const/4 v1, 0x4

    aput-object v3, v5, v1

    .end local v1           #oomAdj:Ljava/lang/String;
    const/4 v1, 0x5

    invoke-virtual {v2}, Lcom/android/server/am/ProcessRecord;->toShortString()Ljava/lang/String;

    move-result-object v3

    .end local v3           #schedGroup:Ljava/lang/String;
    aput-object v3, v5, v1

    const/4 v1, 0x6

    iget-object v3, v2, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    aput-object v3, v5, v1

    invoke-static {v4, v5}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10295
    iget-object v1, v2, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    if-nez v1, :cond_0

    iget-object v1, v2, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    if-eqz v1, :cond_1

    .line 10296
    :cond_0
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v3, "          "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v3, v2, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v3, "<="

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v3, v2, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10304
    :cond_1
    :goto_4
    iget-boolean v1, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v1, :cond_2

    .line 10305
    add-int/lit8 v0, v0, 0x1

    .line 10251
    :cond_2
    add-int/lit8 p1, p1, -0x1

    goto/16 :goto_0

    .line 10261
    :cond_3
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v1, v3, :cond_4

    .line 10262
    const-string v1, "bak"

    const-string v3, "  "

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10263
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_4
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    if-lt v1, v3, :cond_5

    .line 10264
    const-string v1, "home "

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10265
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_5
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    if-lt v1, v3, :cond_6

    .line 10266
    const-string v1, "svc"

    const-string v3, "  "

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10267
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_6
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    if-lt v1, v3, :cond_7

    .line 10268
    const-string v1, "bckup"

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10269
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_7
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-lt v1, v3, :cond_8

    .line 10270
    const-string v1, "vis  "

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10271
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_8
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    if-lt v1, v3, :cond_9

    .line 10272
    const-string v1, "fore "

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10273
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_9
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    const/16 v3, -0xc

    if-lt v1, v3, :cond_a

    .line 10274
    const-string v1, "core "

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    const/16 v5, -0xc

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10275
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_a
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    const/16 v3, -0x10

    if-lt v1, v3, :cond_b

    .line 10276
    const-string v1, "sys  "

    const/4 v3, 0x0

    iget v4, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    const/16 v5, -0x10

    invoke-static {v1, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->buildOomTag(Ljava/lang/String;Ljava/lang/String;II)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10278
    .end local v1           #oomAdj:Ljava/lang/String;
    :cond_b
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    invoke-static {v1}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

    move-result-object v1

    .restart local v1       #oomAdj:Ljava/lang/String;
    goto/16 :goto_1

    .line 10283
    :pswitch_0
    const-string v3, "B"

    .line 10284
    .restart local v3       #schedGroup:Ljava/lang/String;
    goto/16 :goto_2

    .line 10286
    .end local v3           #schedGroup:Ljava/lang/String;
    :pswitch_1
    const-string v3, "F"

    .line 10287
    .restart local v3       #schedGroup:Ljava/lang/String;
    goto/16 :goto_2

    :cond_c
    move-object v7, p4

    .line 10292
    goto/16 :goto_3

    .line 10300
    .end local v1           #oomAdj:Ljava/lang/String;
    .end local v3           #schedGroup:Ljava/lang/String;
    :cond_d
    const-string v1, "%s%s #%2d: %s"

    const/4 v3, 0x4

    new-array v3, v3, [Ljava/lang/Object;

    const/4 v4, 0x0

    aput-object p3, v3, v4

    const/4 v4, 0x1

    iget-boolean v5, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v5, :cond_e

    move-object v5, p5

    :goto_5
    aput-object v5, v3, v4

    const/4 v4, 0x2

    invoke-static {p1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    const/4 v4, 0x3

    invoke-virtual {v2}, Lcom/android/server/am/ProcessRecord;->toString()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v1, v3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto/16 :goto_4

    :cond_e
    move-object v5, p4

    goto :goto_5

    .line 10308
    .end local v2           #r:Lcom/android/server/am/ProcessRecord;
    :cond_f
    return v0

    .line 10281
    :pswitch_data_0
    .packed-switch 0x0
        :pswitch_1
        :pswitch_0
    .end packed-switch
.end method

.method private dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Lcom/android/server/am/ServiceRecord;[Ljava/lang/String;)V
    .locals 3
    .parameter "fd"
    .parameter "pw"
    .parameter "r"
    .parameter "args"

    .prologue
    .line 9945
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "  Service "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p3, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v2}, Landroid/content/ComponentName;->flattenToString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9946
    iget-object v1, p3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_0

    iget-object v1, p3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v1, :cond_0

    .line 9950
    :try_start_0
    invoke-virtual {p2}, Ljava/io/PrintWriter;->flush()V

    .line 9951
    iget-object v1, p3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v1, p1, p3, p4}, Landroid/app/IApplicationThread;->dumpService(Ljava/io/FileDescriptor;Landroid/os/IBinder;[Ljava/lang/String;)V

    .line 9952
    const-string v1, "\n"

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 9957
    :cond_0
    :goto_0
    return-void

    .line 9953
    :catch_0
    move-exception v1

    move-object v0, v1

    .line 9954
    .local v0, e:Landroid/os/RemoteException;
    const-string v1, "got a RemoteException while dumping the service"

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto :goto_0
.end method

.method public static dumpStackTraces(ZLjava/util/ArrayList;)Ljava/io/File;
    .locals 13
    .parameter "clearTraces"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(Z",
            "Ljava/util/ArrayList",
            "<",
            "Ljava/lang/Integer;",
            ">;)",
            "Ljava/io/File;"
        }
    .end annotation

    .prologue
    .local p1, pids:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/Integer;>;"
    const/4 v11, 0x0

    const-string v12, "ActivityManager"

    .line 4793
    const-string v7, "dalvik.vm.stack-trace-file"

    invoke-static {v7, v11}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    .line 4794
    .local v6, tracesPath:Ljava/lang/String;
    if-eqz v6, :cond_0

    invoke-virtual {v6}, Ljava/lang/String;->length()I

    move-result v7

    if-nez v7, :cond_1

    :cond_0
    move-object v7, v11

    .line 4833
    .end local p0
    :goto_0
    return-object v7

    .line 4798
    .restart local p0
    :cond_1
    new-instance v5, Ljava/io/File;

    invoke-direct {v5, v6}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 4800
    .local v5, tracesFile:Ljava/io/File;
    :try_start_0
    invoke-virtual {v5}, Ljava/io/File;->getParentFile()Ljava/io/File;

    move-result-object v4

    .line 4801
    .local v4, tracesDir:Ljava/io/File;
    invoke-virtual {v4}, Ljava/io/File;->exists()Z

    move-result v7

    if-nez v7, :cond_2

    invoke-virtual {v5}, Ljava/io/File;->mkdirs()Z

    .line 4802
    :cond_2
    invoke-virtual {v4}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v7

    const/16 v8, 0x1fd

    const/4 v9, -0x1

    const/4 v10, -0x1

    invoke-static {v7, v8, v9, v10}, Landroid/os/FileUtils;->setPermissions(Ljava/lang/String;III)I

    .line 4804
    if-eqz p0, :cond_3

    invoke-virtual {v5}, Ljava/io/File;->exists()Z

    move-result v7

    if-eqz v7, :cond_3

    invoke-virtual {v5}, Ljava/io/File;->delete()Z

    .line 4805
    :cond_3
    invoke-virtual {v5}, Ljava/io/File;->createNewFile()Z

    .line 4806
    invoke-virtual {v5}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v7

    const/16 v8, 0x1b6

    const/4 v9, -0x1

    const/4 v10, -0x1

    invoke-static {v7, v8, v9, v10}, Landroid/os/FileUtils;->setPermissions(Ljava/lang/String;III)I
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    .line 4814
    new-instance v3, Lcom/android/server/am/ActivityManagerService$4;

    const/16 v7, 0x8

    invoke-direct {v3, v6, v7}, Lcom/android/server/am/ActivityManagerService$4;-><init>(Ljava/lang/String;I)V

    .line 4819
    .local v3, observer:Landroid/os/FileObserver;
    :try_start_1
    invoke-virtual {v3}, Landroid/os/FileObserver;->startWatching()V

    .line 4820
    invoke-virtual {p1}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 4821
    .local v2, num:I
    const/4 v1, 0x0

    .end local p0
    .local v1, i:I
    :goto_1
    if-ge v1, v2, :cond_4

    .line 4822
    monitor-enter v3
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1
    .catch Ljava/lang/InterruptedException; {:try_start_1 .. :try_end_1} :catch_1

    .line 4823
    :try_start_2
    invoke-virtual {p1, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p0

    check-cast p0, Ljava/lang/Integer;

    invoke-virtual {p0}, Ljava/lang/Integer;->intValue()I

    move-result v7

    const/4 v8, 0x3

    invoke-static {v7, v8}, Landroid/os/Process;->sendSignal(II)V

    .line 4824
    const-wide/16 v7, 0xc8

    invoke-virtual {v3, v7, v8}, Ljava/lang/Object;->wait(J)V

    .line 4825
    monitor-exit v3
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 4821
    add-int/lit8 v1, v1, 0x1

    goto :goto_1

    .line 4807
    .end local v1           #i:I
    .end local v2           #num:I
    .end local v3           #observer:Landroid/os/FileObserver;
    .end local v4           #tracesDir:Ljava/io/File;
    .restart local p0
    :catch_0
    move-exception v7

    move-object v0, v7

    .line 4808
    .local v0, e:Ljava/io/IOException;
    const-string v7, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to prepare ANR traces file: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v12, v7, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    move-object v7, v11

    .line 4809
    goto :goto_0

    .line 4825
    .end local v0           #e:Ljava/io/IOException;
    .end local p0
    .restart local v1       #i:I
    .restart local v2       #num:I
    .restart local v3       #observer:Landroid/os/FileObserver;
    .restart local v4       #tracesDir:Ljava/io/File;
    :catchall_0
    move-exception v7

    :try_start_3
    monitor-exit v3
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    :try_start_4
    throw v7
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1
    .catch Ljava/lang/InterruptedException; {:try_start_4 .. :try_end_4} :catch_1

    .line 4827
    .end local v1           #i:I
    .end local v2           #num:I
    :catch_1
    move-exception v7

    move-object v0, v7

    .line 4828
    .local v0, e:Ljava/lang/InterruptedException;
    :try_start_5
    const-string v7, "ActivityManager"

    invoke-static {v7, v0}, Landroid/util/Log;->wtf(Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    .line 4830
    invoke-virtual {v3}, Landroid/os/FileObserver;->stopWatching()V

    .end local v0           #e:Ljava/lang/InterruptedException;
    :goto_2
    move-object v7, v5

    .line 4833
    goto/16 :goto_0

    .line 4830
    .restart local v1       #i:I
    .restart local v2       #num:I
    :cond_4
    invoke-virtual {v3}, Landroid/os/FileObserver;->stopWatching()V

    goto :goto_2

    .end local v1           #i:I
    .end local v2           #num:I
    :catchall_1
    move-exception v7

    invoke-virtual {v3}, Landroid/os/FileObserver;->stopWatching()V

    throw v7
.end method

.method private final ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V
    .locals 2
    .parameter "starting"
    .parameter "configChanges"

    .prologue
    const/4 v1, 0x0

    .line 2464
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 2465
    .local v0, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_0

    .line 2466
    invoke-direct {p0, v0, p1, v1, p2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    .line 2468
    :cond_0
    return-void
.end method

.method private final ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V
    .locals 11
    .parameter "top"
    .parameter "starting"
    .parameter "onlyThisProcess"
    .parameter "configChanges"

    .prologue
    const/4 v9, 0x1

    const/4 v8, 0x0

    const-string v10, "ActivityManager"

    .line 2328
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 2329
    .local v1, count:I
    sub-int v4, v1, v9

    .line 2330
    .local v4, i:I
    :goto_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    if-eq v6, p1, :cond_0

    .line 2331
    add-int/lit8 v4, v4, -0x1

    goto :goto_0

    .line 2334
    :cond_0
    const/4 v0, 0x0

    .line 2335
    .local v0, behindFullscreen:Z
    :goto_1
    if-ltz v4, :cond_a

    .line 2336
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 2340
    .local v5, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_2

    .line 2335
    :cond_1
    add-int/lit8 v4, v4, -0x1

    goto :goto_1

    .line 2344
    :cond_2
    if-eqz p3, :cond_3

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    invoke-virtual {p3, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_d

    :cond_3
    move v2, v9

    .line 2349
    .local v2, doThisProcess:Z
    :goto_2
    if-eq v5, p2, :cond_4

    if-eqz v2, :cond_4

    .line 2350
    invoke-direct {p0, v5, v8}, Lcom/android/server/am/ActivityManagerService;->ensureActivityConfigurationLocked(Lcom/android/server/am/HistoryRecord;I)Z

    .line 2353
    :cond_4
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_5

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v6, :cond_e

    .line 2354
    :cond_5
    if-eqz p3, :cond_6

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    invoke-virtual {p3, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_9

    .line 2361
    :cond_6
    if-eq v5, p2, :cond_7

    .line 2362
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v5, v6, p4}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 2364
    :cond_7
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v6, :cond_8

    .line 2367
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v6, v5, v9}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2369
    :cond_8
    if-eq v5, p2, :cond_9

    .line 2370
    invoke-direct {p0, v5, v8, v8}, Lcom/android/server/am/ActivityManagerService;->startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    .line 2404
    :cond_9
    :goto_3
    iget v6, v5, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    or-int/2addr p4, v6

    .line 2406
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    if-eqz v6, :cond_1

    .line 2410
    const/4 v0, 0x1

    .line 2411
    add-int/lit8 v4, v4, -0x1

    .line 2418
    .end local v2           #doThisProcess:Z
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_a
    :goto_4
    if-ltz v4, :cond_11

    .line 2419
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 2424
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v6, :cond_c

    .line 2425
    if-eqz v0, :cond_10

    .line 2426
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-eqz v6, :cond_c

    .line 2429
    iput-boolean v8, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    .line 2431
    :try_start_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v7, 0x0

    invoke-virtual {v6, v5, v7}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2432
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v6, v7, :cond_b

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v6, v7, :cond_c

    :cond_b
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_c

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v6, :cond_c

    .line 2437
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    const/4 v7, 0x0

    invoke-interface {v6, v5, v7}, Landroid/app/IApplicationThread;->scheduleWindowVisibility(Landroid/os/IBinder;Z)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1

    .line 2455
    :cond_c
    :goto_5
    add-int/lit8 v4, v4, -0x1

    goto :goto_4

    :cond_d
    move v2, v8

    .line 2344
    goto :goto_2

    .line 2374
    .restart local v2       #doThisProcess:Z
    :cond_e
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-eqz v6, :cond_f

    .line 2379
    invoke-virtual {v5, v8}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    goto :goto_3

    .line 2381
    :cond_f
    if-nez p3, :cond_9

    .line 2384
    iput-boolean v9, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    .line 2385
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v6, v7, :cond_9

    if-eq v5, p2, :cond_9

    .line 2391
    :try_start_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v7, 0x1

    invoke-virtual {v6, v5, v7}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2392
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    const/4 v7, 0x1

    invoke-interface {v6, v5, v7}, Landroid/app/IApplicationThread;->scheduleWindowVisibility(Landroid/os/IBinder;Z)V

    .line 2393
    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V
    :try_end_1
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_3

    .line 2394
    :catch_0
    move-exception v6

    move-object v3, v6

    .line 2397
    .local v3, e:Ljava/lang/Exception;
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception thrown making visibile: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v5, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v7}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_3

    .line 2439
    .end local v2           #doThisProcess:Z
    .end local v3           #e:Ljava/lang/Exception;
    :catch_1
    move-exception v6

    move-object v3, v6

    .line 2442
    .restart local v3       #e:Ljava/lang/Exception;
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception thrown making hidden: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v5, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v7}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_5

    .line 2449
    .end local v3           #e:Ljava/lang/Exception;
    :cond_10
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    if-eqz v6, :cond_c

    .line 2452
    const/4 v0, 0x1

    goto :goto_5

    .line 2457
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_11
    return-void
.end method

.method private final ensureActivityConfigurationLocked(Lcom/android/server/am/HistoryRecord;I)Z
    .locals 7
    .parameter "r"
    .parameter "globalChanges"

    .prologue
    const/4 v6, 0x0

    const/4 v5, 0x1

    .line 13660
    iget-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mConfigWillChange:Z

    if-eqz v3, :cond_0

    move v3, v5

    .line 13765
    :goto_0
    return v3

    .line 13671
    :cond_0
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    .line 13672
    .local v1, newConfig:Landroid/content/res/Configuration;
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    if-ne v3, v1, :cond_1

    move v3, v5

    .line 13675
    goto :goto_0

    .line 13679
    :cond_1
    iget-boolean v3, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_2

    .line 13682
    invoke-virtual {p1, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    move v3, v5

    .line 13683
    goto :goto_0

    .line 13688
    :cond_2
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    .line 13689
    .local v2, oldConfig:Landroid/content/res/Configuration;
    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    .line 13693
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_3

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v3, :cond_4

    .line 13696
    :cond_3
    invoke-virtual {p1, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    move v3, v5

    .line 13697
    goto :goto_0

    .line 13702
    :cond_4
    iget-boolean v3, p1, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-nez v3, :cond_9

    .line 13705
    invoke-virtual {v2, v1}, Landroid/content/res/Configuration;->diff(Landroid/content/res/Configuration;)I

    move-result v0

    .line 13712
    .local v0, changes:I
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget v3, v3, Landroid/content/pm/ActivityInfo;->configChanges:I

    xor-int/lit8 v3, v3, -0x1

    and-int/2addr v3, v0

    if-eqz v3, :cond_9

    .line 13714
    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    or-int/2addr v3, v0

    iput v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    .line 13715
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {p1, v3, p2}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 13716
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_5

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v3, :cond_6

    .line 13719
    :cond_5
    invoke-direct {p0, p1, v5}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    :goto_1
    move v3, v6

    .line 13746
    goto :goto_0

    .line 13720
    :cond_6
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v4, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v3, v4, :cond_7

    .line 13726
    iput-boolean v5, p1, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    move v3, v5

    .line 13727
    goto :goto_0

    .line 13728
    :cond_7
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v4, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v3, v4, :cond_8

    .line 13735
    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-direct {p0, p1, v3, v5}, Lcom/android/server/am/ActivityManagerService;->relaunchActivityLocked(Lcom/android/server/am/HistoryRecord;IZ)Z

    .line 13736
    iput v6, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    goto :goto_1

    .line 13740
    :cond_8
    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-direct {p0, p1, v3, v6}, Lcom/android/server/am/ActivityManagerService;->relaunchActivityLocked(Lcom/android/server/am/HistoryRecord;IZ)Z

    .line 13741
    iput v6, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    goto :goto_1

    .line 13755
    .end local v0           #changes:I
    :cond_9
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_a

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_a

    .line 13758
    :try_start_0
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v3, p1}, Landroid/app/IApplicationThread;->scheduleActivityConfigurationChanged(Landroid/os/IBinder;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 13763
    :cond_a
    :goto_2
    invoke-virtual {p1, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    move v3, v5

    .line 13765
    goto/16 :goto_0

    .line 13759
    :catch_0
    move-exception v3

    goto :goto_2
.end method

.method private ensurePackageDexOpt(Ljava/lang/String;)V
    .locals 2
    .parameter "packageName"

    .prologue
    .line 1752
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v0

    .line 1754
    .local v0, pm:Landroid/content/pm/IPackageManager;
    :try_start_0
    invoke-interface {v0, p1}, Landroid/content/pm/IPackageManager;->performDexOpt(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    .line 1755
    const/4 v1, 0x1

    iput-boolean v1, p0, Lcom/android/server/am/ActivityManagerService;->mDidDexOpt:Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1759
    :cond_0
    :goto_0
    return-void

    .line 1757
    :catch_0
    move-exception v1

    goto :goto_0
.end method

.method private final findActivityInHistoryLocked(Lcom/android/server/am/HistoryRecord;I)I
    .locals 4
    .parameter "r"
    .parameter "task"

    .prologue
    .line 3071
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 3072
    .local v1, i:I
    :cond_0
    if-lez v1, :cond_1

    .line 3073
    add-int/lit8 v1, v1, -0x1

    .line 3074
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    .line 3075
    .local v0, candidate:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v2, Lcom/android/server/am/TaskRecord;->taskId:I

    if-eq v2, p2, :cond_2

    .line 3083
    .end local v0           #candidate:Lcom/android/server/am/HistoryRecord;
    :cond_1
    const/4 v2, -0x1

    :goto_0
    return v2

    .line 3078
    .restart local v0       #candidate:Lcom/android/server/am/HistoryRecord;
    :cond_2
    iget-object v2, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v2, v3}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_0

    move v2, v1

    .line 3079
    goto :goto_0
.end method

.method private findActivityLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;
    .locals 6
    .parameter "intent"
    .parameter "info"

    .prologue
    .line 7620
    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v1

    .line 7621
    .local v1, cls:Landroid/content/ComponentName;
    iget-object v4, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    if-eqz v4, :cond_0

    .line 7622
    new-instance v1, Landroid/content/ComponentName;

    .end local v1           #cls:Landroid/content/ComponentName;
    iget-object v4, p2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v5, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    invoke-direct {v1, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 7625
    .restart local v1       #cls:Landroid/content/ComponentName;
    :cond_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7626
    .local v0, N:I
    const/4 v4, 0x1

    sub-int v2, v0, v4

    .local v2, i:I
    :goto_0
    if-ltz v2, :cond_2

    .line 7627
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7628
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v4, v3, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v4, :cond_1

    .line 7629
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v4}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    invoke-virtual {v4, v1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_1

    move-object v4, v3

    .line 7638
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return-object v4

    .line 7626
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    add-int/lit8 v2, v2, -0x1

    goto :goto_0

    .line 7638
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_2
    const/4 v4, 0x0

    goto :goto_1
.end method

.method private final findAffinityTaskTopLocked(ILjava/lang/String;)I
    .locals 8
    .parameter "startIndex"
    .parameter "affinity"

    .prologue
    const/4 v7, 0x1

    .line 6987
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, p1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    iget-object v4, v5, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6988
    .local v4, startTask:Lcom/android/server/am/TaskRecord;
    move-object v2, v4

    .line 6991
    .local v2, jt:Lcom/android/server/am/TaskRecord;
    sub-int v1, p1, v7

    .local v1, j:I
    :goto_0
    if-ltz v1, :cond_1

    .line 6992
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 6993
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    iget-object v5, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v5, v2, :cond_0

    .line 6994
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6995
    iget-object v5, v2, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {p2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_0

    move v5, v1

    .line 7019
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    .end local p0
    :goto_1
    return v5

    .line 6991
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    .restart local p0
    :cond_0
    add-int/lit8 v1, v1, -0x1

    goto :goto_0

    .line 7002
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7003
    .local v0, N:I
    move-object v2, v4

    .line 7004
    add-int/lit8 v1, p1, 0x1

    :goto_2
    if-ge v1, v0, :cond_4

    .line 7005
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7006
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    iget-object v5, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v5, v2, :cond_3

    .line 7007
    iget-object v5, v2, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {p2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_2

    move v5, v1

    .line 7008
    goto :goto_1

    .line 7010
    :cond_2
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7004
    :cond_3
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .line 7015
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    sub-int v6, v0, v7

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p0

    .end local p0
    check-cast p0, Lcom/android/server/am/HistoryRecord;

    iget-object v5, p0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {p2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_5

    .line 7016
    sub-int v5, v0, v7

    goto :goto_1

    .line 7019
    :cond_5
    const/4 v5, -0x1

    goto :goto_1
.end method

.method private findAppProcess(Landroid/os/IBinder;)Lcom/android/server/am/ProcessRecord;
    .locals 9
    .parameter "app"

    .prologue
    const/4 v8, 0x0

    .line 9149
    if-nez p1, :cond_0

    move-object v5, v8

    .line 9165
    :goto_0
    return-object v5

    .line 9153
    :cond_0
    monitor-enter p0

    .line 9154
    :try_start_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v5}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v5

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .local v2, i$:Ljava/util/Iterator;
    :cond_1
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_3

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/util/SparseArray;

    .line 9155
    .local v1, apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    invoke-virtual {v1}, Landroid/util/SparseArray;->size()I

    move-result v0

    .line 9156
    .local v0, NA:I
    const/4 v3, 0x0

    .local v3, ia:I
    :goto_1
    if-ge v3, v0, :cond_1

    .line 9157
    invoke-virtual {v1, v3}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ProcessRecord;

    .line 9158
    .local v4, p:Lcom/android/server/am/ProcessRecord;
    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v5, :cond_2

    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v5}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v5

    if-ne v5, p1, :cond_2

    .line 9159
    monitor-exit p0

    move-object v5, v4

    goto :goto_0

    .line 9156
    :cond_2
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 9164
    .end local v0           #NA:I
    .end local v1           #apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v3           #ia:I
    .end local v4           #p:Lcom/android/server/am/ProcessRecord;
    :cond_3
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Can\'t find mystery application: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9165
    monitor-exit p0

    move-object v5, v8

    goto :goto_0

    .line 9166
    .end local v2           #i$:Ljava/util/Iterator;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5
.end method

.method private findServiceLocked(Landroid/content/Intent;Ljava/lang/String;)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    .locals 12
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    const/4 v11, 0x0

    .line 10809
    const/4 v5, 0x0

    .line 10810
    .local v5, r:Lcom/android/server/am/ServiceRecord;
    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v8

    if-eqz v8, :cond_0

    .line 10811
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 10813
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_0
    if-nez v5, :cond_1

    .line 10814
    new-instance v3, Landroid/content/Intent$FilterComparison;

    invoke-direct {v3, p1}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 10815
    .local v3, filter:Landroid/content/Intent$FilterComparison;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    invoke-virtual {v8, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 10818
    .end local v3           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_1
    if-nez v5, :cond_4

    .line 10820
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v8

    const/4 v9, 0x0

    invoke-interface {v8, p1, p2, v9}, Landroid/content/pm/IPackageManager;->resolveService(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v6

    .line 10823
    .local v6, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v6, :cond_2

    iget-object v8, v6, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object v7, v8

    .line 10825
    .local v7, sInfo:Landroid/content/pm/ServiceInfo;
    :goto_0
    if-nez v7, :cond_3

    move-object v8, v11

    .line 10850
    .end local v6           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v7           #sInfo:Landroid/content/pm/ServiceInfo;
    :goto_1
    return-object v8

    .restart local v6       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_2
    move-object v7, v11

    .line 10823
    goto :goto_0

    .line 10829
    .restart local v7       #sInfo:Landroid/content/pm/ServiceInfo;
    :cond_3
    new-instance v4, Landroid/content/ComponentName;

    iget-object v8, v7, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v9, v7, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v8, v9}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 10831
    .local v4, name:Landroid/content/ComponentName;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v8, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    move-object v0, v8

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v5, v0
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 10836
    .end local v4           #name:Landroid/content/ComponentName;
    .end local v6           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v7           #sInfo:Landroid/content/pm/ServiceInfo;
    :cond_4
    :goto_2
    if-eqz v5, :cond_7

    .line 10837
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v1

    .line 10838
    .local v1, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    .line 10839
    .local v2, callingUid:I
    iget-object v8, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    iget-boolean v9, v5, Lcom/android/server/am/ServiceRecord;->exported:Z

    if-eqz v9, :cond_5

    const/4 v9, -0x1

    :goto_3
    invoke-virtual {p0, v8, v1, v2, v9}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v8

    if-eqz v8, :cond_6

    .line 10842
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Permission Denial: Accessing service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " from pid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ", uid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " requires "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10846
    new-instance v8, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    iget-object v9, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    invoke-direct {v8, p0, v11, v9}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto :goto_1

    .line 10839
    :cond_5
    iget-object v9, v5, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_3

    .line 10848
    :cond_6
    new-instance v8, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    invoke-direct {v8, p0, v5, v11}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto :goto_1

    .end local v1           #callingPid:I
    .end local v2           #callingUid:I
    :cond_7
    move-object v8, v11

    .line 10850
    goto :goto_1

    .line 10832
    :catch_0
    move-exception v8

    goto :goto_2
.end method

.method private final findServiceLocked(Landroid/content/ComponentName;Landroid/os/IBinder;)Lcom/android/server/am/ServiceRecord;
    .locals 2
    .parameter "name"
    .parameter "token"

    .prologue
    .line 10793
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v1, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    .line 10794
    .local v0, r:Lcom/android/server/am/ServiceRecord;
    if-ne v0, p2, :cond_0

    move-object v1, v0

    :goto_0
    return-object v1

    :cond_0
    const/4 v1, 0x0

    goto :goto_0
.end method

.method private findTaskLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;
    .locals 7
    .parameter "intent"
    .parameter "info"

    .prologue
    .line 7574
    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v1

    .line 7575
    .local v1, cls:Landroid/content/ComponentName;
    iget-object v5, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    if-eqz v5, :cond_0

    .line 7576
    new-instance v1, Landroid/content/ComponentName;

    .end local v1           #cls:Landroid/content/ComponentName;
    iget-object v5, p2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v6, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    invoke-direct {v1, v5, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 7579
    .restart local v1       #cls:Landroid/content/ComponentName;
    :cond_0
    const/4 v2, 0x0

    .line 7581
    .local v2, cp:Lcom/android/server/am/TaskRecord;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7582
    .local v0, N:I
    const/4 v5, 0x1

    sub-int v3, v0, v5

    .local v3, i:I
    :goto_0
    if-ltz v3, :cond_4

    .line 7583
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7584
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v5, :cond_3

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v5, v2, :cond_3

    iget v5, v4, Lcom/android/server/am/HistoryRecord;->launchMode:I

    const/4 v6, 0x3

    if-eq v5, v6, :cond_3

    .line 7586
    iget-object v2, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7590
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    if-eqz v5, :cond_1

    .line 7591
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    iget-object v6, p2, Landroid/content/pm/ActivityInfo;->taskAffinity:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_3

    move-object v5, v4

    .line 7611
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return-object v5

    .line 7595
    .restart local v4       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v5, :cond_2

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v5, v1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_2

    move-object v5, v4

    .line 7600
    goto :goto_1

    .line 7601
    :cond_2
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;

    if-eqz v5, :cond_3

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v5, v1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_3

    move-object v5, v4

    .line 7606
    goto :goto_1

    .line 7582
    :cond_3
    add-int/lit8 v3, v3, -0x1

    goto :goto_0

    .line 7611
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    const/4 v5, 0x0

    goto :goto_1
.end method

.method private final finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z
    .locals 8
    .parameter "r"
    .parameter "index"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "reason"

    .prologue
    .line 4128
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v1, :cond_0

    .line 4129
    const-string v1, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Duplicate finish request for "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4130
    const/4 v1, 0x0

    .line 4218
    .end local p2
    :goto_0
    return v1

    .line 4133
    .restart local p2
    :cond_0
    const/4 v1, 0x1

    iput-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    .line 4134
    const/16 v1, 0x7531

    const/4 v2, 0x4

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v3, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x1

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v4, v4, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x2

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v4, v2, v3

    const/4 v3, 0x3

    aput-object p5, v2, v3

    invoke-static {v1, v2}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4137
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    const/4 v3, 0x1

    sub-int/2addr v2, v3

    iput v2, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 4138
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    const/4 v2, 0x1

    sub-int/2addr v1, v2

    if-ge p2, v1, :cond_2

    .line 4139
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    add-int/lit8 v2, p2, 0x1

    invoke-virtual {v1, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 4140
    .local v7, next:Lcom/android/server/am/HistoryRecord;
    iget-object v1, v7, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-ne v1, v2, :cond_2

    .line 4141
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    if-eqz v1, :cond_1

    .line 4143
    const/4 v1, 0x1

    iput-boolean v1, v7, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 4145
    :cond_1
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1}, Landroid/content/Intent;->getFlags()I

    move-result v1

    const/high16 v2, 0x8

    and-int/2addr v1, v2

    if-eqz v1, :cond_2

    .line 4149
    iget-object v1, v7, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    const/high16 v2, 0x8

    invoke-virtual {v1, v2}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 4154
    .end local v7           #next:Lcom/android/server/am/HistoryRecord;
    :cond_2
    invoke-virtual {p1}, Lcom/android/server/am/HistoryRecord;->pauseKeyDispatchingLocked()V

    .line 4155
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v1, p1, :cond_3

    .line 4156
    const/4 v1, 0x0

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4160
    :cond_3
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 4161
    .local v0, resultTo:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_5

    .line 4165
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    if-lez v1, :cond_4

    .line 4166
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-direct {p0, v1, v2, p4, p1}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V

    .line 4169
    :cond_4
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    iget v3, p1, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move-object v1, p1

    move v4, p3

    move-object v5, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/HistoryRecord;->addResultLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 4171
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 4178
    :cond_5
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 4179
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    .line 4180
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 4181
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 4183
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-lez v1, :cond_6

    .line 4187
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4190
    :cond_6
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v1, p1, :cond_b

    .line 4191
    if-lez p2, :cond_7

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    const/4 v2, 0x1

    sub-int v2, p2, v2

    invoke-virtual {v1, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    .end local p2
    check-cast p2, Lcom/android/server/am/HistoryRecord;

    iget-object v1, p2, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v1, v2, :cond_9

    :cond_7
    const/4 v1, 0x1

    move v6, v1

    .line 4195
    .local v6, endTask:Z
    :goto_1
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    if-eqz v6, :cond_a

    const/16 v2, 0x2009

    :goto_2
    invoke-virtual {v1, v2}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 4200
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v2, 0x0

    invoke-virtual {v1, p1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 4202
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-nez v1, :cond_8

    .line 4205
    const/4 v1, 0x0

    const/4 v2, 0x0

    invoke-direct {p0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->startPausingLocked(ZZ)V

    .line 4218
    .end local v6           #endTask:Z
    :cond_8
    const/4 v1, 0x0

    goto/16 :goto_0

    .line 4191
    :cond_9
    const/4 v1, 0x0

    move v6, v1

    goto :goto_1

    .line 4195
    .restart local v6       #endTask:Z
    :cond_a
    const/16 v2, 0x2007

    goto :goto_2

    .line 4208
    .end local v6           #endTask:Z
    .restart local p2
    :cond_b
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v1, v2, :cond_8

    .line 4212
    const/4 v1, 0x1

    invoke-direct {p0, p1, p2, v1}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;II)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    if-nez v1, :cond_c

    const/4 v1, 0x1

    goto/16 :goto_0

    :cond_c
    const/4 v1, 0x0

    goto/16 :goto_0
.end method

.method private final finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;I)Lcom/android/server/am/HistoryRecord;
    .locals 2
    .parameter "r"
    .parameter "mode"

    .prologue
    .line 4227
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 4228
    .local v0, index:I
    if-gez v0, :cond_0

    .line 4229
    const/4 v1, 0x0

    .line 4232
    :goto_0
    return-object v1

    :cond_0
    invoke-direct {p0, p1, v0, p2}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;II)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    goto :goto_0
.end method

.method private final finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;II)Lcom/android/server/am/HistoryRecord;
    .locals 4
    .parameter "r"
    .parameter "index"
    .parameter "mode"

    .prologue
    const/4 v3, 0x0

    .line 4240
    const/4 v2, 0x2

    if-ne p3, v2, :cond_1

    iget-boolean v2, p1, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-eqz v2, :cond_1

    .line 4241
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_0

    .line 4242
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4243
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x3

    if-le v2, v3, :cond_0

    .line 4247
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v0

    .line 4248
    .local v0, msg:Landroid/os/Message;
    const/16 v2, 0xb

    iput v2, v0, Landroid/os/Message;->what:I

    .line 4249
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v2, v0}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 4252
    .end local v0           #msg:Landroid/os/Message;
    :cond_0
    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v2, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4253
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    move-object v2, p1

    .line 4279
    :goto_0
    return-object v2

    .line 4258
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4259
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4260
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v2, p1, :cond_2

    .line 4261
    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4263
    :cond_2
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4264
    .local v1, prevState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->FINISHING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v2, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4266
    if-eqz p3, :cond_3

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v1, v2, :cond_3

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->INITIALIZING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v1, v2, :cond_5

    .line 4271
    :cond_3
    const/4 v2, 0x1

    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    move-result v2

    if-eqz v2, :cond_4

    move-object v2, v3

    goto :goto_0

    :cond_4
    move-object v2, p1

    goto :goto_0

    .line 4276
    :cond_5
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4277
    invoke-direct {p0, v3}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-object v2, p1

    .line 4279
    goto :goto_0
.end method

.method private final finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z
    .locals 7
    .parameter "receiver"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "resultExtras"
    .parameter "resultAbort"
    .parameter "explicit"

    .prologue
    const/4 v6, 0x1

    const/4 v4, 0x0

    const/4 v3, 0x0

    const-string v5, "ActivityManager"

    .line 12759
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    if-nez v2, :cond_1

    .line 12760
    if-eqz p6, :cond_0

    .line 12761
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but no pending broadcasts"

    invoke-static {v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    :cond_0
    move v2, v4

    .line 12805
    :goto_0
    return v2

    .line 12765
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v2, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/BroadcastRecord;

    .line 12766
    .local v0, r:Lcom/android/server/am/BroadcastRecord;
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    if-nez v2, :cond_3

    .line 12767
    if-eqz p6, :cond_2

    .line 12768
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but none active"

    invoke-static {v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    :cond_2
    move v2, v4

    .line 12770
    goto :goto_0

    .line 12772
    :cond_3
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    if-eq v2, p1, :cond_4

    .line 12773
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but active receiver is different"

    invoke-static {v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    move v2, v4

    .line 12774
    goto :goto_0

    .line 12776
    :cond_4
    iget v1, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 12777
    .local v1, state:I
    iput v4, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 12778
    if-nez v1, :cond_5

    .line 12779
    if-eqz p6, :cond_5

    .line 12780
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but state is IDLE"

    invoke-static {v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12783
    :cond_5
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 12784
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2, v3}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 12785
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    if-eqz v2, :cond_6

    .line 12786
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    iput-object v3, v2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 12788
    :cond_6
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    if-eqz v2, :cond_7

    .line 12789
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    iget-object v2, v2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iput-object v3, v2, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 12791
    :cond_7
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 12792
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 12793
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    .line 12794
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;

    .line 12795
    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 12797
    iput p2, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    .line 12798
    iput-object p3, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    .line 12799
    iput-object p4, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    .line 12800
    iput-boolean p5, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    .line 12805
    if-eq v1, v6, :cond_8

    const/4 v2, 0x3

    if-ne v1, v2, :cond_9

    :cond_8
    move v2, v6

    goto :goto_0

    :cond_9
    move v2, v4

    goto :goto_0
.end method

.method private final finishTaskMoveLocked(I)V
    .locals 1
    .parameter "task"

    .prologue
    .line 7406
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 7407
    return-void
.end method

.method private forceStopPackageLocked(Ljava/lang/String;I)V
    .locals 17
    .parameter "packageName"
    .parameter "uid"

    .prologue
    .line 5252
    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x1

    move-object/from16 v3, p0

    move-object/from16 v4, p1

    move/from16 v5, p2

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 5253
    new-instance v6, Landroid/content/Intent;

    const-string v3, "android.intent.action.PACKAGE_RESTARTED"

    const-string v4, "package"

    const/4 v5, 0x0

    move-object v0, v4

    move-object/from16 v1, p1

    move-object v2, v5

    invoke-static {v0, v1, v2}, Landroid/net/Uri;->fromParts(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v4

    invoke-direct {v6, v3, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    .line 5255
    .local v6, intent:Landroid/content/Intent;
    const-string v3, "android.intent.extra.UID"

    move-object v0, v6

    move-object v1, v3

    move/from16 v2, p2

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 5256
    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    sget v15, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v16, 0x3e8

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v16}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 5259
    return-void
.end method

.method private final forceStopPackageLocked(Ljava/lang/String;IZZZ)Z
    .locals 17
    .parameter "name"
    .parameter "uid"
    .parameter "callerWillRestart"
    .parameter "purgeCache"
    .parameter "doit"

    .prologue
    .line 5302
    if-gez p2, :cond_0

    .line 5304
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result p2

    .line 5309
    :cond_0
    :goto_0
    if-eqz p5, :cond_2

    .line 5310
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Force stopping package "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " uid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 5312
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v12

    .line 5313
    .local v12, badApps:Ljava/util/Iterator;,"Ljava/util/Iterator<Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    :cond_1
    :goto_1
    invoke-interface {v12}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_2

    .line 5314
    invoke-interface {v12}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/util/SparseArray;

    .line 5315
    .local v11, ba:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    move-object v0, v11

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    if-eqz v3, :cond_1

    .line 5316
    invoke-interface {v12}, Ljava/util/Iterator;->remove()V

    goto :goto_1

    .line 5321
    .end local v11           #ba:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    .end local v12           #badApps:Ljava/util/Iterator;,"Ljava/util/Iterator<Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    :cond_2
    const/16 v6, -0x64

    move-object/from16 v3, p0

    move-object/from16 v4, p1

    move/from16 v5, p2

    move/from16 v7, p3

    move/from16 v8, p5

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->killPackageProcessesLocked(Ljava/lang/String;IIZZ)Z

    move-result v13

    .line 5324
    .local v13, didSomething:Z
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v5, v3, v4

    .local v5, i:I
    :goto_2
    if-ltz v5, :cond_6

    .line 5325
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 5326
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_5

    .line 5327
    if-nez p5, :cond_3

    .line 5328
    const/4 v3, 0x1

    .line 5371
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    .end local p2
    :goto_3
    return v3

    .line 5330
    .restart local v4       #r:Lcom/android/server/am/HistoryRecord;
    .restart local p2
    :cond_3
    const/4 v13, 0x1

    .line 5331
    const-string v3, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "  Force finishing activity "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v3, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 5332
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4

    .line 5333
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v6, 0x1

    iput-boolean v6, v3, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 5335
    :cond_4
    const/4 v3, 0x0

    iput-object v3, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 5336
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "uninstall"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 5324
    :cond_5
    add-int/lit8 v5, v5, -0x1

    goto :goto_2

    .line 5340
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_6
    new-instance v16, Ljava/util/ArrayList;

    invoke-direct/range {v16 .. v16}, Ljava/util/ArrayList;-><init>()V

    .line 5341
    .local v16, services:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ServiceRecord;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v14

    .local v14, i$:Ljava/util/Iterator;
    :cond_7
    :goto_4
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_a

    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Lcom/android/server/am/ServiceRecord;

    .line 5342
    .local v15, service:Lcom/android/server/am/ServiceRecord;
    iget-object v3, v15, Lcom/android/server/am/ServiceRecord;->packageName:Ljava/lang/String;

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_7

    .line 5343
    if-nez p5, :cond_8

    .line 5344
    const/4 v3, 0x1

    goto :goto_3

    .line 5346
    :cond_8
    const/4 v13, 0x1

    .line 5347
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  Force stopping service "

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 5348
    iget-object v3, v15, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_9

    .line 5349
    iget-object v3, v15, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v4, 0x1

    iput-boolean v4, v3, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 5351
    :cond_9
    const/4 v3, 0x0

    iput-object v3, v15, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 5352
    move-object/from16 v0, v16

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_4

    .line 5356
    .end local v15           #service:Lcom/android/server/am/ServiceRecord;
    :cond_a
    invoke-virtual/range {v16 .. v16}, Ljava/util/ArrayList;->size()I

    move-result v9

    .line 5357
    .local v9, N:I
    const/4 v5, 0x0

    .end local p2
    :goto_5
    if-ge v5, v9, :cond_b

    .line 5358
    move-object/from16 v0, v16

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/ServiceRecord;

    const/4 v3, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, p2

    move v2, v3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 5357
    add-int/lit8 v5, v5, 0x1

    goto :goto_5

    .line 5361
    :cond_b
    if-eqz p5, :cond_d

    .line 5362
    if-eqz p4, :cond_c

    .line 5363
    invoke-static {}, Lcom/android/server/AttributeCache;->instance()Lcom/android/server/AttributeCache;

    move-result-object v10

    .line 5364
    .local v10, ac:Lcom/android/server/AttributeCache;
    if-eqz v10, :cond_c

    .line 5365
    move-object v0, v10

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Lcom/android/server/AttributeCache;->removePackage(Ljava/lang/String;)V

    .line 5368
    .end local v10           #ac:Lcom/android/server/AttributeCache;
    :cond_c
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    :cond_d
    move v3, v13

    .line 5371
    goto/16 :goto_3

    .line 5305
    .end local v5           #i:I
    .end local v9           #N:I
    .end local v13           #didSomething:Z
    .end local v14           #i$:Ljava/util/Iterator;
    .end local v16           #services:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ServiceRecord;>;"
    .restart local p2
    :catch_0
    move-exception v3

    goto/16 :goto_0
.end method

.method private final generateApplicationProvidersLocked(Lcom/android/server/am/ProcessRecord;)Ljava/util/List;
    .locals 9
    .parameter "app"

    .prologue
    .line 7748
    const/4 v4, 0x0

    .line 7750
    .local v4, providers:Ljava/util/List;
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    const/16 v8, 0xc00

    invoke-interface {v5, v6, v7, v8}, Landroid/content/pm/IPackageManager;->queryContentProviders(Ljava/lang/String;II)Ljava/util/List;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v4

    .line 7755
    :goto_0
    if-eqz v4, :cond_1

    .line 7756
    invoke-interface {v4}, Ljava/util/List;->size()I

    move-result v0

    .line 7757
    .local v0, N:I
    const/4 v3, 0x0

    .local v3, i:I
    :goto_1
    if-ge v3, v0, :cond_1

    .line 7758
    invoke-interface {v4, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/ProviderInfo;

    .line 7760
    .local v1, cpi:Landroid/content/pm/ProviderInfo;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v6, v1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 7762
    .local v2, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v2, :cond_0

    .line 7763
    new-instance v2, Lcom/android/server/am/ContentProviderRecord;

    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    invoke-direct {v2, v1, v5}, Lcom/android/server/am/ContentProviderRecord;-><init>(Landroid/content/pm/ProviderInfo;Landroid/content/pm/ApplicationInfo;)V

    .line 7764
    .restart local v2       #cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v6, v1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7766
    :cond_0
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    iget-object v6, v1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7767
    iget-object v5, v1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {p1, v5}, Lcom/android/server/am/ProcessRecord;->addPackage(Ljava/lang/String;)Z

    .line 7768
    iget-object v5, v1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 7757
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 7771
    .end local v0           #N:I
    .end local v1           #cpi:Landroid/content/pm/ProviderInfo;
    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v3           #i:I
    :cond_1
    return-object v4

    .line 7753
    :catch_0
    move-exception v5

    goto :goto_0
.end method

.method private generateProcessError(Lcom/android/server/am/ProcessRecord;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/app/ActivityManager$ProcessErrorStateInfo;
    .locals 2
    .parameter "app"
    .parameter "condition"
    .parameter "activity"
    .parameter "shortMsg"
    .parameter "longMsg"
    .parameter "stackTrace"

    .prologue
    .line 8947
    new-instance v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;

    invoke-direct {v0}, Landroid/app/ActivityManager$ProcessErrorStateInfo;-><init>()V

    .line 8949
    .local v0, report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    iput p2, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->condition:I

    .line 8950
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iput-object v1, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->processName:Ljava/lang/String;

    .line 8951
    iget v1, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iput v1, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->pid:I

    .line 8952
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v1, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->uid:I

    .line 8953
    iput-object p3, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->tag:Ljava/lang/String;

    .line 8954
    iput-object p4, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->shortMsg:Ljava/lang/String;

    .line 8955
    iput-object p5, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->longMsg:Ljava/lang/String;

    .line 8956
    iput-object p6, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->stackTrace:Ljava/lang/String;

    .line 8958
    return-object v0
.end method

.method private getCallingRecordLocked(Landroid/os/IBinder;)Lcom/android/server/am/HistoryRecord;
    .locals 3
    .parameter "token"

    .prologue
    .line 6045
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 6046
    .local v0, index:I
    if-ltz v0, :cond_0

    .line 6047
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 6048
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v1, :cond_0

    .line 6049
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 6052
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_0
    return-object v2

    :cond_0
    const/4 v2, 0x0

    goto :goto_0
.end method

.method private getCommonServicesLocked()Ljava/util/HashMap;
    .locals 5
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Landroid/os/IBinder;",
            ">;"
        }
    .end annotation

    .prologue
    const-string v4, "window"

    const-string v3, "package"

    const-string v2, "alarm"

    .line 1582
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    if-nez v0, :cond_0

    .line 1583
    new-instance v0, Ljava/util/HashMap;

    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V

    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    .line 1586
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    const-string v1, "package"

    const-string v1, "package"

    invoke-static {v3}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v3, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 1587
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    const-string v1, "window"

    const-string v1, "window"

    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v4, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 1588
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    const-string v1, "alarm"

    const-string v1, "alarm"

    invoke-static {v2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v2, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 1591
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    return-object v0
.end method

.method private getContentProviderExternal(Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;
    .locals 1
    .parameter "name"

    .prologue
    .line 8042
    const/4 v0, 0x0

    invoke-direct {p0, v0, p1}, Lcom/android/server/am/ActivityManagerService;->getContentProviderImpl(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;

    move-result-object v0

    return-object v0
.end method

.method private final getContentProviderImpl(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;
    .locals 24
    .parameter "caller"
    .parameter "name"

    .prologue
    .line 7821
    const/4 v15, 0x0

    .line 7823
    .local v15, cpi:Landroid/content/pm/ProviderInfo;
    monitor-enter p0

    .line 7824
    const/16 v23, 0x0

    .line 7825
    .local v23, r:Lcom/android/server/am/ProcessRecord;
    if-eqz p1, :cond_0

    .line 7826
    :try_start_0
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v23

    .line 7827
    if-nez v23, :cond_0

    .line 7828
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to find app for caller "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ") when getting content provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 8005
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 7836
    :cond_0
    :try_start_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Lcom/android/server/am/ContentProviderRecord;

    .line 7837
    .local v16, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v16, :cond_9

    .line 7838
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    move-object v15, v0

    .line 7839
    const/4 v4, -0x1

    move-object/from16 v0, p0

    move-object v1, v15

    move-object/from16 v2, v23

    move v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkContentProviderPermissionLocked(Landroid/content/pm/ProviderInfo;Lcom/android/server/am/ProcessRecord;I)Ljava/lang/String;

    move-result-object v4

    if-eqz v4, :cond_2

    .line 7840
    new-instance v4, Landroid/app/IActivityManager$ContentProviderHolder;

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    if-eqz v5, :cond_1

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    :goto_0
    invoke-direct {v4, v15, v5}, Landroid/app/IActivityManager$ContentProviderHolder;-><init>(Landroid/content/pm/ProviderInfo;Ljava/lang/String;)V

    monitor-exit p0

    .line 8026
    :goto_1
    return-object v4

    .line 7840
    :cond_1
    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    goto :goto_0

    .line 7845
    :cond_2
    if-eqz v23, :cond_4

    move-object/from16 v0, v16

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Lcom/android/server/am/ContentProviderRecord;->canRunHere(Lcom/android/server/am/ProcessRecord;)Z

    move-result v4

    if-eqz v4, :cond_4

    .line 7850
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    move-object v4, v0

    if-eqz v4, :cond_3

    .line 7853
    new-instance v17, Lcom/android/server/am/ContentProviderRecord;

    move-object/from16 v0, v17

    move-object/from16 v1, v16

    invoke-direct {v0, v1}, Lcom/android/server/am/ContentProviderRecord;-><init>(Lcom/android/server/am/ContentProviderRecord;)V

    .end local v16           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .local v17, cpr:Lcom/android/server/am/ContentProviderRecord;
    move-object/from16 v16, v17

    .line 7855
    .end local v17           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v16       #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_3
    monitor-exit p0

    move-object/from16 v4, v16

    goto :goto_1

    .line 7858
    :cond_4
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v20

    .line 7862
    .local v20, origId:J
    if-eqz v23, :cond_8

    .line 7867
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Ljava/lang/Integer;

    .line 7868
    .local v14, cnt:Ljava/lang/Integer;
    if-nez v14, :cond_7

    .line 7869
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    new-instance v5, Ljava/lang/Integer;

    const/4 v6, 0x1

    invoke-direct {v5, v6}, Ljava/lang/Integer;-><init>(I)V

    move-object v0, v4

    move-object/from16 v1, v16

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7873
    :goto_2
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 7874
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-eqz v4, :cond_5

    move-object/from16 v0, v23

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->setAdj:I

    move v4, v0

    sget v5, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-lt v4, v5, :cond_5

    .line 7879
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    const/4 v5, 0x0

    const/4 v6, 0x1

    move-object/from16 v0, p0

    move-object v1, v4

    move v2, v5

    move v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 7885
    .end local v14           #cnt:Ljava/lang/Integer;
    :cond_5
    :goto_3
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-eqz v4, :cond_6

    .line 7886
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    move-object/from16 v0, p0

    move-object v1, v4

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 7889
    :cond_6
    invoke-static/range {v20 .. v21}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8005
    .end local v20           #origId:J
    :goto_4
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8008
    monitor-enter v16

    .line 8009
    :goto_5
    :try_start_2
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    move-object v4, v0

    if-nez v4, :cond_1a

    .line 8010
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-nez v4, :cond_19

    .line 8011
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to launch app "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "/"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " for provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ": launching app became null"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8015
    const/16 v4, 0x7554

    const/4 v5, 0x3

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    iget-object v7, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    aput-object v7, v5, v6

    const/4 v6, 0x1

    iget-object v7, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x2

    aput-object p2, v5, v6

    invoke-static {v4, v5}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 8018
    const/4 v4, 0x0

    monitor-exit v16

    goto/16 :goto_1

    .line 8025
    :catchall_1
    move-exception v4

    monitor-exit v16
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    throw v4

    .line 7871
    .restart local v14       #cnt:Ljava/lang/Integer;
    .restart local v20       #origId:J
    :cond_7
    :try_start_3
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    new-instance v5, Ljava/lang/Integer;

    invoke-virtual {v14}, Ljava/lang/Integer;->intValue()I

    move-result v6

    add-int/lit8 v6, v6, 0x1

    invoke-direct {v5, v6}, Ljava/lang/Integer;-><init>(I)V

    move-object v0, v4

    move-object/from16 v1, v16

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    goto/16 :goto_2

    .line 7882
    .end local v14           #cnt:Ljava/lang/Integer;
    :cond_8
    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/am/ContentProviderRecord;->externals:I

    move v4, v0

    add-int/lit8 v4, v4, 0x1

    move v0, v4

    move-object/from16 v1, v16

    iput v0, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto/16 :goto_3

    .line 7893
    .end local v20           #origId:J
    :cond_9
    :try_start_4
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    const/16 v5, 0xc00

    move-object v0, v4

    move-object/from16 v1, p2

    move v2, v5

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_2

    move-result-object v15

    .line 7898
    :goto_6
    if-nez v15, :cond_a

    .line 7899
    const/4 v4, 0x0

    :try_start_5
    monitor-exit p0

    goto/16 :goto_1

    .line 7902
    :cond_a
    const/4 v4, -0x1

    move-object/from16 v0, p0

    move-object v1, v15

    move-object/from16 v2, v23

    move v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkContentProviderPermissionLocked(Landroid/content/pm/ProviderInfo;Lcom/android/server/am/ProcessRecord;I)Ljava/lang/String;

    move-result-object v4

    if-eqz v4, :cond_c

    .line 7903
    new-instance v4, Landroid/app/IActivityManager$ContentProviderHolder;

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    if-eqz v5, :cond_b

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    :goto_7
    invoke-direct {v4, v15, v5}, Landroid/app/IActivityManager$ContentProviderHolder;-><init>(Landroid/content/pm/ProviderInfo;Ljava/lang/String;)V

    monitor-exit p0

    goto/16 :goto_1

    :cond_b
    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    goto :goto_7

    .line 7908
    :cond_c
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v4, v0

    if-nez v4, :cond_d

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDidUpdate:Z

    move v4, v0

    if-nez v4, :cond_d

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingUpdate:Z

    move v4, v0

    if-nez v4, :cond_d

    iget-object v4, v15, Landroid/content/pm/ProviderInfo;->processName:Ljava/lang/String;

    const-string v5, "system"

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_d

    .line 7913
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "Attempt to launch content provider before system ready"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 7917
    :cond_d
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    move-object v4, v0

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v16

    .end local v16           #cpr:Lcom/android/server/am/ContentProviderRecord;
    check-cast v16, Lcom/android/server/am/ContentProviderRecord;
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 7918
    .restart local v16       #cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v16, :cond_e

    const/4 v4, 0x1

    move/from16 v18, v4

    .line 7919
    .local v18, firstClass:Z
    :goto_8
    if-eqz v18, :cond_10

    .line 7921
    :try_start_6
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    const/16 v6, 0x400

    invoke-interface {v4, v5, v6}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v13

    .line 7926
    .local v13, ai:Landroid/content/pm/ApplicationInfo;
    if-nez v13, :cond_f

    .line 7927
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "No package info for content provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v15, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_6 .. :try_end_6} :catch_1

    .line 7929
    const/4 v4, 0x0

    :try_start_7
    monitor-exit p0
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_0

    goto/16 :goto_1

    .line 7918
    .end local v13           #ai:Landroid/content/pm/ApplicationInfo;
    .end local v18           #firstClass:Z
    :cond_e
    const/4 v4, 0x0

    move/from16 v18, v4

    goto :goto_8

    .line 7931
    .restart local v13       #ai:Landroid/content/pm/ApplicationInfo;
    .restart local v18       #firstClass:Z
    :cond_f
    :try_start_8
    new-instance v17, Lcom/android/server/am/ContentProviderRecord;

    move-object/from16 v0, v17

    move-object v1, v15

    move-object v2, v13

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ContentProviderRecord;-><init>(Landroid/content/pm/ProviderInfo;Landroid/content/pm/ApplicationInfo;)V
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_8 .. :try_end_8} :catch_1

    .end local v16           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v17       #cpr:Lcom/android/server/am/ContentProviderRecord;
    move-object/from16 v16, v17

    .line 7937
    .end local v13           #ai:Landroid/content/pm/ApplicationInfo;
    .end local v17           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v16       #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_10
    :goto_9
    if-eqz v23, :cond_11

    :try_start_9
    move-object/from16 v0, v16

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Lcom/android/server/am/ContentProviderRecord;->canRunHere(Lcom/android/server/am/ProcessRecord;)Z

    move-result v4

    if-eqz v4, :cond_11

    .line 7942
    monitor-exit p0

    move-object/from16 v4, v16

    goto/16 :goto_1

    .line 7954
    :cond_11
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v12

    .line 7956
    .local v12, N:I
    const/16 v19, 0x0

    .local v19, i:I
    :goto_a
    move/from16 v0, v19

    move v1, v12

    if-ge v0, v1, :cond_12

    .line 7957
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, v16

    if-ne v0, v1, :cond_13

    .line 7964
    :cond_12
    move/from16 v0, v19

    move v1, v12

    if-lt v0, v1, :cond_15

    .line 7965
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v20

    .line 7966
    .restart local v20       #origId:J
    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->processName:Ljava/lang/String;

    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const-string v9, "content provider"

    new-instance v10, Landroid/content/ComponentName;

    iget-object v4, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v4, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v11, v15, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-direct {v10, v4, v11}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    const/4 v11, 0x0

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v11}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;

    move-result-object v22

    .line 7970
    .local v22, proc:Lcom/android/server/am/ProcessRecord;
    if-nez v22, :cond_14

    .line 7971
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to launch app "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "/"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v15, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " for provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ": process is bad"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 7975
    const/4 v4, 0x0

    monitor-exit p0

    goto/16 :goto_1

    .line 7956
    .end local v20           #origId:J
    .end local v22           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_13
    add-int/lit8 v19, v19, 0x1

    goto/16 :goto_a

    .line 7977
    .restart local v20       #origId:J
    .restart local v22       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_14
    move-object/from16 v0, v22

    move-object/from16 v1, v16

    iput-object v0, v1, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    .line 7978
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7979
    invoke-static/range {v20 .. v21}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7984
    .end local v20           #origId:J
    .end local v22           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_15
    if-eqz v18, :cond_16

    .line 7985
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    move-object v4, v0

    iget-object v5, v15, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object v0, v4

    move-object v1, v5

    move-object/from16 v2, v16

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7987
    :cond_16
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p2

    move-object/from16 v2, v16

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7989
    if-eqz v23, :cond_18

    .line 7994
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Ljava/lang/Integer;

    .line 7995
    .restart local v14       #cnt:Ljava/lang/Integer;
    if-nez v14, :cond_17

    .line 7996
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    new-instance v5, Ljava/lang/Integer;

    const/4 v6, 0x1

    invoke-direct {v5, v6}, Ljava/lang/Integer;-><init>(I)V

    move-object v0, v4

    move-object/from16 v1, v16

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8000
    :goto_b
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    goto/16 :goto_4

    .line 7998
    :cond_17
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    move-object v4, v0

    new-instance v5, Ljava/lang/Integer;

    invoke-virtual {v14}, Ljava/lang/Integer;->intValue()I

    move-result v6

    add-int/lit8 v6, v6, 0x1

    invoke-direct {v5, v6}, Ljava/lang/Integer;-><init>(I)V

    move-object v0, v4

    move-object/from16 v1, v16

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    goto :goto_b

    .line 8002
    .end local v14           #cnt:Ljava/lang/Integer;
    :cond_18
    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/am/ContentProviderRecord;->externals:I

    move v4, v0

    add-int/lit8 v4, v4, 0x1

    move v0, v4

    move-object/from16 v1, v16

    iput v0, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_0

    goto/16 :goto_4

    .line 8021
    .end local v12           #N:I
    .end local v18           #firstClass:Z
    .end local v19           #i:I
    :cond_19
    :try_start_a
    invoke-virtual/range {v16 .. v16}, Ljava/lang/Object;->wait()V
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_1
    .catch Ljava/lang/InterruptedException; {:try_start_a .. :try_end_a} :catch_0

    goto/16 :goto_5

    .line 8022
    :catch_0
    move-exception v4

    goto/16 :goto_5

    .line 8025
    :cond_1a
    :try_start_b
    monitor-exit v16
    :try_end_b
    .catchall {:try_start_b .. :try_end_b} :catchall_1

    move-object/from16 v4, v16

    .line 8026
    goto/16 :goto_1

    .line 7932
    .restart local v18       #firstClass:Z
    :catch_1
    move-exception v4

    goto/16 :goto_9

    .line 7896
    .end local v18           #firstClass:Z
    :catch_2
    move-exception v4

    goto/16 :goto_6
.end method

.method private final getLRURecordIndexForAppLocked(Landroid/app/IApplicationThread;)I
    .locals 5
    .parameter "thread"

    .prologue
    .line 4694
    invoke-interface {p1}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v2

    .line 4697
    .local v2, threadBinder:Landroid/os/IBinder;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v0, v3, v4

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 4698
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v3, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 4699
    .local v1, rec:Lcom/android/server/am/ProcessRecord;
    iget-object v3, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_0

    iget-object v3, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v3}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v3

    if-ne v3, v2, :cond_0

    move v3, v0

    .line 4703
    .end local v1           #rec:Lcom/android/server/am/ProcessRecord;
    :goto_1
    return v3

    .line 4697
    .restart local v1       #rec:Lcom/android/server/am/ProcessRecord;
    :cond_0
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 4703
    .end local v1           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_1
    const/4 v3, -0x1

    goto :goto_1
.end method

.method private final getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;
    .locals 3
    .parameter "processName"
    .parameter "uid"

    .prologue
    .line 1739
    const/16 v2, 0x3e8

    if-ne p2, v2, :cond_1

    .line 1743
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v2}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v2

    invoke-virtual {v2, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/util/SparseArray;

    .line 1745
    .local v1, procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    if-eqz v1, :cond_0

    const/4 v2, 0x0

    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object p0

    .end local p0
    check-cast p0, Lcom/android/server/am/ProcessRecord;

    move-object v2, p0

    .line 1748
    .end local v1           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    :goto_0
    return-object v2

    .line 1745
    .restart local v1       #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .restart local p0
    :cond_0
    const/4 v2, 0x0

    goto :goto_0

    .line 1747
    .end local v1           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v2, p1, p2}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .local v0, proc:Lcom/android/server/am/ProcessRecord;
    move-object v2, v0

    .line 1748
    goto :goto_0
.end method

.method private final getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;
    .locals 2
    .parameter "thread"

    .prologue
    const/4 v1, 0x0

    .line 4708
    if-nez p1, :cond_1

    .line 4713
    .end local p0
    :cond_0
    :goto_0
    return-object v1

    .line 4712
    .restart local p0
    :cond_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getLRURecordIndexForAppLocked(Landroid/app/IApplicationThread;)I

    move-result v0

    .line 4713
    .local v0, appIndex:I
    if-ltz v0, :cond_0

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p0

    .end local p0
    check-cast p0, Lcom/android/server/am/ProcessRecord;

    move-object v1, p0

    goto :goto_0
.end method

.method private final getStickiesLocked(Ljava/lang/String;Landroid/content/IntentFilter;Ljava/util/List;)Ljava/util/List;
    .locals 8
    .parameter "action"
    .parameter "filter"
    .parameter "cur"

    .prologue
    .line 12177
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v6}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v5

    .line 12178
    .local v5, resolver:Landroid/content/ContentResolver;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    invoke-virtual {v6, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/util/ArrayList;

    .line 12179
    .local v4, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    if-nez v4, :cond_0

    move-object v1, p3

    .line 12192
    .end local p3
    .local v1, cur:Ljava/util/List;
    :goto_0
    return-object v1

    .line 12182
    .end local v1           #cur:Ljava/util/List;
    .restart local p3
    :cond_0
    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 12183
    .local v0, N:I
    const/4 v2, 0x0

    .local v2, i:I
    :goto_1
    if-ge v2, v0, :cond_3

    .line 12184
    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/Intent;

    .line 12185
    .local v3, intent:Landroid/content/Intent;
    const/4 v6, 0x1

    const-string v7, "ActivityManager"

    invoke-virtual {p2, v5, v3, v6, v7}, Landroid/content/IntentFilter;->match(Landroid/content/ContentResolver;Landroid/content/Intent;ZLjava/lang/String;)I

    move-result v6

    if-ltz v6, :cond_2

    .line 12186
    if-nez p3, :cond_1

    .line 12187
    new-instance p3, Ljava/util/ArrayList;

    .end local p3
    invoke-direct {p3}, Ljava/util/ArrayList;-><init>()V

    .line 12189
    .restart local p3
    :cond_1
    invoke-interface {p3, v3}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 12183
    :cond_2
    add-int/lit8 v2, v2, 0x1

    goto :goto_1

    .end local v3           #intent:Landroid/content/Intent;
    :cond_3
    move-object v1, p3

    .line 12192
    .end local p3
    .restart local v1       #cur:Ljava/util/List;
    goto :goto_0
.end method

.method private grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V
    .locals 6
    .parameter "callingUid"
    .parameter "targetPkg"
    .parameter "intent"
    .parameter "activity"

    .prologue
    .line 6568
    if-nez p3, :cond_1

    .line 6577
    :cond_0
    :goto_0
    return-void

    .line 6571
    :cond_1
    invoke-virtual {p3}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v3

    .line 6572
    .local v3, data:Landroid/net/Uri;
    if-eqz v3, :cond_0

    .line 6575
    invoke-virtual {p3}, Landroid/content/Intent;->getFlags()I

    move-result v4

    move-object v0, p0

    move v1, p1

    move-object v2, p2

    move-object v5, p4

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V

    goto :goto_0
.end method

.method private grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V
    .locals 19
    .parameter "callingUid"
    .parameter "targetPkg"
    .parameter "uri"
    .parameter "modeFlags"
    .parameter "activity"

    .prologue
    .line 6438
    and-int/lit8 p4, p4, 0x3

    .line 6440
    if-nez p4, :cond_1

    .line 6564
    :cond_0
    :goto_0
    return-void

    .line 6447
    :cond_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v13

    .line 6450
    .local v13, pm:Landroid/content/pm/IPackageManager;
    const-string v16, "content"

    invoke-virtual/range {p3 .. p3}, Landroid/net/Uri;->getScheme()Ljava/lang/String;

    move-result-object v17

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v16

    if-eqz v16, :cond_0

    .line 6456
    invoke-virtual/range {p3 .. p3}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v10

    .line 6457
    .local v10, name:Ljava/lang/String;
    const/4 v12, 0x0

    .line 6458
    .local v12, pi:Landroid/content/pm/ProviderInfo;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v10

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ContentProviderRecord;

    .line 6460
    .local v7, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v7, :cond_2

    .line 6461
    iget-object v12, v7, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    .line 6469
    :goto_1
    if-nez v12, :cond_3

    .line 6470
    const-string v16, "ActivityManager"

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "No content provider found for: "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object v1, v10

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-static/range {v16 .. v17}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_0

    .line 6464
    :cond_2
    const/16 v16, 0x800

    :try_start_0
    move-object v0, v13

    move-object v1, v10

    move/from16 v2, v16

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1

    move-result-object v12

    goto :goto_1

    .line 6476
    :cond_3
    :try_start_1
    move-object v0, v13

    move-object/from16 v1, p2

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    move-result v14

    .line 6477
    .local v14, targetUid:I
    if-ltz v14, :cond_0

    .line 6487
    move-object/from16 v0, p0

    move-object v1, v13

    move-object v2, v12

    move v3, v14

    move/from16 v4, p4

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z

    move-result v16

    if-nez v16, :cond_0

    .line 6495
    move-object v0, v12

    iget-boolean v0, v0, Landroid/content/pm/ProviderInfo;->grantUriPermissions:Z

    move/from16 v16, v0

    if-nez v16, :cond_4

    .line 6496
    new-instance v16, Ljava/lang/SecurityException;

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Provider "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, "/"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " does not allow granting of Uri permissions (uri "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, ")"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-direct/range {v16 .. v17}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 6482
    .end local v14           #targetUid:I
    :catch_0
    move-exception v8

    .line 6483
    .local v8, ex:Landroid/os/RemoteException;
    goto/16 :goto_0

    .line 6501
    .end local v8           #ex:Landroid/os/RemoteException;
    .restart local v14       #targetUid:I
    :cond_4
    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    if-eqz v16, :cond_7

    .line 6502
    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    array-length v0, v0

    move v5, v0

    .line 6503
    .local v5, N:I
    const/4 v6, 0x0

    .line 6504
    .local v6, allowed:Z
    const/4 v9, 0x0

    .local v9, i:I
    :goto_2
    if-ge v9, v5, :cond_5

    .line 6505
    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    aget-object v16, v16, v9

    if-eqz v16, :cond_6

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    aget-object v16, v16, v9

    invoke-virtual/range {p3 .. p3}, Landroid/net/Uri;->getPath()Ljava/lang/String;

    move-result-object v17

    invoke-virtual/range {v16 .. v17}, Landroid/os/PatternMatcher;->match(Ljava/lang/String;)Z

    move-result v16

    if-eqz v16, :cond_6

    .line 6507
    const/4 v6, 0x1

    .line 6511
    :cond_5
    if-nez v6, :cond_7

    .line 6512
    new-instance v16, Ljava/lang/SecurityException;

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Provider "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, "/"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " does not allow granting of permission to path of Uri "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-direct/range {v16 .. v17}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 6504
    :cond_6
    add-int/lit8 v9, v9, 0x1

    goto :goto_2

    .line 6521
    .end local v5           #N:I
    .end local v6           #allowed:Z
    .end local v9           #i:I
    :cond_7
    move-object/from16 v0, p0

    move-object v1, v13

    move-object v2, v12

    move/from16 v3, p1

    move/from16 v4, p4

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z

    move-result v16

    if-nez v16, :cond_8

    .line 6522
    move-object/from16 v0, p0

    move-object/from16 v1, p3

    move/from16 v2, p1

    move/from16 v3, p4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkUriPermissionLocked(Landroid/net/Uri;II)Z

    move-result v16

    if-nez v16, :cond_8

    .line 6523
    new-instance v16, Ljava/lang/SecurityException;

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Uid "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " does not have permission to uri "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-direct/range {v16 .. v17}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 6535
    :cond_8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move v1, v14

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Ljava/util/HashMap;

    .line 6537
    .local v15, targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    if-nez v15, :cond_9

    .line 6538
    new-instance v15, Ljava/util/HashMap;

    .end local v15           #targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    invoke-direct {v15}, Ljava/util/HashMap;-><init>()V

    .line 6539
    .restart local v15       #targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move v1, v14

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 6542
    :cond_9
    move-object v0, v15

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/am/UriPermission;

    .line 6543
    .local v11, perm:Lcom/android/server/am/UriPermission;
    if-nez v11, :cond_a

    .line 6544
    new-instance v11, Lcom/android/server/am/UriPermission;

    .end local v11           #perm:Lcom/android/server/am/UriPermission;
    move-object v0, v11

    move v1, v14

    move-object/from16 v2, p3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/UriPermission;-><init>(ILandroid/net/Uri;)V

    .line 6545
    .restart local v11       #perm:Lcom/android/server/am/UriPermission;
    move-object v0, v15

    move-object/from16 v1, p3

    move-object v2, v11

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 6548
    :cond_a
    move-object v0, v11

    iget v0, v0, Lcom/android/server/am/UriPermission;->modeFlags:I

    move/from16 v16, v0

    or-int v16, v16, p4

    move/from16 v0, v16

    move-object v1, v11

    iput v0, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    .line 6549
    if-nez p5, :cond_b

    .line 6550
    move-object v0, v11

    iget v0, v0, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    move/from16 v16, v0

    or-int v16, v16, p4

    move/from16 v0, v16

    move-object v1, v11

    iput v0, v1, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    goto/16 :goto_0

    .line 6551
    :cond_b
    and-int/lit8 v16, p4, 0x1

    if-eqz v16, :cond_d

    .line 6552
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/UriPermission;->readActivities:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6553
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    if-nez v16, :cond_c

    .line 6554
    new-instance v16, Ljava/util/HashSet;

    invoke-direct/range {v16 .. v16}, Ljava/util/HashSet;-><init>()V

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    .line 6556
    :cond_c
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v11

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    goto/16 :goto_0

    .line 6557
    :cond_d
    and-int/lit8 v16, p4, 0x2

    if-eqz v16, :cond_0

    .line 6558
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/UriPermission;->writeActivities:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6559
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    if-nez v16, :cond_e

    .line 6560
    new-instance v16, Ljava/util/HashSet;

    invoke-direct/range {v16 .. v16}, Ljava/util/HashSet;-><init>()V

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    .line 6562
    :cond_e
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v11

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    goto/16 :goto_0

    .line 6466
    .end local v11           #perm:Lcom/android/server/am/UriPermission;
    .end local v14           #targetUid:I
    .end local v15           #targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    :catch_1
    move-exception v16

    goto/16 :goto_1
.end method

.method private handleAppCrashLocked(Lcom/android/server/am/ProcessRecord;)Z
    .locals 14
    .parameter "app"

    .prologue
    .line 8985
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v11

    .line 8987
    .local v11, now:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v0, v1, v2}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/Long;

    .line 8989
    .local v9, crashTime:Ljava/lang/Long;
    if-eqz v9, :cond_2

    invoke-virtual {v9}, Ljava/lang/Long;->longValue()J

    move-result-wide v3

    const-wide/32 v5, 0xea60

    add-long/2addr v3, v5

    cmp-long v0, v11, v3

    if-gez v0, :cond_2

    .line 8991
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Process "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " has crashed too many times: killing!"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8993
    const/16 v0, 0x7550

    const/4 v1, 0x2

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 8995
    const/4 v0, 0x0

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->killServicesLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 8996
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    const/4 v1, 0x1

    sub-int v2, v0, v1

    .local v2, i:I
    :goto_0
    if-ltz v2, :cond_1

    .line 8997
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 8998
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v0, p1, :cond_0

    .line 8999
    const-string v0, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  Force finishing activity "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v4}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    invoke-virtual {v4}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v0, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9001
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "crashed"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 8996
    :cond_0
    add-int/lit8 v2, v2, -0x1

    goto :goto_0

    .line 9004
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    iget-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v0, :cond_4

    .line 9009
    const/16 v0, 0x753f

    const/4 v1, 0x2

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    .end local v2           #i:I
    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 9011
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 9012
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->bad:Z

    .line 9013
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v0, v1, v2}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 9014
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 9015
    const/4 v0, 0x0

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z

    .line 9016
    const/4 v0, 0x0

    .line 9060
    :goto_1
    return v0

    .line 9019
    :cond_2
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    .line 9020
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v0, p1, :cond_4

    .line 9023
    const-string v0, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "  Force finishing activity "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget-object v3, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v3}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v3

    invoke-virtual {v3}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9025
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v5

    .line 9026
    .local v5, index:I
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "crashed"

    move-object v3, p0

    move-object v4, v1

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 9031
    add-int/lit8 v5, v5, -0x1

    .line 9032
    if-ltz v5, :cond_4

    .line 9033
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 9034
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v0, v2, :cond_3

    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v0, v2, :cond_3

    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v0, v2, :cond_4

    .line 9037
    :cond_3
    iget-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->isHomeActivity:Z

    if-nez v0, :cond_4

    .line 9038
    const-string v0, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "  Force finishing activity "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget-object v3, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v3}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v3

    invoke-virtual {v3}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9040
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "crashed"

    move-object v3, p0

    move-object v4, v1

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 9049
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    .end local v5           #index:I
    :cond_4
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v0}, Ljava/util/HashSet;->size()I

    move-result v0

    if-eqz v0, :cond_5

    .line 9052
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v0}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v10

    .line 9053
    .local v10, it:Ljava/util/Iterator;
    :goto_2
    invoke-interface {v10}, Ljava/util/Iterator;->hasNext()Z

    move-result v0

    if-eqz v0, :cond_5

    .line 9054
    invoke-interface {v10}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/am/ServiceRecord;

    .line 9055
    .local v13, sr:Lcom/android/server/am/ServiceRecord;
    iget v0, v13, Lcom/android/server/am/ServiceRecord;->crashCount:I

    add-int/lit8 v0, v0, 0x1

    iput v0, v13, Lcom/android/server/am/ServiceRecord;->crashCount:I

    goto :goto_2

    .line 9059
    .end local v10           #it:Ljava/util/Iterator;
    .end local v13           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_5
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 9060
    const/4 v0, 0x1

    goto/16 :goto_1
.end method

.method private final handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V
    .locals 10
    .parameter "app"
    .parameter "restarting"

    .prologue
    const/4 v9, 0x0

    const/4 v8, 0x0

    .line 4602
    const/4 v5, -0x1

    invoke-direct {p0, p1, p2, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V

    .line 4603
    if-nez p2, :cond_0

    .line 4604
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v5, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4608
    :cond_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_1

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v5, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v5, p1, :cond_1

    .line 4610
    iput-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 4612
    :cond_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_2

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v5, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v5, p1, :cond_2

    .line 4613
    iput-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4617
    :cond_2
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4618
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4619
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4620
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4622
    const/4 v0, 0x1

    .line 4623
    .local v0, atTop:Z
    const/4 v1, 0x0

    .line 4626
    .local v1, hasVisibleActivities:Z
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 4629
    .local v2, i:I
    :goto_0
    if-lez v2, :cond_9

    .line 4630
    add-int/lit8 v2, v2, -0x1

    .line 4631
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 4634
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v5, p1, :cond_6

    .line 4635
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v5, :cond_3

    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->stateNotNeeded:Z

    if-eqz v5, :cond_4

    :cond_3
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_7

    .line 4639
    :cond_4
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 4641
    iput-boolean v9, v4, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 4642
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v5, v4}, Lcom/android/server/WindowManagerService;->removeAppToken(Landroid/os/IBinder;)V

    .line 4646
    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->removeActivityUriPermissionsLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4663
    :cond_5
    :goto_1
    const/4 v5, 0x1

    invoke-direct {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityLocked(Lcom/android/server/am/HistoryRecord;Z)V

    .line 4664
    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v5, v4, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4666
    :cond_6
    const/4 v0, 0x0

    .line 4667
    goto :goto_0

    .line 4653
    :cond_7
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-eqz v5, :cond_8

    .line 4654
    const/4 v1, 0x1

    .line 4656
    :cond_8
    iput-object v8, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 4657
    iput-boolean v9, v4, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    .line 4658
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v5, :cond_5

    .line 4659
    iput-object v8, v4, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    goto :goto_1

    .line 4669
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_9
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    .line 4671
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    if-eqz v5, :cond_a

    .line 4672
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Crash of app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " running instrumentation "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4674
    new-instance v3, Landroid/os/Bundle;

    invoke-direct {v3}, Landroid/os/Bundle;-><init>()V

    .line 4675
    .local v3, info:Landroid/os/Bundle;
    const-string v5, "shortMsg"

    const-string v6, "Process crashed."

    invoke-virtual {v3, v5, v6}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 4676
    invoke-virtual {p0, p1, v9, v3}, Lcom/android/server/am/ActivityManagerService;->finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V

    .line 4679
    .end local v3           #info:Landroid/os/Bundle;
    :cond_a
    if-nez p2, :cond_b

    .line 4680
    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-result v5

    if-nez v5, :cond_b

    .line 4686
    if-eqz v1, :cond_b

    .line 4687
    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 4691
    :cond_b
    return-void
.end method

.method private final indexOfTokenLocked(Landroid/os/IBinder;)I
    .locals 5
    .parameter "token"

    .prologue
    .line 10362
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 10365
    .local v0, count:I
    const/4 v2, -0x1

    .line 10366
    .local v2, index:I
    const/4 v4, 0x1

    sub-int v1, v0, v4

    .local v1, i:I
    :goto_0
    if-ltz v1, :cond_0

    .line 10367
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    .line 10368
    .local v3, o:Ljava/lang/Object;
    if-ne v3, p1, :cond_1

    .line 10369
    move v2, v1

    .line 10374
    .end local v3           #o:Ljava/lang/Object;
    :cond_0
    return v2

    .line 10366
    .restart local v3       #o:Ljava/lang/Object;
    :cond_1
    add-int/lit8 v1, v1, -0x1

    goto :goto_0
.end method

.method public static final installSystemProviders()V
    .locals 8

    .prologue
    .line 8163
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    monitor-enter v4

    .line 8164
    :try_start_0
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v5, v5, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    const-string v6, "system"

    const/16 v7, 0x3e8

    invoke-virtual {v5, v6, v7}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .line 8165
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    invoke-direct {v5, v0}, Lcom/android/server/am/ActivityManagerService;->generateApplicationProvidersLocked(Lcom/android/server/am/ProcessRecord;)Ljava/util/List;

    move-result-object v3

    .line 8166
    .local v3, providers:Ljava/util/List;
    if-eqz v3, :cond_1

    .line 8167
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v5

    const/4 v6, 0x1

    sub-int v1, v5, v6

    .local v1, i:I
    :goto_0
    if-ltz v1, :cond_1

    .line 8168
    invoke-interface {v3, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/pm/ProviderInfo;

    .line 8169
    .local v2, pi:Landroid/content/pm/ProviderInfo;
    iget-object v5, v2, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v5, v5, 0x1

    if-nez v5, :cond_0

    .line 8170
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Not installing system proc provider "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v2, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ": not system .apk"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8172
    invoke-interface {v3, v1}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 8167
    :cond_0
    add-int/lit8 v1, v1, -0x1

    goto :goto_0

    .line 8176
    .end local v1           #i:I
    .end local v2           #pi:Landroid/content/pm/ProviderInfo;
    :cond_1
    monitor-exit v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 8177
    if-eqz v3, :cond_2

    .line 8178
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    invoke-virtual {v4, v3}, Landroid/app/ActivityThread;->installSystemProviders(Ljava/util/List;)V

    .line 8180
    :cond_2
    return-void

    .line 8176
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #providers:Ljava/util/List;
    :catchall_0
    move-exception v5

    :try_start_1
    monitor-exit v4
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v5
.end method

.method private isNextTransitionForward()Z
    .locals 2

    .prologue
    .line 1762
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v1}, Lcom/android/server/WindowManagerService;->getPendingAppTransition()I

    move-result v0

    .line 1763
    .local v0, transit:I
    const/16 v1, 0x1006

    if-eq v0, v1, :cond_0

    const/16 v1, 0x1008

    if-eq v0, v1, :cond_0

    const/16 v1, 0x100a

    if-ne v0, v1, :cond_1

    :cond_0
    const/4 v1, 0x1

    :goto_0
    return v1

    :cond_1
    const/4 v1, 0x0

    goto :goto_0
.end method

.method private final killPackageProcessesLocked(Ljava/lang/String;IIZZ)Z
    .locals 11
    .parameter "packageName"
    .parameter "uid"
    .parameter "minOomAdj"
    .parameter "callerWillRestart"
    .parameter "doit"

    .prologue
    .line 5263
    new-instance v8, Ljava/util/ArrayList;

    invoke-direct {v8}, Ljava/util/ArrayList;-><init>()V

    .line 5268
    .local v8, procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v9, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ":"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    .line 5269
    .local v7, procNamePrefix:Ljava/lang/String;
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v9}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v9

    invoke-virtual {v9}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .local v5, i$:Ljava/util/Iterator;
    :cond_0
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_6

    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/util/SparseArray;

    .line 5270
    .local v3, apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    invoke-virtual {v3}, Landroid/util/SparseArray;->size()I

    move-result v1

    .line 5271
    .local v1, NA:I
    const/4 v6, 0x0

    .local v6, ia:I
    :goto_0
    if-ge v6, v1, :cond_0

    .line 5272
    invoke-virtual {v3, v6}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 5273
    .local v2, app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v9, v2, Lcom/android/server/am/ProcessRecord;->removed:Z

    if-eqz v9, :cond_2

    .line 5274
    if-eqz p5, :cond_1

    .line 5275
    invoke-virtual {v8, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 5271
    :cond_1
    :goto_1
    add-int/lit8 v6, v6, 0x1

    goto :goto_0

    .line 5277
    :cond_2
    if-lez p2, :cond_3

    const/16 v9, 0x3e8

    if-eq p2, v9, :cond_3

    iget-object v9, v2, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    if-eq v9, p2, :cond_4

    :cond_3
    iget-object v9, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v9, p1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v9

    if-nez v9, :cond_4

    iget-object v9, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v9, v7}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v9

    if-eqz v9, :cond_1

    .line 5280
    :cond_4
    iget v9, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    if-lt v9, p3, :cond_1

    .line 5281
    if-nez p5, :cond_5

    .line 5282
    const/4 v9, 0x1

    .line 5295
    .end local v1           #NA:I
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v6           #ia:I
    .end local p1
    :goto_2
    return v9

    .line 5284
    .restart local v1       #NA:I
    .restart local v2       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v3       #apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v6       #ia:I
    .restart local p1
    :cond_5
    const/4 v9, 0x1

    iput-boolean v9, v2, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 5285
    invoke-virtual {v8, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_1

    .line 5291
    .end local v1           #NA:I
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v6           #ia:I
    :cond_6
    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 5292
    .local v0, N:I
    const/4 v4, 0x0

    .end local p1
    .local v4, i:I
    :goto_3
    if-ge v4, v0, :cond_7

    .line 5293
    invoke-virtual {v8, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, p1, p4}, Lcom/android/server/am/ActivityManagerService;->removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z

    .line 5292
    add-int/lit8 v4, v4, 0x1

    goto :goto_3

    .line 5295
    :cond_7
    if-lez v0, :cond_8

    const/4 v9, 0x1

    goto :goto_2

    :cond_8
    const/4 v9, 0x0

    goto :goto_2
.end method

.method private final killServicesLocked(Lcom/android/server/am/ProcessRecord;Z)V
    .locals 13
    .parameter "app"
    .parameter "allowRestart"

    .prologue
    .line 10409
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->size()I

    move-result v9

    if-lez v9, :cond_0

    .line 10410
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v6

    .line 10411
    .local v6, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_0
    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_0

    .line 10412
    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ConnectionRecord;

    .line 10413
    .local v7, r:Lcom/android/server/am/ConnectionRecord;
    const/4 v9, 0x0

    invoke-direct {p0, v7, p1, v9}, Lcom/android/server/am/ActivityManagerService;->removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V

    goto :goto_0

    .line 10416
    .end local v6           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .end local v7           #r:Lcom/android/server/am/ConnectionRecord;
    :cond_0
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->clear()V

    .line 10418
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->size()I

    move-result v9

    if-eqz v9, :cond_8

    .line 10421
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .line 10422
    .local v5, it:Ljava/util/Iterator;
    :cond_1
    :goto_1
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_7

    .line 10423
    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/am/ServiceRecord;

    .line 10424
    .local v8, sr:Lcom/android/server/am/ServiceRecord;
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v9}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v9

    monitor-enter v9

    .line 10425
    :try_start_0
    iget-object v10, v8, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v10}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopLaunchedLocked()V

    .line 10426
    monitor-exit v9
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 10427
    const/4 v9, 0x0

    iput-object v9, v8, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 10428
    const/4 v9, 0x0

    iput v9, v8, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    .line 10429
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9, v8}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10431
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_2

    const/4 v9, 0x1

    move v3, v9

    .line 10432
    .local v3, hasClients:Z
    :goto_2
    if-eqz v3, :cond_3

    .line 10433
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 10435
    .local v1, bindings:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :goto_3
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_3

    .line 10436
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/IntentBindRecord;

    .line 10439
    .local v0, b:Lcom/android/server/am/IntentBindRecord;
    const/4 v9, 0x0

    iput-object v9, v0, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    .line 10440
    const/4 v9, 0x0

    iput-boolean v9, v0, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    iput-boolean v9, v0, Lcom/android/server/am/IntentBindRecord;->received:Z

    iput-boolean v9, v0, Lcom/android/server/am/IntentBindRecord;->requested:Z

    goto :goto_3

    .line 10426
    .end local v0           #b:Lcom/android/server/am/IntentBindRecord;
    .end local v1           #bindings:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    .end local v3           #hasClients:Z
    :catchall_0
    move-exception v10

    :try_start_1
    monitor-exit v9
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v10

    .line 10431
    :cond_2
    const/4 v9, 0x0

    move v3, v9

    goto :goto_2

    .line 10444
    .restart local v3       #hasClients:Z
    :cond_3
    iget v9, v8, Lcom/android/server/am/ServiceRecord;->crashCount:I

    const/4 v10, 0x2

    if-lt v9, v10, :cond_4

    .line 10445
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Service crashed "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget v11, v8, Lcom/android/server/am/ServiceRecord;->crashCount:I

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " times, stopping: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10447
    const/16 v9, 0x7552

    const/4 v10, 0x3

    new-array v10, v10, [Ljava/lang/Object;

    const/4 v11, 0x0

    iget v12, v8, Lcom/android/server/am/ServiceRecord;->crashCount:I

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v10, v11

    const/4 v11, 0x1

    iget-object v12, v8, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    aput-object v12, v10, v11

    const/4 v11, 0x2

    iget v12, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v10, v11

    invoke-static {v9, v10}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 10449
    const/4 v9, 0x1

    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto/16 :goto_1

    .line 10450
    :cond_4
    if-nez p2, :cond_5

    .line 10451
    const/4 v9, 0x1

    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto/16 :goto_1

    .line 10453
    :cond_5
    const/4 v9, 0x1

    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;Z)Z

    move-result v2

    .line 10458
    .local v2, canceled:Z
    iget-boolean v9, v8, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    if-eqz v9, :cond_1

    iget-boolean v9, v8, Lcom/android/server/am/ServiceRecord;->stopIfKilled:Z

    if-nez v9, :cond_6

    if-eqz v2, :cond_1

    .line 10459
    :cond_6
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-nez v9, :cond_1

    .line 10460
    const/4 v9, 0x0

    iput-boolean v9, v8, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 10461
    if-nez v3, :cond_1

    .line 10463
    const/4 v9, 0x1

    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto/16 :goto_1

    .line 10470
    .end local v2           #canceled:Z
    .end local v3           #hasClients:Z
    .end local v8           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_7
    if-nez p2, :cond_8

    .line 10471
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->clear()V

    .line 10476
    .end local v5           #it:Ljava/util/Iterator;
    :cond_8
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v4

    .line 10477
    .local v4, i:I
    :cond_9
    :goto_4
    if-lez v4, :cond_a

    .line 10478
    add-int/lit8 v4, v4, -0x1

    .line 10479
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/am/ServiceRecord;

    .line 10480
    .restart local v8       #sr:Lcom/android/server/am/ServiceRecord;
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v9, p1, :cond_9

    .line 10481
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    goto :goto_4

    .line 10485
    .end local v8           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_a
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->clear()V

    .line 10486
    return-void
.end method

.method private final logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V
    .locals 11
    .parameter "r"

    .prologue
    const/4 v10, 0x4

    const/4 v9, 0x3

    const/4 v8, 0x2

    const/4 v7, 0x0

    const/4 v6, 0x1

    .line 12836
    iget v3, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    if-lez v3, :cond_1

    .line 12837
    iget-object v3, p1, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    iget v4, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    sub-int/2addr v4, v6

    invoke-interface {v3, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    .line 12838
    .local v2, curReceiver:Ljava/lang/Object;
    instance-of v3, v2, Lcom/android/server/am/BroadcastFilter;

    if-eqz v3, :cond_0

    .line 12839
    move-object v0, v2

    check-cast v0, Lcom/android/server/am/BroadcastFilter;

    move-object v1, v0

    .line 12840
    .local v1, bf:Lcom/android/server/am/BroadcastFilter;
    const/16 v3, 0x7548

    new-array v4, v10, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v7

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v6

    iget v5, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    sub-int/2addr v5, v6

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v8

    invoke-static {v1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v9

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 12861
    .end local v1           #bf:Lcom/android/server/am/BroadcastFilter;
    .end local v2           #curReceiver:Ljava/lang/Object;
    :goto_0
    return-void

    .line 12846
    .restart local v2       #curReceiver:Ljava/lang/Object;
    :cond_0
    const/16 v3, 0x7549

    new-array v4, v10, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v7

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v6

    iget v5, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    sub-int/2addr v5, v6

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v8

    check-cast v2, Landroid/content/pm/ResolveInfo;

    .end local v2           #curReceiver:Ljava/lang/Object;
    invoke-virtual {v2}, Landroid/content/pm/ResolveInfo;->toString()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v9

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_0

    .line 12853
    :cond_1
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Discarding broadcast before first receiver is invoked: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12855
    const/16 v3, 0x7549

    new-array v4, v10, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v7

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v6

    iget v5, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v8

    const-string v5, "NONE"

    aput-object v5, v4, v9

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_0
.end method

.method private final logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V
    .locals 3
    .parameter "tag"
    .parameter "r"
    .parameter "task"

    .prologue
    .line 3124
    const/4 v0, 0x7

    new-array v0, v0, [Ljava/lang/Object;

    const/4 v1, 0x0

    invoke-static {p2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v2

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x1

    iget v2, p3, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x2

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v2, v0, v1

    const/4 v1, 0x3

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x4

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getType()Ljava/lang/String;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x5

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getDataString()Ljava/lang/String;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x6

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getFlags()I

    move-result v2

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    aput-object v2, v0, v1

    invoke-static {p1, v0}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 3129
    return-void
.end method

.method public static final main(I)Landroid/content/Context;
    .locals 8
    .parameter "factoryTest"

    .prologue
    const/4 v6, 0x1

    const/4 v7, 0x0

    .line 1282
    new-instance v4, Lcom/android/server/am/ActivityManagerService$AThread;

    invoke-direct {v4}, Lcom/android/server/am/ActivityManagerService$AThread;-><init>()V

    .line 1283
    .local v4, thr:Lcom/android/server/am/ActivityManagerService$AThread;
    invoke-virtual {v4}, Lcom/android/server/am/ActivityManagerService$AThread;->start()V

    .line 1285
    monitor-enter v4

    .line 1286
    :goto_0
    :try_start_0
    iget-object v5, v4, Lcom/android/server/am/ActivityManagerService$AThread;->mService:Lcom/android/server/am/ActivityManagerService;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    if-nez v5, :cond_0

    .line 1288
    :try_start_1
    invoke-virtual {v4}, Ljava/lang/Object;->wait()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Ljava/lang/InterruptedException; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_0

    .line 1289
    :catch_0
    move-exception v5

    goto :goto_0

    .line 1292
    :cond_0
    :try_start_2
    monitor-exit v4
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 1294
    iget-object v2, v4, Lcom/android/server/am/ActivityManagerService$AThread;->mService:Lcom/android/server/am/ActivityManagerService;

    .line 1295
    .local v2, m:Lcom/android/server/am/ActivityManagerService;
    sput-object v2, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    .line 1296
    invoke-static {}, Landroid/app/ActivityThread;->systemMain()Landroid/app/ActivityThread;

    move-result-object v0

    .line 1297
    .local v0, at:Landroid/app/ActivityThread;
    sput-object v0, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    .line 1298
    invoke-virtual {v0}, Landroid/app/ActivityThread;->getSystemContext()Landroid/app/ContextImpl;

    move-result-object v1

    .line 1299
    .local v1, context:Landroid/content/Context;
    iput-object v1, v2, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    .line 1300
    iput p0, v2, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    .line 1301
    const-string v5, "power"

    invoke-virtual {v1, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/os/PowerManager;

    .line 1303
    .local v3, pm:Landroid/os/PowerManager;
    const-string v5, "ActivityManager-Sleep"

    invoke-virtual {v3, v6, v5}, Landroid/os/PowerManager;->newWakeLock(ILjava/lang/String;)Landroid/os/PowerManager$WakeLock;

    move-result-object v5

    iput-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    .line 1304
    const-string v5, "ActivityManager-Launch"

    invoke-virtual {v3, v6, v5}, Landroid/os/PowerManager;->newWakeLock(ILjava/lang/String;)Landroid/os/PowerManager$WakeLock;

    move-result-object v5

    iput-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    .line 1305
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Landroid/os/PowerManager$WakeLock;->setReferenceCounted(Z)V

    .line 1307
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v5, v1}, Lcom/android/server/am/BatteryStatsService;->publish(Landroid/content/Context;)V

    .line 1308
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    invoke-virtual {v5, v1}, Lcom/android/server/am/UsageStatsService;->publish(Landroid/content/Context;)V

    .line 1310
    monitor-enter v4

    .line 1311
    const/4 v5, 0x1

    :try_start_3
    iput-boolean v5, v4, Lcom/android/server/am/ActivityManagerService$AThread;->mReady:Z

    .line 1312
    invoke-virtual {v4}, Ljava/lang/Object;->notifyAll()V

    .line 1313
    monitor-exit v4
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 1315
    invoke-virtual {v2, v7, v7, v7, v7}, Lcom/android/server/am/ActivityManagerService;->startRunning(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V

    .line 1317
    return-object v1

    .line 1292
    .end local v0           #at:Landroid/app/ActivityThread;
    .end local v1           #context:Landroid/content/Context;
    .end local v2           #m:Lcom/android/server/am/ActivityManagerService;
    .end local v3           #pm:Landroid/os/PowerManager;
    :catchall_0
    move-exception v5

    :try_start_4
    monitor-exit v4
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v5

    .line 1313
    .restart local v0       #at:Landroid/app/ActivityThread;
    .restart local v1       #context:Landroid/content/Context;
    .restart local v2       #m:Lcom/android/server/am/ActivityManagerService;
    .restart local v3       #pm:Landroid/os/PowerManager;
    :catchall_1
    move-exception v5

    :try_start_5
    monitor-exit v4
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    throw v5
.end method

.method private makeAppCrashingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Z
    .locals 7
    .parameter "app"
    .parameter "shortMsg"
    .parameter "longMsg"
    .parameter "stackTrace"

    .prologue
    const/4 v2, 0x1

    .line 8914
    iput-boolean v2, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    .line 8915
    const/4 v3, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v4, p2

    move-object v5, p3

    move-object v6, p4

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->generateProcessError(Lcom/android/server/am/ProcessRecord;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/app/ActivityManager$ProcessErrorStateInfo;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->crashingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8917
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->startAppProblemLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 8918
    invoke-virtual {p1}, Lcom/android/server/am/ProcessRecord;->stopFreezingAllLocked()V

    .line 8919
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->handleAppCrashLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v0

    return v0
.end method

.method private makeAppNotRespondingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
    .locals 7
    .parameter "app"
    .parameter "activity"
    .parameter "shortMsg"
    .parameter "longMsg"

    .prologue
    .line 8924
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 8925
    const/4 v2, 0x2

    const/4 v6, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v3, p2

    move-object v4, p3

    move-object v5, p4

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->generateProcessError(Lcom/android/server/am/ProcessRecord;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/app/ActivityManager$ProcessErrorStateInfo;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8928
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->startAppProblemLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 8929
    invoke-virtual {p1}, Lcom/android/server/am/ProcessRecord;->stopFreezingAllLocked()V

    .line 8930
    return-void
.end method

.method private final moveActivityToFrontLocked(I)Lcom/android/server/am/HistoryRecord;
    .locals 6
    .parameter "where"

    .prologue
    const/4 v5, 0x1

    .line 3091
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    .line 3092
    .local v0, newTop:Lcom/android/server/am/HistoryRecord;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 3093
    .local v2, top:I
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    sub-int v4, v2, v5

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3094
    .local v1, oldTop:Lcom/android/server/am/HistoryRecord;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3, v2, v0}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 3095
    const/4 v3, 0x0

    iput-boolean v3, v1, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 3096
    iput-boolean v5, v0, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 3097
    return-object v0
.end method

.method private final moveTaskBackwardsLocked(I)V
    .locals 2
    .parameter "task"

    .prologue
    .line 7543
    const-string v0, "ActivityManager"

    const-string v1, "moveTaskBackwards not yet implemented!"

    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 7544
    return-void
.end method

.method private final moveTaskToBackLocked(ILcom/android/server/am/HistoryRecord;)Z
    .locals 13
    .parameter "task"
    .parameter "reason"

    .prologue
    const/4 v12, 0x0

    const/4 v11, 0x0

    .line 7459
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "moveTaskToBack: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 7464
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    if-eqz v8, :cond_1

    .line 7465
    invoke-direct {p0, v11, p1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    .line 7466
    .local v5, next:Lcom/android/server/am/HistoryRecord;
    if-nez v5, :cond_0

    .line 7467
    invoke-direct {p0, v11, v12}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    .line 7469
    :cond_0
    if-eqz v5, :cond_1

    .line 7471
    const/4 v3, 0x1

    .line 7473
    .local v3, moveOK:Z
    :try_start_0
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    iget-object v9, v5, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-interface {v8, v9}, Landroid/app/IActivityController;->activityResuming(Ljava/lang/String;)Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v3

    .line 7477
    :goto_0
    if-nez v3, :cond_1

    move v8, v12

    .line 7524
    .end local v3           #moveOK:Z
    .end local v5           #next:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return v8

    .line 7474
    .restart local v3       #moveOK:Z
    .restart local v5       #next:Lcom/android/server/am/HistoryRecord;
    :catch_0
    move-exception v8

    move-object v2, v8

    .line 7475
    .local v2, e:Landroid/os/RemoteException;
    iput-object v11, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    goto :goto_0

    .line 7483
    .end local v2           #e:Landroid/os/RemoteException;
    .end local v3           #moveOK:Z
    .end local v5           #next:Lcom/android/server/am/HistoryRecord;
    :cond_1
    new-instance v4, Ljava/util/ArrayList;

    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    .line 7488
    .local v4, moved:Ljava/util/ArrayList;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7489
    .local v0, N:I
    const/4 v1, 0x0

    .line 7490
    .local v1, bottom:I
    const/4 v6, 0x0

    .line 7494
    .local v6, pos:I
    :goto_2
    if-ge v6, v0, :cond_3

    .line 7495
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 7498
    .local v7, r:Lcom/android/server/am/HistoryRecord;
    iget-object v8, v7, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v8, v8, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v8, p1, :cond_2

    .line 7500
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7501
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8, v1, v7}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7502
    invoke-virtual {v4, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7503
    add-int/lit8 v1, v1, 0x1

    .line 7505
    :cond_2
    add-int/lit8 v6, v6, 0x1

    .line 7506
    goto :goto_2

    .line 7508
    .end local v7           #r:Lcom/android/server/am/HistoryRecord;
    :cond_3
    if-eqz p2, :cond_5

    iget-object v8, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v8}, Landroid/content/Intent;->getFlags()I

    move-result v8

    const/high16 v9, 0x1

    and-int/2addr v8, v9

    if-eqz v8, :cond_5

    .line 7510
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v8, v12}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 7511
    invoke-direct {p0, v11}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v7

    .line 7512
    .restart local v7       #r:Lcom/android/server/am/HistoryRecord;
    if-eqz v7, :cond_4

    .line 7513
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    invoke-virtual {v8, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7518
    .end local v7           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    :goto_3
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v8, v4}, Lcom/android/server/WindowManagerService;->moveAppTokensToBottom(Ljava/util/List;)V

    .line 7523
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->finishTaskMoveLocked(I)V

    .line 7524
    const/4 v8, 0x1

    goto :goto_1

    .line 7516
    :cond_5
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/16 v9, 0x200b

    invoke-virtual {v8, v9}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto :goto_3
.end method

.method private final moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;Lcom/android/server/am/HistoryRecord;)V
    .locals 9
    .parameter "tr"
    .parameter "reason"

    .prologue
    const/4 v7, 0x1

    const/4 v8, 0x0

    .line 7347
    iget v4, p1, Lcom/android/server/am/TaskRecord;->taskId:I

    .line 7348
    .local v4, task:I
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    sub-int v5, v6, v7

    .line 7350
    .local v5, top:I
    if-ltz v5, :cond_0

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/HistoryRecord;

    iget-object v6, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, v4, :cond_1

    .line 7403
    :cond_0
    :goto_0
    return-void

    .line 7355
    :cond_1
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 7359
    .local v1, moved:Ljava/util/ArrayList;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    sub-int v5, v6, v7

    .line 7360
    move v2, v5

    .line 7364
    .local v2, pos:I
    :goto_1
    if-ltz v2, :cond_3

    .line 7365
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7368
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    const/4 v0, 0x1

    .line 7369
    .local v0, first:Z
    iget-object v6, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, v4, :cond_2

    .line 7371
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7372
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v5, v3}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7373
    invoke-virtual {v1, v8, v3}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7374
    add-int/lit8 v5, v5, -0x1

    .line 7375
    if-eqz v0, :cond_2

    .line 7376
    iget-object v6, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-direct {p0, v6}, Lcom/android/server/am/ActivityManagerService;->addRecentTaskLocked(Lcom/android/server/am/TaskRecord;)V

    .line 7377
    const/4 v0, 0x0

    .line 7380
    :cond_2
    add-int/lit8 v2, v2, -0x1

    .line 7381
    goto :goto_1

    .line 7385
    .end local v0           #first:Z
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_3
    if-eqz p2, :cond_5

    iget-object v6, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v6}, Landroid/content/Intent;->getFlags()I

    move-result v6

    const/high16 v7, 0x1

    and-int/2addr v6, v7

    if-eqz v6, :cond_5

    .line 7387
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v6, v8}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 7388
    const/4 v6, 0x0

    invoke-direct {p0, v6}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v3

    .line 7389
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    if-eqz v3, :cond_4

    .line 7390
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    invoke-virtual {v6, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7396
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    :goto_2
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v6, v1}, Lcom/android/server/WindowManagerService;->moveAppTokensToTop(Ljava/util/List;)V

    .line 7401
    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->finishTaskMoveLocked(I)V

    .line 7402
    const/16 v6, 0x7532

    invoke-static {v6, v4}, Landroid/util/EventLog;->writeEvent(II)I

    goto :goto_0

    .line 7393
    :cond_5
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/16 v7, 0x100a

    invoke-virtual {v6, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto :goto_2
.end method

.method private final performClearTaskLocked(ILcom/android/server/am/HistoryRecord;IZ)Lcom/android/server/am/HistoryRecord;
    .locals 10
    .parameter "taskId"
    .parameter "newR"
    .parameter "launchFlags"
    .parameter "doClear"

    .prologue
    .line 3005
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 3008
    .local v2, i:I
    :cond_0
    if-lez v2, :cond_1

    .line 3009
    add-int/lit8 v2, v2, -0x1

    .line 3010
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3011
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v0, v0, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v0, p1, :cond_0

    .line 3012
    add-int/lit8 v2, v2, 0x1

    .line 3018
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    if-lez v2, :cond_7

    .line 3019
    add-int/lit8 v2, v2, -0x1

    .line 3020
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3021
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_1

    .line 3024
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v0, v0, Lcom/android/server/am/TaskRecord;->taskId:I

    if-eq v0, p1, :cond_2

    .line 3025
    const/4 v0, 0x0

    .line 3063
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_0
    return-object v0

    .line 3027
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_2
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    iget-object v3, p2, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, v3}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1

    .line 3029
    move-object v9, v1

    .line 3030
    .local v9, ret:Lcom/android/server/am/HistoryRecord;
    if-eqz p4, :cond_4

    .line 3031
    :cond_3
    :goto_1
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    const/4 v3, 0x1

    sub-int/2addr v0, v3

    if-ge v2, v0, :cond_4

    .line 3032
    add-int/lit8 v2, v2, 0x1

    .line 3033
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3034
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_3

    .line 3037
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "clear"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_3

    .line 3039
    add-int/lit8 v2, v2, -0x1

    goto :goto_1

    .line 3047
    :cond_4
    iget v0, v9, Lcom/android/server/am/HistoryRecord;->launchMode:I

    if-nez v0, :cond_6

    const/high16 v0, 0x2000

    and-int/2addr v0, p3

    if-nez v0, :cond_6

    .line 3049
    iget-boolean v0, v9, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_6

    .line 3050
    invoke-direct {p0, v9}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v5

    .line 3051
    .local v5, index:I
    if-ltz v5, :cond_5

    .line 3052
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "clear"

    move-object v3, p0

    move-object v4, v9

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 3055
    :cond_5
    const/4 v0, 0x0

    goto :goto_0

    .end local v5           #index:I
    :cond_6
    move-object v0, v9

    .line 3059
    goto :goto_0

    .line 3063
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    .end local v9           #ret:Lcom/android/server/am/HistoryRecord;
    :cond_7
    const/4 v0, 0x0

    goto :goto_0
.end method

.method static performReceive(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V
    .locals 8
    .parameter "app"
    .parameter "receiver"
    .parameter "intent"
    .parameter "resultCode"
    .parameter "data"
    .parameter "extras"
    .parameter "ordered"
    .parameter "sticky"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 12962
    if-eqz p0, :cond_0

    iget-object v0, p0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_0

    .line 12965
    iget-object v0, p0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v1, p1

    move-object v2, p2

    move v3, p3

    move-object v4, p4

    move-object v5, p5

    move v6, p6

    move v7, p7

    invoke-interface/range {v0 .. v7}, Landroid/app/IApplicationThread;->scheduleRegisteredReceiver(Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V

    .line 12970
    :goto_0
    return-void

    .line 12968
    :cond_0
    invoke-interface/range {p1 .. p7}, Landroid/content/IIntentReceiver;->performReceive(Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V

    goto :goto_0
.end method

.method private final processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
    .locals 9
    .parameter "r"
    .parameter "app"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    const/4 v1, 0x1

    const/4 v8, 0x0

    .line 12929
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v0, :cond_0

    .line 12930
    new-instance v0, Landroid/os/RemoteException;

    invoke-direct {v0}, Landroid/os/RemoteException;-><init>()V

    throw v0

    .line 12932
    :cond_0
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 12933
    iput-object p2, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 12934
    iput-object p1, p2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 12935
    invoke-direct {p0, p2, v1, v1}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 12938
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    iget-object v1, p1, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    invoke-virtual {v0, v1}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 12940
    const/4 v7, 0x0

    .line 12945
    .local v7, started:Z
    :try_start_0
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v0}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    invoke-virtual {v0}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 12946
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    new-instance v1, Landroid/content/Intent;

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-direct {v1, v2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;

    iget v3, p1, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v4, p1, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v6, p1, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    invoke-interface/range {v0 .. v6}, Landroid/app/IApplicationThread;->scheduleReceiver(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;ILjava/lang/String;Landroid/os/Bundle;Z)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 12948
    const/4 v7, 0x1

    .line 12950
    if-nez v7, :cond_1

    .line 12951
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 12952
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 12953
    iput-object v8, p2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 12957
    :cond_1
    return-void

    .line 12950
    :catchall_0
    move-exception v0

    if-nez v7, :cond_2

    .line 12951
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 12952
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 12953
    iput-object v8, p2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    :cond_2
    throw v0
.end method

.method private final processNextBroadcast(Z)V
    .locals 33
    .parameter "fromMsg"

    .prologue
    .line 13062
    monitor-enter p0

    .line 13069
    :try_start_0
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 13071
    if-eqz p1, :cond_0

    .line 13072
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    .line 13076
    :cond_0
    :goto_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_2

    .line 13077
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v29

    check-cast v29, Lcom/android/server/am/BroadcastRecord;

    .line 13078
    .local v29, r:Lcom/android/server/am/BroadcastRecord;
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v7

    move-wide v0, v7

    move-object/from16 v2, v29

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    .line 13079
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    invoke-interface {v5}, Ljava/util/List;->size()I

    move-result v14

    .line 13082
    .local v14, N:I
    const/16 v19, 0x0

    .local v19, i:I
    :goto_1
    move/from16 v0, v19

    move v1, v14

    if-ge v0, v1, :cond_1

    .line 13083
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v19

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v32

    .line 13087
    .local v32, target:Ljava/lang/Object;
    check-cast v32, Lcom/android/server/am/BroadcastFilter;

    .end local v32           #target:Ljava/lang/Object;
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v29

    move-object/from16 v2, v32

    move v3, v5

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->deliverToRegisteredReceiver(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V

    .line 13082
    add-int/lit8 v19, v19, 0x1

    goto :goto_1

    .line 13089
    :cond_1
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V

    goto :goto_0

    .line 13340
    .end local v14           #N:I
    .end local v19           #i:I
    .end local v29           #r:Lcom/android/server/am/BroadcastRecord;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 13099
    :cond_2
    :try_start_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v5, v0

    if-eqz v5, :cond_5

    .line 13106
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    monitor-enter v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 13107
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v7, v0

    iget-object v7, v7, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v6, v7}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v6

    if-nez v6, :cond_3

    const/4 v6, 0x1

    move/from16 v21, v6

    .line 13108
    .local v21, isDead:Z
    :goto_2
    monitor-exit v5
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 13109
    if-nez v21, :cond_4

    .line 13111
    :try_start_3
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 13341
    .end local v21           #isDead:Z
    :goto_3
    return-void

    .line 13107
    :cond_3
    const/4 v6, 0x0

    move/from16 v21, v6

    goto :goto_2

    .line 13108
    :catchall_1
    move-exception v6

    :try_start_4
    monitor-exit v5
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    :try_start_5
    throw v6

    .line 13113
    .restart local v21       #isDead:Z
    :cond_4
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "pending app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v7, v0

    iget-object v7, v7, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " died before responding to broadcast"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13115
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 13119
    .end local v21           #isDead:Z
    :cond_5
    const/16 v22, 0x0

    .line 13122
    .local v22, looped:Z
    :cond_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-nez v5, :cond_8

    .line 13124
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    .line 13125
    if-eqz v22, :cond_7

    .line 13129
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 13131
    :cond_7
    monitor-exit p0

    goto :goto_3

    .line 13133
    :cond_8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v29

    check-cast v29, Lcom/android/server/am/BroadcastRecord;

    .line 13134
    .restart local v29       #r:Lcom/android/server/am/BroadcastRecord;
    const/16 v18, 0x0

    .line 13144
    .local v18, forceReceive:Z
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    if-eqz v5, :cond_a

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    invoke-interface {v5}, Ljava/util/List;->size()I

    move-result v5

    move/from16 v27, v5

    .line 13145
    .local v27, numReceivers:I
    :goto_4
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v5, v0

    if-eqz v5, :cond_9

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    move-wide v7, v0

    const-wide/16 v9, 0x0

    cmp-long v5, v7, v9

    if-lez v5, :cond_9

    .line 13146
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v25

    .line 13147
    .local v25, now:J
    if-lez v27, :cond_9

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    move-wide v7, v0

    const v5, 0x9c40

    mul-int v5, v5, v27

    int-to-long v9, v5

    add-long/2addr v7, v9

    cmp-long v5, v25, v7

    if-lez v5, :cond_9

    .line 13149
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Hung broadcast discarded after timeout failure: now="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-wide/from16 v1, v25

    invoke-virtual {v0, v1, v2}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " dispatchTime="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    move-wide v7, v0

    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " startTime="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    move-wide v7, v0

    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " intent="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " numReceivers="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move/from16 v1, v27

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " nextReceiver="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " state="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13157
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->broadcastTimeout()V

    .line 13158
    const/16 v18, 0x1

    .line 13159
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13163
    .end local v25           #now:J
    :cond_9
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    move v5, v0

    if-eqz v5, :cond_b

    .line 13167
    monitor-exit p0

    goto/16 :goto_3

    .line 13144
    .end local v27           #numReceivers:I
    :cond_a
    const/4 v5, 0x0

    move/from16 v27, v5

    goto/16 :goto_4

    .line 13170
    .restart local v27       #numReceivers:I
    :cond_b
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    if-eqz v5, :cond_c

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v5, v0

    move v0, v5

    move/from16 v1, v27

    if-ge v0, v1, :cond_c

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move v5, v0

    if-nez v5, :cond_c

    if-eqz v18, :cond_e

    .line 13174
    :cond_c
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;

    move-object v5, v0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    if-eqz v5, :cond_d

    .line 13181
    :try_start_6
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->callerApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;

    move-object v6, v0

    new-instance v7, Landroid/content/Intent;

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v8, v0

    invoke-direct {v7, v8}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move v8, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object v9, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object v10, v0

    const/4 v11, 0x0

    const/4 v12, 0x0

    invoke-static/range {v5 .. v12}, Lcom/android/server/am/ActivityManagerService;->performReceive(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;ZZ)V
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_6 .. :try_end_6} :catch_0

    .line 13190
    :cond_d
    :goto_5
    :try_start_7
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x8

    invoke-virtual {v5, v6}, Landroid/os/Handler;->removeMessages(I)V

    .line 13196
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V

    .line 13197
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 13198
    const/16 v29, 0x0

    .line 13199
    const/16 v22, 0x1

    .line 13202
    :cond_e
    if-eqz v29, :cond_6

    .line 13205
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move/from16 v30, v0

    add-int/lit8 v5, v30, 0x1

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    .line 13209
    .local v30, recIdx:I
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v7

    move-wide v0, v7

    move-object/from16 v2, v29

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    .line 13210
    if-nez v30, :cond_f

    .line 13211
    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    move-wide v7, v0

    move-wide v0, v7

    move-object/from16 v2, v29

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    .line 13218
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x8

    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v23

    .line 13219
    .local v23, msg:Landroid/os/Message;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J

    move-wide v7, v0

    const-wide/16 v9, 0x4e20

    add-long/2addr v7, v9

    move-object v0, v5

    move-object/from16 v1, v23

    move-wide v2, v7

    invoke-virtual {v0, v1, v2, v3}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 13222
    .end local v23           #msg:Landroid/os/Message;
    :cond_f
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v30

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v24

    .line 13223
    .local v24, nextReceiver:Ljava/lang/Object;
    move-object/from16 v0, v24

    instance-of v0, v0, Lcom/android/server/am/BroadcastFilter;

    move v5, v0

    if-eqz v5, :cond_12

    .line 13226
    move-object/from16 v0, v24

    check-cast v0, Lcom/android/server/am/BroadcastFilter;

    move-object/from16 v17, v0

    .line 13230
    .local v17, filter:Lcom/android/server/am/BroadcastFilter;
    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    move v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v29

    move-object/from16 v2, v17

    move v3, v5

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->deliverToRegisteredReceiver(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V

    .line 13231
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v5, v0

    if-eqz v5, :cond_10

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    move v5, v0

    if-nez v5, :cond_11

    .line 13236
    :cond_10
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13237
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 13239
    :cond_11
    monitor-exit p0

    goto/16 :goto_3

    .line 13184
    .end local v17           #filter:Lcom/android/server/am/BroadcastFilter;
    .end local v24           #nextReceiver:Ljava/lang/Object;
    .end local v30           #recIdx:I
    :catch_0
    move-exception v5

    move-object/from16 v16, v5

    .line 13185
    .local v16, e:Landroid/os/RemoteException;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Failure sending broadcast result of "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v16

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_5

    .line 13245
    .end local v16           #e:Landroid/os/RemoteException;
    .restart local v24       #nextReceiver:Ljava/lang/Object;
    .restart local v30       #recIdx:I
    :cond_12
    move-object/from16 v0, v24

    check-cast v0, Landroid/content/pm/ResolveInfo;

    move-object/from16 v20, v0

    .line 13248
    .local v20, info:Landroid/content/pm/ResolveInfo;
    const/16 v31, 0x0

    .line 13249
    .local v31, skip:Z
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    move v6, v0

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v7, v0

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget-boolean v8, v8, Landroid/content/pm/ActivityInfo;->exported:Z

    if-eqz v8, :cond_16

    const/4 v8, -0x1

    :goto_6
    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v6

    move v3, v7

    move v4, v8

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v28

    .line 13253
    .local v28, perm:I
    if-eqz v28, :cond_13

    .line 13254
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: broadcasting "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v7}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " from "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (pid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", uid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ")"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " due to receiver "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "/"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13261
    const/16 v31, 0x1

    .line 13263
    :cond_13
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v5, v0

    const/16 v6, 0x3e8

    if-eq v5, v6, :cond_14

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    move-object v5, v0
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_0

    if-eqz v5, :cond_14

    .line 13266
    :try_start_8
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    move-object v6, v0

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v5, v6, v7}, Landroid/content/pm/IPackageManager;->checkPermission(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_8 .. :try_end_8} :catch_1

    move-result v28

    .line 13272
    :goto_7
    if-eqz v28, :cond_14

    .line 13273
    :try_start_9
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: receiving "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " to "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " due to sender "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (uid "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ")"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13279
    const/16 v31, 0x1

    .line 13282
    :cond_14
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-eqz v5, :cond_15

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    iget-boolean v5, v5, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-eqz v5, :cond_15

    .line 13284
    const/16 v31, 0x1

    .line 13287
    :cond_15
    if-eqz v31, :cond_17

    .line 13288
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 13289
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 13290
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13291
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 13292
    monitor-exit p0

    goto/16 :goto_3

    .line 13249
    .end local v28           #perm:I
    :cond_16
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I

    goto/16 :goto_6

    .line 13269
    .restart local v28       #perm:I
    :catch_1
    move-exception v5

    move-object/from16 v16, v5

    .line 13270
    .restart local v16       #e:Landroid/os/RemoteException;
    const/16 v28, -0x1

    goto/16 :goto_7

    .line 13295
    .end local v16           #e:Landroid/os/RemoteException;
    :cond_17
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13296
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v6, v5, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    .line 13297
    .local v6, targetProcess:Ljava/lang/String;
    new-instance v5, Landroid/content/ComponentName;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v5, v7, v8}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    .line 13300
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;

    .line 13303
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v15

    .line 13305
    .local v15, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v15, :cond_18

    iget-object v5, v15, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_0

    if-eqz v5, :cond_18

    .line 13307
    :try_start_a
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    move-object v2, v15

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_a .. :try_end_a} :catch_2

    .line 13308
    :try_start_b
    monitor-exit p0

    goto/16 :goto_3

    .line 13309
    :catch_2
    move-exception v16

    .line 13310
    .restart local v16       #e:Landroid/os/RemoteException;
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Exception when sending broadcast to "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    move-object v8, v0

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v16

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 13319
    .end local v16           #e:Landroid/os/RemoteException;
    :cond_18
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v7, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v8, 0x1

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getFlags()I

    move-result v5

    or-int/lit8 v9, v5, 0x4

    const-string v10, "broadcast"

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    move-object v11, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getFlags()I

    move-result v5

    const/high16 v12, 0x800

    and-int/2addr v5, v12

    if-eqz v5, :cond_19

    const/4 v5, 0x1

    move v12, v5

    :goto_8
    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v12}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    if-nez v5, :cond_1a

    .line 13327
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    .end local v6           #targetProcess:Ljava/lang/String;
    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unable to launch app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "/"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " for broadcast "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ": process is bad"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13331
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 13332
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v8, v0

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move v9, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object v11, v0

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move v12, v0

    const/4 v13, 0x1

    move-object/from16 v7, p0

    invoke-direct/range {v7 .. v13}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 13334
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 13335
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 13336
    monitor-exit p0

    goto/16 :goto_3

    .line 13319
    .restart local v6       #targetProcess:Ljava/lang/String;
    :cond_19
    const/4 v5, 0x0

    move v12, v5

    goto/16 :goto_8

    .line 13339
    :cond_1a
    move-object/from16 v0, v29

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 13340
    monitor-exit p0
    :try_end_b
    .catchall {:try_start_b .. :try_end_b} :catchall_0

    goto/16 :goto_3
.end method

.method private final processStartTimedOutLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 12
    .parameter "app"

    .prologue
    const/4 v11, 0x1

    const-string v10, "ActivityManager"

    .line 5408
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 5409
    .local v4, pid:I
    const/4 v1, 0x0

    .line 5410
    .local v1, gone:Z
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v6

    .line 5411
    :try_start_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v7, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 5412
    .local v3, knownApp:Lcom/android/server/am/ProcessRecord;
    if-eqz v3, :cond_0

    iget-object v7, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v7, :cond_0

    .line 5413
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v7, v4}, Landroid/util/SparseArray;->remove(I)V

    .line 5414
    const/4 v1, 0x1

    .line 5416
    :cond_0
    monitor-exit v6
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5418
    if-eqz v1, :cond_5

    .line 5419
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Process "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " failed to attach"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5420
    const/16 v6, 0x7555

    const/4 v7, 0x3

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v7, v11

    const/4 v8, 0x2

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 5422
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v6, v7, v8}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 5424
    invoke-virtual {p0, p1, v11}, Lcom/android/server/am/ActivityManagerService;->checkAppInLaunchingProvidersLocked(Lcom/android/server/am/ProcessRecord;Z)Z

    .line 5426
    const/4 v2, 0x0

    .local v2, i:I
    :goto_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    if-ge v2, v6, :cond_2

    .line 5427
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 5428
    .local v5, sr:Lcom/android/server/am/ServiceRecord;
    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v7, v5, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v6, v7, :cond_1

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v7, v5, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_1

    .line 5430
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Forcing bringing down service: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5431
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 5432
    add-int/lit8 v2, v2, -0x1

    .line 5433
    invoke-direct {p0, v5, v11}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 5426
    :cond_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    .line 5416
    .end local v2           #i:I
    .end local v3           #knownApp:Lcom/android/server/am/ProcessRecord;
    .end local v5           #sr:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v7

    :try_start_1
    monitor-exit v6
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v7

    .line 5436
    .restart local v2       #i:I
    .restart local v3       #knownApp:Lcom/android/server/am/ProcessRecord;
    :cond_2
    invoke-static {v4}, Landroid/os/Process;->killProcess(I)V

    .line 5437
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    if-eqz v6, :cond_3

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    iget-object v6, v6, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v6, v6, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v6, v4, :cond_3

    .line 5438
    const-string v6, "ActivityManager"

    const-string v6, "Unattached app died before backup, skipping"

    invoke-static {v10, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5440
    :try_start_2
    const-string v6, "backup"

    invoke-static {v6}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v6

    invoke-static {v6}, Landroid/app/backup/IBackupManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/app/backup/IBackupManager;

    move-result-object v0

    .line 5442
    .local v0, bm:Landroid/app/backup/IBackupManager;
    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v0, v6}, Landroid/app/backup/IBackupManager;->agentDisconnected(Ljava/lang/String;)V
    :try_end_2
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 5447
    .end local v0           #bm:Landroid/app/backup/IBackupManager;
    :cond_3
    :goto_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    if-eqz v6, :cond_4

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    iget-object v6, v6, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    iget v6, v6, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v6, v4, :cond_4

    .line 5448
    const-string v6, "ActivityManager"

    const-string v6, "Unattached app died before broadcast acknowledged, skipping"

    invoke-static {v10, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5449
    const/4 v6, 0x0

    iput-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 5450
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 5455
    .end local v2           #i:I
    :cond_4
    :goto_2
    return-void

    .line 5453
    :cond_5
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Spurious process start timeout - pid not known for "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_2

    .line 5443
    .restart local v2       #i:I
    :catch_0
    move-exception v6

    goto :goto_1
.end method

.method private final realStartActivityLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/ProcessRecord;ZZ)Z
    .locals 13
    .parameter "r"
    .parameter "app"
    .parameter "andResume"
    .parameter "checkConfig"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 1772
    const/4 v0, 0x0

    invoke-virtual {p1, p2, v0}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 1773
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x1

    invoke-virtual {v0, p1, v1}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 1781
    if-eqz p4, :cond_0

    .line 1782
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-virtual {p1, p2}, Lcom/android/server/am/HistoryRecord;->mayFreezeScreenLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v2

    if-eqz v2, :cond_2

    move-object v2, p1

    :goto_0
    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->updateOrientationFromAppTokens(Landroid/content/res/Configuration;Landroid/os/IBinder;)Landroid/content/res/Configuration;

    move-result-object v10

    .line 1785
    .local v10, config:Landroid/content/res/Configuration;
    invoke-virtual {p0, v10, p1}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    .line 1788
    .end local v10           #config:Landroid/content/res/Configuration;
    :cond_0
    iput-object p2, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 1792
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v12

    .line 1793
    .local v12, idx:I
    if-gez v12, :cond_1

    .line 1794
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 1796
    :cond_1
    const/4 v0, 0x1

    const/4 v1, 0x1

    invoke-direct {p0, p2, v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 1799
    :try_start_0
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v0, :cond_3

    .line 1800
    new-instance v0, Landroid/os/RemoteException;

    invoke-direct {v0}, Landroid/os/RemoteException;-><init>()V

    throw v0
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1825
    :catch_0
    move-exception v0

    move-object v11, v0

    .line 1826
    .local v11, e:Landroid/os/RemoteException;
    iget-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->launchFailed:Z

    if-eqz v0, :cond_9

    .line 1829
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Second failure launching "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    invoke-virtual {v2}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ", giving up"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v11}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1832
    iget v0, p2, Lcom/android/server/am/ProcessRecord;->pid:I

    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-direct {p0, p2, v0, v1}, Lcom/android/server/am/ActivityManagerService;->appDiedLocked(Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V

    .line 1833
    const/4 v0, 0x0

    const/4 v1, 0x0

    const-string v2, "2nd-crash"

    invoke-direct {p0, p1, v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    .line 1835
    const/4 v0, 0x0

    .line 1876
    .end local v11           #e:Landroid/os/RemoteException;
    :goto_1
    return v0

    .line 1782
    .end local v12           #idx:I
    :cond_2
    const/4 v2, 0x0

    goto :goto_0

    .line 1802
    .restart local v12       #idx:I
    :cond_3
    const/4 v6, 0x0

    .line 1803
    .local v6, results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    const/4 v7, 0x0

    .line 1804
    .local v7, newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    if-eqz p3, :cond_4

    .line 1805
    :try_start_1
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 1806
    iget-object v7, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 1812
    :cond_4
    if-eqz p3, :cond_5

    .line 1813
    const/16 v0, 0x7536

    const/4 v1, 0x3

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v3, v3, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x2

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 1817
    :cond_5
    iget-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->isHomeActivity:Z

    if-eqz v0, :cond_6

    .line 1818
    iput-object p2, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    .line 1820
    :cond_6
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v0}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    invoke-virtual {v0}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 1821
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    new-instance v1, Landroid/content/Intent;

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-direct {v1, v2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v3

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    if-nez p3, :cond_8

    const/4 v2, 0x1

    move v8, v2

    :goto_2
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->isNextTransitionForward()Z

    move-result v9

    move-object v2, p1

    invoke-interface/range {v0 .. v9}, Landroid/app/IApplicationThread;->scheduleLaunchActivity(Landroid/content/Intent;Landroid/os/IBinder;ILandroid/content/pm/ActivityInfo;Landroid/os/Bundle;Ljava/util/List;Ljava/util/List;ZZ)V
    :try_end_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 1844
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->launchFailed:Z

    .line 1845
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-result v0

    if-eqz v0, :cond_7

    .line 1846
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Activity "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " being launched, but already in LRU list"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 1850
    :cond_7
    if-eqz p3, :cond_a

    .line 1853
    sget-object v0, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 1854
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 1855
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->haveState:Z

    .line 1856
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 1857
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 1858
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-virtual {v0}, Lcom/android/server/am/TaskRecord;->touchActiveTime()V

    .line 1859
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->completeResumeLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 1860
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V

    .line 1874
    :goto_3
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->startSetupActivityLocked()V

    .line 1876
    const/4 v0, 0x1

    goto/16 :goto_1

    .line 1821
    :cond_8
    const/4 v2, 0x0

    move v8, v2

    goto :goto_2

    .line 1840
    .end local v6           #results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    .end local v7           #newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    .restart local v11       #e:Landroid/os/RemoteException;
    :cond_9
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 1841
    throw v11

    .line 1866
    .end local v11           #e:Landroid/os/RemoteException;
    .restart local v6       #results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    .restart local v7       #newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    :cond_a
    sget-object v0, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 1867
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    goto :goto_3
.end method

.method private final realStartServiceLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/ProcessRecord;)V
    .locals 7
    .parameter "r"
    .parameter "app"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    const/4 v6, 0x0

    const/4 v5, 0x1

    .line 11041
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v1, :cond_0

    .line 11042
    new-instance v1, Landroid/os/RemoteException;

    invoke-direct {v1}, Landroid/os/RemoteException;-><init>()V

    throw v1

    .line 11045
    :cond_0
    iput-object p2, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 11046
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    iput-wide v1, p1, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    iput-wide v1, p1, Lcom/android/server/am/ServiceRecord;->restartTime:J

    .line 11048
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v1, p1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 11049
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11050
    invoke-direct {p0, p2, v5, v5}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 11052
    const/4 v0, 0x0

    .line 11056
    .local v0, created:Z
    :try_start_0
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    const/4 v2, 0x0

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 11057
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v1}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v1

    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    const/4 v3, 0x0

    const/4 v4, 0x1

    invoke-virtual {v1, v2, v3, v4}, Landroid/content/Intent;->toShortString(Ljava/lang/StringBuilder;ZZ)V

    .line 11058
    const/16 v1, 0x754e

    const/4 v2, 0x4

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v3, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x1

    iget-object v4, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    aput-object v4, v2, v3

    const/4 v3, 0x2

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x3

    iget-object v4, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v4, v4, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    invoke-static {v1, v2}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 11061
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v1}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v1

    monitor-enter v1
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 11062
    :try_start_1
    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->startLaunchedLocked()V

    .line 11063
    monitor-exit v1
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 11064
    :try_start_2
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v1, v1, Landroid/content/pm/ServiceInfo;->packageName:Ljava/lang/String;

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 11065
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    invoke-interface {v1, p1, v2}, Landroid/app/IApplicationThread;->scheduleCreateService(Landroid/os/IBinder;Landroid/content/pm/ServiceInfo;)V

    .line 11066
    invoke-virtual {p1}, Lcom/android/server/am/ServiceRecord;->postNotification()V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 11067
    const/4 v0, 0x1

    .line 11069
    if-nez v0, :cond_1

    .line 11070
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v1, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11071
    invoke-direct {p0, p1, v6}, Lcom/android/server/am/ActivityManagerService;->scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;Z)Z

    .line 11075
    :cond_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingsLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11080
    iget-boolean v1, p1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    if-eqz v1, :cond_3

    iget-boolean v1, p1, Lcom/android/server/am/ServiceRecord;->callStart:Z

    if-eqz v1, :cond_3

    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-nez v1, :cond_3

    .line 11081
    iget v1, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    add-int/lit8 v1, v1, 0x1

    iput v1, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    .line 11082
    iget v1, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    if-ge v1, v5, :cond_2

    .line 11083
    iput v5, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    .line 11085
    :cond_2
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    new-instance v2, Lcom/android/server/am/ServiceRecord$StartItem;

    iget v3, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    const/4 v4, 0x0

    invoke-direct {v2, v3, v4}, Lcom/android/server/am/ServiceRecord$StartItem;-><init>(ILandroid/content/Intent;)V

    invoke-virtual {v1, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11088
    :cond_3
    invoke-direct {p0, p1, v5}, Lcom/android/server/am/ActivityManagerService;->sendServiceArgsLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11089
    return-void

    .line 11063
    :catchall_0
    move-exception v2

    :try_start_3
    monitor-exit v1
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    :try_start_4
    throw v2
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 11069
    :catchall_1
    move-exception v1

    if-nez v0, :cond_4

    .line 11070
    iget-object v2, p2, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v2, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11071
    invoke-direct {p0, p1, v6}, Lcom/android/server/am/ActivityManagerService;->scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;Z)Z

    :cond_4
    throw v1
.end method

.method private final relaunchActivityLocked(Lcom/android/server/am/HistoryRecord;IZ)Z
    .locals 11
    .parameter "r"
    .parameter "changes"
    .parameter "andResume"

    .prologue
    const/4 v10, 0x0

    const/4 v9, 0x1

    const/4 v8, 0x0

    .line 13616
    const/4 v2, 0x0

    .line 13617
    .local v2, results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    const/4 v3, 0x0

    .line 13618
    .local v3, newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    if-eqz p3, :cond_0

    .line 13619
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 13620
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 13625
    :cond_0
    if-eqz p3, :cond_2

    const/16 v0, 0x7543

    :goto_0
    const/4 v1, 0x3

    new-array v1, v1, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v1, v8

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v4, v4, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v1, v9

    const/4 v4, 0x2

    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v5, v1, v4

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 13629
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {p1, v0, v8}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 13633
    :try_start_0
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez p3, :cond_3

    move v5, v9

    :goto_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v1, p1

    move v4, p2

    invoke-interface/range {v0 .. v6}, Landroid/app/IApplicationThread;->scheduleRelaunchActivity(Landroid/os/IBinder;Ljava/util/List;Ljava/util/List;IZLandroid/content/res/Configuration;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 13642
    if-eqz p3, :cond_1

    .line 13643
    iput-object v10, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 13644
    iput-object v10, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 13645
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->reportResumedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    :cond_1
    move v0, v9

    .line 13648
    :goto_2
    return v0

    .line 13625
    :cond_2
    const/16 v0, 0x7544

    goto :goto_0

    :cond_3
    move v5, v8

    .line 13633
    goto :goto_1

    .line 13638
    :catch_0
    move-exception v0

    move-object v7, v0

    .local v7, e:Landroid/os/RemoteException;
    move v0, v8

    .line 13639
    goto :goto_2
.end method

.method private final removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 2
    .parameter "r"

    .prologue
    .line 4480
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v0, v1, :cond_0

    .line 4481
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4482
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 4483
    sget-object v0, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4484
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v0, p1}, Lcom/android/server/WindowManagerService;->removeAppToken(Landroid/os/IBinder;)V

    .line 4488
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityServicesLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4489
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->removeActivityUriPermissionsLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4491
    :cond_0
    return-void
.end method

.method private removeActivityUriPermissionsLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 3
    .parameter "activity"

    .prologue
    .line 6619
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    if-eqz v2, :cond_1

    .line 6620
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .local v0, i$:Ljava/util/Iterator;
    :cond_0
    :goto_0
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_1

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/UriPermission;

    .line 6621
    .local v1, perm:Lcom/android/server/am/UriPermission;
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->readActivities:Ljava/util/HashSet;

    invoke-virtual {v2, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 6622
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->readActivities:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->size()I

    move-result v2

    if-nez v2, :cond_0

    iget v2, v1, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    and-int/lit8 v2, v2, 0x1

    if-nez v2, :cond_0

    .line 6624
    iget v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/lit8 v2, v2, -0x2

    iput v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    .line 6625
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->removeUriPermissionIfNeededLocked(Lcom/android/server/am/UriPermission;)V

    goto :goto_0

    .line 6629
    .end local v0           #i$:Ljava/util/Iterator;
    .end local v1           #perm:Lcom/android/server/am/UriPermission;
    :cond_1
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    if-eqz v2, :cond_3

    .line 6630
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .restart local v0       #i$:Ljava/util/Iterator;
    :cond_2
    :goto_1
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_3

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/UriPermission;

    .line 6631
    .restart local v1       #perm:Lcom/android/server/am/UriPermission;
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->writeActivities:Ljava/util/HashSet;

    invoke-virtual {v2, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 6632
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->writeActivities:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->size()I

    move-result v2

    if-nez v2, :cond_2

    iget v2, v1, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    and-int/lit8 v2, v2, 0x2

    if-nez v2, :cond_2

    .line 6634
    iget v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/lit8 v2, v2, -0x3

    iput v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    .line 6635
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->removeUriPermissionIfNeededLocked(Lcom/android/server/am/UriPermission;)V

    goto :goto_1

    .line 6639
    .end local v0           #i$:Ljava/util/Iterator;
    .end local v1           #perm:Lcom/android/server/am/UriPermission;
    :cond_3
    return-void
.end method

.method private removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V
    .locals 8
    .parameter "c"
    .parameter "skipApp"
    .parameter "skipAct"

    .prologue
    const/4 v7, 0x0

    .line 11762
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v4}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v1

    .line 11763
    .local v1, binder:Landroid/os/IBinder;
    iget-object v0, p1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    .line 11764
    .local v0, b:Lcom/android/server/am/AppBindRecord;
    iget-object v3, v0, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    .line 11765
    .local v3, s:Lcom/android/server/am/ServiceRecord;
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v4, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11766
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11767
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    if-eqz v4, :cond_0

    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    if-eq v4, p3, :cond_0

    .line 11768
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    iget-object v4, v4, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    if-eqz v4, :cond_0

    .line 11769
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    iget-object v4, v4, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11772
    :cond_0
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    if-eq v4, p2, :cond_1

    .line 11773
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11775
    :cond_1
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v4, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11777
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4}, Ljava/util/HashSet;->size()I

    move-result v4

    if-nez v4, :cond_2

    .line 11778
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v4, v4, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    iget-object v5, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11783
    :cond_2
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v4, :cond_3

    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v4, :cond_3

    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v4, v4, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v4}, Ljava/util/HashMap;->size()I

    move-result v4

    if-nez v4, :cond_3

    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-boolean v4, v4, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    if-eqz v4, :cond_3

    .line 11786
    :try_start_0
    invoke-direct {p0, v3}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11787
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11788
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    .line 11791
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/IntentBindRecord;->doRebind:Z

    .line 11792
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v5, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v5, v5, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v5}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v5

    invoke-interface {v4, v3, v5}, Landroid/app/IApplicationThread;->scheduleUnbindService(Landroid/os/IBinder;Landroid/content/Intent;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 11799
    :cond_3
    :goto_0
    iget v4, p1, Lcom/android/server/am/ConnectionRecord;->flags:I

    and-int/lit8 v4, v4, 0x1

    if-eqz v4, :cond_4

    .line 11800
    invoke-direct {p0, v3, v7}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11802
    :cond_4
    return-void

    .line 11793
    :catch_0
    move-exception v4

    move-object v2, v4

    .line 11794
    .local v2, e:Ljava/lang/Exception;
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Exception when unbinding service "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 11795
    const/4 v4, 0x1

    invoke-virtual {p0, v3, v4}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto :goto_0
.end method

.method private removeContentProviderExternal(Ljava/lang/String;)V
    .locals 5
    .parameter "name"

    .prologue
    .line 8089
    monitor-enter p0

    .line 8090
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v2, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ContentProviderRecord;

    .line 8091
    .local v0, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v0, :cond_0

    .line 8094
    monitor-exit p0

    .line 8105
    :goto_0
    return-void

    .line 8098
    :cond_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v3, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v3, v3, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 8099
    .local v1, localCpr:Lcom/android/server/am/ContentProviderRecord;
    iget v2, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I

    const/4 v3, 0x1

    sub-int/2addr v2, v3

    iput v2, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I

    .line 8100
    iget v2, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I

    if-gez v2, :cond_1

    .line 8101
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Externals < 0 for content provider "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 8103
    :cond_1
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 8104
    monitor-exit p0

    goto :goto_0

    .end local v0           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v1           #localCpr:Lcom/android/server/am/ContentProviderRecord;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method private final removeDyingProviderLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/ContentProviderRecord;)V
    .locals 9
    .parameter "proc"
    .parameter "cpr"

    .prologue
    .line 10490
    monitor-enter p2

    .line 10491
    const/4 v4, 0x0

    :try_start_0
    iput-object v4, p2, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    .line 10492
    invoke-virtual {p2}, Ljava/lang/Object;->notifyAll()V

    .line 10493
    monitor-exit p2
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 10495
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v5, p2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v5, v5, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 10496
    iget-object v4, p2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v4, v4, Landroid/content/pm/ProviderInfo;->authority:Ljava/lang/String;

    const-string v5, ";"

    invoke-virtual {v4, v5}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v3

    .line 10497
    .local v3, names:[Ljava/lang/String;
    const/4 v2, 0x0

    .local v2, j:I
    :goto_0
    array-length v4, v3

    if-ge v2, v4, :cond_0

    .line 10498
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    aget-object v5, v3, v2

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 10497
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    .line 10493
    .end local v2           #j:I
    .end local v3           #names:[Ljava/lang/String;
    :catchall_0
    move-exception v4

    :try_start_1
    monitor-exit p2
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v4

    .line 10501
    .restart local v2       #j:I
    .restart local v3       #names:[Ljava/lang/String;
    :cond_0
    iget-object v4, p2, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    invoke-virtual {v4}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 10502
    .local v1, cit:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ProcessRecord;>;"
    :cond_1
    :goto_1
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_2

    .line 10503
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .line 10504
    .local v0, capp:Lcom/android/server/am/ProcessRecord;
    iget-boolean v4, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v4, :cond_1

    iget-object v4, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v4, :cond_1

    iget v4, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eqz v4, :cond_1

    iget v4, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v4, v5, :cond_1

    .line 10507
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Kill "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget v6, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "): provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, p2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v6, v6, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " in dying process "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 10510
    const/16 v4, 0x7547

    const/4 v5, 0x4

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    iget v7, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x1

    iget-object v7, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v7, v5, v6

    const/4 v6, 0x2

    iget v7, v0, Lcom/android/server/am/ProcessRecord;->setAdj:I

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x3

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "dying provider "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    aput-object v7, v5, v6

    invoke-static {v4, v5}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 10512
    iget v4, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v4}, Landroid/os/Process;->killProcess(I)V

    goto/16 :goto_1

    .line 10516
    .end local v0           #capp:Lcom/android/server/am/ProcessRecord;
    :cond_2
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v4, p2}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10517
    return-void
.end method

.method private static removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V
    .locals 3
    .parameter "list"
    .parameter "app"

    .prologue
    .line 4579
    invoke-virtual {p0}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 4583
    .local v0, i:I
    :cond_0
    :goto_0
    if-lez v0, :cond_1

    .line 4584
    add-int/lit8 v0, v0, -0x1

    .line 4585
    invoke-virtual {p0, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4588
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v2, p1, :cond_0

    .line 4590
    invoke-virtual {p0, v0}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    goto :goto_0

    .line 4593
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    return-void
.end method

.method private final removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z
    .locals 7
    .parameter "app"
    .parameter "callerWillRestart"

    .prologue
    .line 5375
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    .line 5376
    .local v0, name:Ljava/lang/String;
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v3, v4, Landroid/content/pm/ApplicationInfo;->uid:I

    .line 5381
    .local v3, uid:I
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v4, v0, v3}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 5382
    const/4 v1, 0x0

    .line 5383
    .local v1, needRestart:Z
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v4, :cond_2

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v4, v5, :cond_2

    .line 5384
    iget v2, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 5385
    .local v2, pid:I
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v4

    .line 5386
    :try_start_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v5, v2}, Landroid/util/SparseArray;->remove(I)V

    .line 5387
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v6, 0x14

    invoke-virtual {v5, v6, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5388
    monitor-exit v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5389
    const/4 v4, 0x1

    invoke-direct {p0, p1, v4}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 5390
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5391
    invoke-static {v2}, Landroid/os/Process;->killProcess(I)V

    .line 5393
    iget-boolean v4, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v4, :cond_0

    .line 5394
    if-nez p2, :cond_1

    .line 5395
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {p0, v4}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;

    .line 5404
    .end local v2           #pid:I
    :cond_0
    :goto_0
    return v1

    .line 5388
    .restart local v2       #pid:I
    :catchall_0
    move-exception v5

    :try_start_1
    monitor-exit v4
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v5

    .line 5397
    :cond_1
    const/4 v1, 0x1

    goto :goto_0

    .line 5401
    .end local v2           #pid:I
    :cond_2
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_0
.end method

.method private removeUriPermissionIfNeededLocked(Lcom/android/server/am/UriPermission;)V
    .locals 3
    .parameter "perm"

    .prologue
    .line 6603
    iget v1, p1, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/lit8 v1, v1, 0x3

    if-nez v1, :cond_0

    .line 6605
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    iget v2, p1, Lcom/android/server/am/UriPermission;->uid:I

    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/util/HashMap;

    .line 6607
    .local v0, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    if-eqz v0, :cond_0

    .line 6610
    iget-object v1, p1, Lcom/android/server/am/UriPermission;->uri:Landroid/net/Uri;

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6611
    invoke-virtual {v0}, Ljava/util/HashMap;->size()I

    move-result v1

    if-nez v1, :cond_0

    .line 6612
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    iget v2, p1, Lcom/android/server/am/UriPermission;->uid:I

    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->remove(I)V

    .line 6616
    .end local v0           #perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    :cond_0
    return-void
.end method

.method private reportResumedActivityLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 4
    .parameter "r"

    .prologue
    .line 2571
    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v1

    .line 2572
    .local v1, identHash:I
    const/4 v3, 0x1

    invoke-direct {p0, p1, v3}, Lcom/android/server/am/ActivityManagerService;->updateUsageStats(Lcom/android/server/am/HistoryRecord;Z)V

    .line 2574
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->beginBroadcast()I

    move-result v0

    .line 2575
    .local v0, i:I
    :cond_0
    :goto_0
    if-lez v0, :cond_1

    .line 2576
    add-int/lit8 v0, v0, -0x1

    .line 2577
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v3, v0}, Landroid/os/RemoteCallbackList;->getBroadcastItem(I)Landroid/os/IInterface;

    move-result-object v2

    check-cast v2, Landroid/app/IActivityWatcher;

    .line 2578
    .local v2, w:Landroid/app/IActivityWatcher;
    if-eqz v2, :cond_0

    .line 2580
    :try_start_0
    invoke-interface {v2, v1}, Landroid/app/IActivityWatcher;->activityResuming(I)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 2581
    :catch_0
    move-exception v3

    goto :goto_0

    .line 2585
    .end local v2           #w:Landroid/app/IActivityWatcher;
    :cond_1
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->finishBroadcast()V

    .line 2586
    return-void
.end method

.method private reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V
    .locals 5
    .parameter "watcher"
    .parameter "cn"
    .parameter "report"

    .prologue
    const-string v4, "ActivityManager"

    .line 13416
    const-string v2, "ActivityManager"

    invoke-static {v4, p3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13418
    if-eqz p1, :cond_0

    .line 13419
    :try_start_0
    new-instance v1, Landroid/os/Bundle;

    invoke-direct {v1}, Landroid/os/Bundle;-><init>()V

    .line 13420
    .local v1, results:Landroid/os/Bundle;
    const-string v2, "id"

    const-string v3, "ActivityManagerService"

    invoke-virtual {v1, v2, v3}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 13421
    const-string v2, "Error"

    invoke-virtual {v1, v2, p3}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 13422
    const/4 v2, -0x1

    invoke-interface {p1, p2, v2, v1}, Landroid/app/IInstrumentationWatcher;->instrumentationStatus(Landroid/content/ComponentName;ILandroid/os/Bundle;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 13427
    .end local v1           #results:Landroid/os/Bundle;
    :cond_0
    :goto_0
    return-void

    .line 13424
    :catch_0
    move-exception v2

    move-object v0, v2

    .line 13425
    .local v0, e:Landroid/os/RemoteException;
    const-string v2, "ActivityManager"

    invoke-static {v4, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_0
.end method

.method private final requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z
    .locals 10
    .parameter "token"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "reason"

    .prologue
    const/4 v9, 0x1

    const/4 v4, 0x0

    .line 4090
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v2

    .line 4091
    .local v2, index:I
    if-gez v2, :cond_0

    move v0, v4

    .line 4119
    :goto_0
    return v0

    .line 4094
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4097
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    const/4 v7, 0x1

    .line 4098
    .local v7, lastActivity:Z
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    sub-int v6, v0, v9

    .local v6, i:I
    :goto_1
    if-ltz v6, :cond_1

    .line 4099
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/am/HistoryRecord;

    .line 4100
    .local v8, p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v0, v8, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_2

    if-eq v8, v1, :cond_2

    .line 4101
    const/4 v7, 0x0

    .line 4108
    .end local v8           #p:Lcom/android/server/am/HistoryRecord;
    :cond_1
    if-eqz v7, :cond_3

    .line 4109
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    const-string v3, "android.intent.category.HOME"

    invoke-virtual {v0, v3}, Landroid/content/Intent;->hasCategory(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_3

    move v0, v4

    .line 4110
    goto :goto_0

    .line 4098
    .restart local v8       #p:Lcom/android/server/am/HistoryRecord;
    :cond_2
    add-int/lit8 v6, v6, -0x1

    goto :goto_1

    .end local v8           #p:Lcom/android/server/am/HistoryRecord;
    :cond_3
    move-object v0, p0

    move v3, p2

    move-object v4, p3

    move-object v5, p4

    .line 4114
    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 4117
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    iget-object v3, v1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v3}, Lcom/android/server/WindowManagerService;->initializeHoldMode(Ljava/lang/String;)V

    move v0, v9

    .line 4119
    goto :goto_0
.end method

.method private final requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z
    .locals 5
    .parameter "r"
    .parameter "i"
    .parameter "rebind"

    .prologue
    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 11007
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_0

    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v1, :cond_1

    :cond_0
    move v1, v3

    .line 11026
    :goto_0
    return v1

    .line 11011
    :cond_1
    iget-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->requested:Z

    if-eqz v1, :cond_2

    if-eqz p3, :cond_4

    :cond_2
    iget-object v1, p2, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->size()I

    move-result v1

    if-lez v1, :cond_4

    .line 11013
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 11016
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v2, p2, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v2}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v2

    invoke-interface {v1, p1, v2, p3}, Landroid/app/IApplicationThread;->scheduleBindService(Landroid/os/IBinder;Landroid/content/Intent;Z)V

    .line 11017
    if-nez p3, :cond_3

    .line 11018
    const/4 v1, 0x1

    iput-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->requested:Z

    .line 11020
    :cond_3
    const/4 v1, 0x1

    iput-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    .line 11021
    const/4 v1, 0x0

    iput-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->doRebind:Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    :cond_4
    move v1, v4

    .line 11026
    goto :goto_0

    .line 11022
    :catch_0
    move-exception v1

    move-object v0, v1

    .local v0, e:Landroid/os/RemoteException;
    move v1, v3

    .line 11023
    goto :goto_0
.end method

.method private final requestServiceBindingsLocked(Lcom/android/server/am/ServiceRecord;)V
    .locals 3
    .parameter "r"

    .prologue
    .line 11030
    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .line 11031
    .local v0, bindings:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :cond_0
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_1

    .line 11032
    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/IntentBindRecord;

    .line 11033
    .local v1, i:Lcom/android/server/am/IntentBindRecord;
    const/4 v2, 0x0

    invoke-direct {p0, p1, v1, v2}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z

    move-result v2

    if-nez v2, :cond_0

    .line 11037
    .end local v1           #i:Lcom/android/server/am/IntentBindRecord;
    :cond_1
    return-void
.end method

.method private final resetTaskIfNeededLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;
    .locals 26
    .parameter "taskTop"
    .parameter "newActivity"

    .prologue
    .line 7028
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget v3, v3, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v3, v3, 0x4

    if-eqz v3, :cond_1

    const/4 v3, 0x1

    move/from16 v18, v3

    .line 7030
    .local v18, forceReset:Z
    :goto_0
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/am/TaskRecord;->getInactiveDuration()J

    move-result-wide v6

    const-wide/32 v8, 0x1b7740

    cmp-long v3, v6, v8

    if-lez v3, :cond_0

    .line 7031
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget v3, v3, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v3, v3, 0x8

    if-nez v3, :cond_0

    .line 7033
    const/16 v18, 0x1

    .line 7037
    :cond_0
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object/from16 v24, v0

    .line 7042
    .local v24, task:Lcom/android/server/am/TaskRecord;
    const/16 v22, 0x0

    .line 7043
    .local v22, target:Lcom/android/server/am/HistoryRecord;
    const/16 v23, 0x0

    .line 7044
    .local v23, targetI:I
    const/16 v25, -0x1

    .line 7045
    .local v25, taskTopI:I
    const/16 v21, -0x1

    .line 7046
    .local v21, replyChainEnd:I
    const/16 v20, -0x1

    .line 7047
    .local v20, lastReparentPos:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v19, v3, v4

    .end local p2
    .local v19, i:I
    :goto_1
    const/4 v3, -0x1

    move/from16 v0, v19

    move v1, v3

    if-lt v0, v1, :cond_2d

    .line 7048
    if-ltz v19, :cond_2

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v13, p2

    .line 7050
    .local v13, below:Lcom/android/server/am/HistoryRecord;
    :goto_2
    if-eqz v13, :cond_3

    iget-boolean v3, v13, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_3

    .line 7047
    :goto_3
    add-int/lit8 v19, v19, -0x1

    goto :goto_1

    .line 7028
    .end local v13           #below:Lcom/android/server/am/HistoryRecord;
    .end local v18           #forceReset:Z
    .end local v19           #i:I
    .end local v20           #lastReparentPos:I
    .end local v21           #replyChainEnd:I
    .end local v22           #target:Lcom/android/server/am/HistoryRecord;
    .end local v23           #targetI:I
    .end local v24           #task:Lcom/android/server/am/TaskRecord;
    .end local v25           #taskTopI:I
    .restart local p2
    :cond_1
    const/4 v3, 0x0

    move/from16 v18, v3

    goto :goto_0

    .line 7048
    .end local p2
    .restart local v18       #forceReset:Z
    .restart local v19       #i:I
    .restart local v20       #lastReparentPos:I
    .restart local v21       #replyChainEnd:I
    .restart local v22       #target:Lcom/android/server/am/HistoryRecord;
    .restart local v23       #targetI:I
    .restart local v24       #task:Lcom/android/server/am/TaskRecord;
    .restart local v25       #taskTopI:I
    :cond_2
    const/4 v3, 0x0

    move-object v13, v3

    goto :goto_2

    .line 7053
    .restart local v13       #below:Lcom/android/server/am/HistoryRecord;
    :cond_3
    if-nez v22, :cond_4

    .line 7054
    move-object/from16 v22, v13

    .line 7055
    move/from16 v23, v19

    .line 7059
    const/16 v21, -0x1

    .line 7060
    goto :goto_3

    .line 7063
    :cond_4
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    move-object v0, v3

    iget v0, v0, Landroid/content/pm/ActivityInfo;->flags:I

    move/from16 v17, v0

    .line 7065
    .local v17, flags:I
    and-int/lit8 v3, v17, 0x2

    if-eqz v3, :cond_7

    const/4 v3, 0x1

    move/from16 v16, v3

    .line 7067
    .local v16, finishOnTaskLaunch:Z
    :goto_4
    and-int/lit8 v3, v17, 0x40

    if-eqz v3, :cond_8

    const/4 v3, 0x1

    move v12, v3

    .line 7070
    .local v12, allowTaskReparenting:Z
    :goto_5
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v24

    if-ne v0, v1, :cond_1f

    .line 7076
    if-gez v25, :cond_5

    .line 7077
    move/from16 v25, v23

    .line 7079
    :cond_5
    if-eqz v13, :cond_1e

    iget-object v3, v13, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v0, v3

    move-object/from16 v1, v24

    if-ne v0, v1, :cond_1e

    .line 7080
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/high16 v4, 0x8

    and-int/2addr v3, v4

    if-eqz v3, :cond_9

    const/4 v3, 0x1

    move v14, v3

    .line 7083
    .local v14, clearWhenTaskReset:Z
    :goto_6
    if-nez v16, :cond_a

    if-nez v14, :cond_a

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v3, v0

    if-eqz v3, :cond_a

    .line 7090
    if-gez v21, :cond_6

    .line 7091
    move/from16 v21, v23

    .line 7302
    .end local v14           #clearWhenTaskReset:Z
    :cond_6
    :goto_7
    move-object/from16 v22, v13

    .line 7303
    move/from16 v23, v19

    goto :goto_3

    .line 7065
    .end local v12           #allowTaskReparenting:Z
    .end local v16           #finishOnTaskLaunch:Z
    :cond_7
    const/4 v3, 0x0

    move/from16 v16, v3

    goto :goto_4

    .line 7067
    .restart local v16       #finishOnTaskLaunch:Z
    :cond_8
    const/4 v3, 0x0

    move v12, v3

    goto :goto_5

    .line 7080
    .restart local v12       #allowTaskReparenting:Z
    :cond_9
    const/4 v3, 0x0

    move v14, v3

    goto :goto_6

    .line 7093
    .restart local v14       #clearWhenTaskReset:Z
    :cond_a
    if-nez v16, :cond_13

    if-nez v14, :cond_13

    if-eqz v12, :cond_13

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    if-eqz v3, :cond_13

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_13

    .line 7102
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    const/4 v4, 0x0

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7103
    .local v4, p:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    if-eqz v3, :cond_c

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {v3, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_c

    .line 7108
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v0, v3

    move-object/from16 v1, v22

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7122
    :goto_8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, v24

    iget v0, v0, Lcom/android/server/am/TaskRecord;->taskId:I

    move v5, v0

    move-object v0, v3

    move-object/from16 v1, v22

    move v2, v5

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->setAppGroupId(Landroid/os/IBinder;I)V

    .line 7123
    if-gez v21, :cond_b

    .line 7124
    move/from16 v21, v23

    .line 7126
    :cond_b
    const/4 v15, 0x0

    .line 7127
    .local v15, dstPos:I
    move/from16 v5, v23

    .local v5, srcPos:I
    :goto_9
    move v0, v5

    move/from16 v1, v21

    if-gt v0, v1, :cond_10

    .line 7128
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7129
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_f

    .line 7127
    :goto_a
    add-int/lit8 v5, v5, 0x1

    goto :goto_9

    .line 7112
    .end local v5           #srcPos:I
    .end local v15           #dstPos:I
    :cond_c
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v3, v0

    add-int/lit8 v3, v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 7113
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v3, v0

    if-gtz v3, :cond_d

    .line 7114
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 7116
    :cond_d
    new-instance v3, Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v5, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    const/4 v7, 0x0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v8, v8, 0x4

    if-eqz v8, :cond_e

    const/4 v8, 0x1

    :goto_b
    invoke-direct {v3, v5, v6, v7, v8}, Lcom/android/server/am/TaskRecord;-><init>(ILandroid/content/pm/ActivityInfo;Landroid/content/Intent;Z)V

    move-object v0, v3

    move-object/from16 v1, v22

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7118
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    iput-object v5, v3, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;

    goto :goto_8

    .line 7116
    :cond_e
    const/4 v8, 0x0

    goto :goto_b

    .line 7134
    .restart local v5       #srcPos:I
    .restart local v15       #dstPos:I
    :cond_f
    move-object/from16 v0, v24

    iget v0, v0, Lcom/android/server/am/TaskRecord;->numActivities:I

    move v3, v0

    const/4 v6, 0x1

    sub-int/2addr v3, v6

    move v0, v3

    move-object/from16 v1, v24

    iput v0, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 7135
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iput-object v3, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7136
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iget v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    add-int/lit8 v6, v6, 0x1

    iput v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 7137
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7138
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v15, v4}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7139
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    invoke-virtual {v3, v15, v4}, Lcom/android/server/WindowManagerService;->moveAppToken(ILandroid/os/IBinder;)V

    .line 7140
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-virtual {v3, v4, v6}, Lcom/android/server/WindowManagerService;->setAppGroupId(Landroid/os/IBinder;I)V

    .line 7141
    add-int/lit8 v15, v15, 0x1

    .line 7145
    add-int/lit8 v19, v19, 0x1

    goto/16 :goto_a

    .line 7147
    :cond_10
    move-object/from16 v0, p1

    move-object v1, v4

    if-ne v0, v1, :cond_11

    .line 7148
    move-object/from16 p1, v13

    .line 7150
    :cond_11
    move/from16 v0, v25

    move/from16 v1, v21

    if-ne v0, v1, :cond_12

    .line 7151
    const/16 v25, -0x1

    .line 7153
    :cond_12
    const/16 v21, -0x1

    .line 7154
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addRecentTaskLocked(Lcom/android/server/am/TaskRecord;)V

    goto/16 :goto_7

    .line 7155
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    .end local v15           #dstPos:I
    :cond_13
    if-nez v18, :cond_14

    if-nez v16, :cond_14

    if-eqz v14, :cond_1d

    .line 7161
    :cond_14
    if-eqz v14, :cond_18

    .line 7165
    add-int/lit8 v21, v23, 0x1

    .line 7168
    :goto_c
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    move/from16 v0, v21

    move v1, v3

    if-ge v0, v1, :cond_15

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v24

    if-ne v0, v1, :cond_15

    .line 7169
    add-int/lit8 v21, v21, 0x1

    goto :goto_c

    .line 7171
    :cond_15
    add-int/lit8 v21, v21, -0x1

    .line 7175
    :cond_16
    :goto_d
    const/4 v4, 0x0

    .line 7176
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    move/from16 v5, v23

    .restart local v5       #srcPos:I
    :goto_e
    move v0, v5

    move/from16 v1, v21

    if-gt v0, v1, :cond_1a

    .line 7177
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7178
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_19

    .line 7176
    :cond_17
    :goto_f
    add-int/lit8 v5, v5, 0x1

    goto :goto_e

    .line 7172
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    :cond_18
    if-gez v21, :cond_16

    .line 7173
    move/from16 v21, v23

    goto :goto_d

    .line 7181
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    .restart local v5       #srcPos:I
    :cond_19
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "reset"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_17

    .line 7183
    add-int/lit8 v21, v21, -0x1

    .line 7184
    add-int/lit8 v5, v5, -0x1

    goto :goto_f

    .line 7187
    :cond_1a
    move-object/from16 v0, p1

    move-object v1, v4

    if-ne v0, v1, :cond_1b

    .line 7188
    move-object/from16 p1, v13

    .line 7190
    :cond_1b
    move/from16 v0, v25

    move/from16 v1, v21

    if-ne v0, v1, :cond_1c

    .line 7191
    const/16 v25, -0x1

    .line 7193
    :cond_1c
    const/16 v21, -0x1

    .line 7194
    goto/16 :goto_7

    .line 7198
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    :cond_1d
    const/16 v21, -0x1

    goto/16 :goto_7

    .line 7203
    .end local v14           #clearWhenTaskReset:Z
    :cond_1e
    const/16 v21, -0x1

    goto/16 :goto_7

    .line 7206
    :cond_1f
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v3, v0

    if-eqz v3, :cond_20

    .line 7213
    if-gez v21, :cond_6

    .line 7214
    move/from16 v21, v23

    goto/16 :goto_7

    .line 7217
    :cond_20
    if-ltz v25, :cond_6

    if-eqz v12, :cond_6

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    move-object v3, v0

    if-eqz v3, :cond_6

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    move-object v3, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_6

    .line 7231
    if-nez v18, :cond_21

    if-eqz v16, :cond_26

    .line 7232
    :cond_21
    if-gez v21, :cond_22

    .line 7233
    move/from16 v21, v23

    .line 7235
    :cond_22
    const/4 v4, 0x0

    .line 7236
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    move/from16 v5, v23

    .restart local v5       #srcPos:I
    :goto_10
    move v0, v5

    move/from16 v1, v21

    if-gt v0, v1, :cond_25

    .line 7237
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7238
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_24

    .line 7236
    :cond_23
    :goto_11
    add-int/lit8 v5, v5, 0x1

    goto :goto_10

    .line 7241
    :cond_24
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "reset"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_23

    .line 7243
    add-int/lit8 v25, v25, -0x1

    .line 7244
    add-int/lit8 v20, v20, -0x1

    .line 7245
    add-int/lit8 v21, v21, -0x1

    .line 7246
    add-int/lit8 v5, v5, -0x1

    goto :goto_11

    .line 7249
    :cond_25
    const/16 v21, -0x1

    .line 7250
    goto/16 :goto_7

    .line 7251
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    :cond_26
    if-gez v21, :cond_27

    .line 7252
    move/from16 v21, v23

    .line 7254
    :cond_27
    move/from16 v5, v21

    .restart local v5       #srcPos:I
    :goto_12
    move v0, v5

    move/from16 v1, v23

    if-lt v0, v1, :cond_2a

    .line 7255
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7256
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_28

    .line 7254
    :goto_13
    add-int/lit8 v5, v5, -0x1

    goto :goto_12

    .line 7259
    :cond_28
    if-gez v20, :cond_29

    .line 7260
    move/from16 v20, v25

    .line 7261
    move-object/from16 p1, v4

    .line 7265
    :goto_14
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7266
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    const/4 v7, 0x1

    sub-int/2addr v6, v7

    iput v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 7267
    move-object/from16 v0, v24

    move-object v1, v4

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7268
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v20

    move-object v2, v4

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7271
    move-object/from16 v0, v24

    iget v0, v0, Lcom/android/server/am/TaskRecord;->numActivities:I

    move v3, v0

    add-int/lit8 v3, v3, 0x1

    move v0, v3

    move-object/from16 v1, v24

    iput v0, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 7272
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v20

    move-object v2, v4

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->moveAppToken(ILandroid/os/IBinder;)V

    .line 7273
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-virtual {v3, v4, v6}, Lcom/android/server/WindowManagerService;->setAppGroupId(Landroid/os/IBinder;I)V

    goto :goto_13

    .line 7263
    :cond_29
    add-int/lit8 v20, v20, -0x1

    goto :goto_14

    .line 7278
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    :cond_2a
    const/16 v21, -0x1

    .line 7284
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget v3, v3, Landroid/content/pm/ActivityInfo;->launchMode:I

    const/4 v4, 0x1

    if-ne v3, v4, :cond_6

    .line 7285
    const/4 v3, 0x1

    sub-int v8, v20, v3

    .end local v5           #srcPos:I
    .local v8, j:I
    :goto_15
    if-ltz v8, :cond_6

    .line 7286
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7287
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_2c

    .line 7285
    :cond_2b
    :goto_16
    add-int/lit8 v8, v8, -0x1

    goto :goto_15

    .line 7290
    :cond_2c
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v3}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v3

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v3, v5}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_2b

    .line 7291
    const/4 v9, 0x0

    const/4 v10, 0x0

    const-string v11, "replace"

    move-object/from16 v6, p0

    move-object v7, v4

    invoke-direct/range {v6 .. v11}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_2b

    .line 7293
    add-int/lit8 v25, v25, -0x1

    .line 7294
    add-int/lit8 v20, v20, -0x1

    goto :goto_16

    .line 7306
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v8           #j:I
    .end local v12           #allowTaskReparenting:Z
    .end local v13           #below:Lcom/android/server/am/HistoryRecord;
    .end local v16           #finishOnTaskLaunch:Z
    .end local v17           #flags:I
    :cond_2d
    return-object p1
.end method

.method private final resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z
    .locals 23
    .parameter "prev"

    .prologue
    .line 2599
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v6

    .line 2603
    .local v6, next:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    move/from16 v22, v0

    .line 2604
    .local v22, userLeaving:Z
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 2606
    if-nez v6, :cond_0

    .line 2609
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->startHomeActivityLocked()Z

    move-result v5

    .line 2857
    .end local v6           #next:Lcom/android/server/am/HistoryRecord;
    :goto_0
    return v5

    .line 2612
    .restart local v6       #next:Lcom/android/server/am/HistoryRecord;
    :cond_0
    const/4 v5, 0x0

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->delayedResume:Z

    .line 2615
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-ne v5, v6, :cond_1

    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v5, v7, :cond_1

    .line 2618
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2619
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    .line 2620
    const/4 v5, 0x0

    goto :goto_0

    .line 2625
    :cond_1
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    move v5, v0

    if-nez v5, :cond_2

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    move v5, v0

    if-eqz v5, :cond_3

    :cond_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-ne v5, v6, :cond_3

    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v5, v7, :cond_3

    .line 2629
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2630
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    .line 2631
    const/4 v5, 0x0

    goto :goto_0

    .line 2636
    :cond_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2637
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2643
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_4

    .line 2645
    const/4 v5, 0x0

    goto :goto_0

    .line 2650
    :cond_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_5

    .line 2652
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move/from16 v1, v22

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->startPausingLocked(ZZ)V

    .line 2653
    const/4 v5, 0x1

    goto :goto_0

    .line 2656
    :cond_5
    if-eqz p1, :cond_6

    move-object/from16 v0, p1

    move-object v1, v6

    if-eq v0, v1, :cond_6

    .line 2657
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    move v5, v0

    if-nez v5, :cond_a

    if-eqz v6, :cond_a

    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-nez v5, :cond_a

    .line 2658
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    .line 2659
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2689
    :cond_6
    :goto_1
    if-eqz p1, :cond_10

    .line 2690
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v5, v0

    if-eqz v5, :cond_d

    .line 2693
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_b

    .line 2694
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 2700
    :goto_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->setAppWillBeHidden(Landroid/os/IBinder;)V

    .line 2701
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    move-object v0, v5

    move-object/from16 v1, p1

    move v2, v7

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2727
    :cond_7
    :goto_3
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v5, :cond_17

    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v5, :cond_17

    .line 2731
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x1

    invoke-virtual {v5, v6, v7}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2733
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object/from16 v18, v0

    .line 2734
    .local v18, lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    move-object v0, v6

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v19, v0

    .line 2736
    .local v19, lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 2738
    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v5, v6, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 2739
    move-object v0, v6

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2740
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-virtual {v5}, Lcom/android/server/am/TaskRecord;->touchActiveTime()V

    .line 2741
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v7, 0x1

    const/4 v8, 0x1

    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v7

    move v3, v8

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 2742
    move-object/from16 v0, p0

    move-object v1, v6

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 2747
    monitor-enter p0

    .line 2748
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v7, v0

    iget-object v8, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v6, v8}, Lcom/android/server/am/HistoryRecord;->mayFreezeScreenLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v8

    if-eqz v8, :cond_12

    move-object v8, v6

    :goto_4
    invoke-virtual {v5, v7, v8}, Lcom/android/server/WindowManagerService;->updateOrientationFromAppTokens(Landroid/content/res/Configuration;Landroid/os/IBinder;)Landroid/content/res/Configuration;

    move-result-object v16

    .line 2751
    .local v16, config:Landroid/content/res/Configuration;
    if-eqz v16, :cond_8

    .line 2752
    const/4 v5, 0x1

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->frozenBeforeDestroy:Z

    .line 2754
    :cond_8
    move-object/from16 v0, p0

    move-object/from16 v1, v16

    move-object v2, v6

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    move-result v21

    .line 2755
    .local v21, updated:Z
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 2756
    if-nez v21, :cond_13

    .line 2762
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v20

    .line 2766
    .local v20, nextNext:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v20

    move-object v1, v6

    if-eq v0, v1, :cond_9

    .line 2768
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v7, 0x13

    invoke-virtual {v5, v7}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    .line 2770
    :cond_9
    move-object/from16 v0, p0

    move-object v1, v6

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 2771
    const/4 v5, 0x0

    const/4 v6, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v6

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 2772
    .end local v6           #next:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2773
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    .line 2774
    const/4 v5, 0x1

    goto/16 :goto_0

    .line 2671
    .end local v16           #config:Landroid/content/res/Configuration;
    .end local v18           #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .end local v19           #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    .end local v20           #nextNext:Lcom/android/server/am/HistoryRecord;
    .end local v21           #updated:Z
    .restart local v6       #next:Lcom/android/server/am/HistoryRecord;
    :cond_a
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v5, v0

    if-eqz v5, :cond_6

    .line 2672
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    move-object v0, v5

    move-object/from16 v1, p1

    move v2, v7

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    goto/16 :goto_1

    .line 2696
    :cond_b
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v7, v0

    iget-object v8, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-ne v7, v8, :cond_c

    const/16 v7, 0x2007

    :goto_5
    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_2

    :cond_c
    const/16 v7, 0x2009

    goto :goto_5

    .line 2705
    :cond_d
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_e

    .line 2706
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_3

    .line 2708
    :cond_e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v7, v0

    iget-object v8, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-ne v7, v8, :cond_f

    const/16 v7, 0x1006

    :goto_6
    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_3

    :cond_f
    const/16 v7, 0x1008

    goto :goto_6

    .line 2717
    :cond_10
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    const/4 v7, 0x1

    if-le v5, v7, :cond_7

    .line 2720
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_11

    .line 2721
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_3

    .line 2723
    :cond_11
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/16 v7, 0x1006

    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_3

    .line 2748
    .restart local v18       #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .restart local v19       #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    :cond_12
    const/4 v8, 0x0

    goto/16 :goto_4

    .line 2755
    :catchall_0
    move-exception v5

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v5

    .line 2779
    .restart local v16       #config:Landroid/content/res/Configuration;
    .restart local v21       #updated:Z
    :cond_13
    :try_start_2
    iget-object v15, v6, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 2780
    .local v15, a:Ljava/util/ArrayList;
    if-eqz v15, :cond_14

    .line 2781
    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v14

    .line 2782
    .local v14, N:I
    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v5, :cond_14

    if-lez v14, :cond_14

    .line 2786
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v5, v6, v15}, Landroid/app/IApplicationThread;->scheduleSendResult(Landroid/os/IBinder;Ljava/util/List;)V

    .line 2790
    .end local v14           #N:I
    :cond_14
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    if-eqz v5, :cond_15

    .line 2791
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v7, v6, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    invoke-interface {v5, v7, v6}, Landroid/app/IApplicationThread;->scheduleNewIntent(Ljava/util/List;Landroid/os/IBinder;)V

    .line 2794
    :cond_15
    const/16 v5, 0x7537

    const/4 v7, 0x3

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    invoke-static {v6}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v9

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v9, v9, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x2

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v5, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 2798
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->isNextTransitionForward()Z

    move-result v7

    invoke-interface {v5, v6, v7}, Landroid/app/IApplicationThread;->scheduleResumeActivity(Landroid/os/IBinder;Z)V

    .line 2801
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V
    :try_end_2
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0

    .line 2825
    const/4 v5, 0x1

    :try_start_3
    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->visible:Z

    .line 2826
    move-object/from16 v0, p0

    move-object v1, v6

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->completeResumeLocked(Lcom/android/server/am/HistoryRecord;)V
    :try_end_3
    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_1

    .line 2837
    const/4 v5, 0x0

    iput-object v5, v6, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 2838
    const/4 v5, 0x0

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->haveState:Z

    .line 2839
    const/4 v5, 0x0

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 2857
    .end local v15           #a:Ljava/util/ArrayList;
    .end local v16           #config:Landroid/content/res/Configuration;
    .end local v18           #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .end local v19           #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    .end local v21           #updated:Z
    :goto_7
    const/4 v5, 0x1

    goto/16 :goto_0

    .line 2803
    .restart local v16       #config:Landroid/content/res/Configuration;
    .restart local v18       #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .restart local v19       #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    .restart local v21       #updated:Z
    :catch_0
    move-exception v5

    move-object/from16 v17, v5

    .line 2805
    .local v17, e:Ljava/lang/Exception;
    move-object/from16 v0, v19

    move-object v1, v6

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 2806
    move-object/from16 v0, v18

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2807
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Restarting because process died: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v5, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 2808
    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    if-nez v5, :cond_16

    .line 2809
    const/4 v5, 0x1

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    .line 2818
    :goto_8
    const/4 v5, 0x1

    const/4 v7, 0x0

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    move v3, v7

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    .line 2819
    const/4 v5, 0x1

    goto/16 :goto_0

    .line 2812
    :cond_16
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    iget-object v7, v6, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    iget v8, v6, Lcom/android/server/am/HistoryRecord;->theme:I

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->nonLocalizedLabel:Ljava/lang/CharSequence;

    iget v10, v6, Lcom/android/server/am/HistoryRecord;->labelRes:I

    iget v11, v6, Lcom/android/server/am/HistoryRecord;->icon:I

    const/4 v12, 0x0

    const/4 v13, 0x1

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/WindowManagerService;->setAppStartingWindow(Landroid/os/IBinder;Ljava/lang/String;ILjava/lang/CharSequence;IILandroid/os/IBinder;Z)V

    goto :goto_8

    .line 2827
    .end local v17           #e:Ljava/lang/Exception;
    .restart local v15       #a:Ljava/util/ArrayList;
    :catch_1
    move-exception v5

    move-object/from16 v17, v5

    .line 2830
    .restart local v17       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Exception thrown during resume of "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v17

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2831
    const/4 v5, 0x0

    const/4 v7, 0x0

    const-string v8, "resume-exception"

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    move-object v3, v7

    move-object v4, v8

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    .line 2833
    const/4 v5, 0x1

    goto/16 :goto_0

    .line 2843
    .end local v15           #a:Ljava/util/ArrayList;
    .end local v16           #config:Landroid/content/res/Configuration;
    .end local v17           #e:Ljava/lang/Exception;
    .end local v18           #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .end local v19           #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    .end local v21           #updated:Z
    :cond_17
    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    if-nez v5, :cond_18

    .line 2844
    const/4 v5, 0x1

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    .line 2854
    :goto_9
    const/4 v5, 0x1

    const/4 v7, 0x1

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    move v3, v7

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    goto/16 :goto_7

    .line 2847
    :cond_18
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    iget-object v7, v6, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    iget v8, v6, Lcom/android/server/am/HistoryRecord;->theme:I

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->nonLocalizedLabel:Ljava/lang/CharSequence;

    iget v10, v6, Lcom/android/server/am/HistoryRecord;->labelRes:I

    iget v11, v6, Lcom/android/server/am/HistoryRecord;->icon:I

    const/4 v12, 0x0

    const/4 v13, 0x1

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/WindowManagerService;->setAppStartingWindow(Landroid/os/IBinder;Ljava/lang/String;ILjava/lang/CharSequence;IILandroid/os/IBinder;Z)V

    goto :goto_9
.end method

.method private final resumedAppLocked()Lcom/android/server/am/HistoryRecord;
    .locals 2

    .prologue
    .line 14289
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 14290
    .local v0, resumedActivity:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_0

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-nez v1, :cond_2

    .line 14291
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 14292
    if-eqz v0, :cond_1

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-nez v1, :cond_2

    .line 14293
    :cond_1
    const/4 v1, 0x0

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 14296
    :cond_2
    return-object v0
.end method

.method private retrieveServiceLocked(Landroid/content/Intent;Ljava/lang/String;II)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    .locals 19
    .parameter "service"
    .parameter "resolvedType"
    .parameter "callingPid"
    .parameter "callingUid"

    .prologue
    .line 10869
    const/4 v5, 0x0

    .line 10870
    .local v5, r:Lcom/android/server/am/ServiceRecord;
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v6

    if-eqz v6, :cond_0

    .line 10871
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object v6, v0

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 10873
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_0
    new-instance v13, Landroid/content/Intent$FilterComparison;

    move-object v0, v13

    move-object/from16 v1, p1

    invoke-direct {v0, v1}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 10874
    .local v13, filter:Landroid/content/Intent$FilterComparison;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    move-object v6, v0

    invoke-virtual {v6, v13}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 10875
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    if-nez v5, :cond_9

    .line 10877
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v6

    const/16 v7, 0x400

    move-object v0, v6

    move-object/from16 v1, p1

    move-object/from16 v2, p2

    move v3, v7

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->resolveService(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v17

    .line 10880
    .local v17, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v17, :cond_1

    move-object/from16 v0, v17

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object v6, v0

    move-object v10, v6

    .line 10882
    .local v10, sInfo:Landroid/content/pm/ServiceInfo;
    :goto_0
    if-nez v10, :cond_2

    .line 10883
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to start service "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ": not found"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10885
    const/4 v6, 0x0

    move-object v9, v13

    .line 10933
    .end local v10           #sInfo:Landroid/content/pm/ServiceInfo;
    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .end local v17           #rInfo:Landroid/content/pm/ResolveInfo;
    .local v9, filter:Landroid/content/Intent$FilterComparison;
    :goto_1
    return-object v6

    .line 10880
    .end local v9           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v13       #filter:Landroid/content/Intent$FilterComparison;
    .restart local v17       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_1
    const/4 v6, 0x0

    move-object v10, v6

    goto :goto_0

    .line 10888
    .restart local v10       #sInfo:Landroid/content/pm/ServiceInfo;
    :cond_2
    new-instance v8, Landroid/content/ComponentName;

    iget-object v6, v10, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    invoke-direct {v8, v6, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 10890
    .local v8, name:Landroid/content/ComponentName;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object v6, v0

    invoke-virtual {v6, v8}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Lcom/android/server/am/ServiceRecord;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1

    .line 10891
    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .local v16, r:Lcom/android/server/am/ServiceRecord;
    if-nez v16, :cond_8

    .line 10892
    :try_start_1
    new-instance v9, Landroid/content/Intent$FilterComparison;

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->cloneFilter()Landroid/content/Intent;

    move-result-object v6

    invoke-direct {v9, v6}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V
    :try_end_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_2

    .line 10893
    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v9       #filter:Landroid/content/Intent$FilterComparison;
    :try_start_2
    new-instance v11, Lcom/android/server/am/ActivityManagerService$ServiceRestarter;

    const/4 v6, 0x0

    move-object v0, v11

    move-object/from16 v1, p0

    move-object v2, v6

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService$ServiceRestarter;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ActivityManagerService$1;)V

    .line 10894
    .local v11, res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    const/4 v7, 0x0

    .line 10895
    .local v7, ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object v6, v0

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v18

    .line 10896
    .local v18, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v18
    :try_end_2
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 10897
    :try_start_3
    iget-object v6, v10, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v12, v10, Landroid/content/pm/ServiceInfo;->packageName:Ljava/lang/String;

    iget-object v13, v10, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    move-object/from16 v0, v18

    move v1, v6

    move-object v2, v12

    move-object v3, v13

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/internal/os/BatteryStatsImpl;->getServiceStatsLocked(ILjava/lang/String;Ljava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    move-result-object v7

    .line 10900
    monitor-exit v18
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 10901
    :try_start_4
    new-instance v5, Lcom/android/server/am/ServiceRecord;

    move-object/from16 v6, p0

    invoke-direct/range {v5 .. v11}, Lcom/android/server/am/ServiceRecord;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;Landroid/content/ComponentName;Landroid/content/Intent$FilterComparison;Landroid/content/pm/ServiceInfo;Ljava/lang/Runnable;)V
    :try_end_4
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_0

    .line 10902
    .end local v16           #r:Lcom/android/server/am/ServiceRecord;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :try_start_5
    invoke-virtual {v11, v5}, Lcom/android/server/am/ActivityManagerService$ServiceRestarter;->setService(Lcom/android/server/am/ServiceRecord;)V

    .line 10903
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object v6, v0

    invoke-virtual {v6, v8, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 10904
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    move-object v6, v0

    invoke-virtual {v6, v9, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 10907
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v6, v0

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v12

    .line 10908
    .local v12, N:I
    const/4 v14, 0x0

    .local v14, i:I
    :goto_2
    if-ge v14, v12, :cond_4

    .line 10909
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v6, v0

    invoke-virtual {v6, v14}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Lcom/android/server/am/ServiceRecord;

    .line 10910
    .local v15, pr:Lcom/android/server/am/ServiceRecord;
    iget-object v6, v15, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v6, v8}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_3

    .line 10911
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v6, v0

    invoke-virtual {v6, v14}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
    :try_end_5
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_5} :catch_3

    .line 10912
    add-int/lit8 v14, v14, -0x1

    .line 10913
    add-int/lit8 v12, v12, -0x1

    .line 10908
    :cond_3
    add-int/lit8 v14, v14, 0x1

    goto :goto_2

    .line 10900
    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .end local v12           #N:I
    .end local v14           #i:I
    .end local v15           #pr:Lcom/android/server/am/ServiceRecord;
    .restart local v16       #r:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v6

    :try_start_6
    monitor-exit v18
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    :try_start_7
    throw v6
    :try_end_7
    .catch Landroid/os/RemoteException; {:try_start_7 .. :try_end_7} :catch_0

    .line 10917
    .end local v7           #ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    .end local v11           #res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    .end local v18           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catch_0
    move-exception v6

    move-object/from16 v5, v16

    .line 10921
    .end local v8           #name:Landroid/content/ComponentName;
    .end local v10           #sInfo:Landroid/content/pm/ServiceInfo;
    .end local v16           #r:Lcom/android/server/am/ServiceRecord;
    .end local v17           #rInfo:Landroid/content/pm/ResolveInfo;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_4
    :goto_3
    if-eqz v5, :cond_7

    .line 10922
    iget-object v6, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    iget-boolean v7, v5, Lcom/android/server/am/ServiceRecord;->exported:Z

    if-eqz v7, :cond_5

    const/4 v7, -0x1

    :goto_4
    move-object/from16 v0, p0

    move-object v1, v6

    move/from16 v2, p3

    move/from16 v3, p4

    move v4, v7

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-eqz v6, :cond_6

    .line 10925
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Permission Denial: Accessing service "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " from pid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ", uid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " requires "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10929
    new-instance v6, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    const/4 v7, 0x0

    iget-object v8, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    move-object v0, v6

    move-object/from16 v1, p0

    move-object v2, v7

    move-object v3, v8

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto/16 :goto_1

    .line 10922
    :cond_5
    iget-object v7, v5, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_4

    .line 10931
    :cond_6
    new-instance v6, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    const/4 v7, 0x0

    move-object v0, v6

    move-object/from16 v1, p0

    move-object v2, v5

    move-object v3, v7

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto/16 :goto_1

    .line 10933
    :cond_7
    const/4 v6, 0x0

    goto/16 :goto_1

    .line 10917
    .end local v9           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v13       #filter:Landroid/content/Intent$FilterComparison;
    :catch_1
    move-exception v6

    move-object v9, v13

    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v9       #filter:Landroid/content/Intent$FilterComparison;
    goto :goto_3

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .end local v9           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v8       #name:Landroid/content/ComponentName;
    .restart local v10       #sInfo:Landroid/content/pm/ServiceInfo;
    .restart local v13       #filter:Landroid/content/Intent$FilterComparison;
    .restart local v16       #r:Lcom/android/server/am/ServiceRecord;
    .restart local v17       #rInfo:Landroid/content/pm/ResolveInfo;
    :catch_2
    move-exception v6

    move-object v9, v13

    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v9       #filter:Landroid/content/Intent$FilterComparison;
    move-object/from16 v5, v16

    .end local v16           #r:Lcom/android/server/am/ServiceRecord;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    goto/16 :goto_3

    .restart local v7       #ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    .restart local v11       #res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    .restart local v18       #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catch_3
    move-exception v6

    goto/16 :goto_3

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .end local v7           #ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    .end local v9           #filter:Landroid/content/Intent$FilterComparison;
    .end local v11           #res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    .end local v18           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v13       #filter:Landroid/content/Intent$FilterComparison;
    .restart local v16       #r:Lcom/android/server/am/ServiceRecord;
    :cond_8
    move-object v9, v13

    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v9       #filter:Landroid/content/Intent$FilterComparison;
    move-object/from16 v5, v16

    .end local v16           #r:Lcom/android/server/am/ServiceRecord;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    goto/16 :goto_3

    .end local v8           #name:Landroid/content/ComponentName;
    .end local v9           #filter:Landroid/content/Intent$FilterComparison;
    .end local v10           #sInfo:Landroid/content/pm/ServiceInfo;
    .end local v17           #rInfo:Landroid/content/pm/ResolveInfo;
    .restart local v13       #filter:Landroid/content/Intent$FilterComparison;
    :cond_9
    move-object v9, v13

    .end local v13           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v9       #filter:Landroid/content/Intent$FilterComparison;
    goto/16 :goto_3
.end method

.method private retrieveSettings()V
    .locals 8

    .prologue
    const/4 v7, 0x1

    const/4 v6, 0x0

    .line 8708
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v5}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    .line 8709
    .local v3, resolver:Landroid/content/ContentResolver;
    const-string v5, "debug_app"

    invoke-static {v3, v5}, Landroid/provider/Settings$System;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 8711
    .local v2, debugApp:Ljava/lang/String;
    const-string v5, "wait_for_debugger"

    invoke-static {v3, v5, v6}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v5

    if-eqz v5, :cond_0

    move v4, v7

    .line 8713
    .local v4, waitForDebugger:Z
    :goto_0
    const-string v5, "always_finish_activities"

    invoke-static {v3, v5, v6}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v5

    if-eqz v5, :cond_1

    move v0, v7

    .line 8716
    .local v0, alwaysFinishActivities:Z
    :goto_1
    new-instance v1, Landroid/content/res/Configuration;

    invoke-direct {v1}, Landroid/content/res/Configuration;-><init>()V

    .line 8717
    .local v1, configuration:Landroid/content/res/Configuration;
    invoke-static {v3, v1}, Landroid/provider/Settings$System;->getConfiguration(Landroid/content/ContentResolver;Landroid/content/res/Configuration;)V

    .line 8719
    monitor-enter p0

    .line 8720
    :try_start_0
    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 8721
    iput-boolean v4, p0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    iput-boolean v4, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 8722
    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    .line 8725
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-virtual {v5, v1}, Landroid/content/res/Configuration;->updateFrom(Landroid/content/res/Configuration;)I

    .line 8726
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    const/4 v6, 0x1

    iput v6, v5, Landroid/content/res/Configuration;->seq:I

    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    .line 8728
    monitor-exit p0

    .line 8729
    return-void

    .end local v0           #alwaysFinishActivities:Z
    .end local v1           #configuration:Landroid/content/res/Configuration;
    .end local v4           #waitForDebugger:Z
    :cond_0
    move v4, v6

    .line 8711
    goto :goto_0

    .restart local v4       #waitForDebugger:Z
    :cond_1
    move v0, v6

    .line 8713
    goto :goto_1

    .line 8728
    .restart local v0       #alwaysFinishActivities:Z
    .restart local v1       #configuration:Landroid/content/res/Configuration;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5
.end method

.method private revokeUriPermissionLocked(ILandroid/net/Uri;I)V
    .locals 22
    .parameter "callingUid"
    .parameter "uri"
    .parameter "modeFlags"

    .prologue
    .line 6643
    and-int/lit8 p3, p3, 0x3

    .line 6645
    if-nez p3, :cond_1

    .line 6725
    .end local p1
    :cond_0
    :goto_0
    return-void

    .line 6652
    .restart local p1
    :cond_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v16

    .line 6654
    .local v16, pm:Landroid/content/pm/IPackageManager;
    invoke-virtual/range {p2 .. p2}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v8

    .line 6655
    .local v8, authority:Ljava/lang/String;
    const/4 v15, 0x0

    .line 6656
    .local v15, pi:Landroid/content/pm/ProviderInfo;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object v1, v8

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/ContentProviderRecord;

    .line 6658
    .local v9, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v9, :cond_2

    .line 6659
    iget-object v15, v9, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    .line 6667
    :goto_1
    if-nez v15, :cond_3

    .line 6668
    const-string v19, "ActivityManager"

    new-instance v20, Ljava/lang/StringBuilder;

    invoke-direct/range {v20 .. v20}, Ljava/lang/StringBuilder;-><init>()V

    const-string v21, "No content provider found for: "

    invoke-virtual/range {v20 .. v21}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    move-object/from16 v0, v20

    move-object v1, v8

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    invoke-virtual/range {v20 .. v20}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v20

    invoke-static/range {v19 .. v20}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_0

    .line 6662
    :cond_2
    const/16 v19, 0x800

    :try_start_0
    move-object/from16 v0, v16

    move-object v1, v8

    move/from16 v2, v19

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v15

    goto :goto_1

    .line 6673
    :cond_3
    move-object/from16 v0, p0

    move-object/from16 v1, v16

    move-object v2, v15

    move/from16 v3, p1

    move/from16 v4, p3

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z

    move-result v19

    if-nez v19, :cond_4

    .line 6677
    new-instance v19, Ljava/lang/SecurityException;

    new-instance v20, Ljava/lang/StringBuilder;

    invoke-direct/range {v20 .. v20}, Ljava/lang/StringBuilder;-><init>()V

    const-string v21, "Uid "

    invoke-virtual/range {v20 .. v21}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    move-object/from16 v0, v20

    move/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v20

    const-string v21, " does not have permission to uri "

    invoke-virtual/range {v20 .. v21}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    move-object/from16 v0, v20

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v20

    invoke-virtual/range {v20 .. v20}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v20

    invoke-direct/range {v19 .. v20}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v19

    .line 6683
    :cond_4
    invoke-virtual/range {p2 .. p2}, Landroid/net/Uri;->getPathSegments()Ljava/util/List;

    move-result-object v7

    .line 6684
    .local v7, SEGMENTS:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v7, :cond_0

    .line 6685
    invoke-interface {v7}, Ljava/util/List;->size()I

    move-result v6

    .line 6686
    .local v6, NS:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Landroid/util/SparseArray;->size()I

    move-result v5

    .line 6687
    .local v5, N:I
    const/4 v10, 0x0

    .end local p1
    .local v10, i:I
    :goto_2
    if-ge v10, v5, :cond_0

    .line 6688
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move v1, v10

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Ljava/util/HashMap;

    .line 6690
    .local v14, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    invoke-virtual {v14}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v19

    invoke-interface/range {v19 .. v19}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v11

    .line 6692
    .local v11, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/UriPermission;>;"
    :cond_5
    :goto_3
    invoke-interface {v11}, Ljava/util/Iterator;->hasNext()Z

    move-result v19

    if-eqz v19, :cond_7

    .line 6693
    invoke-interface {v11}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/am/UriPermission;

    .line 6694
    .local v13, perm:Lcom/android/server/am/UriPermission;
    move-object v0, v13

    iget-object v0, v0, Lcom/android/server/am/UriPermission;->uri:Landroid/net/Uri;

    move-object/from16 v18, v0

    .line 6695
    .local v18, targetUri:Landroid/net/Uri;
    invoke-virtual/range {v18 .. v18}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v19

    move-object v0, v8

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v19

    if-eqz v19, :cond_5

    .line 6698
    invoke-virtual/range {v18 .. v18}, Landroid/net/Uri;->getPathSegments()Ljava/util/List;

    move-result-object v17

    .line 6699
    .local v17, targetSegments:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v17, :cond_5

    .line 6702
    invoke-interface/range {v17 .. v17}, Ljava/util/List;->size()I

    move-result v19

    move/from16 v0, v19

    move v1, v6

    if-lt v0, v1, :cond_5

    .line 6705
    const/4 v12, 0x0

    .local v12, j:I
    :goto_4
    if-ge v12, v6, :cond_6

    .line 6706
    invoke-interface {v7, v12}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, v17

    move v1, v12

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v19

    move-object/from16 v0, p1

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v19

    if-eqz v19, :cond_5

    .line 6705
    add-int/lit8 v12, v12, 0x1

    goto :goto_4

    .line 6712
    :cond_6
    move-object v0, v13

    move/from16 v1, p3

    invoke-virtual {v0, v1}, Lcom/android/server/am/UriPermission;->clearModes(I)V

    .line 6713
    move-object v0, v13

    iget v0, v0, Lcom/android/server/am/UriPermission;->modeFlags:I

    move/from16 v19, v0

    if-nez v19, :cond_5

    .line 6714
    invoke-interface {v11}, Ljava/util/Iterator;->remove()V

    goto :goto_3

    .line 6717
    .end local v12           #j:I
    .end local v13           #perm:Lcom/android/server/am/UriPermission;
    .end local v17           #targetSegments:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .end local v18           #targetUri:Landroid/net/Uri;
    :cond_7
    invoke-virtual {v14}, Ljava/util/HashMap;->size()I

    move-result v19

    if-nez v19, :cond_8

    .line 6718
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v19, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v20, v0

    move-object/from16 v0, v20

    move v1, v10

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v20

    invoke-virtual/range {v19 .. v20}, Landroid/util/SparseArray;->remove(I)V

    .line 6720
    add-int/lit8 v5, v5, -0x1

    .line 6721
    add-int/lit8 v10, v10, -0x1

    .line 6687
    :cond_8
    add-int/lit8 v10, v10, 0x1

    goto/16 :goto_2

    .line 6664
    .end local v5           #N:I
    .end local v6           #NS:I
    .end local v7           #SEGMENTS:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .end local v10           #i:I
    .end local v11           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/UriPermission;>;"
    .end local v14           #perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    .restart local p1
    :catch_0
    move-exception v19

    goto/16 :goto_1
.end method

.method private saveLocaleLocked(Ljava/util/Locale;ZZ)V
    .locals 2
    .parameter "l"
    .parameter "isDiff"
    .parameter "isPersist"

    .prologue
    .line 13772
    if-eqz p2, :cond_0

    .line 13773
    const-string v0, "user.language"

    invoke-virtual {p1}, Ljava/util/Locale;->getLanguage()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 13774
    const-string v0, "user.region"

    invoke-virtual {p1}, Ljava/util/Locale;->getCountry()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 13777
    :cond_0
    if-eqz p3, :cond_1

    .line 13778
    const-string v0, "persist.sys.language"

    invoke-virtual {p1}, Ljava/util/Locale;->getLanguage()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 13779
    const-string v0, "persist.sys.country"

    invoke-virtual {p1}, Ljava/util/Locale;->getCountry()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 13780
    const-string v0, "persist.sys.localevar"

    invoke-virtual {p1}, Ljava/util/Locale;->getVariant()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 13782
    :cond_1
    return-void
.end method

.method private static scanArgs([Ljava/lang/String;Ljava/lang/String;)Z
    .locals 5
    .parameter "args"
    .parameter "value"

    .prologue
    .line 10351
    if-eqz p0, :cond_1

    .line 10352
    move-object v1, p0

    .local v1, arr$:[Ljava/lang/String;
    array-length v3, v1

    .local v3, len$:I
    const/4 v2, 0x0

    .local v2, i$:I
    :goto_0
    if-ge v2, v3, :cond_1

    aget-object v0, v1, v2

    .line 10353
    .local v0, arg:Ljava/lang/String;
    invoke-virtual {p1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_0

    .line 10354
    const/4 v4, 0x1

    .line 10358
    .end local v0           #arg:Ljava/lang/String;
    .end local v1           #arr$:[Ljava/lang/String;
    .end local v2           #i$:I
    .end local v3           #len$:I
    :goto_1
    return v4

    .line 10352
    .restart local v0       #arg:Ljava/lang/String;
    .restart local v1       #arr$:[Ljava/lang/String;
    .restart local v2       #i$:I
    .restart local v3       #len$:I
    :cond_0
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    .line 10358
    .end local v0           #arg:Ljava/lang/String;
    .end local v1           #arr$:[Ljava/lang/String;
    .end local v2           #i$:I
    .end local v3           #len$:I
    :cond_1
    const/4 v4, 0x0

    goto :goto_1
.end method

.method private final scheduleBroadcastsLocked()V
    .locals 2

    .prologue
    .line 12199
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    if-eqz v0, :cond_0

    .line 12204
    :goto_0
    return-void

    .line 12202
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/4 v1, 0x7

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    .line 12203
    const/4 v0, 0x1

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    goto :goto_0
.end method

.method private final scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;Z)Z
    .locals 23
    .parameter "r"
    .parameter "allowCancel"

    .prologue
    .line 11093
    const/4 v4, 0x0

    .line 11095
    .local v4, canceled:Z
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v10

    .line 11096
    .local v10, now:J
    const-wide/16 v8, 0x1388

    .line 11097
    .local v8, minDuration:J
    const-wide/32 v14, 0xea60

    .line 11101
    .local v14, resetTime:J
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    invoke-virtual/range {v17 .. v17}, Ljava/util/ArrayList;->size()I

    move-result v3

    .line 11102
    .local v3, N:I
    if-lez v3, :cond_6

    .line 11103
    const/16 v17, 0x1

    sub-int v7, v3, v17

    .local v7, i:I
    :goto_0
    if-ltz v7, :cond_5

    .line 11104
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    move-object/from16 v0, v17

    move v1, v7

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Lcom/android/server/am/ServiceRecord$StartItem;

    .line 11105
    .local v16, si:Lcom/android/server/am/ServiceRecord$StartItem;
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord$StartItem;->intent:Landroid/content/Intent;

    move-object/from16 v17, v0

    if-nez v17, :cond_1

    .line 11103
    :cond_0
    :goto_1
    add-int/lit8 v7, v7, -0x1

    goto :goto_0

    .line 11107
    :cond_1
    if-eqz p2, :cond_2

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/am/ServiceRecord$StartItem;->deliveryCount:I

    move/from16 v17, v0

    const/16 v18, 0x3

    move/from16 v0, v17

    move/from16 v1, v18

    if-ge v0, v1, :cond_4

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/am/ServiceRecord$StartItem;->doneExecutingCount:I

    move/from16 v17, v0

    const/16 v18, 0x6

    move/from16 v0, v17

    move/from16 v1, v18

    if-ge v0, v1, :cond_4

    .line 11109
    :cond_2
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    const/16 v18, 0x0

    move-object/from16 v0, v17

    move/from16 v1, v18

    move-object/from16 v2, v16

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 11110
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v17

    move-object/from16 v0, v16

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord$StartItem;->deliveredTime:J

    move-wide/from16 v19, v0

    sub-long v5, v17, v19

    .line 11111
    .local v5, dur:J
    const-wide/16 v17, 0x2

    mul-long v5, v5, v17

    .line 11112
    cmp-long v17, v8, v5

    if-gez v17, :cond_3

    move-wide v8, v5

    .line 11113
    :cond_3
    cmp-long v17, v14, v5

    if-gez v17, :cond_0

    move-wide v14, v5

    goto :goto_1

    .line 11115
    .end local v5           #dur:J
    :cond_4
    const-string v17, "ActivityManager"

    new-instance v18, Ljava/lang/StringBuilder;

    invoke-direct/range {v18 .. v18}, Ljava/lang/StringBuilder;-><init>()V

    const-string v19, "Canceling start item "

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord$StartItem;->intent:Landroid/content/Intent;

    move-object/from16 v19, v0

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v18

    const-string v19, " in service "

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    move-object/from16 v19, v0

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v18

    invoke-virtual/range {v18 .. v18}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v18

    invoke-static/range {v17 .. v18}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11117
    const/4 v4, 0x1

    goto :goto_1

    .line 11120
    .end local v16           #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :cond_5
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    invoke-virtual/range {v17 .. v17}, Ljava/util/ArrayList;->clear()V

    .line 11123
    .end local v7           #i:I
    :cond_6
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ServiceRecord;->totalRestartCount:I

    move/from16 v17, v0

    add-int/lit8 v17, v17, 0x1

    move/from16 v0, v17

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ServiceRecord;->totalRestartCount:I

    .line 11124
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v17, v0

    const-wide/16 v19, 0x0

    cmp-long v17, v17, v19

    if-nez v17, :cond_b

    .line 11125
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ServiceRecord;->restartCount:I

    move/from16 v17, v0

    add-int/lit8 v17, v17, 0x1

    move/from16 v0, v17

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ServiceRecord;->restartCount:I

    .line 11126
    move-wide v0, v8

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    .line 11144
    :cond_7
    :goto_2
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v17, v0

    add-long v17, v17, v10

    move-wide/from16 v0, v17

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    .line 11150
    :cond_8
    const/4 v13, 0x0

    .line 11151
    .local v13, repeat:Z
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    invoke-virtual/range {v17 .. v17}, Ljava/util/ArrayList;->size()I

    move-result v17

    const/16 v18, 0x1

    sub-int v7, v17, v18

    .restart local v7       #i:I
    :goto_3
    if-ltz v7, :cond_9

    .line 11152
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    move-object/from16 v0, v17

    move v1, v7

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Lcom/android/server/am/ServiceRecord;

    .line 11153
    .local v12, r2:Lcom/android/server/am/ServiceRecord;
    move-object v0, v12

    move-object/from16 v1, p1

    if-eq v0, v1, :cond_d

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v17, v0

    move-object v0, v12

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v19, v0

    const-wide/16 v21, 0x2710

    sub-long v19, v19, v21

    cmp-long v17, v17, v19

    if-ltz v17, :cond_d

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v17, v0

    move-object v0, v12

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v19, v0

    const-wide/16 v21, 0x2710

    add-long v19, v19, v21

    cmp-long v17, v17, v19

    if-gez v17, :cond_d

    .line 11157
    move-object v0, v12

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v17, v0

    const-wide/16 v19, 0x2710

    add-long v17, v17, v19

    move-wide/from16 v0, v17

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    .line 11158
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v17, v0

    sub-long v17, v17, v10

    move-wide/from16 v0, v17

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    .line 11159
    const/4 v13, 0x1

    .line 11163
    .end local v12           #r2:Lcom/android/server/am/ServiceRecord;
    :cond_9
    if-nez v13, :cond_8

    .line 11165
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    move-object/from16 v0, v17

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v17

    if-nez v17, :cond_a

    .line 11166
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    move-object/from16 v17, v0

    move-object/from16 v0, v17

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11169
    :cond_a
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/am/ServiceRecord;->cancelNotification()V

    .line 11171
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object/from16 v17, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->restarter:Ljava/lang/Runnable;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V

    .line 11172
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object/from16 v17, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->restarter:Ljava/lang/Runnable;

    move-object/from16 v18, v0

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    move-wide/from16 v19, v0

    invoke-virtual/range {v17 .. v20}, Landroid/os/Handler;->postAtTime(Ljava/lang/Runnable;J)Z

    .line 11173
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v17

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v19, v0

    add-long v17, v17, v19

    move-wide/from16 v0, v17

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    .line 11174
    const-string v17, "ActivityManager"

    new-instance v18, Ljava/lang/StringBuilder;

    invoke-direct/range {v18 .. v18}, Ljava/lang/StringBuilder;-><init>()V

    const-string v19, "Scheduling restart of crashed service "

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    move-object/from16 v19, v0

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    const-string v19, " in "

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v19, v0

    invoke-virtual/range {v18 .. v20}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v18

    const-string v19, "ms"

    invoke-virtual/range {v18 .. v19}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v18

    invoke-virtual/range {v18 .. v18}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v18

    invoke-static/range {v17 .. v18}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11176
    const/16 v17, 0x7553

    const/16 v18, 0x2

    move/from16 v0, v18

    new-array v0, v0, [Ljava/lang/Object;

    move-object/from16 v18, v0

    const/16 v19, 0x0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    move-object/from16 v20, v0

    aput-object v20, v18, v19

    const/16 v19, 0x1

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v20, v0

    invoke-static/range {v20 .. v21}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v20

    aput-object v20, v18, v19

    invoke-static/range {v17 .. v18}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 11179
    return v4

    .line 11133
    .end local v7           #i:I
    .end local v13           #repeat:Z
    :cond_b
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartTime:J

    move-wide/from16 v17, v0

    add-long v17, v17, v14

    cmp-long v17, v10, v17

    if-lez v17, :cond_c

    .line 11134
    const/16 v17, 0x1

    move/from16 v0, v17

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ServiceRecord;->restartCount:I

    .line 11135
    move-wide v0, v8

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    goto/16 :goto_2

    .line 11137
    :cond_c
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v17, v0

    const-wide/16 v19, 0x4

    mul-long v17, v17, v19

    move-wide/from16 v0, v17

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    .line 11138
    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    move-wide/from16 v17, v0

    cmp-long v17, v17, v8

    if-gez v17, :cond_7

    .line 11139
    move-wide v0, v8

    move-object/from16 v2, p1

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    goto/16 :goto_2

    .line 11151
    .restart local v7       #i:I
    .restart local v12       #r2:Lcom/android/server/am/ServiceRecord;
    .restart local v13       #repeat:Z
    :cond_d
    add-int/lit8 v7, v7, -0x1

    goto/16 :goto_3
.end method

.method public static self()Lcom/android/server/am/ActivityManagerService;
    .locals 1

    .prologue
    .line 1321
    sget-object v0, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    return-object v0
.end method

.method private final sendPackageBroadcastLocked(I[Ljava/lang/String;)V
    .locals 4
    .parameter "cmd"
    .parameter "packages"

    .prologue
    .line 12338
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 12339
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 12340
    .local v1, r:Lcom/android/server/am/ProcessRecord;
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_0

    .line 12342
    :try_start_0
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v2, p1, p2}, Landroid/app/IApplicationThread;->dispatchPackageBroadcast(I[Ljava/lang/String;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 12338
    :cond_0
    :goto_1
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 12347
    .end local v1           #r:Lcom/android/server/am/ProcessRecord;
    :cond_1
    return-void

    .line 12343
    .restart local v1       #r:Lcom/android/server/am/ProcessRecord;
    :catch_0
    move-exception v2

    goto :goto_1
.end method

.method private final sendServiceArgsLocked(Lcom/android/server/am/ServiceRecord;Z)V
    .locals 8
    .parameter "r"
    .parameter "oomAdjusted"

    .prologue
    .line 10952
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 10953
    .local v0, N:I
    if-nez v0, :cond_1

    .line 11003
    :cond_0
    :goto_0
    return-void

    .line 10957
    :cond_1
    const/4 v3, 0x0

    .line 10958
    .local v3, i:I
    :goto_1
    if-ge v3, v0, :cond_6

    .line 10960
    :try_start_0
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord$StartItem;

    .line 10963
    .local v4, si:Lcom/android/server/am/ServiceRecord$StartItem;
    iget-object v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->intent:Landroid/content/Intent;

    if-nez v5, :cond_2

    const/4 v5, 0x1

    if-le v0, v5, :cond_2

    .line 10966
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 10969
    :cond_2
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 10970
    if-nez p2, :cond_3

    .line 10971
    const/4 p2, 0x1

    .line 10972
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 10974
    :cond_3
    const/4 v2, 0x0

    .line 10975
    .local v2, flags:I
    iget v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->deliveryCount:I

    if-lez v5, :cond_4

    .line 10976
    or-int/lit8 v2, v2, 0x2

    .line 10978
    :cond_4
    iget v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->doneExecutingCount:I

    if-lez v5, :cond_5

    .line 10979
    or-int/lit8 v2, v2, 0x1

    .line 10981
    :cond_5
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget v6, v4, Lcom/android/server/am/ServiceRecord$StartItem;->id:I

    iget-object v7, v4, Lcom/android/server/am/ServiceRecord$StartItem;->intent:Landroid/content/Intent;

    invoke-interface {v5, p1, v6, v2, v7}, Landroid/app/IApplicationThread;->scheduleServiceArgs(Landroid/os/IBinder;IILandroid/content/Intent;)V

    .line 10982
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v5

    iput-wide v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->deliveredTime:J

    .line 10983
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    invoke-virtual {v5, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 10984
    iget v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->deliveryCount:I

    add-int/lit8 v5, v5, 0x1

    iput v5, v4, Lcom/android/server/am/ServiceRecord$StartItem;->deliveryCount:I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1

    .line 10985
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 10986
    .end local v2           #flags:I
    .end local v4           #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :catch_0
    move-exception v5

    move-object v1, v5

    .line 10995
    :cond_6
    :goto_2
    if-ne v3, v0, :cond_7

    .line 10996
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    goto :goto_0

    .line 10990
    :catch_1
    move-exception v5

    move-object v1, v5

    .line 10991
    .local v1, e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    const-string v6, "Unexpected exception"

    invoke-static {v5, v6, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_2

    .line 10998
    .end local v1           #e:Ljava/lang/Exception;
    :cond_7
    :goto_3
    if-lez v3, :cond_0

    .line 10999
    add-int/lit8 v3, v3, -0x1

    .line 11000
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    goto :goto_3
.end method

.method private final setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 2
    .parameter "r"

    .prologue
    .line 1595
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-eq v0, p1, :cond_0

    .line 1596
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    .line 1597
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x1

    invoke-virtual {v0, p1, v1}, Lcom/android/server/WindowManagerService;->setFocusedApp(Landroid/os/IBinder;Z)V

    .line 1599
    :cond_0
    return-void
.end method

.method public static setSystemProcess()V
    .locals 8

    .prologue
    .line 1244
    :try_start_0
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    .line 1246
    .local v3, m:Lcom/android/server/am/ActivityManagerService;
    const-string v4, "activity"

    invoke-static {v4, v3}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1247
    const-string v4, "meminfo"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$MemBinder;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$MemBinder;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1249
    const-string v4, "cpuinfo"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$CpuBinder;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$CpuBinder;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1251
    const-string v4, "permission"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$PermissionController;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$PermissionController;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1253
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v4, v4, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    const-string v5, "android"

    const/16 v6, 0x400

    invoke-virtual {v4, v5, v6}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v2

    .line 1256
    .local v2, info:Landroid/content/pm/ApplicationInfo;
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    invoke-virtual {v4, v2}, Landroid/app/ActivityThread;->installSystemApplicationInfo(Landroid/content/pm/ApplicationInfo;)V

    .line 1258
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    monitor-enter v4
    :try_end_0
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1259
    :try_start_1
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    sget-object v6, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    invoke-virtual {v6}, Landroid/app/ActivityThread;->getApplicationThread()Landroid/app/ActivityThread$ApplicationThread;

    move-result-object v6

    iget-object v7, v2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6, v2, v7}, Lcom/android/server/am/ActivityManagerService;->newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 1262
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    const/4 v5, 0x1

    iput-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    .line 1263
    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    iput v5, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 1264
    const/16 v5, -0x10

    iput v5, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    .line 1265
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v5, v5, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v6, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v7, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v5, v6, v7, v0}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 1266
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v5, v5, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 1267
    :try_start_2
    sget-object v6, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v6, v6, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    iget v7, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v6, v7, v0}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 1268
    monitor-exit v5
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 1269
    :try_start_3
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    const/4 v6, 0x1

    const/4 v7, 0x1

    invoke-direct {v5, v0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 1270
    monitor-exit v4
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 1275
    return-void

    .line 1268
    :catchall_0
    move-exception v6

    :try_start_4
    monitor-exit v5
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    :try_start_5
    throw v6

    .line 1270
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    :catchall_1
    move-exception v5

    monitor-exit v4
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    :try_start_6
    throw v5
    :try_end_6
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_6 .. :try_end_6} :catch_0

    .line 1271
    .end local v2           #info:Landroid/content/pm/ApplicationInfo;
    .end local v3           #m:Lcom/android/server/am/ActivityManagerService;
    :catch_0
    move-exception v4

    move-object v1, v4

    .line 1272
    .local v1, e:Landroid/content/pm/PackageManager$NameNotFoundException;
    new-instance v4, Ljava/lang/RuntimeException;

    const-string v5, "Unable to find android system package"

    invoke-direct {v4, v5, v1}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V

    throw v4
.end method

.method private final startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I
    .locals 31
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "aInfo"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "callingPid"
    .parameter "callingUid"
    .parameter "onlyIfNeeded"
    .parameter "componentSpecified"

    .prologue
    .line 3138
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Starting activity: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3140
    const/16 v29, 0x0

    .line 3141
    .local v29, sourceRecord:Lcom/android/server/am/HistoryRecord;
    const/4 v7, 0x0

    .line 3142
    .local v7, resultRecord:Lcom/android/server/am/HistoryRecord;
    if-eqz p7, :cond_0

    .line 3143
    move-object/from16 v0, p0

    move-object/from16 v1, p7

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v24

    .line 3146
    .local v24, index:I
    if-ltz v24, :cond_0

    .line 3147
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v24

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v29

    .end local v29           #sourceRecord:Lcom/android/server/am/HistoryRecord;
    check-cast v29, Lcom/android/server/am/HistoryRecord;

    .line 3148
    .restart local v29       #sourceRecord:Lcom/android/server/am/HistoryRecord;
    if-ltz p9, :cond_0

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v5, v0

    if-nez v5, :cond_0

    .line 3149
    move-object/from16 v7, v29

    .line 3154
    .end local v24           #index:I
    :cond_0
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getFlags()I

    move-result v25

    .line 3156
    .local v25, launchFlags:I
    const/high16 v5, 0x200

    and-int v5, v5, v25

    if-eqz v5, :cond_2

    if-eqz v29, :cond_2

    .line 3160
    if-ltz p9, :cond_1

    .line 3161
    const/4 v5, -0x3

    .line 3281
    :goto_0
    return v5

    .line 3163
    :cond_1
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v7, v0

    .line 3164
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object/from16 p8, v0

    .line 3165
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move/from16 p9, v0

    .line 3166
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3167
    if-eqz v7, :cond_2

    .line 3168
    move-object v0, v7

    move-object/from16 v1, v29

    move-object/from16 v2, p8

    move/from16 v3, p9

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/HistoryRecord;->removeResultsLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    .line 3173
    :cond_2
    const/16 v23, 0x0

    .line 3175
    .local v23, err:I
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    if-nez v5, :cond_3

    .line 3178
    const/16 v23, -0x1

    .line 3181
    :cond_3
    if-nez v23, :cond_4

    if-nez p6, :cond_4

    .line 3184
    const/16 v23, -0x2

    .line 3187
    :cond_4
    const/16 v21, 0x0

    .line 3188
    .local v21, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v23, :cond_5

    if-eqz p1, :cond_5

    .line 3189
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v21

    .line 3190
    if-eqz v21, :cond_7

    .line 3191
    move-object/from16 v0, v21

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move/from16 p10, v0

    .line 3192
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    move-object v0, v5

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    move/from16 p11, v0

    .line 3201
    :cond_5
    :goto_1
    if-eqz v23, :cond_8

    .line 3202
    if-eqz v7, :cond_6

    .line 3203
    const/4 v6, -0x1

    const/4 v10, 0x0

    const/4 v11, 0x0

    move-object/from16 v5, p0

    move-object/from16 v8, p8

    move/from16 v9, p9

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    :cond_6
    move/from16 v5, v23

    .line 3207
    goto :goto_0

    .line 3194
    :cond_7
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to find app for caller "

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v8, " (pid="

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move/from16 v1, p10

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v8, ") when starting: "

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3197
    const/16 v23, -0x4

    goto :goto_1

    .line 3210
    :cond_8
    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    move-object v5, v0

    move-object/from16 v0, p6

    iget-boolean v0, v0, Landroid/content/pm/ActivityInfo;->exported:Z

    move v6, v0

    if-eqz v6, :cond_a

    const/4 v6, -0x1

    :goto_2
    move-object/from16 v0, p0

    move-object v1, v5

    move/from16 v2, p10

    move/from16 v3, p11

    move v4, v6

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v28

    .line 3212
    .local v28, perm:I
    if-eqz v28, :cond_b

    .line 3213
    if-eqz v7, :cond_9

    .line 3214
    const/4 v6, -0x1

    const/4 v10, 0x0

    const/4 v11, 0x0

    move-object/from16 v5, p0

    move-object/from16 v8, p8

    move/from16 v9, p9

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3218
    :cond_9
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: starting "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " from "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p10

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p11

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " requires "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v26

    .line 3222
    .local v26, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v26

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3223
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v26

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 3210
    .end local v26           #msg:Ljava/lang/String;
    .end local v28           #perm:I
    :cond_a
    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    goto/16 :goto_2

    .line 3226
    .restart local v28       #perm:I
    :cond_b
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    if-eqz v5, :cond_e

    .line 3227
    const/16 v20, 0x0

    .line 3231
    .local v20, abort:Z
    :try_start_0
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->cloneFilter()Landroid/content/Intent;

    move-result-object v30

    .line 3232
    .local v30, watchIntent:Landroid/content/Intent;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object v0, v5

    move-object/from16 v1, v30

    move-object v2, v6

    invoke-interface {v0, v1, v2}, Landroid/app/IActivityController;->activityStarting(Landroid/content/Intent;Ljava/lang/String;)Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v5

    if-nez v5, :cond_d

    const/4 v5, 0x1

    move/from16 v20, v5

    .line 3238
    .end local v30           #watchIntent:Landroid/content/Intent;
    :goto_3
    if-eqz v20, :cond_e

    .line 3239
    if-eqz v7, :cond_c

    .line 3240
    const/4 v6, -0x1

    const/4 v10, 0x0

    const/4 v11, 0x0

    move-object/from16 v5, p0

    move-object/from16 v8, p8

    move/from16 v9, p9

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3246
    :cond_c
    const/4 v5, 0x0

    goto/16 :goto_0

    .line 3232
    .restart local v30       #watchIntent:Landroid/content/Intent;
    :cond_d
    const/4 v5, 0x0

    move/from16 v20, v5

    goto :goto_3

    .line 3234
    .end local v30           #watchIntent:Landroid/content/Intent;
    :catch_0
    move-exception v5

    move-object/from16 v22, v5

    .line 3235
    .local v22, e:Landroid/os/RemoteException;
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    goto :goto_3

    .line 3250
    .end local v20           #abort:Z
    .end local v22           #e:Landroid/os/RemoteException;
    :cond_e
    new-instance v8, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v15, v0

    move-object/from16 v9, p0

    move-object/from16 v10, v21

    move/from16 v11, p11

    move-object/from16 v12, p2

    move-object/from16 v13, p3

    move-object/from16 v14, p6

    move-object/from16 v16, v7

    move-object/from16 v17, p8

    move/from16 v18, p9

    move/from16 v19, p13

    invoke-direct/range {v8 .. v19}, Lcom/android/server/am/HistoryRecord;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;ILandroid/content/Intent;Ljava/lang/String;Landroid/content/pm/ActivityInfo;Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;IZ)V

    .line 3254
    .local v8, r:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_f

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move v0, v5

    move/from16 v1, p11

    if-eq v0, v1, :cond_10

    .line 3256
    :cond_f
    const-string v5, "Activity start"

    move-object/from16 v0, p0

    move/from16 v1, p10

    move/from16 v2, p11

    move-object v3, v5

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v5

    if-nez v5, :cond_10

    .line 3257
    new-instance v27, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;

    move-object/from16 v0, v27

    move-object/from16 v1, p0

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    .line 3258
    .local v27, pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    move-object v0, v8

    move-object/from16 v1, v27

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->r:Lcom/android/server/am/HistoryRecord;

    .line 3259
    move-object/from16 v0, v29

    move-object/from16 v1, v27

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->sourceRecord:Lcom/android/server/am/HistoryRecord;

    .line 3260
    move-object/from16 v0, p4

    move-object/from16 v1, v27

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedUriPermissions:[Landroid/net/Uri;

    .line 3261
    move/from16 v0, p5

    move-object/from16 v1, v27

    iput v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedMode:I

    .line 3262
    move/from16 v0, p12

    move-object/from16 v1, v27

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->onlyIfNeeded:Z

    .line 3263
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v27

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 3264
    const/4 v5, 0x4

    goto/16 :goto_0

    .line 3268
    .end local v27           #pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    :cond_10
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDidAppSwitch:Z

    move v5, v0

    if-eqz v5, :cond_11

    .line 3274
    const-wide/16 v5, 0x0

    move-wide v0, v5

    move-object/from16 v2, p0

    iput-wide v0, v2, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 3279
    :goto_4
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->doPendingActivityLaunchesLocked(Z)V

    .line 3281
    const/4 v15, 0x1

    move-object/from16 v9, p0

    move-object v10, v8

    move-object/from16 v11, v29

    move-object/from16 v12, p4

    move/from16 v13, p5

    move/from16 v14, p12

    invoke-direct/range {v9 .. v15}, Lcom/android/server/am/ActivityManagerService;->startActivityUncheckedLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;[Landroid/net/Uri;IZZ)I

    move-result v5

    goto/16 :goto_0

    .line 3276
    :cond_11
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mDidAppSwitch:Z

    goto :goto_4
.end method

.method private final startActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V
    .locals 21
    .parameter "r"
    .parameter "newTask"
    .parameter "doResume"

    .prologue
    .line 2862
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v14

    .line 2864
    .local v14, NH:I
    const/4 v4, -0x1

    .line 2866
    .local v4, addPos:I
    if-nez p2, :cond_4

    .line 2868
    const/16 v17, 0x0

    .line 2869
    .local v17, next:Lcom/android/server/am/HistoryRecord;
    const/16 v20, 0x1

    .line 2870
    .local v20, startIt:Z
    const/4 v3, 0x1

    sub-int v16, v14, v3

    .local v16, i:I
    :goto_0
    if-ltz v16, :cond_4

    .line 2871
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v18

    check-cast v18, Lcom/android/server/am/HistoryRecord;

    .line 2872
    .local v18, p:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v18

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v3, v0

    if-eqz v3, :cond_0

    .line 2870
    :goto_1
    add-int/lit8 v16, v16, -0x1

    goto :goto_0

    .line 2875
    :cond_0
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    if-ne v3, v5, :cond_2

    .line 2879
    add-int/lit8 v4, v16, 0x1

    .line 2880
    if-nez v20, :cond_4

    .line 2881
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move v1, v4

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 2882
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 2883
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iget v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    add-int/lit8 v5, v5, 0x1

    iput v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 2884
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget v7, v5, Landroid/content/pm/ActivityInfo;->screenOrientation:I

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v8, v0

    move-object/from16 v5, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/WindowManagerService;->addAppToken(ILandroid/view/IApplicationToken;IIZ)V

    .line 2990
    .end local v16           #i:I
    .end local v17           #next:Lcom/android/server/am/HistoryRecord;
    .end local v18           #p:Lcom/android/server/am/HistoryRecord;
    .end local v20           #startIt:Z
    :cond_1
    :goto_2
    return-void

    .line 2893
    .restart local v16       #i:I
    .restart local v17       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v18       #p:Lcom/android/server/am/HistoryRecord;
    .restart local v20       #startIt:Z
    :cond_2
    move-object/from16 v0, v18

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v3, v0

    if-eqz v3, :cond_3

    .line 2894
    const/16 v20, 0x0

    .line 2896
    :cond_3
    move-object/from16 v17, v18

    goto :goto_1

    .line 2902
    .end local v16           #i:I
    .end local v17           #next:Lcom/android/server/am/HistoryRecord;
    .end local v18           #p:Lcom/android/server/am/HistoryRecord;
    .end local v20           #startIt:Z
    :cond_4
    if-gez v4, :cond_5

    .line 2903
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v4

    .line 2909
    :cond_5
    if-ge v4, v14, :cond_6

    .line 2910
    const/4 v3, 0x0

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 2915
    :cond_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move v1, v4

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 2916
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 2917
    move/from16 v0, p2

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 2918
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iget v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    add-int/lit8 v5, v5, 0x1

    iput v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 2919
    if-lez v14, :cond_12

    .line 2923
    move/from16 v13, p2

    .line 2924
    .local v13, showStartingIcon:Z
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v19, v0

    .line 2925
    .local v19, proc:Lcom/android/server/am/ProcessRecord;
    if-nez v19, :cond_7

    .line 2926
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v3, v5, v6}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v19

    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    check-cast v19, Lcom/android/server/am/ProcessRecord;

    .line 2928
    .restart local v19       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_7
    if-eqz v19, :cond_8

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v3, v0

    if-nez v3, :cond_9

    .line 2929
    :cond_8
    const/4 v13, 0x1

    .line 2933
    :cond_9
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/high16 v5, 0x1

    and-int/2addr v3, v5

    if-eqz v3, :cond_d

    .line 2934
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    const/4 v5, 0x0

    invoke-virtual {v3, v5}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 2935
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2945
    :goto_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget v7, v5, Landroid/content/pm/ActivityInfo;->screenOrientation:I

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v8, v0

    move-object/from16 v5, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/WindowManagerService;->addAppToken(ILandroid/view/IApplicationToken;IIZ)V

    .line 2947
    const/4 v15, 0x1

    .line 2948
    .local v15, doShow:Z
    if-eqz p2, :cond_a

    .line 2954
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/high16 v5, 0x20

    and-int/2addr v3, v5

    if-eqz v3, :cond_a

    .line 2956
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, p1

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->resetTaskIfNeededLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    .line 2957
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p1

    if-ne v0, v1, :cond_10

    const/4 v3, 0x1

    move v15, v3

    .line 2960
    :cond_a
    :goto_4
    if-eqz v15, :cond_c

    .line 2965
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v12, v0

    .line 2966
    .local v12, prev:Lcom/android/server/am/HistoryRecord;
    if-eqz v12, :cond_b

    .line 2969
    iget-object v3, v12, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    if-eq v3, v5, :cond_11

    const/4 v12, 0x0

    .line 2973
    :cond_b
    :goto_5
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v7, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->theme:I

    move v8, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->nonLocalizedLabel:Ljava/lang/CharSequence;

    move-object v9, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->labelRes:I

    move v10, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->icon:I

    move v11, v0

    move-object/from16 v6, p1

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/WindowManagerService;->setAppStartingWindow(Landroid/os/IBinder;Ljava/lang/String;ILjava/lang/CharSequence;IILandroid/os/IBinder;Z)V

    .line 2987
    .end local v12           #prev:Lcom/android/server/am/HistoryRecord;
    .end local v13           #showStartingIcon:Z
    .end local v15           #doShow:Z
    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_c
    :goto_6
    if-eqz p3, :cond_1

    .line 2988
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    goto/16 :goto_2

    .line 2936
    .restart local v13       #showStartingIcon:Z
    .restart local v19       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_d
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/high16 v5, 0x8

    and-int/2addr v3, v5

    if-eqz v3, :cond_e

    .line 2937
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    const/16 v5, 0x1008

    invoke-virtual {v3, v5}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 2938
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    goto/16 :goto_3

    .line 2940
    :cond_e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    if-eqz p2, :cond_f

    const/16 v5, 0x1008

    :goto_7
    invoke-virtual {v3, v5}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 2943
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mNoAnimActivities:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    goto/16 :goto_3

    .line 2940
    :cond_f
    const/16 v5, 0x1006

    goto :goto_7

    .line 2957
    .restart local v15       #doShow:Z
    :cond_10
    const/4 v3, 0x0

    move v15, v3

    goto/16 :goto_4

    .line 2971
    .restart local v12       #prev:Lcom/android/server/am/HistoryRecord;
    :cond_11
    iget-boolean v3, v12, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-eqz v3, :cond_b

    const/4 v12, 0x0

    goto :goto_5

    .line 2980
    .end local v12           #prev:Lcom/android/server/am/HistoryRecord;
    .end local v13           #showStartingIcon:Z
    .end local v15           #doShow:Z
    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_12
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget v7, v5, Landroid/content/pm/ActivityInfo;->screenOrientation:I

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v8, v0

    move-object/from16 v5, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/WindowManagerService;->addAppToken(ILandroid/view/IApplicationToken;IIZ)V

    goto :goto_6
.end method

.method private final startActivityMayWait(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZLandroid/app/IActivityManager$WaitResult;Landroid/content/res/Configuration;)I
    .locals 24
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"
    .parameter "debug"
    .parameter "outResult"
    .parameter "config"

    .prologue
    .line 3677
    if-eqz p2, :cond_0

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    if-eqz v4, :cond_0

    .line 3678
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 3681
    :cond_0
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    if-eqz v4, :cond_5

    const/4 v4, 0x1

    move/from16 v17, v4

    .line 3684
    .local v17, componentSpecified:Z
    :goto_0
    new-instance v6, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    .line 3689
    .end local p2
    .local v6, intent:Landroid/content/Intent;
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    const v5, 0x10400

    move-object v0, v4

    move-object v1, v6

    move-object/from16 v2, p3

    move v3, v5

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->resolveIntent(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v22

    .line 3694
    .local v22, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v22, :cond_6

    move-object/from16 v0, v22

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-object v10, v4

    .line 3699
    .end local v22           #rInfo:Landroid/content/pm/ResolveInfo;
    .local v10, aInfo:Landroid/content/pm/ActivityInfo;
    :goto_1
    if-eqz v10, :cond_1

    .line 3704
    new-instance v4, Landroid/content/ComponentName;

    iget-object v5, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 3708
    if-eqz p10, :cond_1

    .line 3709
    iget-object v4, v10, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    const-string v5, "system"

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_1

    .line 3710
    iget-object v4, v10, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    const/4 v5, 0x1

    const/4 v7, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    move v2, v5

    move v3, v7

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->setDebugApp(Ljava/lang/String;ZZ)V

    .line 3715
    :cond_1
    monitor-enter p0

    .line 3718
    if-nez p1, :cond_7

    .line 3719
    :try_start_1
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v14

    .line 3720
    .local v14, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v15

    .line 3725
    .local v15, callingUid:I
    :goto_2
    if-eqz p12, :cond_8

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p12

    invoke-virtual {v0, v1}, Landroid/content/res/Configuration;->diff(Landroid/content/res/Configuration;)I

    move-result v4

    if-eqz v4, :cond_8

    const/4 v4, 0x1

    :goto_3
    move v0, v4

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfigWillChange:Z

    .line 3729
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v19

    .local v19, origId:J
    move-object/from16 v4, p0

    move-object/from16 v5, p1

    move-object/from16 v7, p3

    move-object/from16 v8, p4

    move/from16 v9, p5

    move-object/from16 v11, p6

    move-object/from16 v12, p7

    move/from16 v13, p8

    move/from16 v16, p9

    .line 3731
    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    move-result v23

    .line 3736
    .local v23, res:I
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfigWillChange:Z

    move v4, v0

    if-eqz v4, :cond_2

    .line 3741
    const-string v4, "android.permission.CHANGE_CONFIGURATION"

    const-string v5, "updateConfiguration()"

    move-object/from16 v0, p0

    move-object v1, v4

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 3743
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfigWillChange:Z

    .line 3746
    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p12

    move-object v2, v4

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    .line 3749
    :cond_2
    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 3751
    if-eqz p11, :cond_4

    .line 3752
    move/from16 v0, v23

    move-object/from16 v1, p11

    iput v0, v1, Landroid/app/IActivityManager$WaitResult;->result:I

    .line 3753
    if-nez v23, :cond_9

    .line 3754
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityLaunched:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p11

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 3757
    :cond_3
    :try_start_2
    invoke-virtual/range {p0 .. p0}, Ljava/lang/Object;->wait()V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Ljava/lang/InterruptedException; {:try_start_2 .. :try_end_2} :catch_1

    .line 3760
    :goto_4
    :try_start_3
    move-object/from16 v0, p11

    iget-boolean v0, v0, Landroid/app/IActivityManager$WaitResult;->timeout:Z

    move v4, v0

    if-nez v4, :cond_4

    move-object/from16 v0, p11

    iget-object v0, v0, Landroid/app/IActivityManager$WaitResult;->who:Landroid/content/ComponentName;

    move-object v4, v0

    if-eqz v4, :cond_3

    .line 3781
    .end local v6           #intent:Landroid/content/Intent;
    :cond_4
    :goto_5
    monitor-exit p0

    return v23

    .line 3681
    .end local v10           #aInfo:Landroid/content/pm/ActivityInfo;
    .end local v14           #callingPid:I
    .end local v15           #callingUid:I
    .end local v17           #componentSpecified:Z
    .end local v19           #origId:J
    .end local v23           #res:I
    .restart local p2
    :cond_5
    const/4 v4, 0x0

    move/from16 v17, v4

    goto/16 :goto_0

    .line 3694
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v17       #componentSpecified:Z
    .restart local v22       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_6
    const/4 v4, 0x0

    move-object v10, v4

    goto/16 :goto_1

    .line 3695
    .end local v22           #rInfo:Landroid/content/pm/ResolveInfo;
    :catch_0
    move-exception v4

    move-object/from16 v18, v4

    .line 3696
    .local v18, e:Landroid/os/RemoteException;
    const/4 v10, 0x0

    .restart local v10       #aInfo:Landroid/content/pm/ActivityInfo;
    goto/16 :goto_1

    .line 3722
    .end local v18           #e:Landroid/os/RemoteException;
    :cond_7
    const/4 v15, -0x1

    .restart local v15       #callingUid:I
    move v14, v15

    .restart local v14       #callingPid:I
    goto/16 :goto_2

    .line 3725
    :cond_8
    const/4 v4, 0x0

    goto :goto_3

    .line 3761
    .restart local v19       #origId:J
    .restart local v23       #res:I
    :cond_9
    const/4 v4, 0x2

    move/from16 v0, v23

    move v1, v4

    if-ne v0, v1, :cond_4

    .line 3762
    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v21

    .line 3763
    .local v21, r:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v21

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    move v4, v0

    if-eqz v4, :cond_a

    .line 3764
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p11

    iput-boolean v0, v1, Landroid/app/IActivityManager$WaitResult;->timeout:Z

    .line 3765
    new-instance v4, Landroid/content/ComponentName;

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    .end local v6           #intent:Landroid/content/Intent;
    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    move-object v0, v4

    move-object/from16 v1, p11

    iput-object v0, v1, Landroid/app/IActivityManager$WaitResult;->who:Landroid/content/ComponentName;

    .line 3766
    const-wide/16 v4, 0x0

    move-wide v0, v4

    move-object/from16 v2, p11

    iput-wide v0, v2, Landroid/app/IActivityManager$WaitResult;->totalTime:J

    .line 3767
    const-wide/16 v4, 0x0

    move-wide v0, v4

    move-object/from16 v2, p11

    iput-wide v0, v2, Landroid/app/IActivityManager$WaitResult;->thisTime:J

    goto :goto_5

    .line 3782
    .end local v14           #callingPid:I
    .end local v15           #callingUid:I
    .end local v19           #origId:J
    .end local v21           #r:Lcom/android/server/am/HistoryRecord;
    .end local v23           #res:I
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    throw v4

    .line 3769
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v14       #callingPid:I
    .restart local v15       #callingUid:I
    .restart local v19       #origId:J
    .restart local v21       #r:Lcom/android/server/am/HistoryRecord;
    .restart local v23       #res:I
    :cond_a
    :try_start_4
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v4

    move-wide v0, v4

    move-object/from16 v2, p11

    iput-wide v0, v2, Landroid/app/IActivityManager$WaitResult;->thisTime:J

    .line 3770
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityVisible:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p11

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    .line 3773
    :cond_b
    :try_start_5
    invoke-virtual/range {p0 .. p0}, Ljava/lang/Object;->wait()V
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0
    .catch Ljava/lang/InterruptedException; {:try_start_5 .. :try_end_5} :catch_2

    .line 3776
    :goto_6
    :try_start_6
    move-object/from16 v0, p11

    iget-boolean v0, v0, Landroid/app/IActivityManager$WaitResult;->timeout:Z

    move v4, v0

    if-nez v4, :cond_4

    move-object/from16 v0, p11

    iget-object v0, v0, Landroid/app/IActivityManager$WaitResult;->who:Landroid/content/ComponentName;

    move-object v4, v0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    if-eqz v4, :cond_b

    goto/16 :goto_5

    .line 3758
    .end local v21           #r:Lcom/android/server/am/HistoryRecord;
    :catch_1
    move-exception v4

    goto/16 :goto_4

    .line 3774
    .restart local v21       #r:Lcom/android/server/am/HistoryRecord;
    :catch_2
    move-exception v4

    goto :goto_6
.end method

.method private final startActivityUncheckedLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;[Landroid/net/Uri;IZZ)I
    .locals 28
    .parameter "r"
    .parameter "sourceRecord"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "onlyIfNeeded"
    .parameter "doResume"

    .prologue
    .line 3302
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object/from16 v20, v0

    .line 3303
    .local v20, intent:Landroid/content/Intent;
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchedFromUid:I

    move v6, v0

    .line 3305
    .local v6, callingUid:I
    invoke-virtual/range {v20 .. v20}, Landroid/content/Intent;->getFlags()I

    move-result v21

    .line 3309
    .local v21, launchFlags:I
    const/high16 v5, 0x4

    and-int v5, v5, v21

    if-nez v5, :cond_3

    const/4 v5, 0x1

    :goto_0
    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 3316
    if-nez p6, :cond_0

    .line 3317
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->delayedResume:Z

    .line 3320
    :cond_0
    const/high16 v5, 0x100

    and-int v5, v5, v21

    if-eqz v5, :cond_4

    move-object/from16 v23, p1

    .line 3327
    .local v23, notTop:Lcom/android/server/am/HistoryRecord;
    :goto_1
    if-eqz p5, :cond_2

    .line 3328
    move-object/from16 v17, p2

    .line 3329
    .local v17, checkedCaller:Lcom/android/server/am/HistoryRecord;
    if-nez v17, :cond_1

    .line 3330
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v17

    .line 3332
    :cond_1
    move-object/from16 v0, v17

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v7, v0

    invoke-virtual {v5, v7}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_2

    .line 3334
    const/16 p5, 0x0

    .line 3338
    .end local v17           #checkedCaller:Lcom/android/server/am/HistoryRecord;
    :cond_2
    if-eqz p3, :cond_5

    if-lez v6, :cond_5

    .line 3339
    const/16 v19, 0x0

    .local v19, i:I
    :goto_2
    move-object/from16 v0, p3

    array-length v0, v0

    move v5, v0

    move/from16 v0, v19

    move v1, v5

    if-ge v0, v1, :cond_5

    .line 3340
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v7, v0

    aget-object v8, p3, v19

    move-object/from16 v5, p0

    move/from16 v9, p4

    move-object/from16 v10, p1

    invoke-direct/range {v5 .. v10}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V

    .line 3339
    add-int/lit8 v19, v19, 0x1

    goto :goto_2

    .line 3309
    .end local v19           #i:I
    .end local v23           #notTop:Lcom/android/server/am/HistoryRecord;
    :cond_3
    const/4 v5, 0x0

    goto :goto_0

    .line 3320
    :cond_4
    const/4 v5, 0x0

    move-object/from16 v23, v5

    goto :goto_1

    .line 3345
    .restart local v23       #notTop:Lcom/android/server/am/HistoryRecord;
    :cond_5
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v5, v0

    move-object/from16 v0, p0

    move v1, v6

    move-object v2, v5

    move-object/from16 v3, v20

    move-object/from16 v4, p1

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V

    .line 3348
    if-nez p2, :cond_f

    .line 3351
    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-nez v5, :cond_6

    .line 3352
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    .end local v6           #callingUid:I
    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "startActivity called from non-Activity context; forcing Intent.FLAG_ACTIVITY_NEW_TASK for: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v20

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3354
    const/high16 v5, 0x1000

    or-int v21, v21, v5

    .line 3368
    :cond_6
    :goto_3
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_7

    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-eqz v5, :cond_7

    .line 3374
    const-string v5, "ActivityManager"

    const-string v6, "Activity is launching as a new task, so cancelling activity result."

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3375
    const/4 v8, -0x1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v9, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move v11, v0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object/from16 v7, p0

    invoke-virtual/range {v7 .. v13}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3378
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3381
    :cond_7
    const/4 v15, 0x0

    .line 3382
    .local v15, addingToTask:Z
    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-eqz v5, :cond_8

    const/high16 v5, 0x800

    and-int v5, v5, v21

    if-eqz v5, :cond_9

    :cond_8
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-eq v5, v6, :cond_9

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-ne v5, v6, :cond_1f

    .line 3389
    :cond_9
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-nez v5, :cond_1f

    .line 3394
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-eq v5, v6, :cond_12

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v20

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->findTaskLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    move-object/from16 v25, v5

    .line 3397
    .local v25, taskTop:Lcom/android/server/am/HistoryRecord;
    :goto_4
    if-eqz v25, :cond_1f

    .line 3398
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-nez v5, :cond_a

    .line 3403
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    move-object v0, v5

    move-object/from16 v1, v20

    move-object v2, v6

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    .line 3411
    :cond_a
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v18

    .line 3412
    .local v18, curTop:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    if-eq v5, v6, :cond_c

    .line 3413
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    const/high16 v6, 0x40

    invoke-virtual {v5, v6}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 3414
    if-eqz p2, :cond_b

    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    if-ne v5, v6, :cond_13

    :cond_b
    const/4 v5, 0x1

    move/from16 v16, v5

    .line 3416
    .local v16, callerAtFront:Z
    :goto_5
    if-eqz v16, :cond_c

    .line 3419
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object v1, v5

    move-object/from16 v2, p1

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;Lcom/android/server/am/HistoryRecord;)V

    .line 3424
    .end local v16           #callerAtFront:Z
    :cond_c
    const/high16 v5, 0x20

    and-int v5, v5, v21

    if-eqz v5, :cond_d

    .line 3425
    move-object/from16 v0, p0

    move-object/from16 v1, v25

    move-object/from16 v2, p1

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->resetTaskIfNeededLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v25

    .line 3427
    :cond_d
    if-eqz p5, :cond_14

    .line 3432
    if-eqz p6, :cond_e

    .line 3433
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3435
    :cond_e
    const/4 v5, 0x1

    .line 3641
    .end local v18           #curTop:Lcom/android/server/am/HistoryRecord;
    .end local v25           #taskTop:Lcom/android/server/am/HistoryRecord;
    .end local p3
    :goto_6
    return v5

    .line 3356
    .end local v15           #addingToTask:Z
    .restart local v6       #callingUid:I
    .restart local p3
    :cond_f
    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-ne v5, v6, :cond_10

    .line 3360
    .end local v6           #callingUid:I
    const/high16 v5, 0x1000

    or-int v21, v21, v5

    goto/16 :goto_3

    .line 3361
    :cond_10
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-eq v5, v6, :cond_11

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-ne v5, v6, :cond_6

    .line 3365
    :cond_11
    const/high16 v5, 0x1000

    or-int v21, v21, v5

    goto/16 :goto_3

    .line 3394
    .restart local v15       #addingToTask:Z
    :cond_12
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v20

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->findActivityLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    move-object/from16 v25, v5

    goto/16 :goto_4

    .line 3414
    .restart local v18       #curTop:Lcom/android/server/am/HistoryRecord;
    .restart local v25       #taskTop:Lcom/android/server/am/HistoryRecord;
    :cond_13
    const/4 v5, 0x0

    move/from16 v16, v5

    goto :goto_5

    .line 3437
    :cond_14
    const/high16 v5, 0x400

    and-int v5, v5, v21

    if-nez v5, :cond_15

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-eq v5, v6, :cond_15

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-ne v5, v6, :cond_1a

    .line 3444
    :cond_15
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    const/4 v6, 0x1

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move/from16 v3, v21

    move v4, v6

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->performClearTaskLocked(ILcom/android/server/am/HistoryRecord;IZ)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3446
    .local v26, top:Lcom/android/server/am/HistoryRecord;
    if-eqz v26, :cond_19

    .line 3447
    move-object/from16 v0, v26

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    move v5, v0

    if-eqz v5, :cond_16

    .line 3452
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    invoke-virtual {v5, v6, v7}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    .line 3454
    :cond_16
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3455
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3506
    .end local v26           #top:Lcom/android/server/am/HistoryRecord;
    :cond_17
    :goto_7
    if-nez v15, :cond_1f

    .line 3510
    if-eqz p6, :cond_18

    .line 3511
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3513
    :cond_18
    const/4 v5, 0x2

    goto/16 :goto_6

    .line 3461
    .restart local v26       #top:Lcom/android/server/am/HistoryRecord;
    :cond_19
    const/4 v15, 0x1

    .line 3465
    move-object/from16 p2, v25

    goto :goto_7

    .line 3467
    .end local v26           #top:Lcom/android/server/am/HistoryRecord;
    :cond_1a
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    iget-object v6, v6, Lcom/android/server/am/TaskRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v5, v6}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_1d

    .line 3474
    const/high16 v5, 0x2000

    and-int v5, v5, v21

    if-eqz v5, :cond_1c

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v6, v0

    invoke-virtual {v5, v6}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_1c

    .line 3476
    const/16 v5, 0x7533

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3477
    move-object/from16 v0, v25

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    move v5, v0

    if-eqz v5, :cond_1b

    .line 3478
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    invoke-virtual {v5, v6, v7}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    .line 3480
    :cond_1b
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v25

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    goto :goto_7

    .line 3481
    :cond_1c
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    iget-object v6, v6, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5, v6}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v5

    if-nez v5, :cond_17

    .line 3485
    const/4 v15, 0x1

    .line 3486
    move-object/from16 p2, v25

    goto/16 :goto_7

    .line 3488
    :cond_1d
    const/high16 v5, 0x20

    and-int v5, v5, v21

    if-nez v5, :cond_1e

    .line 3494
    const/4 v15, 0x1

    .line 3495
    move-object/from16 p2, v25

    goto/16 :goto_7

    .line 3496
    :cond_1e
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget-boolean v5, v5, Lcom/android/server/am/TaskRecord;->rootWasReset:Z

    if-nez v5, :cond_17

    .line 3504
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    invoke-virtual {v5, v6, v7}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    goto/16 :goto_7

    .line 3525
    .end local v18           #curTop:Lcom/android/server/am/HistoryRecord;
    .end local v25           #taskTop:Lcom/android/server/am/HistoryRecord;
    :cond_1f
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v5, v0

    if-eqz v5, :cond_23

    .line 3529
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3530
    .restart local v26       #top:Lcom/android/server/am/HistoryRecord;
    if-eqz v26, :cond_25

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-nez v5, :cond_25

    .line 3531
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v6, v0

    invoke-virtual {v5, v6}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_25

    .line 3532
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-eqz v5, :cond_25

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v5, :cond_25

    .line 3533
    const/high16 v5, 0x2000

    and-int v5, v5, v21

    if-nez v5, :cond_20

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x1

    if-eq v5, v6, :cond_20

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-ne v5, v6, :cond_25

    .line 3536
    :cond_20
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, v26

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3539
    if-eqz p6, :cond_21

    .line 3540
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3542
    :cond_21
    if-eqz p5, :cond_22

    .line 3546
    const/4 v5, 0x1

    goto/16 :goto_6

    .line 3548
    :cond_22
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3549
    const/4 v5, 0x3

    goto/16 :goto_6

    .line 3556
    .end local v26           #top:Lcom/android/server/am/HistoryRecord;
    :cond_23
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_24

    .line 3557
    const/4 v8, -0x1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v9, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move v11, v0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object/from16 v7, p0

    invoke-virtual/range {v7 .. v13}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3561
    :cond_24
    const/4 v5, -0x2

    goto/16 :goto_6

    .line 3564
    .restart local v26       #top:Lcom/android/server/am/HistoryRecord;
    :cond_25
    const/16 v22, 0x0

    .line 3567
    .local v22, newTask:Z
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-nez v5, :cond_29

    if-nez v15, :cond_29

    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-eqz v5, :cond_29

    .line 3570
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v5, v0

    add-int/lit8 v5, v5, 0x1

    move v0, v5

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 3571
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v5, v0

    if-gtz v5, :cond_26

    .line 3572
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 3574
    :cond_26
    new-instance v5, Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v8, v8, 0x4

    if-eqz v8, :cond_28

    const/4 v8, 0x1

    :goto_8
    move-object v0, v5

    move v1, v6

    move-object v2, v7

    move-object/from16 v3, v20

    move v4, v8

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/TaskRecord;-><init>(ILandroid/content/pm/ActivityInfo;Landroid/content/Intent;Z)V

    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 3578
    const/16 v22, 0x1

    .line 3579
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addRecentTaskLocked(Lcom/android/server/am/TaskRecord;)V

    .line 3636
    .end local p3
    :goto_9
    if-eqz v22, :cond_27

    .line 3637
    const/16 v5, 0x7534

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v5, v6}, Landroid/util/EventLog;->writeEvent(II)I

    .line 3639
    :cond_27
    const/16 v5, 0x7535

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3640
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, v22

    move/from16 v3, p6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    .line 3641
    const/4 v5, 0x0

    goto/16 :goto_6

    .line 3574
    .restart local p3
    :cond_28
    const/4 v8, 0x0

    goto :goto_8

    .line 3581
    :cond_29
    if-eqz p2, :cond_2e

    .line 3582
    if-nez v15, :cond_2b

    const/high16 v5, 0x400

    and-int v5, v5, v21

    if-eqz v5, :cond_2b

    .line 3587
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    const/4 v6, 0x1

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move/from16 v3, v21

    move v4, v6

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->performClearTaskLocked(ILcom/android/server/am/HistoryRecord;IZ)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3589
    if-eqz v26, :cond_2d

    .line 3590
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3591
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3594
    if-eqz p6, :cond_2a

    .line 3595
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3597
    :cond_2a
    const/4 v5, 0x3

    goto/16 :goto_6

    .line 3599
    :cond_2b
    if-nez v15, :cond_2d

    const/high16 v5, 0x2

    and-int v5, v5, v21

    if-eqz v5, :cond_2d

    .line 3604
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->findActivityInHistoryLocked(Lcom/android/server/am/HistoryRecord;I)I

    move-result v27

    .line 3605
    .local v27, where:I
    if-ltz v27, :cond_2d

    .line 3606
    move-object/from16 v0, p0

    move/from16 v1, v27

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->moveActivityToFrontLocked(I)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3607
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3608
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3609
    if-eqz p6, :cond_2c

    .line 3610
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3612
    :cond_2c
    const/4 v5, 0x3

    goto/16 :goto_6

    .line 3618
    .end local v27           #where:I
    :cond_2d
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    goto/16 :goto_9

    .line 3626
    :cond_2e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v14

    .line 3627
    .local v14, N:I
    if-lez v14, :cond_2f

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x1

    sub-int v6, v14, v6

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p3

    .end local p3
    check-cast p3, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v24, p3

    .line 3629
    .local v24, prev:Lcom/android/server/am/HistoryRecord;
    :goto_a
    if-eqz v24, :cond_30

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    :goto_b
    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    goto/16 :goto_9

    .line 3627
    .end local v24           #prev:Lcom/android/server/am/HistoryRecord;
    .restart local p3
    :cond_2f
    const/4 v5, 0x0

    move-object/from16 v24, v5

    goto :goto_a

    .line 3629
    .end local p3
    .restart local v24       #prev:Lcom/android/server/am/HistoryRecord;
    :cond_30
    new-instance v5, Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v8, v8, 0x4

    if-eqz v8, :cond_31

    const/4 v8, 0x1

    :goto_c
    move-object v0, v5

    move v1, v6

    move-object v2, v7

    move-object/from16 v3, v20

    move v4, v8

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/TaskRecord;-><init>(ILandroid/content/pm/ActivityInfo;Landroid/content/Intent;Z)V

    goto :goto_b

    :cond_31
    const/4 v8, 0x0

    goto :goto_c
.end method

.method private startHomeActivityLocked()Z
    .locals 15

    .prologue
    .line 2479
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    const/4 v1, 0x1

    if-ne v0, v1, :cond_0

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    if-nez v0, :cond_0

    .line 2484
    const/4 v0, 0x0

    .line 2511
    :goto_0
    return v0

    .line 2486
    :cond_0
    new-instance v2, Landroid/content/Intent;

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    if-eqz v1, :cond_4

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    invoke-static {v1}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v1

    :goto_1
    invoke-direct {v2, v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    .line 2489
    .local v2, intent:Landroid/content/Intent;
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    invoke-virtual {v2, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 2490
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    const/4 v1, 0x1

    if-eq v0, v1, :cond_1

    .line 2491
    const-string v0, "android.intent.category.HOME"

    invoke-virtual {v2, v0}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 2493
    :cond_1
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v0

    const/16 v1, 0x400

    invoke-virtual {v2, v0, v1}, Landroid/content/Intent;->resolveActivityInfo(Landroid/content/pm/PackageManager;I)Landroid/content/pm/ActivityInfo;

    move-result-object v6

    .line 2496
    .local v6, aInfo:Landroid/content/pm/ActivityInfo;
    if-eqz v6, :cond_3

    .line 2497
    new-instance v0, Landroid/content/ComponentName;

    iget-object v1, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v3, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v0, v1, v3}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v2, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 2501
    iget-object v0, v6, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    iget-object v1, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v14

    .line 2503
    .local v14, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v14, :cond_2

    iget-object v0, v14, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    if-nez v0, :cond_3

    .line 2504
    :cond_2
    invoke-virtual {v2}, Landroid/content/Intent;->getFlags()I

    move-result v0

    const/high16 v1, 0x1000

    or-int/2addr v0, v1

    invoke-virtual {v2, v0}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 2505
    const/4 v1, 0x0

    const/4 v3, 0x0

    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object v0, p0

    invoke-direct/range {v0 .. v13}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    .line 2511
    .end local v14           #app:Lcom/android/server/am/ProcessRecord;
    :cond_3
    const/4 v0, 0x1

    goto :goto_0

    .line 2486
    .end local v2           #intent:Landroid/content/Intent;
    .end local v6           #aInfo:Landroid/content/pm/ActivityInfo;
    :cond_4
    const/4 v1, 0x0

    goto :goto_1
.end method

.method private final startPausingLocked(ZZ)V
    .locals 10
    .parameter "userLeaving"
    .parameter "uiSleeping"

    .prologue
    const/16 v9, 0x10

    const/4 v7, 0x0

    const-string v8, "ActivityManager"

    .line 2113
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v3, :cond_0

    .line 2114
    new-instance v0, Ljava/lang/RuntimeException;

    invoke-direct {v0}, Ljava/lang/RuntimeException;-><init>()V

    .line 2115
    .local v0, e:Ljava/lang/RuntimeException;
    const-string v3, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Trying to pause when pause is already pending for "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v8, v3, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2118
    .end local v0           #e:Ljava/lang/RuntimeException;
    :cond_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2119
    .local v2, prev:Lcom/android/server/am/HistoryRecord;
    if-nez v2, :cond_1

    .line 2120
    new-instance v0, Ljava/lang/RuntimeException;

    invoke-direct {v0}, Ljava/lang/RuntimeException;-><init>()V

    .line 2121
    .restart local v0       #e:Ljava/lang/RuntimeException;
    const-string v3, "ActivityManager"

    const-string v3, "Trying to pause when nothing is resumed"

    invoke-static {v8, v3, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2122
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 2190
    .end local v0           #e:Ljava/lang/RuntimeException;
    :goto_0
    return-void

    .line 2126
    :cond_1
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2127
    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2128
    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2129
    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v3, v2, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 2130
    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-virtual {v3}, Lcom/android/server/am/TaskRecord;->touchActiveTime()V

    .line 2132
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 2134
    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4

    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_4

    .line 2137
    const/16 v3, 0x753d

    const/4 v4, 0x2

    :try_start_0
    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    invoke-static {v2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v6

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x1

    iget-object v6, v2, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v6, v4, v5

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 2140
    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-boolean v4, v2, Lcom/android/server/am/HistoryRecord;->finishing:Z

    iget v5, v2, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-interface {v3, v2, v4, p1, v5}, Landroid/app/IApplicationThread;->schedulePauseActivity(Landroid/os/IBinder;ZZI)V

    .line 2142
    const/4 v3, 0x0

    invoke-direct {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->updateUsageStats(Lcom/android/server/am/HistoryRecord;Z)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 2156
    :goto_1
    iget-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v3, :cond_2

    iget-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-nez v3, :cond_2

    .line 2157
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v3}, Landroid/os/PowerManager$WakeLock;->acquire()V

    .line 2158
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v3, v9}, Landroid/os/Handler;->hasMessages(I)Z

    move-result v3

    if-nez v3, :cond_2

    .line 2160
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v3, v9}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 2161
    .local v1, msg:Landroid/os/Message;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v4, 0x4e20

    invoke-virtual {v3, v1, v4, v5}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2166
    .end local v1           #msg:Landroid/os/Message;
    :cond_2
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v3, :cond_5

    .line 2171
    if-nez p2, :cond_3

    .line 2172
    invoke-virtual {v2}, Lcom/android/server/am/HistoryRecord;->pauseKeyDispatchingLocked()V

    .line 2180
    :cond_3
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0x9

    invoke-virtual {v3, v4}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 2181
    .restart local v1       #msg:Landroid/os/Message;
    iput-object v2, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 2182
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v4, 0x1f4

    invoke-virtual {v3, v1, v4, v5}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    goto :goto_0

    .line 2143
    .end local v1           #msg:Landroid/os/Message;
    :catch_0
    move-exception v3

    move-object v0, v3

    .line 2145
    .local v0, e:Ljava/lang/Exception;
    const-string v3, "ActivityManager"

    const-string v3, "Exception thrown during pause"

    invoke-static {v8, v3, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2146
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2147
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    goto :goto_1

    .line 2150
    .end local v0           #e:Ljava/lang/Exception;
    :cond_4
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2151
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    goto :goto_1

    .line 2188
    :cond_5
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    goto/16 :goto_0
.end method

.method private final startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;
    .locals 8
    .parameter "processName"
    .parameter "info"
    .parameter "knownToBeDead"
    .parameter "intentFlags"
    .parameter "hostingType"
    .parameter "hostingName"
    .parameter "allowWhileBooting"

    .prologue
    const/4 v7, 0x1

    const/4 v6, 0x0

    const/4 v5, 0x0

    .line 1914
    iget v2, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 1925
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v0, :cond_2

    iget v2, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v2, :cond_2

    .line 1926
    if-eqz p3, :cond_0

    iget-object v2, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v2, :cond_1

    :cond_0
    move-object v2, v0

    .line 1982
    :goto_0
    return-object v2

    .line 1933
    :cond_1
    invoke-direct {p0, v0, v7}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 1937
    :cond_2
    if-eqz p6, :cond_3

    invoke-virtual {p6}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v2

    move-object v1, v2

    .line 1940
    .local v1, hostingNameStr:Ljava/lang/String;
    :goto_1
    and-int/lit8 v2, p4, 0x4

    if-eqz v2, :cond_4

    .line 1943
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v2

    if-eqz v2, :cond_5

    move-object v2, v5

    .line 1944
    goto :goto_0

    .end local v1           #hostingNameStr:Ljava/lang/String;
    :cond_3
    move-object v1, v5

    .line 1937
    goto :goto_1

    .line 1951
    .restart local v1       #hostingNameStr:Ljava/lang/String;
    :cond_4
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 1952
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v2

    if-eqz v2, :cond_5

    .line 1953
    const/16 v2, 0x7540

    const/4 v3, 0x2

    new-array v3, v3, [Ljava/lang/Object;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v3, v6

    iget-object v4, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    aput-object v4, v3, v7

    invoke-static {v2, v3}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 1955
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 1956
    if-eqz v0, :cond_5

    .line 1957
    iput-boolean v6, v0, Lcom/android/server/am/ProcessRecord;->bad:Z

    .line 1962
    :cond_5
    if-nez v0, :cond_7

    .line 1963
    invoke-virtual {p0, v5, p2, p1}, Lcom/android/server/am/ActivityManagerService;->newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 1964
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget v3, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, p1, v3, v0}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 1972
    :goto_2
    iget-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    if-nez v2, :cond_8

    invoke-virtual {p0, p2}, Lcom/android/server/am/ActivityManagerService;->isAllowedWhileBooting(Landroid/content/pm/ApplicationInfo;)Z

    move-result v2

    if-nez v2, :cond_8

    if-nez p7, :cond_8

    .line 1975
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_6

    .line 1976
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    :cond_6
    move-object v2, v0

    .line 1978
    goto :goto_0

    .line 1967
    :cond_7
    iget-object v2, p2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v2}, Lcom/android/server/am/ProcessRecord;->addPackage(Ljava/lang/String;)Z

    goto :goto_2

    .line 1981
    :cond_8
    invoke-direct {p0, v0, p5, v1}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 1982
    iget v2, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eqz v2, :cond_9

    move-object v2, v0

    goto/16 :goto_0

    :cond_9
    move-object v2, v5

    goto/16 :goto_0
.end method

.method private final startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V
    .locals 17
    .parameter "app"
    .parameter "hostingType"
    .parameter "hostingNameStr"

    .prologue
    .line 1991
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    if-lez v4, :cond_0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v4, v5, :cond_0

    .line 1992
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    monitor-enter v4

    .line 1993
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v6, v0

    invoke-virtual {v5, v6}, Landroid/util/SparseArray;->remove(I)V

    .line 1994
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x14

    move-object v0, v5

    move v1, v6

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 1995
    monitor-exit v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 1996
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 1999
    :cond_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2001
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 2003
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v4, v0

    const/4 v5, 0x0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v6, v0

    const/4 v7, 0x1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v8, v0

    array-length v8, v8

    const/4 v9, 0x1

    sub-int/2addr v8, v9

    invoke-static {v4, v5, v6, v7, v8}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    .line 2004
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v4, v0

    const/4 v5, 0x0

    const/4 v6, 0x0

    aput v6, v4, v5

    .line 2007
    :try_start_1
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v6, v4, Landroid/content/pm/ApplicationInfo;->uid:I
    :try_end_1
    .catch Ljava/lang/RuntimeException; {:try_start_1 .. :try_end_1} :catch_1

    .line 2008
    .local v6, uid:I
    const/4 v8, 0x0

    .line 2010
    .local v8, gids:[I
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Landroid/content/pm/PackageManager;->getPackageGids(Ljava/lang/String;)[I
    :try_end_2
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_2 .. :try_end_2} :catch_0
    .catch Ljava/lang/RuntimeException; {:try_start_2 .. :try_end_2} :catch_1

    move-result-object v8

    .line 2015
    :goto_0
    :try_start_3
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    if-eqz v4, :cond_2

    .line 2016
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    const/4 v5, 0x1

    if-ne v4, v5, :cond_1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    move-object v4, v0

    if-eqz v4, :cond_1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v4, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_1

    .line 2019
    const/4 v6, 0x0

    .line 2021
    :cond_1
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    const/4 v5, 0x2

    if-ne v4, v5, :cond_2

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v4, v4, 0x10

    if-eqz v4, :cond_2

    .line 2023
    const/4 v6, 0x0

    .line 2026
    :cond_2
    const/4 v9, 0x0

    .line 2027
    .local v9, debugFlags:I
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v4, v4, 0x2

    if-eqz v4, :cond_3

    .line 2028
    or-int/lit8 v9, v9, 0x1

    .line 2032
    :cond_3
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit16 v4, v4, 0x4000

    if-nez v4, :cond_4

    sget-boolean v4, Ldalvik/system/Zygote;->systemInSafeMode:Z

    const/4 v5, 0x1

    if-ne v4, v5, :cond_5

    .line 2034
    :cond_4
    or-int/lit8 v9, v9, 0x8

    .line 2036
    :cond_5
    const-string v4, "1"

    const-string v5, "debug.checkjni"

    invoke-static {v5}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_6

    .line 2037
    or-int/lit8 v9, v9, 0x2

    .line 2039
    :cond_6
    const-string v4, "1"

    const-string v5, "debug.assert"

    invoke-static {v5}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_7

    .line 2040
    or-int/lit8 v9, v9, 0x4

    .line 2042
    :cond_7
    const-string v4, "android.app.ActivityThread"

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    move v5, v0

    if-eqz v5, :cond_c

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    :goto_1
    const/4 v10, 0x0

    move v7, v6

    invoke-static/range {v4 .. v10}, Landroid/os/Process;->start(Ljava/lang/String;Ljava/lang/String;II[II[Ljava/lang/String;)I

    move-result v16

    .line 2045
    .local v16, pid:I
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->batteryStats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-object v4, v0

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v11

    .line 2046
    .local v11, bs:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v11
    :try_end_3
    .catch Ljava/lang/RuntimeException; {:try_start_3 .. :try_end_3} :catch_1

    .line 2047
    :try_start_4
    invoke-virtual {v11}, Lcom/android/internal/os/BatteryStatsImpl;->isOnBattery()Z

    move-result v4

    if-eqz v4, :cond_8

    .line 2048
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->batteryStats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-object v4, v0

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->incStartsLocked()V

    .line 2050
    :cond_8
    monitor-exit v11
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 2052
    const/16 v4, 0x753e

    const/4 v5, 0x5

    :try_start_5
    new-array v5, v5, [Ljava/lang/Object;

    const/4 v7, 0x0

    invoke-static/range {v16 .. v16}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    .end local v9           #debugFlags:I
    aput-object v9, v5, v7

    const/4 v7, 0x1

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v5, v7

    const/4 v7, 0x2

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v9, v0

    aput-object v9, v5, v7

    const/4 v7, 0x3

    aput-object p2, v5, v7

    const/4 v7, 0x4

    if-eqz p3, :cond_d

    move-object/from16 v9, p3

    :goto_2
    aput-object v9, v5, v7

    invoke-static {v4, v5}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 2056
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v4, v0

    if-eqz v4, :cond_9

    .line 2057
    invoke-static {}, Lcom/android/server/Watchdog;->getInstance()Lcom/android/server/Watchdog;

    move-result-object v4

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    move-object v0, v4

    move-object/from16 v1, p1

    move-object v2, v5

    move/from16 v3, v16

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/Watchdog;->processStarted(Lcom/android/server/Watchdog$PssRequestor;Ljava/lang/String;I)V

    .line 2060
    :cond_9
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    move-object v12, v0

    .line 2061
    .local v12, buf:Ljava/lang/StringBuilder;
    const/4 v4, 0x0

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 2062
    const-string v4, "Start proc "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2063
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2064
    const-string v4, " for "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2065
    move-object v0, v12

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2066
    if-eqz p3, :cond_a

    .line 2067
    const-string v4, " "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2068
    move-object v0, v12

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2070
    :cond_a
    const-string v4, ": pid="

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2071
    move-object v0, v12

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 2072
    const-string v4, " uid="

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2073
    invoke-virtual {v12, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 2074
    const-string v4, " gids={"

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2075
    if-eqz v8, :cond_e

    .line 2076
    const/4 v14, 0x0

    .local v14, gi:I
    :goto_3
    array-length v4, v8

    if-ge v14, v4, :cond_e

    .line 2077
    if-eqz v14, :cond_b

    const-string v4, ", "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2078
    :cond_b
    aget v4, v8, v14

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
    :try_end_5
    .catch Ljava/lang/RuntimeException; {:try_start_5 .. :try_end_5} :catch_1

    .line 2076
    add-int/lit8 v14, v14, 0x1

    goto :goto_3

    .line 1995
    .end local v6           #uid:I
    .end local v8           #gids:[I
    .end local v11           #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v12           #buf:Ljava/lang/StringBuilder;
    .end local v14           #gi:I
    .end local v16           #pid:I
    :catchall_0
    move-exception v5

    :try_start_6
    monitor-exit v4
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    throw v5

    .line 2012
    .restart local v6       #uid:I
    .restart local v8       #gids:[I
    :catch_0
    move-exception v4

    move-object v13, v4

    .line 2013
    .local v13, e:Landroid/content/pm/PackageManager$NameNotFoundException;
    :try_start_7
    const-string v4, "ActivityManager"

    const-string v5, "Unable to retrieve gids"

    invoke-static {v4, v5, v13}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_7
    .catch Ljava/lang/RuntimeException; {:try_start_7 .. :try_end_7} :catch_1

    goto/16 :goto_0

    .line 2105
    .end local v6           #uid:I
    .end local v8           #gids:[I
    .end local v13           #e:Landroid/content/pm/PackageManager$NameNotFoundException;
    :catch_1
    move-exception v4

    move-object v13, v4

    .line 2107
    .local v13, e:Ljava/lang/RuntimeException;
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2108
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failure starting process "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v13}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2110
    .end local v13           #e:Ljava/lang/RuntimeException;
    :goto_4
    return-void

    .line 2042
    .restart local v6       #uid:I
    .restart local v8       #gids:[I
    .restart local v9       #debugFlags:I
    :cond_c
    const/4 v5, 0x0

    goto/16 :goto_1

    .line 2050
    .restart local v11       #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v16       #pid:I
    :catchall_1
    move-exception v4

    :try_start_8
    monitor-exit v11
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_1

    :try_start_9
    throw v4

    .line 2052
    .end local v9           #debugFlags:I
    :cond_d
    const-string v9, ""

    goto/16 :goto_2

    .line 2082
    .restart local v12       #buf:Ljava/lang/StringBuilder;
    :cond_e
    const-string v4, "}"

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2083
    const-string v4, "ActivityManager"

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 2084
    if-eqz v16, :cond_f

    sget v4, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v0, v16

    move v1, v4

    if-ne v0, v1, :cond_10

    .line 2086
    :cond_f
    sget v4, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2087
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 2088
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_4

    .line 2089
    :cond_10
    if-lez v16, :cond_11

    .line 2090
    move/from16 v0, v16

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2091
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 2092
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    monitor-enter v4
    :try_end_9
    .catch Ljava/lang/RuntimeException; {:try_start_9 .. :try_end_9} :catch_1

    .line 2093
    :try_start_a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v16

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 2094
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x14

    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    .end local v6           #uid:I
    move-result-object v15

    .line 2095
    .local v15, msg:Landroid/os/Message;
    move-object/from16 v0, p1

    move-object v1, v15

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 2096
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const-wide/16 v6, 0x4e20

    invoke-virtual {v5, v15, v6, v7}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2097
    monitor-exit v4

    goto :goto_4

    .end local v15           #msg:Landroid/os/Message;
    :catchall_2
    move-exception v5

    monitor-exit v4
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_2

    :try_start_b
    throw v5

    .line 2099
    .restart local v6       #uid:I
    :cond_11
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2100
    new-instance v13, Ljava/lang/RuntimeException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Failure starting process "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ": returned pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v13, v4}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    .line 2103
    .restart local v13       #e:Ljava/lang/RuntimeException;
    const-string v4, "ActivityManager"

    invoke-virtual {v13}, Ljava/lang/RuntimeException;->getMessage()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v13}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_b
    .catch Ljava/lang/RuntimeException; {:try_start_b .. :try_end_b} :catch_1

    goto/16 :goto_4
.end method

.method private startSetupActivityLocked()V
    .locals 23

    .prologue
    .line 2519
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mCheckedForSetup:Z

    move v3, v0

    if-eqz v3, :cond_1

    .line 2566
    :cond_0
    :goto_0
    return-void

    .line 2526
    :cond_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v19

    .line 2527
    .local v19, resolver:Landroid/content/ContentResolver;
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v3, v0

    const/4 v4, 0x1

    if-eq v3, v4, :cond_0

    const-string v3, "device_provisioned"

    const/4 v4, 0x0

    move-object/from16 v0, v19

    move-object v1, v3

    move v2, v4

    invoke-static {v0, v1, v2}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v3

    if-eqz v3, :cond_0

    .line 2530
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mCheckedForSetup:Z

    .line 2533
    new-instance v5, Landroid/content/Intent;

    const-string v3, "android.intent.action.UPGRADE_SETUP"

    invoke-direct {v5, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 2534
    .local v5, intent:Landroid/content/Intent;
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v3, v3, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v3

    const/16 v4, 0x80

    invoke-virtual {v3, v5, v4}, Landroid/content/pm/PackageManager;->queryIntentActivities(Landroid/content/Intent;I)Ljava/util/List;

    move-result-object v21

    .line 2538
    .local v21, ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/16 v20, 0x0

    .line 2539
    .local v20, ri:Landroid/content/pm/ResolveInfo;
    const/16 v17, 0x0

    .local v17, i:I
    :goto_1
    if-eqz v21, :cond_2

    invoke-interface/range {v21 .. v21}, Ljava/util/List;->size()I

    move-result v3

    move/from16 v0, v17

    move v1, v3

    if-ge v0, v1, :cond_2

    .line 2540
    move-object/from16 v0, v21

    move/from16 v1, v17

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    iget-object v3, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v3, v3, 0x1

    if-eqz v3, :cond_4

    .line 2542
    move-object/from16 v0, v21

    move/from16 v1, v17

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v20

    .end local v20           #ri:Landroid/content/pm/ResolveInfo;
    check-cast v20, Landroid/content/pm/ResolveInfo;

    .line 2547
    .restart local v20       #ri:Landroid/content/pm/ResolveInfo;
    :cond_2
    if-eqz v20, :cond_0

    .line 2548
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->metaData:Landroid/os/Bundle;

    if-eqz v3, :cond_5

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->metaData:Landroid/os/Bundle;

    const-string v4, "android.SETUP_VERSION"

    invoke-virtual {v3, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    move-object/from16 v22, v3

    .line 2551
    .local v22, vers:Ljava/lang/String;
    :goto_2
    if-nez v22, :cond_3

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->metaData:Landroid/os/Bundle;

    if-eqz v3, :cond_3

    .line 2552
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->metaData:Landroid/os/Bundle;

    const-string v4, "android.SETUP_VERSION"

    invoke-virtual {v3, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v22

    .line 2555
    :cond_3
    const-string v3, "last_setup_shown"

    move-object/from16 v0, v19

    move-object v1, v3

    invoke-static {v0, v1}, Landroid/provider/Settings$Secure;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v18

    .line 2557
    .local v18, lastVers:Ljava/lang/String;
    if-eqz v22, :cond_0

    move-object/from16 v0, v22

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_0

    .line 2558
    const/high16 v3, 0x1000

    invoke-virtual {v5, v3}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 2559
    new-instance v3, Landroid/content/ComponentName;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v3, v4, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v5, v3}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 2561
    const/4 v4, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v9, v0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v16}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    goto/16 :goto_0

    .line 2539
    .end local v18           #lastVers:Ljava/lang/String;
    .end local v22           #vers:Ljava/lang/String;
    :cond_4
    add-int/lit8 v17, v17, 0x1

    goto/16 :goto_1

    .line 2548
    :cond_5
    const/4 v3, 0x0

    move-object/from16 v22, v3

    goto :goto_2
.end method

.method private final startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V
    .locals 10
    .parameter "r"
    .parameter "andResume"
    .parameter "checkConfig"

    .prologue
    const/4 v4, 0x0

    const-wide/16 v2, 0x0

    .line 1882
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v8

    .line 1885
    .local v8, app:Lcom/android/server/am/ProcessRecord;
    iget-wide v0, p1, Lcom/android/server/am/HistoryRecord;->startTime:J

    cmp-long v0, v0, v2

    if-nez v0, :cond_1

    .line 1886
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p1, Lcom/android/server/am/HistoryRecord;->startTime:J

    .line 1887
    iget-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    cmp-long v0, v0, v2

    if-nez v0, :cond_0

    .line 1888
    iget-wide v0, p1, Lcom/android/server/am/HistoryRecord;->startTime:J

    iput-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    .line 1894
    :cond_0
    :goto_0
    if-eqz v8, :cond_2

    iget-object v0, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_2

    .line 1896
    :try_start_0
    invoke-direct {p0, p1, v8, p2, p3}, Lcom/android/server/am/ActivityManagerService;->realStartActivityLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/ProcessRecord;ZZ)Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1909
    :goto_1
    return-void

    .line 1890
    :cond_1
    iget-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    cmp-long v0, v0, v2

    if-nez v0, :cond_0

    .line 1891
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    goto :goto_0

    .line 1898
    :catch_0
    move-exception v9

    .line 1899
    .local v9, e:Landroid/os/RemoteException;
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Exception when starting activity "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    invoke-virtual {v2}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1907
    .end local v9           #e:Landroid/os/RemoteException;
    :cond_2
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v2, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v3, 0x1

    const-string v5, "activity"

    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v0}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v6

    move-object v0, p0

    move v7, v4

    invoke-direct/range {v0 .. v7}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;

    goto :goto_1
.end method

.method private final stopActivityLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 6
    .parameter "r"

    .prologue
    const/4 v5, 0x0

    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 4045
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1}, Landroid/content/Intent;->getFlags()I

    move-result v1

    const/high16 v2, 0x4000

    and-int/2addr v1, v2

    if-nez v1, :cond_0

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget v1, v1, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit16 v1, v1, 0x80

    if-eqz v1, :cond_2

    .line 4047
    :cond_0
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v1, :cond_1

    .line 4048
    const-string v1, "no-history"

    invoke-direct {p0, p1, v3, v5, v1}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    .line 4078
    :cond_1
    :goto_0
    return-void

    .line 4051
    :cond_2
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_1

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v1, :cond_1

    .line 4052
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v1, p1, :cond_3

    .line 4053
    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4055
    :cond_3
    invoke-virtual {p1}, Lcom/android/server/am/HistoryRecord;->resumeKeyDispatchingLocked()V

    .line 4057
    const/4 v1, 0x0

    :try_start_0
    iput-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 4058
    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4061
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v1, :cond_4

    .line 4062
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v2, 0x0

    invoke-virtual {v1, p1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 4064
    :cond_4
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-boolean v2, p1, Lcom/android/server/am/HistoryRecord;->visible:Z

    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-interface {v1, p1, v2, v3}, Landroid/app/IApplicationThread;->scheduleStopActivity(Landroid/os/IBinder;ZI)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 4065
    :catch_0
    move-exception v1

    move-object v0, v1

    .line 4069
    .local v0, e:Ljava/lang/Exception;
    const-string v1, "ActivityManager"

    const-string v2, "Exception thrown during pause"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 4071
    iput-boolean v4, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 4072
    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4073
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    if-eqz v1, :cond_1

    .line 4074
    invoke-direct {p0, p1, v4}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    goto :goto_0
.end method

.method private final topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;
    .locals 4
    .parameter "token"
    .parameter "taskId"

    .prologue
    .line 1725
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .line 1726
    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 1727
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 1729
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_0

    if-eq p1, v1, :cond_0

    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v2, Lcom/android/server/am/TaskRecord;->taskId:I

    if-eq p2, v2, :cond_0

    move-object v2, v1

    .line 1734
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return-object v2

    .line 1732
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_0
    add-int/lit8 v0, v0, -0x1

    .line 1733
    goto :goto_0

    .line 1734
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    const/4 v2, 0x0

    goto :goto_1
.end method

.method private final topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;
    .locals 4
    .parameter "notTop"

    .prologue
    .line 1692
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .line 1693
    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 1694
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 1695
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_0

    if-eq v1, p1, :cond_0

    move-object v2, v1

    .line 1700
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return-object v2

    .line 1698
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_0
    add-int/lit8 v0, v0, -0x1

    .line 1699
    goto :goto_0

    .line 1700
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    const/4 v2, 0x0

    goto :goto_1
.end method

.method private final topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;
    .locals 4
    .parameter "notTop"

    .prologue
    .line 1704
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .line 1705
    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 1706
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 1707
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_0

    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->delayedResume:Z

    if-nez v2, :cond_0

    if-eq v1, p1, :cond_0

    move-object v2, v1

    .line 1712
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return-object v2

    .line 1710
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_0
    add-int/lit8 v0, v0, -0x1

    .line 1711
    goto :goto_0

    .line 1712
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    const/4 v2, 0x0

    goto :goto_1
.end method

.method private final trimApplications()V
    .locals 13

    .prologue
    .line 14391
    monitor-enter p0

    .line 14396
    :try_start_0
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    const/4 v11, 0x1

    sub-int v5, v10, v11

    .local v5, i:I
    :goto_0
    if-ltz v5, :cond_3

    .line 14397
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14398
    .local v1, app:Lcom/android/server/am/ProcessRecord;
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-nez v10, :cond_0

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_0

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_0

    .line 14400
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Exiting empty application process "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " ("

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v12, :cond_1

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v12}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v12

    :goto_1
    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ")\n"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 14405
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v10, :cond_2

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v11, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v10, v11, :cond_2

    .line 14406
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcess(I)V

    .line 14414
    :goto_2
    const/4 v10, 0x0

    const/4 v11, -0x1

    invoke-direct {p0, v1, v10, v11}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V

    .line 14415
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 14417
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v10, :cond_0

    .line 14418
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v10, :cond_0

    .line 14419
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {p0, v10}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 14396
    :cond_0
    add-int/lit8 v5, v5, -0x1

    goto :goto_0

    .line 14400
    :cond_1
    const/4 v12, 0x0

    goto :goto_1

    .line 14409
    :cond_2
    :try_start_1
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v10}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_2

    .line 14410
    :catch_0
    move-exception v10

    goto :goto_2

    .line 14429
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    :cond_3
    :try_start_2
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    move-result v10

    if-nez v10, :cond_16

    .line 14432
    const/4 v7, 0x0

    .line 14433
    .local v7, numServiceProcs:I
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    const/4 v11, 0x1

    sub-int v5, v10, v11

    :goto_3
    if-ltz v5, :cond_6

    .line 14434
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14436
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v10, :cond_4

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_4

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_4

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-lez v10, :cond_5

    .line 14444
    :cond_4
    add-int/lit8 v7, v7, 0x1

    .line 14433
    :cond_5
    add-int/lit8 v5, v5, -0x1

    goto :goto_3

    .line 14448
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    :cond_6
    iget v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    .line 14449
    .local v4, curMaxProcs:I
    if-gtz v4, :cond_7

    const/4 v4, 0x2

    .line 14450
    :cond_7
    iget-boolean v10, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    if-eqz v10, :cond_8

    .line 14451
    const/4 v4, 0x1

    .line 14453
    :cond_8
    add-int/2addr v4, v7

    .line 14458
    const/4 v5, 0x0

    .line 14460
    :goto_4
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v5, v10, :cond_c

    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v10, v4, :cond_c

    .line 14462
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14465
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v10, :cond_9

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-nez v10, :cond_9

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_9

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_9

    .line 14467
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Exiting empty application process "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " ("

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v12, :cond_a

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v12}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v12

    :goto_5
    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ")\n"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 14472
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v10, :cond_b

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v11, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v10, v11, :cond_b

    .line 14473
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcess(I)V

    .line 14485
    :goto_6
    const/4 v10, 0x0

    invoke-direct {p0, v1, v10, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 14486
    add-int/lit8 v5, v5, -0x1

    .line 14461
    :cond_9
    add-int/lit8 v5, v5, 0x1

    goto :goto_4

    .line 14467
    :cond_a
    const/4 v12, 0x0

    goto :goto_5

    .line 14476
    :cond_b
    :try_start_3
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v10}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_1

    goto :goto_6

    .line 14477
    :catch_1
    move-exception v10

    goto :goto_6

    .line 14495
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    :cond_c
    const/4 v5, 0x0

    .line 14497
    :goto_7
    :try_start_4
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v5, v10, :cond_16

    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v10, v4, :cond_16

    .line 14499
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14502
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v10, :cond_e

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_e

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_e

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-nez v10, :cond_e

    const/4 v10, 0x1

    move v2, v10

    .line 14505
    .local v2, canQuit:Z
    :goto_8
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 14509
    .local v0, NUMA:I
    const/4 v6, 0x0

    .local v6, j:I
    :goto_9
    if-ge v6, v0, :cond_10

    if-eqz v2, :cond_10

    .line 14510
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 14514
    .local v9, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v10, :cond_d

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stateNotNeeded:Z

    if-nez v10, :cond_f

    :cond_d
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v10, :cond_f

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stopped:Z

    if-eqz v10, :cond_f

    const/4 v10, 0x1

    move v2, v10

    .line 14509
    :goto_a
    add-int/lit8 v6, v6, 0x1

    goto :goto_9

    .line 14502
    .end local v0           #NUMA:I
    .end local v2           #canQuit:Z
    .end local v6           #j:I
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_e
    const/4 v10, 0x0

    move v2, v10

    goto :goto_8

    .line 14514
    .restart local v0       #NUMA:I
    .restart local v2       #canQuit:Z
    .restart local v6       #j:I
    .restart local v9       #r:Lcom/android/server/am/HistoryRecord;
    :cond_f
    const/4 v10, 0x0

    move v2, v10

    goto :goto_a

    .line 14517
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_10
    if-eqz v2, :cond_13

    .line 14519
    const/4 v6, 0x0

    :goto_b
    if-ge v6, v0, :cond_12

    .line 14520
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 14521
    .restart local v9       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v10, :cond_11

    .line 14522
    const/4 v10, 0x0

    invoke-direct {p0, v9, v10}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 14524
    :cond_11
    const/4 v10, 0x0

    iput-object v10, v9, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 14519
    add-int/lit8 v6, v6, 0x1

    goto :goto_b

    .line 14526
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_12
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Exiting application process "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " ("

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v12, :cond_14

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v12}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v12

    :goto_c
    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ")\n"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 14530
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v10, :cond_15

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v11, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v10, v11, :cond_15

    .line 14531
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcess(I)V

    .line 14543
    :goto_d
    const/4 v10, 0x0

    invoke-direct {p0, v1, v10, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    .line 14544
    add-int/lit8 v5, v5, -0x1

    .line 14498
    :cond_13
    add-int/lit8 v5, v5, 0x1

    goto/16 :goto_7

    .line 14526
    :cond_14
    const/4 v12, 0x0

    goto :goto_c

    .line 14534
    :cond_15
    :try_start_5
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v10}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_2

    goto :goto_d

    .line 14535
    :catch_2
    move-exception v10

    goto :goto_d

    .line 14551
    .end local v0           #NUMA:I
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    .end local v2           #canQuit:Z
    .end local v4           #curMaxProcs:I
    .end local v6           #j:I
    .end local v7           #numServiceProcs:I
    :cond_16
    const/16 v3, 0x14

    .line 14552
    .local v3, curMaxActivities:I
    :try_start_6
    iget-boolean v10, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    if-eqz v10, :cond_17

    .line 14553
    const/4 v3, 0x1

    .line 14558
    :cond_17
    const/4 v5, 0x0

    .line 14560
    :goto_e
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v5, v10, :cond_1a

    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v10, v3, :cond_1a

    .line 14562
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 14567
    .restart local v9       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v10, :cond_18

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stateNotNeeded:Z

    if-nez v10, :cond_19

    :cond_18
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v10, :cond_19

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stopped:Z

    if-eqz v10, :cond_19

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-nez v10, :cond_19

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v10, :cond_19

    .line 14569
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v8

    .line 14570
    .local v8, origSize:I
    const/4 v10, 0x1

    invoke-direct {p0, v9, v10}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 14577
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v8, v10, :cond_19

    .line 14578
    add-int/lit8 v5, v5, -0x1

    .line 14561
    .end local v8           #origSize:I
    :cond_19
    add-int/lit8 v5, v5, 0x1

    goto :goto_e

    .line 14582
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1a
    monitor-exit p0

    .line 14583
    return-void

    .line 14582
    .end local v3           #curMaxActivities:I
    .end local v5           #i:I
    :catchall_0
    move-exception v10

    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    throw v10
.end method

.method private final unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z
    .locals 4
    .parameter "r"

    .prologue
    .line 11190
    iget-wide v0, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    const-wide/16 v2, 0x0

    cmp-long v0, v0, v2

    if-nez v0, :cond_0

    .line 11191
    const/4 v0, 0x0

    .line 11196
    :goto_0
    return v0

    .line 11193
    :cond_0
    invoke-virtual {p1}, Lcom/android/server/am/ServiceRecord;->resetRestartCounter()V

    .line 11194
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 11195
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->restarter:Ljava/lang/Runnable;

    invoke-virtual {v0, v1}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V

    .line 11196
    const/4 v0, 0x1

    goto :goto_0
.end method

.method private final updateLRUListLocked(Lcom/android/server/am/HistoryRecord;)Z
    .locals 2
    .parameter "r"

    .prologue
    .line 1686
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    move-result v0

    .line 1687
    .local v0, hadit:Z
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 1688
    return v0
.end method

.method private final updateLruProcessInternalLocked(Lcom/android/server/am/ProcessRecord;ZZI)V
    .locals 11
    .parameter "app"
    .parameter "oomAdj"
    .parameter "updateActivityTime"
    .parameter "bestPos"

    .prologue
    .line 1604
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v4

    .line 1605
    .local v4, lrui:I
    if-ltz v4, :cond_0

    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 1607
    :cond_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v7

    const/4 v8, 0x1

    sub-int v2, v7, v8

    .line 1608
    .local v2, i:I
    const/4 v6, 0x0

    .line 1610
    .local v6, skipTop:I
    iget v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    iput v7, p1, Lcom/android/server/am/ProcessRecord;->lruSeq:I

    .line 1613
    if-eqz p3, :cond_1

    .line 1614
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v7

    iput-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lastActivityTime:J

    .line 1616
    :cond_1
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v7

    if-lez v7, :cond_7

    .line 1619
    iget-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lastActivityTime:J

    iput-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lruWeight:J

    .line 1635
    :goto_0
    if-ltz v2, :cond_4

    .line 1636
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ProcessRecord;

    .line 1639
    .local v5, p:Lcom/android/server/am/ProcessRecord;
    if-lez v6, :cond_2

    iget v7, v5, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v8, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v7, v8, :cond_2

    .line 1640
    add-int/lit8 v6, v6, -0x1

    .line 1642
    :cond_2
    iget-wide v7, v5, Lcom/android/server/am/ProcessRecord;->lruWeight:J

    iget-wide v9, p1, Lcom/android/server/am/ProcessRecord;->lruWeight:J

    cmp-long v7, v7, v9

    if-lez v7, :cond_3

    if-ge v2, p4, :cond_9

    .line 1643
    :cond_3
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    add-int/lit8 v8, v2, 0x1

    invoke-virtual {v7, v8, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 1648
    .end local v5           #p:Lcom/android/server/am/ProcessRecord;
    :cond_4
    if-gez v2, :cond_5

    .line 1649
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    const/4 v8, 0x0

    invoke-virtual {v7, v8, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 1654
    :cond_5
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->size()I

    move-result v7

    if-lez v7, :cond_a

    .line 1655
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .local v3, i$:Ljava/util/Iterator;
    :cond_6
    :goto_1
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_a

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ConnectionRecord;

    .line 1656
    .local v1, cr:Lcom/android/server/am/ConnectionRecord;
    iget-object v7, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    if-eqz v7, :cond_6

    iget-object v7, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v7, v7, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    if-eqz v7, :cond_6

    iget-object v7, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v7, v7, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v7, v7, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v7, :cond_6

    iget-object v7, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v7, v7, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v7, v7, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->lruSeq:I

    iget v8, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    if-eq v7, v8, :cond_6

    .line 1659
    iget-object v7, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v7, v7, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v7, v7, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    add-int/lit8 v8, v2, 0x1

    invoke-direct {p0, v7, p2, p3, v8}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessInternalLocked(Lcom/android/server/am/ProcessRecord;ZZI)V

    goto :goto_1

    .line 1620
    .end local v1           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v3           #i$:Ljava/util/Iterator;
    :cond_7
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->size()I

    move-result v7

    if-lez v7, :cond_8

    .line 1623
    iget-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lastActivityTime:J

    const-wide/16 v9, 0x3a98

    sub-long/2addr v7, v9

    iput-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lruWeight:J

    .line 1625
    const/4 v6, 0x2

    goto/16 :goto_0

    .line 1630
    :cond_8
    iget-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lastActivityTime:J

    const-wide/32 v9, 0x1d4c0

    sub-long/2addr v7, v9

    iput-wide v7, p1, Lcom/android/server/am/ProcessRecord;->lruWeight:J

    .line 1632
    const/4 v6, 0x2

    goto/16 :goto_0

    .line 1646
    .restart local v5       #p:Lcom/android/server/am/ProcessRecord;
    :cond_9
    add-int/lit8 v2, v2, -0x1

    .line 1647
    goto/16 :goto_0

    .line 1664
    .end local v5           #p:Lcom/android/server/am/ProcessRecord;
    :cond_a
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->size()I

    move-result v7

    if-lez v7, :cond_c

    .line 1665
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->keySet()Ljava/util/Set;

    move-result-object v7

    invoke-interface {v7}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .restart local v3       #i$:Ljava/util/Iterator;
    :cond_b
    :goto_2
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_c

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ContentProviderRecord;

    .line 1666
    .local v0, cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v7, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v7, :cond_b

    iget-object v7, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->lruSeq:I

    iget v8, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    if-eq v7, v8, :cond_b

    .line 1667
    iget-object v7, v0, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    add-int/lit8 v8, v2, 0x1

    invoke-direct {p0, v7, p2, p3, v8}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessInternalLocked(Lcom/android/server/am/ProcessRecord;ZZI)V

    goto :goto_2

    .line 1674
    .end local v0           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v3           #i$:Ljava/util/Iterator;
    :cond_c
    if-eqz p2, :cond_d

    .line 1675
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 1677
    :cond_d
    return-void
.end method

.method private final updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V
    .locals 1
    .parameter "app"
    .parameter "oomAdj"
    .parameter "updateActivityTime"

    .prologue
    .line 1681
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    add-int/lit8 v0, v0, 0x1

    iput v0, p0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    .line 1682
    const/4 v0, 0x0

    invoke-direct {p0, p1, p2, p3, v0}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessInternalLocked(Lcom/android/server/am/ProcessRecord;ZZI)V

    .line 1683
    return-void
.end method

.method private final updateOomAdjLocked()Z
    .locals 14

    .prologue
    .line 14322
    const/4 v4, 0x1

    .line 14323
    .local v4, didOomAdj:Z
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->resumedAppLocked()Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 14324
    .local v0, TOP_ACT:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_3

    iget-object v10, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v1, v10

    .line 14332
    .local v1, TOP_APP:Lcom/android/server/am/ProcessRecord;
    :goto_0
    iget v10, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    add-int/lit8 v10, v10, 0x1

    iput v10, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    .line 14338
    sget v10, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    sget v11, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    sub-int/2addr v10, v11

    add-int/lit8 v8, v10, 0x1

    .line 14339
    .local v8, numSlots:I
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    const/4 v11, 0x4

    sub-int/2addr v10, v11

    div-int v5, v10, v8

    .line 14340
    .local v5, factor:I
    const/4 v10, 0x1

    if-ge v5, v10, :cond_0

    const/4 v5, 0x1

    .line 14341
    :cond_0
    const/4 v9, 0x0

    .line 14342
    .local v9, step:I
    const/4 v7, 0x0

    .line 14346
    .local v7, numHidden:I
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v6

    .line 14347
    .local v6, i:I
    sget v3, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    .line 14348
    .local v3, curHiddenAdj:I
    :cond_1
    :goto_1
    if-lez v6, :cond_5

    .line 14349
    add-int/lit8 v6, v6, -0x1

    .line 14350
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 14352
    .local v2, app:Lcom/android/server/am/ProcessRecord;
    invoke-direct {p0, v2, v3, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)Z

    move-result v10

    if-eqz v10, :cond_4

    .line 14353
    sget v10, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    if-ge v3, v10, :cond_2

    iget v10, v2, Lcom/android/server/am/ProcessRecord;->curAdj:I

    if-ne v10, v3, :cond_2

    .line 14355
    add-int/lit8 v9, v9, 0x1

    .line 14356
    if-lt v9, v5, :cond_2

    .line 14357
    const/4 v9, 0x0

    .line 14358
    add-int/lit8 v3, v3, 0x1

    .line 14361
    :cond_2
    iget v10, v2, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v11, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v10, v11, :cond_1

    .line 14364
    const-string v10, "android.process.acore"

    iget-object v11, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v10

    if-nez v10, :cond_1

    .line 14367
    iget-boolean v10, v2, Lcom/android/server/am/ProcessRecord;->killedBackground:Z

    if-nez v10, :cond_1

    .line 14368
    add-int/lit8 v7, v7, 0x1

    .line 14369
    const/16 v10, 0xf

    if-le v7, v10, :cond_1

    .line 14370
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "No longer want "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " (pid "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget v12, v2, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, "): hidden #"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 14372
    const/16 v10, 0x7547

    const/4 v11, 0x4

    new-array v11, v11, [Ljava/lang/Object;

    const/4 v12, 0x0

    iget v13, v2, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v13}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v13

    aput-object v13, v11, v12

    const/4 v12, 0x1

    iget-object v13, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v13, v11, v12

    const/4 v12, 0x2

    iget v13, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    invoke-static {v13}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v13

    aput-object v13, v11, v12

    const/4 v12, 0x3

    const-string v13, "too many background"

    aput-object v13, v11, v12

    invoke-static {v10, v11}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 14374
    const/4 v10, 0x1

    iput-boolean v10, v2, Lcom/android/server/am/ProcessRecord;->killedBackground:Z

    .line 14375
    iget v10, v2, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcessQuiet(I)V

    goto/16 :goto_1

    .line 14324
    .end local v1           #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #curHiddenAdj:I
    .end local v5           #factor:I
    .end local v6           #i:I
    .end local v7           #numHidden:I
    .end local v8           #numSlots:I
    .end local v9           #step:I
    :cond_3
    const/4 v10, 0x0

    move-object v1, v10

    goto/16 :goto_0

    .line 14380
    .restart local v1       #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v3       #curHiddenAdj:I
    .restart local v5       #factor:I
    .restart local v6       #i:I
    .restart local v7       #numHidden:I
    .restart local v8       #numSlots:I
    .restart local v9       #step:I
    :cond_4
    const/4 v4, 0x0

    goto/16 :goto_1

    .line 14387
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    :cond_5
    iget v10, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    if-lez v10, :cond_6

    const/4 v10, 0x0

    :goto_2
    return v10

    :cond_6
    move v10, v4

    goto :goto_2
.end method

.method private final updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z
    .locals 10
    .parameter "app"

    .prologue
    const/4 v9, 0x1

    const/4 v8, 0x0

    .line 14300
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->resumedAppLocked()Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 14301
    .local v0, TOP_ACT:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_1

    iget-object v6, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v1, v6

    .line 14302
    .local v1, TOP_APP:Lcom/android/server/am/ProcessRecord;
    :goto_0
    iget v2, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 14303
    .local v2, curAdj:I
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v6, v7, :cond_2

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    if-gt v6, v7, :cond_2

    move v5, v9

    .line 14306
    .local v5, wasHidden:Z
    :goto_1
    iget v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    add-int/lit8 v6, v6, 0x1

    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    .line 14308
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    invoke-direct {p0, p1, v6, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)Z

    move-result v4

    .line 14309
    .local v4, res:Z
    if-eqz v4, :cond_0

    .line 14310
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v6, v7, :cond_3

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    if-gt v6, v7, :cond_3

    move v3, v9

    .line 14312
    .local v3, nowHidden:Z
    :goto_2
    if-eq v3, v5, :cond_0

    .line 14315
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 14318
    .end local v3           #nowHidden:Z
    :cond_0
    return v4

    .line 14301
    .end local v1           #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .end local v2           #curAdj:I
    .end local v4           #res:Z
    .end local v5           #wasHidden:Z
    :cond_1
    const/4 v6, 0x0

    move-object v1, v6

    goto :goto_0

    .restart local v1       #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #curAdj:I
    :cond_2
    move v5, v8

    .line 14303
    goto :goto_1

    .restart local v4       #res:Z
    .restart local v5       #wasHidden:Z
    :cond_3
    move v3, v8

    .line 14310
    goto :goto_2
.end method

.method private final updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)Z
    .locals 8
    .parameter "app"
    .parameter "hiddenAdj"
    .parameter "TOP_APP"

    .prologue
    const/4 v7, 0x1

    const/4 v6, 0x0

    .line 14224
    iput p2, p1, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    .line 14226
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v4, :cond_0

    move v4, v7

    .line 14285
    :goto_0
    return v4

    .line 14230
    :cond_0
    invoke-direct {p0, p1, p2, p3, v6}, Lcom/android/server/am/ActivityManagerService;->computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;Z)I

    move-result v0

    .line 14232
    .local v0, adj:I
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eqz v4, :cond_1

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne v4, v5, :cond_2

    :cond_1
    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v4

    if-eqz v4, :cond_6

    .line 14233
    :cond_2
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    iget v5, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    if-eq v4, v5, :cond_4

    .line 14234
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    if-le v4, v5, :cond_7

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    if-gt v4, v5, :cond_7

    .line 14238
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 14245
    :cond_3
    :goto_1
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    iput v4, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    .line 14247
    :cond_4
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    if-eq v0, v4, :cond_5

    .line 14248
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v4, v0}, Landroid/os/Process;->setOomAdj(II)Z

    move-result v4

    if-eqz v4, :cond_8

    .line 14252
    iput v0, p1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    .line 14257
    :cond_5
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    iget v5, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    if-eq v4, v5, :cond_6

    .line 14258
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    iput v4, p1, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    .line 14263
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 14265
    .local v2, oldId:J
    :try_start_0
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v5, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    invoke-static {v4, v5}, Landroid/os/Process;->setProcessGroup(II)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 14271
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .end local v2           #oldId:J
    :cond_6
    :goto_2
    move v4, v7

    .line 14285
    goto :goto_0

    .line 14239
    :cond_7
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v4, v5, :cond_3

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-ge v4, v5, :cond_3

    .line 14243
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcLocked(Lcom/android/server/am/ProcessRecord;)V

    goto :goto_1

    :cond_8
    move v4, v6

    .line 14254
    goto :goto_0

    .line 14266
    .restart local v2       #oldId:J
    :catch_0
    move-exception v4

    move-object v1, v4

    .line 14267
    .local v1, e:Ljava/lang/Exception;
    :try_start_1
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failed setting process group of "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " to "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 14269
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 14271
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_2

    .end local v1           #e:Ljava/lang/Exception;
    :catchall_0
    move-exception v4

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v4
.end method

.method private updateUsageStats(Lcom/android/server/am/HistoryRecord;Z)V
    .locals 2
    .parameter "resumedComponent"
    .parameter "resumed"

    .prologue
    .line 2471
    if-eqz p2, :cond_0

    .line 2472
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, v1}, Lcom/android/server/am/UsageStatsService;->noteResumeComponent(Landroid/content/ComponentName;)V

    .line 2476
    :goto_0
    return-void

    .line 2474
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, v1}, Lcom/android/server/am/UsageStatsService;->notePauseComponent(Landroid/content/ComponentName;)V

    goto :goto_0
.end method


# virtual methods
.method public final activityDestroyed(Landroid/os/IBinder;)V
    .locals 6
    .parameter "token"

    .prologue
    .line 6015
    monitor-enter p0

    .line 6016
    :try_start_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v5, 0x11

    invoke-virtual {v4, v5, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 6018
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 6019
    .local v0, index:I
    if-ltz v0, :cond_0

    .line 6020
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 6021
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v4, v5, :cond_0

    .line 6022
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 6023
    .local v1, origId:J
    invoke-direct {p0, v3}, Lcom/android/server/am/ActivityManagerService;->removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 6024
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6027
    .end local v1           #origId:J
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_0
    monitor-exit p0

    .line 6028
    return-void

    .line 6027
    .end local v0           #index:I
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4
.end method

.method public final activityIdle(Landroid/os/IBinder;Landroid/content/res/Configuration;)V
    .locals 3
    .parameter "token"
    .parameter "config"

    .prologue
    .line 5686
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 5687
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-virtual {p0, p1, v2, p2}, Lcom/android/server/am/ActivityManagerService;->activityIdleInternal(Landroid/os/IBinder;ZLandroid/content/res/Configuration;)V

    .line 5688
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5689
    return-void
.end method

.method final activityIdleInternal(Landroid/os/IBinder;ZLandroid/content/res/Configuration;)V
    .locals 27
    .parameter "token"
    .parameter "fromTimeout"
    .parameter "config"

    .prologue
    .line 5744
    const/16 v24, 0x0

    .line 5745
    .local v24, stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    const/16 v19, 0x0

    .line 5746
    .local v19, finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    const/16 v25, 0x0

    .line 5747
    .local v25, thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    const/4 v14, 0x0

    .line 5748
    .local v14, NS:I
    const/4 v13, 0x0

    .line 5749
    .local v13, NF:I
    const/4 v15, 0x0

    .line 5750
    .local v15, NT:I
    const/16 v23, 0x0

    .line 5751
    .local v23, sendThumbnail:Landroid/app/IApplicationThread;
    const/16 v16, 0x0

    .line 5752
    .local v16, booting:Z
    const/16 v18, 0x0

    .line 5754
    .local v18, enableScreen:Z
    monitor-enter p0

    .line 5755
    if-eqz p1, :cond_0

    .line 5756
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v3, v0

    const/16 v4, 0xa

    move-object v0, v3

    move v1, v4

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5760
    :cond_0
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v22

    .line 5761
    .local v22, index:I
    if-ltz v22, :cond_9

    .line 5762
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v22

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5764
    .local v5, r:Lcom/android/server/am/HistoryRecord;
    if-eqz p2, :cond_1

    .line 5765
    const-wide/16 v6, -0x1

    const-wide/16 v8, -0x1

    move-object/from16 v3, p0

    move/from16 v4, p2

    invoke-virtual/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->reportActivityLaunchedLocked(ZLcom/android/server/am/HistoryRecord;JJ)V

    .line 5773
    :cond_1
    if-eqz p3, :cond_2

    .line 5774
    move-object/from16 v0, p3

    move-object v1, v5

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    .line 5778
    :cond_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v3, v0

    if-ne v3, v5, :cond_3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v3

    if-eqz v3, :cond_3

    .line 5779
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v3, v0

    const/16 v4, 0x10

    invoke-virtual {v3, v4}, Landroid/os/Handler;->removeMessages(I)V

    .line 5780
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 5785
    :cond_3
    const/4 v3, 0x1

    iput-boolean v3, v5, Lcom/android/server/am/HistoryRecord;->idle:Z

    .line 5786
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    .line 5787
    iget-boolean v3, v5, Lcom/android/server/am/HistoryRecord;->thumbnailNeeded:Z

    if-eqz v3, :cond_4

    iget-object v3, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4

    iget-object v3, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_4

    .line 5788
    iget-object v3, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v0, v3

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v23, v0

    .line 5789
    const/4 v3, 0x0

    iput-boolean v3, v5, Lcom/android/server/am/HistoryRecord;->thumbnailNeeded:Z

    .line 5795
    :cond_4
    const/4 v3, 0x0

    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    move v2, v4

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 5798
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    move v3, v0

    if-nez v3, :cond_5

    if-nez p2, :cond_5

    .line 5799
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    .line 5800
    const/16 v18, 0x1

    .line 5808
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_5
    :goto_0
    const/4 v3, 0x1

    move-object/from16 v0, p0

    move v1, v3

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->processStoppingActivitiesLocked(Z)Ljava/util/ArrayList;

    move-result-object v24

    .line 5809
    if-eqz v24, :cond_a

    invoke-virtual/range {v24 .. v24}, Ljava/util/ArrayList;->size()I

    move-result v3

    move v14, v3

    .line 5810
    :goto_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v13

    if-lez v13, :cond_6

    .line 5811
    new-instance v20, Ljava/util/ArrayList;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v3, v0

    move-object/from16 v0, v20

    move-object v1, v3

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5812
    .end local v19           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .local v20, finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :try_start_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->clear()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_3

    move-object/from16 v19, v20

    .line 5814
    .end local v20           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v19       #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :cond_6
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v15

    if-lez v15, :cond_7

    .line 5815
    new-instance v26, Ljava/util/ArrayList;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    move-object v3, v0

    move-object/from16 v0, v26

    move-object v1, v3

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 5816
    .end local v25           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .local v26, thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :try_start_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->clear()V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_4

    move-object/from16 v25, v26

    .line 5819
    .end local v26           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v25       #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :cond_7
    :try_start_4
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    move/from16 v16, v0

    .line 5820
    const/4 v3, 0x0

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 5821
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    .line 5826
    if-eqz v23, :cond_8

    .line 5828
    :try_start_5
    move-object/from16 v0, v23

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/app/IApplicationThread;->requestThumbnail(Landroid/os/IBinder;)V
    :try_end_5
    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_0

    .line 5837
    :cond_8
    :goto_2
    const/16 v21, 0x0

    .local v21, i:I
    :goto_3
    move/from16 v0, v21

    move v1, v14

    if-ge v0, v1, :cond_c

    .line 5838
    move-object/from16 v0, v24

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5839
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 5840
    :try_start_6
    iget-boolean v3, v5, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_b

    .line 5841
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;I)Lcom/android/server/am/HistoryRecord;

    .line 5845
    :goto_4
    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    .line 5837
    add-int/lit8 v21, v21, 0x1

    goto :goto_3

    .line 5803
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    .end local v21           #i:I
    :cond_9
    if-eqz p2, :cond_5

    .line 5804
    const/4 v8, 0x0

    const-wide/16 v9, -0x1

    const-wide/16 v11, -0x1

    move-object/from16 v6, p0

    move/from16 v7, p2

    :try_start_7
    invoke-virtual/range {v6 .. v12}, Lcom/android/server/am/ActivityManagerService;->reportActivityLaunchedLocked(ZLcom/android/server/am/HistoryRecord;JJ)V

    goto/16 :goto_0

    .line 5821
    .end local v22           #index:I
    :catchall_0
    move-exception v3

    :goto_5
    monitor-exit p0
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_0

    throw v3

    .line 5809
    .restart local v22       #index:I
    :cond_a
    const/4 v3, 0x0

    move v14, v3

    goto/16 :goto_1

    .line 5829
    :catch_0
    move-exception v17

    .line 5830
    .local v17, e:Ljava/lang/Exception;
    const-string v3, "ActivityManager"

    const-string v4, "Exception thrown when requesting thumbnail"

    move-object v0, v3

    move-object v1, v4

    move-object/from16 v2, v17

    invoke-static {v0, v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5831
    const/4 v7, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x1

    move-object/from16 v6, p0

    move-object/from16 v8, p1

    invoke-virtual/range {v6 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    goto :goto_2

    .line 5843
    .end local v17           #e:Ljava/lang/Exception;
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    .restart local v21       #i:I
    :cond_b
    :try_start_8
    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->stopActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    goto :goto_4

    .line 5845
    :catchall_1
    move-exception v3

    monitor-exit p0
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_1

    throw v3

    .line 5850
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_c
    const/16 v21, 0x0

    :goto_6
    move/from16 v0, v21

    move v1, v13

    if-ge v0, v1, :cond_d

    .line 5851
    move-object/from16 v0, v19

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5852
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 5853
    const/4 v3, 0x1

    :try_start_9
    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 5854
    monitor-exit p0

    .line 5850
    add-int/lit8 v21, v21, 0x1

    goto :goto_6

    .line 5854
    :catchall_2
    move-exception v3

    monitor-exit p0
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_2

    throw v3

    .line 5858
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_d
    const/16 v21, 0x0

    :goto_7
    move/from16 v0, v21

    move v1, v15

    if-ge v0, v1, :cond_e

    .line 5859
    move-object/from16 v0, v25

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5860
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x1

    move-object/from16 v4, p0

    invoke-virtual/range {v4 .. v9}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    .line 5858
    add-int/lit8 v21, v21, 0x1

    goto :goto_7

    .line 5863
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_e
    if-eqz v16, :cond_f

    .line 5864
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->finishBooting()V

    .line 5867
    :cond_f
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 5871
    if-eqz v18, :cond_10

    .line 5872
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->enableScreenAfterBoot()V

    .line 5874
    :cond_10
    return-void

    .line 5821
    .end local v19           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .end local v21           #i:I
    .restart local v20       #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :catchall_3
    move-exception v3

    move-object/from16 v19, v20

    .end local v20           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v19       #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    goto :goto_5

    .end local v25           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v26       #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :catchall_4
    move-exception v3

    move-object/from16 v25, v26

    .end local v26           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v25       #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    goto :goto_5
.end method

.method public final activityPaused(Landroid/os/IBinder;Landroid/os/Bundle;)V
    .locals 4
    .parameter "token"
    .parameter "icicle"

    .prologue
    .line 5940
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v2

    if-eqz v2, :cond_0

    .line 5941
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "File descriptors passed in Bundle"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 5944
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 5945
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-virtual {p0, p1, p2, v2}, Lcom/android/server/am/ActivityManagerService;->activityPaused(Landroid/os/IBinder;Landroid/os/Bundle;Z)V

    .line 5946
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5947
    return-void
.end method

.method final activityPaused(Landroid/os/IBinder;Landroid/os/Bundle;Z)V
    .locals 7
    .parameter "token"
    .parameter "icicle"
    .parameter "timeout"

    .prologue
    .line 5954
    const/4 v2, 0x0

    .line 5956
    .local v2, r:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 5957
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v1

    .line 5958
    .local v1, index:I
    if-ltz v1, :cond_1

    .line 5959
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    move-object v0, v3

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    move-object v2, v0

    .line 5960
    if-nez p3, :cond_0

    .line 5961
    iput-object p2, v2, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 5962
    const/4 v3, 0x1

    iput-boolean v3, v2, Lcom/android/server/am/HistoryRecord;->haveState:Z

    .line 5964
    :cond_0
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0x9

    invoke-virtual {v3, v4, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5965
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v3, v2, :cond_2

    .line 5966
    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v3, v2, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 5967
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->completePauseLocked()V

    .line 5975
    :cond_1
    :goto_0
    monitor-exit p0

    .line 5976
    return-void

    .line 5969
    :cond_2
    const/16 v3, 0x753c

    const/4 v4, 0x3

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    invoke-static {v2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v6

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x1

    iget-object v6, v2, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v6, v4, v5

    const/4 v5, 0x2

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v6, :cond_3

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v6, v6, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    :goto_1
    aput-object v6, v4, v5

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_0

    .line 5975
    .end local v1           #index:I
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3

    .line 5969
    .restart local v1       #index:I
    :cond_3
    :try_start_1
    const-string v6, "(none)"
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_1
.end method

.method public final activityStopped(Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;)V
    .locals 10
    .parameter "token"
    .parameter "thumbnail"
    .parameter "description"

    .prologue
    const/4 v3, 0x0

    .line 5983
    const/4 v2, 0x0

    .line 5985
    .local v2, r:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 5987
    .local v8, origId:J
    monitor-enter p0

    .line 5988
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v7

    .line 5989
    .local v7, index:I
    if-ltz v7, :cond_0

    .line 5990
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v1, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    move-object v0, v4

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    move-object v2, v0

    .line 5991
    iput-object p2, v2, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    .line 5992
    iput-object p3, v2, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    .line 5993
    const/4 v1, 0x1

    iput-boolean v1, v2, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 5994
    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v1, v2, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 5995
    iget-boolean v1, v2, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v1, :cond_0

    .line 5996
    iget-boolean v1, v2, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    if-eqz v1, :cond_0

    .line 5997
    const/4 v1, 0x1

    invoke-direct {p0, v2, v1}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 5998
    const/4 v1, 0x0

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 6002
    :cond_0
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 6004
    if-eqz v2, :cond_1

    .line 6005
    const/4 v6, 0x0

    move-object v1, p0

    move-object v4, v3

    move-object v5, v3

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    .line 6008
    :cond_1
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 6010
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6011
    return-void

    .line 6002
    .end local v7           #index:I
    :catchall_0
    move-exception v1

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v1
.end method

.method final addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;
    .locals 5
    .parameter "info"

    .prologue
    const/4 v3, 0x0

    const/4 v4, 0x1

    .line 8198
    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v2, p1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 8200
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_0

    .line 8201
    invoke-virtual {p0, v3, p1, v3}, Lcom/android/server/am/ActivityManagerService;->newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 8202
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v2, p1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v3, p1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v1, v2, v3, v0}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 8203
    invoke-direct {p0, v0, v4, v4}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 8206
    :cond_0
    iget v1, p1, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v1, v1, 0x9

    const/16 v2, 0x9

    if-ne v1, v2, :cond_1

    .line 8208
    iput-boolean v4, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    .line 8209
    const/16 v1, -0xc

    iput v1, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    .line 8211
    :cond_1
    iget-object v1, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v1, :cond_2

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v1

    if-gez v1, :cond_2

    .line 8212
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 8213
    const-string v1, "added application"

    iget-object v2, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-direct {p0, v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 8216
    :cond_2
    return-object v0
.end method

.method public addErrorToDropBox(Ljava/lang/String;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;Ljava/lang/String;Ljava/io/File;Landroid/app/ApplicationErrorReport$CrashInfo;)V
    .locals 19
    .parameter "eventType"
    .parameter "process"
    .parameter "activity"
    .parameter "parent"
    .parameter "subject"
    .parameter "report"
    .parameter "logFile"
    .parameter "crashInfo"

    .prologue
    .line 9188
    if-eqz p2, :cond_0

    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne v4, v5, :cond_2

    .line 9189
    :cond_0
    const-string v18, "system_server_"

    .line 9196
    .local v18, prefix:Ljava/lang/String;
    :goto_0
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    move-object v0, v4

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    .line 9197
    .local v10, dropboxTag:Ljava/lang/String;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    const-string v5, "dropbox"

    invoke-virtual {v4, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/os/DropBoxManager;

    .line 9201
    .local v11, dbox:Landroid/os/DropBoxManager;
    if-eqz v11, :cond_1

    invoke-virtual {v11, v10}, Landroid/os/DropBoxManager;->isTagEnabled(Ljava/lang/String;)Z

    move-result v4

    if-nez v4, :cond_4

    .line 9298
    :cond_1
    :goto_1
    return-void

    .line 9190
    .end local v10           #dropboxTag:Ljava/lang/String;
    .end local v11           #dbox:Landroid/os/DropBoxManager;
    .end local v18           #prefix:Ljava/lang/String;
    :cond_2
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v4, v4, 0x1

    if-eqz v4, :cond_3

    .line 9191
    const-string v18, "system_app_"

    .restart local v18       #prefix:Ljava/lang/String;
    goto :goto_0

    .line 9193
    .end local v18           #prefix:Ljava/lang/String;
    :cond_3
    const-string v18, "data_app_"

    .restart local v18       #prefix:Ljava/lang/String;
    goto :goto_0

    .line 9203
    .restart local v10       #dropboxTag:Ljava/lang/String;
    .restart local v11       #dbox:Landroid/os/DropBoxManager;
    :cond_4
    new-instance v7, Ljava/lang/StringBuilder;

    const/16 v4, 0x400

    invoke-direct {v7, v4}, Ljava/lang/StringBuilder;-><init>(I)V

    .line 9204
    .local v7, sb:Ljava/lang/StringBuilder;
    if-eqz p2, :cond_5

    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne v4, v5, :cond_7

    .line 9205
    :cond_5
    const-string v4, "Process: system_server\n"

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9209
    :goto_2
    if-eqz p2, :cond_8

    .line 9210
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v13, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    .line 9211
    .local v13, flags:I
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v17

    .line 9212
    .local v17, pm:Landroid/content/pm/IPackageManager;
    const-string v4, "Flags: 0x"

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const/16 v5, 0x10

    invoke-static {v13, v5}, Ljava/lang/Integer;->toString(II)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9213
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->pkgList:Ljava/util/HashSet;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v14

    .local v14, i$:Ljava/util/Iterator;
    :goto_3
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_8

    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Ljava/lang/String;

    .line 9214
    .local v16, pkg:Ljava/lang/String;
    const-string v4, "Package: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9216
    const/4 v4, 0x0

    :try_start_0
    move-object/from16 v0, v17

    move-object/from16 v1, v16

    move v2, v4

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->getPackageInfo(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;

    move-result-object v15

    .line 9217
    .local v15, pi:Landroid/content/pm/PackageInfo;
    if-eqz v15, :cond_6

    .line 9218
    const-string v4, " v"

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget v5, v15, Landroid/content/pm/PackageInfo;->versionCode:I

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 9219
    iget-object v4, v15, Landroid/content/pm/PackageInfo;->versionName:Ljava/lang/String;

    if-eqz v4, :cond_6

    .line 9220
    const-string v4, " ("

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v15, Landroid/content/pm/PackageInfo;->versionName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ")"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 9226
    .end local v15           #pi:Landroid/content/pm/PackageInfo;
    :cond_6
    :goto_4
    const-string v4, "\n"

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto :goto_3

    .line 9207
    .end local v13           #flags:I
    .end local v14           #i$:Ljava/util/Iterator;
    .end local v16           #pkg:Ljava/lang/String;
    .end local v17           #pm:Landroid/content/pm/IPackageManager;
    :cond_7
    const-string v4, "Process: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto/16 :goto_2

    .line 9223
    .restart local v13       #flags:I
    .restart local v14       #i$:Ljava/util/Iterator;
    .restart local v16       #pkg:Ljava/lang/String;
    .restart local v17       #pm:Landroid/content/pm/IPackageManager;
    :catch_0
    move-exception v4

    move-object v12, v4

    .line 9224
    .local v12, e:Landroid/os/RemoteException;
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Error getting package info: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v12}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_4

    .line 9229
    .end local v12           #e:Landroid/os/RemoteException;
    .end local v13           #flags:I
    .end local v14           #i$:Ljava/util/Iterator;
    .end local v16           #pkg:Ljava/lang/String;
    .end local v17           #pm:Landroid/content/pm/IPackageManager;
    :cond_8
    if-eqz p3, :cond_9

    .line 9230
    const-string v4, "Activity: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9232
    :cond_9
    if-eqz p4, :cond_a

    move-object/from16 v0, p4

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-eqz v4, :cond_a

    move-object/from16 v0, p4

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    iget v4, v4, Lcom/android/server/am/ProcessRecord;->pid:I

    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    if-eq v4, v5, :cond_a

    .line 9233
    const-string v4, "Parent-Process: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p4

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9235
    :cond_a
    if-eqz p4, :cond_b

    move-object/from16 v0, p4

    move-object/from16 v1, p3

    if-eq v0, v1, :cond_b

    .line 9236
    const-string v4, "Parent-Activity: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p4

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9238
    :cond_b
    if-eqz p5, :cond_c

    .line 9239
    const-string v4, "Subject: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9241
    :cond_c
    const-string v4, "Build: "

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    sget-object v5, Landroid/os/Build;->FINGERPRINT:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\n"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9242
    const-string v4, "\n"

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9246
    new-instance v3, Lcom/android/server/am/ActivityManagerService$8;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Error dump: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v4, p0

    move-object/from16 v6, p6

    move-object/from16 v8, p7

    move-object/from16 v9, p8

    invoke-direct/range {v3 .. v11}, Lcom/android/server/am/ActivityManagerService$8;-><init>(Lcom/android/server/am/ActivityManagerService;Ljava/lang/String;Ljava/lang/String;Ljava/lang/StringBuilder;Ljava/io/File;Landroid/app/ApplicationErrorReport$CrashInfo;Ljava/lang/String;Landroid/os/DropBoxManager;)V

    .line 9293
    .local v3, worker:Ljava/lang/Thread;
    if-eqz p2, :cond_d

    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne v4, v5, :cond_e

    .line 9294
    :cond_d
    invoke-virtual {v3}, Lcom/android/server/am/ActivityManagerService$8;->run()V

    goto/16 :goto_1

    .line 9296
    :cond_e
    invoke-virtual {v3}, Ljava/lang/Thread;->start()V

    goto/16 :goto_1
.end method

.method final addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 6
    .parameter "proc"

    .prologue
    .line 14192
    const/4 v0, 0x0

    .line 14193
    .local v0, added:Z
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v1, v2, v3

    .local v1, i:I
    :goto_0
    if-ltz v1, :cond_0

    .line 14194
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    iget-wide v2, v2, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    iget-wide v4, p1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    cmp-long v2, v2, v4

    if-gez v2, :cond_2

    .line 14196
    const/4 v0, 0x1

    .line 14197
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    add-int/lit8 v3, v1, 0x1

    invoke-virtual {v2, v3, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 14201
    :cond_0
    if-nez v0, :cond_1

    .line 14202
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    const/4 v3, 0x0

    invoke-virtual {v2, v3, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 14204
    :cond_1
    return-void

    .line 14193
    :cond_2
    add-int/lit8 v1, v1, -0x1

    goto :goto_0
.end method

.method final appNotResponding(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;)V
    .locals 25
    .parameter "app"
    .parameter "activity"
    .parameter "parent"
    .parameter "annotation"

    .prologue
    .line 4838
    new-instance v21, Ljava/util/ArrayList;

    const/16 v5, 0x14

    move-object/from16 v0, v21

    move v1, v5

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(I)V

    .line 4840
    .local v21, pids:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/Integer;>;"
    monitor-enter p0

    .line 4842
    :try_start_0
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    move v5, v0

    if-eqz v5, :cond_1

    .line 4843
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "During shutdown skipping ANR: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4844
    monitor-exit p0

    .line 4954
    :cond_0
    :goto_0
    return-void

    .line 4845
    :cond_1
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    move v5, v0

    if-eqz v5, :cond_2

    .line 4846
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Skipping duplicate ANR: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4847
    monitor-exit p0

    goto :goto_0

    .line 4877
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 4848
    :cond_2
    :try_start_1
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->crashing:Z

    move v5, v0

    if-eqz v5, :cond_3

    .line 4849
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Crashing app skipping ANR: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4850
    monitor-exit p0

    goto :goto_0

    .line 4855
    :cond_3
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 4858
    const/16 v5, 0x7538

    const/4 v6, 0x4

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v8, v0

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v6, v7

    const/4 v7, 0x1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v8, v0

    aput-object v8, v6, v7

    const/4 v7, 0x2

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->flags:I

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v6, v7

    const/4 v7, 0x3

    aput-object p4, v6, v7

    invoke-static {v5, v6}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4862
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v21

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4864
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move/from16 v19, v0

    .line 4865
    .local v19, parentPid:I
    if-eqz p3, :cond_4

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-eqz v5, :cond_4

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v5, :cond_4

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    move-object v0, v5

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move/from16 v19, v0

    .line 4866
    :cond_4
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    move/from16 v0, v19

    move v1, v5

    if-eq v0, v1, :cond_5

    invoke-static/range {v19 .. v19}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v21

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4868
    :cond_5
    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v6, v0

    if-eq v5, v6, :cond_6

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move v0, v5

    move/from16 v1, v19

    if-eq v0, v1, :cond_6

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v21

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4870
    :cond_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    const/4 v6, 0x1

    sub-int v15, v5, v6

    .local v15, i:I
    :goto_1
    if-ltz v15, :cond_8

    .line 4871
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v15}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v22

    check-cast v22, Lcom/android/server/am/ProcessRecord;

    .line 4872
    .local v22, r:Lcom/android/server/am/ProcessRecord;
    if-eqz v22, :cond_7

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v5, v0

    if-eqz v5, :cond_7

    .line 4873
    move-object/from16 v0, v22

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move/from16 v20, v0

    .line 4874
    .local v20, pid:I
    if-lez v20, :cond_7

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    move/from16 v0, v20

    move v1, v5

    if-eq v0, v1, :cond_7

    move/from16 v0, v20

    move/from16 v1, v19

    if-eq v0, v1, :cond_7

    sget v5, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v0, v20

    move v1, v5

    if-eq v0, v1, :cond_7

    invoke-static/range {v20 .. v20}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v21

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4870
    .end local v20           #pid:I
    :cond_7
    add-int/lit8 v15, v15, -0x1

    goto :goto_1

    .line 4877
    .end local v22           #r:Lcom/android/server/am/ProcessRecord;
    :cond_8
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 4879
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v21

    invoke-static {v0, v1}, Lcom/android/server/am/ActivityManagerService;->dumpStackTraces(ZLjava/util/ArrayList;)Ljava/io/File;

    move-result-object v12

    .line 4882
    .local v12, tracesFile:Ljava/io/File;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    move-object/from16 v16, v0

    .line 4883
    .local v16, info:Ljava/lang/StringBuilder;
    const/4 v5, 0x0

    move-object/from16 v0, v16

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 4884
    const-string v5, "ANR in "

    move-object/from16 v0, v16

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4885
    if-eqz p2, :cond_9

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v5, v0

    if-eqz v5, :cond_9

    .line 4886
    const-string v5, " ("

    move-object/from16 v0, v16

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4888
    :cond_9
    const-string v5, "\n"

    move-object/from16 v0, v16

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4889
    if-eqz p4, :cond_a

    .line 4890
    const-string v5, "Reason: "

    move-object/from16 v0, v16

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "\n"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4892
    :cond_a
    if-eqz p3, :cond_b

    move-object/from16 v0, p3

    move-object/from16 v1, p2

    if-eq v0, v1, :cond_b

    .line 4893
    const-string v5, "Parent: "

    move-object/from16 v0, v16

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "\n"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4896
    :cond_b
    const/4 v11, 0x0

    .line 4898
    .local v11, cpuInfo:Ljava/lang/String;
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStatsNow()V

    .line 4899
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    move-object v5, v0

    monitor-enter v5

    .line 4900
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object v6, v0

    invoke-virtual {v6}, Lcom/android/server/ProcessStats;->printCurrentState()Ljava/lang/String;

    move-result-object v11

    .line 4901
    monitor-exit v5
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_2

    .line 4902
    move-object/from16 v0, v16

    move-object v1, v11

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4905
    const-string v5, "ActivityManager"

    invoke-virtual/range {v16 .. v16}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 4906
    if-nez v12, :cond_c

    .line 4908
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    const/4 v6, 0x3

    invoke-static {v5, v6}, Landroid/os/Process;->sendSignal(II)V

    .line 4911
    :cond_c
    const-string v6, "anr"

    const/4 v13, 0x0

    move-object/from16 v5, p0

    move-object/from16 v7, p1

    move-object/from16 v8, p2

    move-object/from16 v9, p3

    move-object/from16 v10, p4

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/am/ActivityManagerService;->addErrorToDropBox(Ljava/lang/String;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;Ljava/lang/String;Ljava/io/File;Landroid/app/ApplicationErrorReport$CrashInfo;)V

    .line 4913
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    if-eqz v5, :cond_d

    .line 4916
    :try_start_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v7, v0

    invoke-virtual/range {v16 .. v16}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-interface {v5, v6, v7, v8}, Landroid/app/IActivityController;->appNotResponding(Ljava/lang/String;ILjava/lang/String;)I

    move-result v23

    .line 4917
    .local v23, res:I
    if-eqz v23, :cond_d

    .line 4918
    if-gez v23, :cond_0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    sget v6, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v5, v6, :cond_0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    invoke-static {v5}, Landroid/os/Process;->killProcess(I)V
    :try_end_3
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0

    goto/16 :goto_0

    .line 4921
    .end local v23           #res:I
    :catch_0
    move-exception v5

    move-object v14, v5

    .line 4922
    .local v14, e:Landroid/os/RemoteException;
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 4927
    .end local v14           #e:Landroid/os/RemoteException;
    :cond_d
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v5

    const-string v6, "anr_show_background"

    const/4 v7, 0x0

    invoke-static {v5, v6, v7}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v5

    if-eqz v5, :cond_e

    const/4 v5, 0x1

    move/from16 v24, v5

    .line 4930
    .local v24, showBackground:Z
    :goto_2
    monitor-enter p0

    .line 4931
    if-nez v24, :cond_f

    :try_start_4
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/am/ProcessRecord;->isInterestingToUserLocked()Z

    move-result v5

    if-nez v5, :cond_f

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    sget v6, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v5, v6, :cond_f

    .line 4932
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    invoke-static {v5}, Landroid/os/Process;->killProcess(I)V

    .line 4933
    monitor-exit p0

    goto/16 :goto_0

    .line 4953
    :catchall_1
    move-exception v5

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    throw v5

    .line 4901
    .end local v24           #showBackground:Z
    :catchall_2
    move-exception v6

    :try_start_5
    monitor-exit v5
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_2

    throw v6

    .line 4927
    :cond_e
    const/4 v5, 0x0

    move/from16 v24, v5

    goto :goto_2

    .line 4937
    .restart local v24       #showBackground:Z
    :cond_f
    if-eqz p2, :cond_11

    :try_start_6
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v5, v0

    :goto_3
    if-eqz p4, :cond_12

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "ANR "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    :goto_4
    invoke-virtual/range {v16 .. v16}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object v2, v5

    move-object v3, v6

    move-object v4, v7

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->makeAppNotRespondingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V

    .line 4943
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v18

    .line 4944
    .local v18, msg:Landroid/os/Message;
    new-instance v17, Ljava/util/HashMap;

    invoke-direct/range {v17 .. v17}, Ljava/util/HashMap;-><init>()V

    .line 4945
    .local v17, map:Ljava/util/HashMap;
    const/4 v5, 0x2

    move v0, v5

    move-object/from16 v1, v18

    iput v0, v1, Landroid/os/Message;->what:I

    .line 4946
    move-object/from16 v0, v17

    move-object/from16 v1, v18

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 4947
    const-string v5, "app"

    move-object/from16 v0, v17

    move-object v1, v5

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 4948
    if-eqz p2, :cond_10

    .line 4949
    const-string v5, "activity"

    move-object/from16 v0, v17

    move-object v1, v5

    move-object/from16 v2, p2

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 4952
    :cond_10
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 4953
    monitor-exit p0

    goto/16 :goto_0

    .line 4937
    .end local v17           #map:Ljava/util/HashMap;
    .end local v18           #msg:Landroid/os/Message;
    :cond_11
    const/4 v5, 0x0

    goto :goto_3

    :cond_12
    const-string v6, "ANR"
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    goto :goto_4
.end method

.method public final attachApplication(Landroid/app/IApplicationThread;)V
    .locals 4
    .parameter "thread"

    .prologue
    .line 5677
    monitor-enter p0

    .line 5678
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v0

    .line 5679
    .local v0, callingPid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 5680
    .local v1, origId:J
    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->attachApplicationLocked(Landroid/app/IApplicationThread;I)Z

    .line 5681
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5682
    monitor-exit p0

    .line 5683
    return-void

    .line 5682
    .end local v0           #callingPid:I
    .end local v1           #origId:J
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3
.end method

.method public backupAgentCreated(Ljava/lang/String;Landroid/os/IBinder;)V
    .locals 7
    .parameter "agentPackageName"
    .parameter "agent"

    .prologue
    const-string v4, "ActivityManager"

    .line 12112
    monitor-enter p0

    .line 12113
    :try_start_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    invoke-virtual {p1, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_0

    .line 12114
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Backup agent created for "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " but not requested!"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 12115
    monitor-exit p0

    .line 12132
    :goto_0
    return-void

    .line 12118
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result-wide v2

    .line 12120
    .local v2, oldIdent:J
    :try_start_1
    const-string v4, "backup"

    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v4

    invoke-static {v4}, Landroid/app/backup/IBackupManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/app/backup/IBackupManager;

    move-result-object v0

    .line 12122
    .local v0, bm:Landroid/app/backup/IBackupManager;
    invoke-interface {v0, p1, p2}, Landroid/app/backup/IBackupManager;->agentConnected(Ljava/lang/String;Landroid/os/IBinder;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1

    .line 12129
    :try_start_2
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12131
    .end local v0           #bm:Landroid/app/backup/IBackupManager;
    :goto_1
    monitor-exit p0

    goto :goto_0

    .end local v2           #oldIdent:J
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v4

    .line 12123
    .restart local v2       #oldIdent:J
    :catch_0
    move-exception v4

    .line 12129
    :try_start_3
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_1

    .line 12125
    :catch_1
    move-exception v4

    move-object v1, v4

    .line 12126
    .local v1, e:Ljava/lang/Exception;
    :try_start_4
    const-string v4, "ActivityManager"

    const-string v5, "Exception trying to deliver BackupAgent binding: "

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12127
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 12129
    :try_start_5
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_1

    .end local v1           #e:Ljava/lang/Exception;
    :catchall_1
    move-exception v4

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v4
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0
.end method

.method public bindBackupAgent(Landroid/content/pm/ApplicationInfo;I)Z
    .locals 13
    .parameter "app"
    .parameter "backupMode"

    .prologue
    const/4 v12, 0x0

    .line 12059
    const-string v0, "android.permission.BACKUP"

    const-string v1, "startBackupAgent"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 12061
    monitor-enter p0

    .line 12063
    const/4 v10, 0x0

    .line 12064
    .local v10, ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v0}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v11

    .line 12065
    .local v11, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v11
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 12066
    :try_start_1
    iget v0, p1, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v2, p1, Landroid/content/pm/ApplicationInfo;->name:Ljava/lang/String;

    invoke-virtual {v11, v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl;->getServiceStatsLocked(ILjava/lang/String;Ljava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    move-result-object v10

    .line 12067
    monitor-exit v11
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 12069
    :try_start_2
    new-instance v9, Lcom/android/server/am/BackupRecord;

    invoke-direct {v9, v10, p1, p2}, Lcom/android/server/am/BackupRecord;-><init>(Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;Landroid/content/pm/ApplicationInfo;I)V

    .line 12070
    .local v9, r:Lcom/android/server/am/BackupRecord;
    new-instance v6, Landroid/content/ComponentName;

    iget-object v0, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->backupAgentName:Ljava/lang/String;

    invoke-direct {v6, v0, v1}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 12072
    .local v6, hostingName:Landroid/content/ComponentName;
    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "backup"

    const/4 v7, 0x0

    move-object v0, p0

    move-object v2, p1

    invoke-direct/range {v0 .. v7}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;Z)Lcom/android/server/am/ProcessRecord;

    move-result-object v8

    .line 12074
    .local v8, proc:Lcom/android/server/am/ProcessRecord;
    if-nez v8, :cond_0

    .line 12075
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to start backup agent process "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 12076
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    move v0, v12

    .line 12104
    :goto_0
    return v0

    .line 12067
    .end local v6           #hostingName:Landroid/content/ComponentName;
    .end local v8           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v9           #r:Lcom/android/server/am/BackupRecord;
    :catchall_0
    move-exception v0

    :try_start_3
    monitor-exit v11
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    :try_start_4
    throw v0

    .line 12102
    .end local v11           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catchall_1
    move-exception v0

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    throw v0

    .line 12079
    .restart local v6       #hostingName:Landroid/content/ComponentName;
    .restart local v8       #proc:Lcom/android/server/am/ProcessRecord;
    .restart local v9       #r:Lcom/android/server/am/BackupRecord;
    .restart local v11       #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :cond_0
    :try_start_5
    iput-object v8, v9, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 12080
    iput-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    .line 12081
    iget-object v0, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    .line 12084
    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 12088
    iget-object v0, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    if-eqz v0, :cond_1

    .line 12091
    :try_start_6
    iget-object v0, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0, p1, p2}, Landroid/app/IApplicationThread;->scheduleCreateBackupAgent(Landroid/content/pm/ApplicationInfo;I)V
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_6 .. :try_end_6} :catch_0

    .line 12102
    :cond_1
    :goto_1
    :try_start_7
    monitor-exit p0
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_1

    .line 12104
    const/4 v0, 0x1

    goto :goto_0

    .line 12092
    :catch_0
    move-exception v0

    goto :goto_1
.end method

.method public bindService(Landroid/app/IApplicationThread;Landroid/os/IBinder;Landroid/content/Intent;Ljava/lang/String;Landroid/app/IServiceConnection;I)I
    .locals 20
    .parameter "caller"
    .parameter "token"
    .parameter "service"
    .parameter "resolvedType"
    .parameter "connection"
    .parameter "flags"

    .prologue
    .line 11633
    if-eqz p3, :cond_0

    invoke-virtual/range {p3 .. p3}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v8

    const/4 v9, 0x1

    if-ne v8, v9, :cond_0

    .line 11634
    new-instance v8, Ljava/lang/IllegalArgumentException;

    const-string v9, "File descriptors passed in Intent"

    invoke-direct {v8, v9}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v8

    .line 11637
    :cond_0
    monitor-enter p0

    .line 11641
    :try_start_0
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v14

    .line 11642
    .local v14, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v14, :cond_1

    .line 11643
    new-instance v8, Ljava/lang/SecurityException;

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Unable to find app for caller "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    move-object v0, v9

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " (pid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ") when binding service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    move-object v0, v9

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-direct {v8, v9}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v8

    .line 11755
    .end local v14           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v8

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v8

    .line 11649
    .restart local v14       #callerApp:Lcom/android/server/am/ProcessRecord;
    :cond_1
    const/4 v7, 0x0

    .line 11650
    .local v7, activity:Lcom/android/server/am/HistoryRecord;
    if-eqz p2, :cond_3

    .line 11651
    :try_start_1
    move-object/from16 v0, p0

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v12

    .line 11652
    .local v12, aindex:I
    if-gez v12, :cond_2

    .line 11653
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Binding with unknown activity: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    move-object v0, v9

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11654
    const/4 v8, 0x0

    monitor-exit p0

    .line 11757
    .end local v12           #aindex:I
    :goto_0
    return v8

    .line 11656
    .restart local v12       #aindex:I
    :cond_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v8, v0

    invoke-virtual {v8, v12}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    .end local v7           #activity:Lcom/android/server/am/HistoryRecord;
    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 11659
    .end local v12           #aindex:I
    .restart local v7       #activity:Lcom/android/server/am/HistoryRecord;
    :cond_3
    const/4 v10, 0x0

    .line 11660
    .local v10, clientLabel:I
    const/4 v11, 0x0

    .line 11662
    .local v11, clientIntent:Landroid/app/PendingIntent;
    iget-object v8, v14, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    const/16 v9, 0x3e8

    if-ne v8, v9, :cond_4

    .line 11667
    :try_start_2
    const-string v8, "android.intent.extra.client_intent"

    move-object/from16 v0, p3

    move-object v1, v8

    invoke-virtual {v0, v1}, Landroid/content/Intent;->getParcelableExtra(Ljava/lang/String;)Landroid/os/Parcelable;

    move-result-object v12

    move-object v0, v12

    check-cast v0, Landroid/app/PendingIntent;

    move-object v11, v0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Ljava/lang/RuntimeException; {:try_start_2 .. :try_end_2} :catch_1

    .line 11671
    :goto_1
    if-eqz v11, :cond_4

    .line 11672
    :try_start_3
    const-string v8, "android.intent.extra.client_label"

    const/4 v9, 0x0

    move-object/from16 v0, p3

    move-object v1, v8

    move v2, v9

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I

    move-result v10

    .line 11673
    if-eqz v10, :cond_4

    .line 11677
    invoke-virtual/range {p3 .. p3}, Landroid/content/Intent;->cloneFilter()Landroid/content/Intent;

    move-result-object p3

    .line 11682
    :cond_4
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v8

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v9

    move-object/from16 v0, p0

    move-object/from16 v1, p3

    move-object/from16 v2, p4

    move v3, v8

    move v4, v9

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->retrieveServiceLocked(Landroid/content/Intent;Ljava/lang/String;II)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v18

    .line 11685
    .local v18, res:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-nez v18, :cond_5

    .line 11686
    const/4 v8, 0x0

    monitor-exit p0

    goto :goto_0

    .line 11688
    :cond_5
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    move-object v8, v0

    if-nez v8, :cond_6

    .line 11689
    const/4 v8, -0x1

    monitor-exit p0

    goto :goto_0

    .line 11691
    :cond_6
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    move-object/from16 v19, v0

    .line 11693
    .local v19, s:Lcom/android/server/am/ServiceRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v16

    .line 11695
    .local v16, origId:J
    move-object/from16 v0, p0

    move-object/from16 v1, v19

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z

    move-result v8

    if-eqz v8, :cond_7

    .line 11700
    :cond_7
    move-object/from16 v0, v19

    move-object/from16 v1, p3

    move-object v2, v14

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ServiceRecord;->retrieveAppBindingLocked(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;)Lcom/android/server/am/AppBindRecord;

    move-result-object v6

    .line 11701
    .local v6, b:Lcom/android/server/am/AppBindRecord;
    new-instance v5, Lcom/android/server/am/ConnectionRecord;

    move-object/from16 v8, p5

    move/from16 v9, p6

    invoke-direct/range {v5 .. v11}, Lcom/android/server/am/ConnectionRecord;-><init>(Lcom/android/server/am/AppBindRecord;Lcom/android/server/am/HistoryRecord;Landroid/app/IServiceConnection;IILandroid/app/PendingIntent;)V

    .line 11704
    .local v5, c:Lcom/android/server/am/ConnectionRecord;
    invoke-interface/range {p5 .. p5}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v13

    .line 11705
    .local v13, binder:Landroid/os/IBinder;
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    move-object v8, v0

    invoke-virtual {v8, v13, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 11706
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v8, v5}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 11707
    if-eqz v7, :cond_9

    .line 11708
    iget-object v8, v7, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    if-nez v8, :cond_8

    .line 11709
    new-instance v8, Ljava/util/HashSet;

    invoke-direct {v8}, Ljava/util/HashSet;-><init>()V

    iput-object v8, v7, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    .line 11711
    :cond_8
    iget-object v8, v7, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v8, v5}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 11713
    :cond_9
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v8, v5}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 11714
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    move-object v8, v0

    invoke-virtual {v8, v13, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 11716
    and-int/lit8 v8, p6, 0x1

    if-eqz v8, :cond_a

    .line 11717
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v8

    move-wide v0, v8

    move-object/from16 v2, v19

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    .line 11718
    invoke-virtual/range {p3 .. p3}, Landroid/content/Intent;->getFlags()I

    move-result v8

    const/4 v9, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v19

    move v2, v8

    move v3, v9

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z

    move-result v8

    if-nez v8, :cond_a

    .line 11719
    const/4 v8, 0x0

    monitor-exit p0

    goto/16 :goto_0

    .line 11723
    :cond_a
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v8, v0

    if-eqz v8, :cond_b

    .line 11725
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v8, v0

    move-object/from16 v0, p0

    move-object v1, v8

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11733
    :cond_b
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v8, v0

    if-eqz v8, :cond_d

    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-boolean v8, v8, Lcom/android/server/am/IntentBindRecord;->received:Z
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    if-eqz v8, :cond_d

    .line 11737
    :try_start_4
    iget-object v8, v5, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    move-object v9, v0

    iget-object v10, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    .end local v10           #clientLabel:I
    iget-object v10, v10, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    invoke-interface {v8, v9, v10}, Landroid/app/IServiceConnection;->connected(Landroid/content/ComponentName;Landroid/os/IBinder;)V
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_4 .. :try_end_4} :catch_0

    .line 11747
    :goto_2
    :try_start_5
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v8, v8, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->size()I

    move-result v8

    const/4 v9, 0x1

    if-ne v8, v9, :cond_c

    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-boolean v8, v8, Lcom/android/server/am/IntentBindRecord;->doRebind:Z

    if-eqz v8, :cond_c

    .line 11748
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    const/4 v9, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v19

    move-object v2, v8

    move v3, v9

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z

    .line 11754
    :cond_c
    :goto_3
    invoke-static/range {v16 .. v17}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11755
    monitor-exit p0

    .line 11757
    const/4 v8, 0x1

    goto/16 :goto_0

    .line 11738
    :catch_0
    move-exception v8

    move-object v15, v8

    .line 11739
    .local v15, e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Failure sending service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    move-object v10, v0

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " to connection "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v5, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v10}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " (in "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v5, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v10, v10, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v10, v10, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ")"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v15}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_2

    .line 11750
    .end local v15           #e:Ljava/lang/Exception;
    .restart local v10       #clientLabel:I
    :cond_d
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-boolean v8, v8, Lcom/android/server/am/IntentBindRecord;->requested:Z

    if-nez v8, :cond_c

    .line 11751
    iget-object v8, v6, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    const/4 v9, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v19

    move-object v2, v8

    move v3, v9

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    goto :goto_3

    .line 11669
    .end local v5           #c:Lcom/android/server/am/ConnectionRecord;
    .end local v6           #b:Lcom/android/server/am/AppBindRecord;
    .end local v13           #binder:Landroid/os/IBinder;
    .end local v16           #origId:J
    .end local v18           #res:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    .end local v19           #s:Lcom/android/server/am/ServiceRecord;
    :catch_1
    move-exception v8

    goto/16 :goto_1
.end method

.method public final broadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZ)I
    .locals 21
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "map"
    .parameter "requiredPermission"
    .parameter "serialized"
    .parameter "sticky"

    .prologue
    .line 12672
    if-eqz p2, :cond_0

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v2

    const/4 v3, 0x1

    if-ne v2, v3, :cond_0

    .line 12673
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "File descriptors passed in Intent"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 12676
    :cond_0
    monitor-enter p0

    .line 12677
    :try_start_0
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getFlags()I

    move-result v16

    .line 12679
    .local v16, flags:I
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v2, v0

    if-nez v2, :cond_1

    .line 12682
    const/high16 v2, 0x1000

    and-int v2, v2, v16

    if-eqz v2, :cond_2

    .line 12683
    new-instance v17, Landroid/content/Intent;

    move-object/from16 v0, v17

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 12684
    .end local p2
    .local v17, intent:Landroid/content/Intent;
    const/high16 v2, 0x4000

    :try_start_1
    move-object/from16 v0, v17

    move v1, v2

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    move-object/from16 p2, v17

    .line 12692
    .end local v17           #intent:Landroid/content/Intent;
    .restart local p2
    :cond_1
    const/high16 v2, 0x800

    and-int v2, v2, v16

    if-eqz v2, :cond_3

    .line 12693
    :try_start_2
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "Can\'t use FLAG_RECEIVER_BOOT_UPGRADE here"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 12708
    .end local v16           #flags:I
    :catchall_0
    move-exception v2

    :goto_0
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v2

    .line 12685
    .restart local v16       #flags:I
    :cond_2
    const/high16 v2, 0x4000

    and-int v2, v2, v16

    if-nez v2, :cond_1

    .line 12686
    :try_start_3
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Attempt to launch receivers of broadcast intent "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " before boot completion"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 12688
    new-instance v2, Ljava/lang/IllegalStateException;

    const-string v3, "Cannot broadcast before boot completed"

    invoke-direct {v2, v3}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 12697
    :cond_3
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v3

    .line 12698
    .local v3, callerApp:Lcom/android/server/am/ProcessRecord;
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v14

    .line 12699
    .local v14, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v15

    .line 12700
    .local v15, callingUid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v18

    .line 12701
    .local v18, origId:J
    if-eqz v3, :cond_4

    iget-object v2, v3, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object v4, v2

    :goto_1
    move-object/from16 v2, p0

    move-object/from16 v5, p2

    move-object/from16 v6, p3

    move-object/from16 v7, p4

    move/from16 v8, p5

    move-object/from16 v9, p6

    move-object/from16 v10, p7

    move-object/from16 v11, p8

    move/from16 v12, p9

    move/from16 v13, p10

    invoke-direct/range {v2 .. v15}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    move-result v20

    .line 12706
    .local v20, res:I
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12707
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    return v20

    .line 12701
    .end local v20           #res:I
    :cond_4
    const/4 v2, 0x0

    move-object v4, v2

    goto :goto_1

    .line 12708
    .end local v3           #callerApp:Lcom/android/server/am/ProcessRecord;
    .end local v14           #callingPid:I
    .end local v15           #callingUid:I
    .end local v18           #origId:J
    .end local p2
    .restart local v17       #intent:Landroid/content/Intent;
    :catchall_1
    move-exception v2

    move-object/from16 p2, v17

    .end local v17           #intent:Landroid/content/Intent;
    .restart local p2
    goto :goto_0
.end method

.method broadcastIntentInPackage(Ljava/lang/String;ILandroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZ)I
    .locals 17
    .parameter "packageName"
    .parameter "uid"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "map"
    .parameter "requiredPermission"
    .parameter "serialized"
    .parameter "sticky"

    .prologue
    .line 12715
    monitor-enter p0

    .line 12716
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v14

    .line 12717
    .local v14, origId:J
    const/4 v1, 0x0

    const/4 v12, -0x1

    move-object/from16 v0, p0

    move-object/from16 v2, p1

    move-object/from16 v3, p3

    move-object/from16 v4, p4

    move-object/from16 v5, p5

    move/from16 v6, p6

    move-object/from16 v7, p7

    move-object/from16 v8, p8

    move-object/from16 v9, p9

    move/from16 v10, p10

    move/from16 v11, p11

    move/from16 v13, p2

    invoke-direct/range {v0 .. v13}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    move-result v16

    .line 12720
    .local v16, res:I
    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12721
    monitor-exit p0

    return v16

    .line 12722
    .end local v14           #origId:J
    .end local v16           #res:I
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public cancelIntentSender(Landroid/content/IIntentSender;)V
    .locals 7
    .parameter "sender"

    .prologue
    .line 6163
    instance-of v5, p1, Lcom/android/server/am/PendingIntentRecord;

    if-nez v5, :cond_0

    .line 6185
    :goto_0
    return-void

    .line 6166
    :cond_0
    monitor-enter p0

    .line 6167
    :try_start_0
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v3, v0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 6169
    .local v3, rec:Lcom/android/server/am/PendingIntentRecord;
    :try_start_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v6, v6, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;

    invoke-interface {v5, v6}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I

    move-result v4

    .line 6171
    .local v4, uid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    if-eq v4, v5, :cond_1

    .line 6172
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: cancelIntentSender() from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " is not allowed to cancel packges "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v6, v6, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 6177
    .local v2, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    invoke-static {v5, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6178
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 6180
    .end local v2           #msg:Ljava/lang/String;
    .end local v4           #uid:I
    :catch_0
    move-exception v5

    move-object v1, v5

    .line 6181
    .local v1, e:Landroid/os/RemoteException;
    :try_start_2
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/Throwable;)V

    throw v5

    .line 6184
    .end local v1           #e:Landroid/os/RemoteException;
    .end local v3           #rec:Lcom/android/server/am/PendingIntentRecord;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v5

    .line 6183
    .restart local v3       #rec:Lcom/android/server/am/PendingIntentRecord;
    .restart local v4       #uid:I
    :cond_1
    const/4 v5, 0x1

    :try_start_3
    invoke-virtual {p0, v3, v5}, Lcom/android/server/am/ActivityManagerService;->cancelIntentSenderLocked(Lcom/android/server/am/PendingIntentRecord;Z)V

    .line 6184
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_0
.end method

.method cancelIntentSenderLocked(Lcom/android/server/am/PendingIntentRecord;Z)V
    .locals 2
    .parameter "rec"
    .parameter "cleanActivity"

    .prologue
    .line 6188
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/PendingIntentRecord;->canceled:Z

    .line 6189
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    iget-object v1, p1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6190
    if-eqz p2, :cond_0

    iget-object v0, p1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord$Key;->activity:Lcom/android/server/am/HistoryRecord;

    if-eqz v0, :cond_0

    .line 6191
    iget-object v0, p1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord$Key;->activity:Lcom/android/server/am/HistoryRecord;

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    iget-object v1, p1, Lcom/android/server/am/PendingIntentRecord;->ref:Ljava/lang/ref/WeakReference;

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 6193
    :cond_0
    return-void
.end method

.method checkAppInLaunchingProvidersLocked(Lcom/android/server/am/ProcessRecord;Z)Z
    .locals 5
    .parameter "app"
    .parameter "alwaysBad"

    .prologue
    .line 10694
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 10695
    .local v0, NL:I
    const/4 v3, 0x0

    .line 10696
    .local v3, restart:Z
    const/4 v2, 0x0

    .local v2, i:I
    :goto_0
    if-ge v2, v0, :cond_2

    .line 10697
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 10699
    .local v1, cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v4, v1, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    if-ne v4, p1, :cond_0

    .line 10700
    if-nez p2, :cond_1

    iget-boolean v4, p1, Lcom/android/server/am/ProcessRecord;->bad:Z

    if-nez v4, :cond_1

    .line 10701
    const/4 v3, 0x1

    .line 10696
    :cond_0
    :goto_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    .line 10703
    :cond_1
    invoke-direct {p0, p1, v1}, Lcom/android/server/am/ActivityManagerService;->removeDyingProviderLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/ContentProviderRecord;)V

    .line 10704
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_1

    .line 10708
    .end local v1           #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_2
    return v3
.end method

.method checkAppSwitchAllowedLocked(IILjava/lang/String;)Z
    .locals 6
    .parameter "callingPid"
    .parameter "callingUid"
    .parameter "name"

    .prologue
    const/4 v5, 0x1

    .line 8389
    iget-wide v1, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    cmp-long v1, v1, v3

    if-gez v1, :cond_0

    move v1, v5

    .line 8401
    :goto_0
    return v1

    .line 8393
    :cond_0
    const-string v1, "android.permission.STOP_APP_SWITCHES"

    const/4 v2, -0x1

    invoke-virtual {p0, v1, p1, p2, v2}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v0

    .line 8396
    .local v0, perm:I
    if-nez v0, :cond_1

    move v1, v5

    .line 8397
    goto :goto_0

    .line 8400
    :cond_1
    const-string v1, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v2, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " request from "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " stopped"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8401
    const/4 v1, 0x0

    goto :goto_0
.end method

.method checkCallingPermission(Ljava/lang/String;)I
    .locals 2
    .parameter "permission"

    .prologue
    .line 6358
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v0

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    invoke-virtual {p0, p1, v0, v1}, Lcom/android/server/am/ActivityManagerService;->checkPermission(Ljava/lang/String;II)I

    move-result v0

    return v0
.end method

.method checkComponentPermission(Ljava/lang/String;III)I
    .locals 7
    .parameter "permission"
    .parameter "pid"
    .parameter "uid"
    .parameter "reqUid"

    .prologue
    const/4 v6, 0x0

    const/4 v5, -0x1

    const-string v4, "ActivityManager"

    .line 6306
    sget-object v2, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v2}, Ljava/lang/ThreadLocal;->get()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ActivityManagerService$Identity;

    .line 6307
    .local v1, tlsIdentity:Lcom/android/server/am/ActivityManagerService$Identity;
    if-eqz v1, :cond_0

    .line 6308
    const-string v2, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "checkComponentPermission() adjusting {pid,uid} to {"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget v3, v1, Lcom/android/server/am/ActivityManagerService$Identity;->pid:I

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, ","

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget v3, v1, Lcom/android/server/am/ActivityManagerService$Identity;->uid:I

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, "}"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v4, v2}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 6310
    iget p3, v1, Lcom/android/server/am/ActivityManagerService$Identity;->uid:I

    .line 6311
    iget p2, v1, Lcom/android/server/am/ActivityManagerService$Identity;->pid:I

    .line 6315
    :cond_0
    if-eqz p3, :cond_1

    const/16 v2, 0x3e8

    if-eq p3, v2, :cond_1

    const/16 v2, 0x3e9

    if-eq p3, v2, :cond_1

    sget v2, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq p2, v2, :cond_1

    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v2

    if-nez v2, :cond_2

    :cond_1
    move v2, v6

    .line 6334
    :goto_0
    return v2

    .line 6320
    :cond_2
    if-ltz p4, :cond_3

    if-eq p3, p4, :cond_3

    .line 6321
    const-string v2, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Permission denied: checkComponentPermission() reqUid="

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v4, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    move v2, v5

    .line 6322
    goto :goto_0

    .line 6324
    :cond_3
    if-nez p1, :cond_4

    move v2, v6

    .line 6325
    goto :goto_0

    .line 6328
    :cond_4
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v2

    invoke-interface {v2, p1, p3}, Landroid/content/pm/IPackageManager;->checkUidPermission(Ljava/lang/String;I)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v2

    goto :goto_0

    .line 6330
    :catch_0
    move-exception v2

    move-object v0, v2

    .line 6332
    .local v0, e:Landroid/os/RemoteException;
    const-string v2, "ActivityManager"

    const-string v2, "PackageManager is dead?!?"

    invoke-static {v4, v2, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    move v2, v5

    .line 6334
    goto :goto_0
.end method

.method public checkPermission(Ljava/lang/String;II)I
    .locals 1
    .parameter "permission"
    .parameter "pid"
    .parameter "uid"

    .prologue
    const/4 v0, -0x1

    .line 6347
    if-nez p1, :cond_0

    .line 6350
    :goto_0
    return v0

    :cond_0
    invoke-virtual {p0, p1, p2, p3, v0}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v0

    goto :goto_0
.end method

.method public checkUriPermission(Landroid/net/Uri;III)I
    .locals 3
    .parameter "uri"
    .parameter "pid"
    .parameter "uid"
    .parameter "modeFlags"

    .prologue
    const/4 v2, 0x0

    .line 6419
    sget-object v1, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v1}, Ljava/lang/ThreadLocal;->get()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ActivityManagerService$Identity;

    .line 6420
    .local v0, tlsIdentity:Lcom/android/server/am/ActivityManagerService$Identity;
    if-eqz v0, :cond_0

    .line 6421
    iget p3, v0, Lcom/android/server/am/ActivityManagerService$Identity;->uid:I

    .line 6422
    iget p2, v0, Lcom/android/server/am/ActivityManagerService$Identity;->pid:I

    .line 6426
    :cond_0
    sget v1, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne p2, v1, :cond_1

    move v1, v2

    .line 6430
    :goto_0
    return v1

    .line 6429
    :cond_1
    monitor-enter p0

    .line 6430
    :try_start_0
    invoke-direct {p0, p1, p3, p4}, Lcom/android/server/am/ActivityManagerService;->checkUriPermissionLocked(Landroid/net/Uri;II)Z

    move-result v1

    if-eqz v1, :cond_2

    move v1, v2

    :goto_1
    monitor-exit p0

    goto :goto_0

    .line 6433
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1

    .line 6430
    :cond_2
    const/4 v1, -0x1

    goto :goto_1
.end method

.method public clearApplicationUserData(Ljava/lang/String;Landroid/content/pm/IPackageDataObserver;)Z
    .locals 25
    .parameter "packageName"
    .parameter "observer"

    .prologue
    .line 5037
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v24

    .line 5038
    .local v24, uid:I
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v21

    .line 5039
    .local v21, pid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v19

    .line 5041
    .local v19, callingId:J
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v23

    .line 5042
    .local v23, pm:Landroid/content/pm/IPackageManager;
    const/16 v22, -0x1

    .line 5043
    .local v22, pkgUid:I
    monitor-enter p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 5045
    :try_start_1
    move-object/from16 v0, v23

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1

    move-result v22

    .line 5048
    :goto_0
    const/4 v5, -0x1

    move/from16 v0, v22

    move v1, v5

    if-ne v0, v1, :cond_0

    .line 5049
    :try_start_2
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Invalid packageName:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5050
    const/4 v5, 0x0

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 5078
    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5080
    :goto_1
    return v5

    .line 5052
    :cond_0
    move/from16 v0, v24

    move/from16 v1, v22

    if-eq v0, v1, :cond_1

    :try_start_3
    const-string v5, "android.permission.CLEAR_APP_USER_DATA"

    const/4 v6, -0x1

    move-object/from16 v0, p0

    move-object v1, v5

    move/from16 v2, v21

    move/from16 v3, v24

    move v4, v6

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v5

    if-nez v5, :cond_2

    .line 5056
    :cond_1
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, v22

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;I)V

    .line 5062
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 5066
    :try_start_4
    move-object/from16 v0, v23

    move-object/from16 v1, p1

    move-object/from16 v2, p2

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->clearApplicationUserData(Ljava/lang/String;Landroid/content/pm/IPackageDataObserver;)V

    .line 5067
    new-instance v8, Landroid/content/Intent;

    const-string v5, "android.intent.action.PACKAGE_DATA_CLEARED"

    const-string v6, "package"

    const/4 v7, 0x0

    move-object v0, v6

    move-object/from16 v1, p1

    move-object v2, v7

    invoke-static {v0, v1, v2}, Landroid/net/Uri;->fromParts(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v6

    invoke-direct {v8, v5, v6}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    .line 5069
    .local v8, intent:Landroid/content/Intent;
    const-string v5, "android.intent.extra.UID"

    move-object v0, v8

    move-object v1, v5

    move/from16 v2, v22

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 5070
    monitor-enter p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_0

    .line 5071
    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    :try_start_5
    sget v17, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v18, 0x3e8

    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v18}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 5074
    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_2

    .line 5078
    .end local v8           #intent:Landroid/content/Intent;
    :goto_2
    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5080
    const/4 v5, 0x1

    goto :goto_1

    .line 5058
    :cond_2
    :try_start_6
    new-instance v5, Ljava/lang/SecurityException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    move-object v0, v6

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " does not have permission:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "android.permission.CLEAR_APP_USER_DATA"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " to clear data"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "for process:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 5062
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    :try_start_7
    throw v5
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_1

    .line 5078
    .end local v22           #pkgUid:I
    .end local v23           #pm:Landroid/content/pm/IPackageManager;
    :catchall_1
    move-exception v5

    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v5

    .line 5074
    .restart local v8       #intent:Landroid/content/Intent;
    .restart local v22       #pkgUid:I
    .restart local v23       #pm:Landroid/content/pm/IPackageManager;
    :catchall_2
    move-exception v5

    :try_start_8
    monitor-exit p0
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_2

    :try_start_9
    throw v5
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_9 .. :try_end_9} :catch_0

    .line 5075
    .end local v8           #intent:Landroid/content/Intent;
    :catch_0
    move-exception v5

    goto :goto_2

    .line 5046
    :catch_1
    move-exception v5

    goto/16 :goto_0
.end method

.method public closeSystemDialogs(Ljava/lang/String;)V
    .locals 23
    .parameter "reason"

    .prologue
    .line 5177
    new-instance v9, Landroid/content/Intent;

    const-string v3, "android.intent.action.CLOSE_SYSTEM_DIALOGS"

    invoke-direct {v9, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 5178
    .local v9, intent:Landroid/content/Intent;
    if-eqz p1, :cond_0

    .line 5179
    const-string v3, "reason"

    move-object v0, v9

    move-object v1, v3

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;

    .line 5182
    :cond_0
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v19

    .line 5183
    .local v19, uid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v20

    .line 5184
    .local v20, origId:J
    monitor-enter p0

    .line 5185
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->beginBroadcast()I

    move-result v5

    .line 5186
    .local v5, i:I
    :cond_1
    :goto_0
    if-lez v5, :cond_2

    .line 5187
    add-int/lit8 v5, v5, -0x1

    .line 5188
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Landroid/os/RemoteCallbackList;->getBroadcastItem(I)Landroid/os/IInterface;

    move-result-object v22

    check-cast v22, Landroid/app/IActivityWatcher;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5189
    .local v22, w:Landroid/app/IActivityWatcher;
    if-eqz v22, :cond_1

    .line 5191
    :try_start_1
    move-object/from16 v0, v22

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/app/IActivityWatcher;->closingSystemDialogs(Ljava/lang/String;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_0

    .line 5192
    :catch_0
    move-exception v3

    goto :goto_0

    .line 5196
    .end local v22           #w:Landroid/app/IActivityWatcher;
    :cond_2
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->finishBroadcast()V

    .line 5198
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->closeSystemDialogs(Ljava/lang/String;)V

    .line 5200
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v5, v3, v4

    :goto_1
    if-ltz v5, :cond_4

    .line 5201
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 5202
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget v3, v3, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit16 v3, v3, 0x100

    if-eqz v3, :cond_3

    .line 5203
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "close-sys"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 5200
    :cond_3
    add-int/lit8 v5, v5, -0x1

    goto :goto_1

    .line 5208
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, -0x1

    move-object/from16 v6, p0

    invoke-direct/range {v6 .. v19}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 5210
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 5211
    invoke-static/range {v20 .. v21}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5212
    return-void

    .line 5210
    .end local v5           #i:I
    :catchall_0
    move-exception v3

    :try_start_3
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    throw v3
.end method

.method public collectPss(Lcom/android/server/Watchdog$PssStats;)V
    .locals 6
    .parameter "stats"

    .prologue
    const/4 v4, 0x0

    .line 8634
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    .line 8635
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    .line 8636
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundPss:I

    .line 8637
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundCount:I

    .line 8638
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mServicePss:I

    .line 8639
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mServiceCount:I

    .line 8640
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisiblePss:I

    .line 8641
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisibleCount:I

    .line 8642
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundPss:I

    .line 8643
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundCount:I

    .line 8644
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mNoPssCount:I

    .line 8645
    monitor-enter p0

    .line 8647
    :try_start_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    array-length v4, v4

    iget-object v5, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    array-length v5, v5

    if-ge v4, v5, :cond_0

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    array-length v4, v4

    move v0, v4

    .line 8649
    .local v0, NPD:I
    :goto_0
    const/4 v1, 0x0

    .line 8650
    .local v1, aggr:I
    const/4 v2, 0x0

    .local v2, i:I
    :goto_1
    if-ge v2, v0, :cond_1

    .line 8651
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    aget v4, v4, v2

    add-int/2addr v1, v4

    .line 8652
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    aput v1, v4, v2

    .line 8650
    add-int/lit8 v2, v2, 0x1

    goto :goto_1

    .line 8647
    .end local v0           #NPD:I
    .end local v1           #aggr:I
    .end local v2           #i:I
    :cond_0
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    array-length v4, v4

    move v0, v4

    goto :goto_0

    .line 8654
    .restart local v0       #NPD:I
    .restart local v1       #aggr:I
    .restart local v2       #i:I
    :cond_1
    :goto_2
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    array-length v4, v4

    if-ge v2, v4, :cond_2

    .line 8655
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    const/4 v5, 0x0

    aput v5, v4, v2

    .line 8656
    add-int/lit8 v2, v2, 0x1

    goto :goto_2

    .line 8659
    :cond_2
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    const/4 v5, 0x1

    sub-int v2, v4, v5

    :goto_3
    if-ltz v2, :cond_8

    .line 8660
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 8661
    .local v3, proc:Lcom/android/server/am/ProcessRecord;
    iget-boolean v4, v3, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v4, :cond_3

    .line 8659
    :goto_4
    add-int/lit8 v2, v2, -0x1

    goto :goto_3

    .line 8665
    :cond_3
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    if-nez v4, :cond_4

    .line 8666
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mNoPssCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mNoPssCount:I

    goto :goto_4

    .line 8685
    .end local v0           #NPD:I
    .end local v1           #aggr:I
    .end local v2           #i:I
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 8669
    .restart local v0       #NPD:I
    .restart local v1       #aggr:I
    .restart local v2       #i:I
    .restart local v3       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_4
    :try_start_1
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v4, v5, :cond_6

    .line 8670
    iget-boolean v4, v3, Lcom/android/server/am/ProcessRecord;->empty:Z

    if-eqz v4, :cond_5

    .line 8671
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    .line 8672
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    goto :goto_4

    .line 8674
    :cond_5
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundPss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundPss:I

    .line 8675
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundCount:I

    goto :goto_4

    .line 8677
    :cond_6
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-lt v4, v5, :cond_7

    .line 8678
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisiblePss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisiblePss:I

    .line 8679
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisibleCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisibleCount:I

    goto :goto_4

    .line 8681
    :cond_7
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundPss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundPss:I

    .line 8682
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundCount:I

    goto :goto_4

    .line 8685
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_8
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8686
    return-void
.end method

.method createAppErrorIntentLocked(Lcom/android/server/am/ProcessRecord;JLandroid/app/ApplicationErrorReport$CrashInfo;)Landroid/content/Intent;
    .locals 3
    .parameter "r"
    .parameter "timeMillis"
    .parameter "crashInfo"

    .prologue
    .line 9394
    invoke-direct {p0, p1, p2, p3, p4}, Lcom/android/server/am/ActivityManagerService;->createAppErrorReportLocked(Lcom/android/server/am/ProcessRecord;JLandroid/app/ApplicationErrorReport$CrashInfo;)Landroid/app/ApplicationErrorReport;

    move-result-object v0

    .line 9395
    .local v0, report:Landroid/app/ApplicationErrorReport;
    if-nez v0, :cond_0

    .line 9396
    const/4 v2, 0x0

    .line 9402
    :goto_0
    return-object v2

    .line 9398
    :cond_0
    new-instance v1, Landroid/content/Intent;

    const-string v2, "android.intent.action.APP_ERROR"

    invoke-direct {v1, v2}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 9399
    .local v1, result:Landroid/content/Intent;
    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    invoke-virtual {v1, v2}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 9400
    const-string v2, "android.intent.extra.BUG_REPORT"

    invoke-virtual {v1, v2, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;

    .line 9401
    const/high16 v2, 0x1000

    invoke-virtual {v1, v2}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    move-object v2, v1

    .line 9402
    goto :goto_0
.end method

.method protected dump(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
    .locals 10
    .parameter "fd"
    .parameter "pw"
    .parameter "args"

    .prologue
    .line 9552
    const-string v0, "android.permission.DUMP"

    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_0

    .line 9554
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Permission Denial: can\'t dump ActivityManager from from pid="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, ", uid="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " without permission "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, "android.permission.DUMP"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9678
    :goto_0
    return-void

    .line 9562
    :cond_0
    const/4 v5, 0x0

    .line 9564
    .local v5, dumpAll:Z
    const/4 v4, 0x0

    .line 9565
    .local v4, opti:I
    :goto_1
    array-length v0, p3

    if-ge v4, v0, :cond_1

    .line 9566
    aget-object v9, p3, v4

    .line 9567
    .local v9, opt:Ljava/lang/String;
    if-eqz v9, :cond_1

    invoke-virtual {v9}, Ljava/lang/String;->length()I

    move-result v0

    if-lez v0, :cond_1

    const/4 v0, 0x0

    invoke-virtual {v9, v0}, Ljava/lang/String;->charAt(I)C

    move-result v0

    const/16 v1, 0x2d

    if-eq v0, v1, :cond_3

    .line 9591
    .end local v9           #opt:Ljava/lang/String;
    :cond_1
    array-length v0, p3

    if-ge v4, v0, :cond_11

    .line 9592
    aget-object v7, p3, v4

    .line 9593
    .local v7, cmd:Ljava/lang/String;
    add-int/lit8 v4, v4, 0x1

    .line 9594
    const-string v0, "activities"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_2

    const-string v0, "a"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_6

    .line 9595
    :cond_2
    monitor-enter p0

    .line 9596
    const/4 v5, 0x1

    const/4 v6, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_0
    invoke-virtual/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->dumpActivitiesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZZ)Z

    .line 9597
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto :goto_0

    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    .line 9570
    .end local v7           #cmd:Ljava/lang/String;
    .restart local v5       #dumpAll:Z
    .restart local v9       #opt:Ljava/lang/String;
    :cond_3
    add-int/lit8 v4, v4, 0x1

    .line 9571
    const-string v0, "-a"

    invoke-virtual {v0, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_4

    .line 9572
    const/4 v5, 0x1

    goto :goto_1

    .line 9573
    :cond_4
    const-string v0, "-h"

    invoke-virtual {v0, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_5

    .line 9574
    const-string v0, "Activity manager dump options:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9575
    const-string v0, "  [-a] [-h] [cmd] ..."

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9576
    const-string v0, "  cmd may be one of:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9577
    const-string v0, "    activities: activity stack state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9578
    const-string v0, "    broadcasts: broadcast state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9579
    const-string v0, "    intents: pending intent state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9580
    const-string v0, "    processes: process state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9581
    const-string v0, "    providers: content provider state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9582
    const-string v0, "    services: service state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9583
    const-string v0, "    service [name]: service client-side state"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto/16 :goto_0

    .line 9586
    :cond_5
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Unknown argument: "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, "; use -h for help"

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto/16 :goto_1

    .line 9599
    .end local v9           #opt:Ljava/lang/String;
    .restart local v7       #cmd:Ljava/lang/String;
    :cond_6
    const-string v0, "broadcasts"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_7

    const-string v0, "b"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_8

    .line 9600
    :cond_7
    monitor-enter p0

    .line 9601
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_1
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpBroadcastsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9602
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto/16 :goto_0

    :catchall_1
    move-exception v0

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    throw v0

    .line 9604
    .restart local v5       #dumpAll:Z
    :cond_8
    const-string v0, "intents"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_9

    const-string v0, "i"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_a

    .line 9605
    :cond_9
    monitor-enter p0

    .line 9606
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_2
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpPendingIntentsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9607
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto/16 :goto_0

    :catchall_2
    move-exception v0

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_2

    throw v0

    .line 9609
    .restart local v5       #dumpAll:Z
    :cond_a
    const-string v0, "processes"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_b

    const-string v0, "p"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_c

    .line 9610
    :cond_b
    monitor-enter p0

    .line 9611
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_3
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpProcessesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9612
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto/16 :goto_0

    :catchall_3
    move-exception v0

    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_3

    throw v0

    .line 9614
    .restart local v5       #dumpAll:Z
    :cond_c
    const-string v0, "providers"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_d

    const-string v0, "prov"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_e

    .line 9615
    :cond_d
    monitor-enter p0

    .line 9616
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_4
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpProvidersLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9617
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto/16 :goto_0

    :catchall_4
    move-exception v0

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_4

    throw v0

    .line 9619
    .restart local v5       #dumpAll:Z
    :cond_e
    const-string v0, "service"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_f

    .line 9620
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)V

    goto/16 :goto_0

    .line 9622
    :cond_f
    const-string v0, "services"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_10

    const-string v0, "s"

    invoke-virtual {v0, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_11

    .line 9623
    :cond_10
    monitor-enter p0

    .line 9624
    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    :try_start_5
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpServicesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9625
    .end local v5           #dumpAll:Z
    monitor-exit p0

    goto/16 :goto_0

    :catchall_5
    move-exception v0

    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_5

    throw v0

    .line 9631
    .end local v7           #cmd:Ljava/lang/String;
    .restart local v5       #dumpAll:Z
    :cond_11
    monitor-enter p0

    .line 9633
    if-eqz v5, :cond_12

    .line 9634
    :try_start_6
    const-string v0, "Providers in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_12
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 9636
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpProvidersLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    move-result v8

    .line 9637
    .local v8, needSep:Z
    if-eqz v8, :cond_13

    .line 9638
    const-string v0, " "

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9640
    :cond_13
    if-eqz v5, :cond_14

    .line 9641
    const-string v0, "-------------------------------------------------------------------------------"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9642
    const-string v0, "Broadcasts in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_14
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 9644
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpBroadcastsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    move-result v8

    .line 9645
    if-eqz v8, :cond_15

    .line 9646
    const-string v0, " "

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9648
    :cond_15
    if-eqz v5, :cond_16

    .line 9649
    const-string v0, "-------------------------------------------------------------------------------"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9650
    const-string v0, "Services in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_16
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 9652
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpServicesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    move-result v8

    .line 9653
    if-eqz v8, :cond_17

    .line 9654
    const-string v0, " "

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9656
    :cond_17
    if-eqz v5, :cond_18

    .line 9657
    const-string v0, "-------------------------------------------------------------------------------"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9658
    const-string v0, "PendingIntents in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_18
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 9660
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpPendingIntentsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    move-result v8

    .line 9661
    if-eqz v8, :cond_19

    .line 9662
    const-string v0, " "

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9664
    :cond_19
    if-eqz v5, :cond_1a

    .line 9665
    const-string v0, "-------------------------------------------------------------------------------"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9666
    const-string v0, "Activities in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9668
    :cond_1a
    if-nez v5, :cond_1d

    const/4 v0, 0x1

    move v6, v0

    :goto_2
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    invoke-virtual/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->dumpActivitiesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZZ)Z

    move-result v8

    .line 9669
    if-eqz v8, :cond_1b

    .line 9670
    const-string v0, " "

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9672
    :cond_1b
    if-eqz v5, :cond_1c

    .line 9673
    const-string v0, "-------------------------------------------------------------------------------"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9674
    const-string v0, "Processes in Current Activity Manager State:"

    invoke-virtual {p2, v0}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_1c
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 9676
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->dumpProcessesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z

    .line 9677
    monitor-exit p0

    goto/16 :goto_0

    .end local v8           #needSep:Z
    :catchall_6
    move-exception v0

    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_6

    throw v0

    .line 9668
    .restart local v8       #needSep:Z
    :cond_1d
    const/4 v0, 0x0

    move v6, v0

    goto :goto_2
.end method

.method dumpActivitiesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZZ)Z
    .locals 9
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"
    .parameter "needHeader"

    .prologue
    const/4 v8, 0x1

    const/4 v7, 0x0

    const-string v6, "  "

    const-string v5, " "

    .line 9682
    if-eqz p6, :cond_0

    .line 9683
    const-string v3, "  Activity stack:"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9685
    :cond_0
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    const-string v4, "  "

    const-string v4, "Hist"

    invoke-static {p2, v3, v6, v4, v8}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 9686
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9687
    const-string v3, "  Running activities (most recent first):"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9688
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    const-string v4, "  "

    const-string v4, "Run"

    invoke-static {p2, v3, v6, v4, v7}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 9689
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_1

    .line 9690
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9691
    const-string v3, "  Activities waiting for another to become visible:"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9692
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    const-string v4, "  "

    const-string v4, "Wait"

    invoke-static {p2, v3, v6, v4, v7}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 9694
    :cond_1
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_2

    .line 9695
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9696
    const-string v3, "  Activities waiting to stop:"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9697
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    const-string v4, "  "

    const-string v4, "Stop"

    invoke-static {p2, v3, v6, v4, v7}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 9699
    :cond_2
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_3

    .line 9700
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9701
    const-string v3, "  Activities waiting to finish:"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9702
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    const-string v4, "  "

    const-string v4, "Fin"

    invoke-static {p2, v3, v6, v4, v7}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 9705
    :cond_3
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9706
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mPausingActivity: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9707
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mResumedActivity: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9708
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mFocusedActivity: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9709
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mLastPausedActivity: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9711
    if-eqz p5, :cond_4

    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_4

    .line 9712
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9713
    const-string v3, "Recent tasks in Current Activity Manager State:"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9715
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 9716
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_0
    if-ge v1, v0, :cond_4

    .line 9717
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/TaskRecord;

    .line 9718
    .local v2, tr:Lcom/android/server/am/TaskRecord;
    const-string v3, "  * Recent #"

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->print(I)V

    const-string v3, ": "

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9719
    invoke-virtual {p2, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9720
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/TaskRecord;

    const-string v4, "    "

    invoke-virtual {v3, p2, v4}, Lcom/android/server/am/TaskRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9716
    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    .line 9724
    .end local v0           #N:I
    .end local v1           #i:I
    .end local v2           #tr:Lcom/android/server/am/TaskRecord;
    :cond_4
    const-string v3, " "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9725
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mCurTask: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget v4, p0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9727
    return v8
.end method

.method dumpBroadcastsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z
    .locals 19
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    .line 9961
    const/4 v12, 0x0

    .line 9963
    .local v12, needSep:Z
    if-eqz p5, :cond_1

    .line 9964
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/HashMap;->size()I

    move-result v15

    if-lez v15, :cond_0

    .line 9965
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9966
    const-string v15, "  Registered Receivers:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9967
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v15

    invoke-interface {v15}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v11

    .line 9968
    .local v11, it:Ljava/util/Iterator;
    :goto_0
    invoke-interface {v11}, Ljava/util/Iterator;->hasNext()Z

    move-result v15

    if-eqz v15, :cond_0

    .line 9969
    invoke-interface {v11}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/am/ReceiverList;

    .line 9970
    .local v13, r:Lcom/android/server/am/ReceiverList;
    const-string v15, "  * "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p2

    move-object v1, v13

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9971
    const-string v15, "    "

    move-object v0, v13

    move-object/from16 v1, p2

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ReceiverList;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_0

    .line 9975
    .end local v11           #it:Ljava/util/Iterator;
    .end local v13           #r:Lcom/android/server/am/ReceiverList;
    :cond_0
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9976
    const-string v15, "Receiver Resolver Table:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9977
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    move-object v15, v0

    const/16 v16, 0x0

    const-string v17, "  "

    const/16 v18, 0x0

    move-object v0, v15

    move-object/from16 v1, p2

    move-object/from16 v2, v16

    move-object/from16 v3, v17

    move-object/from16 v4, v18

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/IntentResolver;->dump(Ljava/io/PrintWriter;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Z

    .line 9978
    const/4 v12, 0x1

    .line 9981
    :cond_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    if-gtz v15, :cond_2

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    if-gtz v15, :cond_2

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v15, v0

    if-eqz v15, :cond_7

    .line 9983
    :cond_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    if-lez v15, :cond_3

    .line 9984
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9985
    const-string v15, "  Active broadcasts:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9987
    :cond_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    const/16 v16, 0x1

    sub-int v8, v15, v16

    .end local p1
    .local v8, i:I
    :goto_1
    if-ltz v8, :cond_4

    .line 9988
    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    const-string v16, "  Broadcast #"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v15

    const-string v16, ":"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9989
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/BroadcastRecord;

    const-string v15, "    "

    move-object/from16 v0, p1

    move-object/from16 v1, p2

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9987
    add-int/lit8 v8, v8, -0x1

    goto :goto_1

    .line 9991
    :cond_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    if-lez v15, :cond_5

    .line 9992
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9993
    const-string v15, "  Active ordered broadcasts:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9995
    :cond_5
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v15

    const/16 v16, 0x1

    sub-int v8, v15, v16

    :goto_2
    if-ltz v8, :cond_6

    .line 9996
    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    const-string v16, "  Serialized Broadcast #"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v15

    const-string v16, ":"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9997
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v15, v0

    invoke-virtual {v15, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/BroadcastRecord;

    const-string v15, "    "

    move-object/from16 v0, p1

    move-object/from16 v1, p2

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9995
    add-int/lit8 v8, v8, -0x1

    goto :goto_2

    .line 9999
    :cond_6
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10000
    const-string v15, "  Pending broadcast:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10001
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v15, v0

    if-eqz v15, :cond_c

    .line 10002
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v15, v0

    const-string v16, "    "

    move-object v0, v15

    move-object/from16 v1, p2

    move-object/from16 v2, v16

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10006
    :goto_3
    const/4 v12, 0x1

    .line 10009
    .end local v8           #i:I
    :cond_7
    if-eqz p5, :cond_9

    .line 10010
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10011
    const-string v15, "  Historical broadcasts:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10012
    const/4 v8, 0x0

    .restart local v8       #i:I
    :goto_4
    const/16 v15, 0x64

    if-ge v8, v15, :cond_8

    .line 10013
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBroadcastHistory:[Lcom/android/server/am/BroadcastRecord;

    move-object v15, v0

    aget-object v13, v15, v8

    .line 10014
    .local v13, r:Lcom/android/server/am/BroadcastRecord;
    if-nez v13, :cond_d

    .line 10020
    .end local v13           #r:Lcom/android/server/am/BroadcastRecord;
    :cond_8
    const/4 v12, 0x1

    .line 10023
    .end local v8           #i:I
    :cond_9
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    move-object v15, v0

    if-eqz v15, :cond_f

    .line 10024
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10025
    const-string v15, "  Sticky broadcasts:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10026
    new-instance v14, Ljava/lang/StringBuilder;

    const/16 v15, 0x80

    invoke-direct {v14, v15}, Ljava/lang/StringBuilder;-><init>(I)V

    .line 10028
    .local v14, sb:Ljava/lang/StringBuilder;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    move-object v15, v0

    invoke-virtual {v15}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v15

    invoke-interface {v15}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v9

    .local v9, i$:Ljava/util/Iterator;
    :cond_a
    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z

    move-result v15

    if-eqz v15, :cond_e

    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/util/Map$Entry;

    .line 10029
    .local v7, ent:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Ljava/util/ArrayList<Landroid/content/Intent;>;>;"
    const-string v15, "  * Sticky action "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface {v7}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, p2

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10030
    const-string v15, ":"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10031
    invoke-interface {v7}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Ljava/util/ArrayList;

    .line 10032
    .local v10, intents:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v5

    .line 10033
    .local v5, N:I
    const/4 v8, 0x0

    .restart local v8       #i:I
    :goto_5
    if-ge v8, v5, :cond_a

    .line 10034
    const/4 v15, 0x0

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 10035
    const-string v15, "    Intent: "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 10036
    invoke-virtual {v10, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Landroid/content/Intent;

    const/4 v15, 0x1

    const/16 v16, 0x0

    move-object/from16 v0, p1

    move-object v1, v14

    move v2, v15

    move/from16 v3, v16

    invoke-virtual {v0, v1, v2, v3}, Landroid/content/Intent;->toShortString(Ljava/lang/StringBuilder;ZZ)V

    .line 10037
    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10038
    invoke-virtual {v10, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Landroid/content/Intent;

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getExtras()Landroid/os/Bundle;

    move-result-object v6

    .line 10039
    .local v6, bundle:Landroid/os/Bundle;
    if-eqz v6, :cond_b

    .line 10040
    const-string v15, "      "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10041
    invoke-virtual {v6}, Landroid/os/Bundle;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10033
    :cond_b
    add-int/lit8 v8, v8, 0x1

    goto :goto_5

    .line 10004
    .end local v5           #N:I
    .end local v6           #bundle:Landroid/os/Bundle;
    .end local v7           #ent:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Ljava/util/ArrayList<Landroid/content/Intent;>;>;"
    .end local v9           #i$:Ljava/util/Iterator;
    .end local v10           #intents:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    .end local v14           #sb:Ljava/lang/StringBuilder;
    :cond_c
    const-string v15, "    (null)"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto/16 :goto_3

    .line 10017
    .restart local v13       #r:Lcom/android/server/am/BroadcastRecord;
    :cond_d
    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    const-string v16, "  Historical Broadcast #"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v15

    const-string v16, ":"

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10018
    const-string v15, "    "

    move-object v0, v13

    move-object/from16 v1, p2

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10012
    add-int/lit8 v8, v8, 0x1

    goto/16 :goto_4

    .line 10045
    .end local v8           #i:I
    .end local v13           #r:Lcom/android/server/am/BroadcastRecord;
    .restart local v9       #i$:Ljava/util/Iterator;
    .restart local v14       #sb:Ljava/lang/StringBuilder;
    :cond_e
    const/4 v12, 0x1

    .line 10048
    .end local v9           #i$:Ljava/util/Iterator;
    .end local v14           #sb:Ljava/lang/StringBuilder;
    :cond_f
    if-eqz p5, :cond_10

    .line 10049
    const-string v15, " "

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10050
    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    const-string v16, "  mBroadcastsScheduled="

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v15

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    move/from16 v16, v0

    invoke-virtual/range {v15 .. v16}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v15

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v15

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10051
    const-string v15, "  mHandler:"

    move-object/from16 v0, p2

    move-object v1, v15

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10052
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v15, v0

    new-instance v16, Landroid/util/PrintWriterPrinter;

    move-object/from16 v0, v16

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/util/PrintWriterPrinter;-><init>(Ljava/io/PrintWriter;)V

    const-string v17, "    "

    invoke-virtual/range {v15 .. v17}, Landroid/os/Handler;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    .line 10053
    const/4 v12, 0x1

    .line 10056
    :cond_10
    return v12
.end method

.method dumpPendingIntentsLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z
    .locals 6
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    const-string v5, "  * "

    .line 10191
    const/4 v1, 0x0

    .line 10193
    .local v1, needSep:Z
    if-eqz p5, :cond_2

    .line 10194
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    invoke-virtual {v4}, Ljava/util/HashMap;->size()I

    move-result v4

    if-lez v4, :cond_2

    .line 10195
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    invoke-virtual {v4}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v4

    invoke-interface {v4}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .line 10197
    .end local p0
    .local v0, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;>;"
    :goto_0
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_2

    .line 10198
    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/ref/WeakReference;

    .line 10199
    .local v3, ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    if-eqz v3, :cond_0

    invoke-virtual {v3}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object p0

    check-cast p0, Lcom/android/server/am/PendingIntentRecord;

    move-object v2, p0

    .line 10200
    .local v2, rec:Lcom/android/server/am/PendingIntentRecord;
    :goto_1
    const/4 v1, 0x1

    .line 10201
    if-eqz v2, :cond_1

    .line 10202
    const-string v4, "  * "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10203
    const-string v4, "    "

    invoke-virtual {v2, p2, v4}, Lcom/android/server/am/PendingIntentRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_0

    .line 10199
    .end local v2           #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_0
    const/4 v4, 0x0

    move-object v2, v4

    goto :goto_1

    .line 10205
    .restart local v2       #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_1
    const-string v4, "  * "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/Object;)V

    goto :goto_0

    .line 10211
    .end local v0           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;>;"
    .end local v2           #rec:Lcom/android/server/am/PendingIntentRecord;
    .end local v3           #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    :cond_2
    return v1
.end method

.method dumpProcessesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z
    .locals 24
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    .line 9732
    const/4 v15, 0x0

    .line 9733
    .local v15, needSep:Z
    const/16 v18, 0x0

    .line 9735
    .local v18, numPers:I
    if-eqz p5, :cond_4

    .line 9736
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .local v13, i$:Ljava/util/Iterator;
    :cond_0
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_4

    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v20

    check-cast v20, Landroid/util/SparseArray;

    .line 9737
    .local v20, procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    invoke-virtual/range {v20 .. v20}, Landroid/util/SparseArray;->size()I

    move-result v11

    .line 9738
    .local v11, NA:I
    const/4 v14, 0x0

    .local v14, ia:I
    :goto_0
    if-ge v14, v11, :cond_0

    .line 9739
    if-nez v15, :cond_1

    .line 9740
    const-string v3, "  All known processes:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9741
    const/4 v15, 0x1

    .line 9743
    :cond_1
    move-object/from16 v0, v20

    move v1, v14

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v22

    check-cast v22, Lcom/android/server/am/ProcessRecord;

    .line 9744
    .local v22, r:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, v22

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v3, v0

    if-eqz v3, :cond_3

    const-string v3, "  *PERS*"

    :goto_1
    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9745
    const-string v3, " UID "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v20

    move v1, v14

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v3

    move-object/from16 v0, p2

    move v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9746
    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p2

    move-object/from16 v1, v22

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9747
    const-string v3, "    "

    move-object/from16 v0, v22

    move-object/from16 v1, p2

    move-object v2, v3

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ProcessRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9748
    move-object/from16 v0, v22

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v3, v0

    if-eqz v3, :cond_2

    .line 9749
    add-int/lit8 v18, v18, 0x1

    .line 9738
    :cond_2
    add-int/lit8 v14, v14, 0x1

    goto :goto_0

    .line 9744
    :cond_3
    const-string v3, "  *APP*"

    goto :goto_1

    .line 9755
    .end local v11           #NA:I
    .end local v13           #i$:Ljava/util/Iterator;
    .end local v14           #ia:I
    .end local v20           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v22           #r:Lcom/android/server/am/ProcessRecord;
    :cond_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_6

    .line 9756
    if-eqz v15, :cond_5

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9757
    :cond_5
    const/4 v15, 0x1

    .line 9758
    const-string v3, "  Running processes (most recent first):"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9759
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "    "

    const-string v7, "App "

    const-string v8, "PERS"

    const/4 v9, 0x1

    move-object/from16 v3, p2

    move-object/from16 v4, p0

    invoke-static/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 9761
    const/4 v15, 0x1

    .line 9764
    :cond_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v3, v0

    monitor-enter v3

    .line 9765
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/util/SparseArray;->size()I

    move-result v4

    if-lez v4, :cond_8

    .line 9766
    if-eqz v15, :cond_7

    const-string v4, " "

    move-object/from16 v0, p2

    move-object v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9767
    :cond_7
    const/4 v15, 0x1

    .line 9768
    const-string v4, "  PID mappings:"

    move-object/from16 v0, p2

    move-object v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9769
    const/4 v12, 0x0

    .local v12, i:I
    :goto_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/util/SparseArray;->size()I

    move-result v4

    if-ge v12, v4, :cond_8

    .line 9770
    const-string v4, "    PID #"

    move-object/from16 v0, p2

    move-object v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    invoke-virtual {v4, v12}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v4

    move-object/from16 v0, p2

    move v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9771
    const-string v4, ": "

    move-object/from16 v0, p2

    move-object v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    invoke-virtual {v4, v12}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v4

    move-object/from16 v0, p2

    move-object v1, v4

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9769
    add-int/lit8 v12, v12, 0x1

    goto :goto_2

    .line 9774
    .end local v12           #i:I
    :cond_8
    monitor-exit v3
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 9776
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/util/SparseArray;->size()I

    move-result v3

    if-lez v3, :cond_a

    .line 9777
    if-eqz v15, :cond_9

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9778
    :cond_9
    const/4 v15, 0x1

    .line 9779
    const-string v3, "  Foreground Processes:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9780
    const/4 v12, 0x0

    .restart local v12       #i:I
    :goto_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/util/SparseArray;->size()I

    move-result v3

    if-ge v12, v3, :cond_a

    .line 9781
    const-string v3, "    PID #"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v3, v0

    invoke-virtual {v3, v12}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v3

    move-object/from16 v0, p2

    move v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9782
    const-string v3, ": "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v3, v0

    invoke-virtual {v3, v12}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9780
    add-int/lit8 v12, v12, 0x1

    goto :goto_3

    .line 9774
    .end local v12           #i:I
    :catchall_0
    move-exception v4

    :try_start_1
    monitor-exit v3
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v4

    .line 9786
    :cond_a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_c

    .line 9787
    if-eqz v15, :cond_b

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9788
    :cond_b
    const/4 v15, 0x1

    .line 9789
    const-string v3, "  Persisent processes that are starting:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9790
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "    "

    const-string v7, "Starting Norm"

    const-string v8, "Restarting PERS"

    const/4 v9, 0x0

    move-object/from16 v3, p2

    move-object/from16 v4, p0

    invoke-static/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 9794
    :cond_c
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_e

    .line 9795
    if-eqz v15, :cond_d

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9796
    :cond_d
    const/4 v15, 0x1

    .line 9797
    const-string v3, "  Processes that are starting:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9798
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "    "

    const-string v7, "Starting Norm"

    const-string v8, "Starting PERS"

    const/4 v9, 0x0

    move-object/from16 v3, p2

    move-object/from16 v4, p0

    invoke-static/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 9802
    :cond_e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_10

    .line 9803
    if-eqz v15, :cond_f

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9804
    :cond_f
    const/4 v15, 0x1

    .line 9805
    const-string v3, "  Processes that are being removed:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9806
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "    "

    const-string v7, "Removed Norm"

    const-string v8, "Removed PERS"

    const/4 v9, 0x0

    move-object/from16 v3, p2

    move-object/from16 v4, p0

    invoke-static/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 9810
    :cond_10
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_12

    .line 9811
    if-eqz v15, :cond_11

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9812
    :cond_11
    const/4 v15, 0x1

    .line 9813
    const-string v3, "  Processes that are on old until the system is ready:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9814
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "    "

    const-string v7, "OnHold Norm"

    const-string v8, "OnHold PERS"

    const/4 v9, 0x0

    move-object/from16 v3, p2

    move-object/from16 v4, p0

    invoke-static/range {v3 .. v9}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Lcom/android/server/am/ActivityManagerService;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 9818
    :cond_12
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_14

    .line 9819
    if-eqz v15, :cond_13

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9820
    :cond_13
    const/4 v15, 0x1

    .line 9821
    const-string v3, "  Processes that are waiting to GC:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9822
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v16

    .line 9823
    .local v16, now:J
    const/4 v12, 0x0

    .restart local v12       #i:I
    :goto_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-ge v12, v3, :cond_14

    .line 9824
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v12}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v19

    check-cast v19, Lcom/android/server/am/ProcessRecord;

    .line 9825
    .local v19, proc:Lcom/android/server/am/ProcessRecord;
    const-string v3, "    Process "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p2

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9826
    const-string v3, "      lowMem="

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v19

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    move v3, v0

    move-object/from16 v0, p2

    move v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Z)V

    .line 9827
    const-string v3, ", last gced="

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9828
    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    move-wide v3, v0

    sub-long v3, v16, v3

    move-object/from16 v0, p2

    move-wide v1, v3

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->print(J)V

    .line 9829
    const-string v3, " ms ago, last lowMem="

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9830
    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    move-wide v3, v0

    sub-long v3, v16, v3

    move-object/from16 v0, p2

    move-wide v1, v3

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->print(J)V

    .line 9831
    const-string v3, " ms ago"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9823
    add-int/lit8 v12, v12, 0x1

    goto :goto_4

    .line 9836
    .end local v12           #i:I
    .end local v16           #now:J
    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_14
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->size()I

    move-result v3

    if-lez v3, :cond_17

    .line 9837
    if-eqz v15, :cond_15

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9838
    :cond_15
    const/4 v15, 0x1

    .line 9839
    const-string v3, "  Time since processes crashed:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9840
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v16

    .line 9842
    .restart local v16       #now:J
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .end local p1
    .restart local v13       #i$:Ljava/util/Iterator;
    :cond_16
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_17

    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Ljava/util/Map$Entry;

    .line 9843
    .local v21, procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    invoke-interface/range {v21 .. v21}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Landroid/util/SparseArray;

    .line 9844
    .local v23, uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    invoke-virtual/range {v23 .. v23}, Landroid/util/SparseArray;->size()I

    move-result v10

    .line 9845
    .local v10, N:I
    const/4 v12, 0x0

    .restart local v12       #i:I
    :goto_5
    if-ge v12, v10, :cond_16

    .line 9846
    const-string v3, "    Process "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface/range {v21 .. v21}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, p2

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9847
    const-string v3, " uid "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v23

    move v1, v12

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v3

    move-object/from16 v0, p2

    move v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9848
    const-string v3, ": last crashed "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9849
    move-object/from16 v0, v23

    move v1, v12

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/Long;

    invoke-virtual/range {p1 .. p1}, Ljava/lang/Long;->longValue()J

    move-result-wide v3

    sub-long v3, v16, v3

    move-object/from16 v0, p2

    move-wide v1, v3

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->print(J)V

    .line 9850
    const-string v3, " ms ago"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9845
    add-int/lit8 v12, v12, 0x1

    goto :goto_5

    .line 9855
    .end local v10           #N:I
    .end local v12           #i:I
    .end local v13           #i$:Ljava/util/Iterator;
    .end local v16           #now:J
    .end local v21           #procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    .end local v23           #uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    :cond_17
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->size()I

    move-result v3

    if-lez v3, :cond_1a

    .line 9856
    if-eqz v15, :cond_18

    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9857
    :cond_18
    const/4 v15, 0x1

    .line 9858
    const-string v3, "  Bad processes:"

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9860
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .restart local v13       #i$:Ljava/util/Iterator;
    :cond_19
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_1a

    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Ljava/util/Map$Entry;

    .line 9861
    .restart local v21       #procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    invoke-interface/range {v21 .. v21}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Landroid/util/SparseArray;

    .line 9862
    .restart local v23       #uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    invoke-virtual/range {v23 .. v23}, Landroid/util/SparseArray;->size()I

    move-result v10

    .line 9863
    .restart local v10       #N:I
    const/4 v12, 0x0

    .restart local v12       #i:I
    :goto_6
    if-ge v12, v10, :cond_19

    .line 9864
    const-string v3, "    Bad process "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface/range {v21 .. v21}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, p2

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9865
    const-string v3, " uid "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v23

    move v1, v12

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v3

    move-object/from16 v0, p2

    move v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9866
    const-string v3, ": crashed at time "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9867
    move-object/from16 v0, v23

    move v1, v12

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9863
    add-int/lit8 v12, v12, 0x1

    goto :goto_6

    .line 9872
    .end local v10           #N:I
    .end local v12           #i:I
    .end local v13           #i$:Ljava/util/Iterator;
    .end local v21           #procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    .end local v23           #uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    :cond_1a
    const-string v3, " "

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9873
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mHomeProcess: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9874
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mConfiguration: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9875
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mConfigWillChange: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfigWillChange:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9876
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mSleeping="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mShuttingDown="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9877
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v3, v0

    if-nez v3, :cond_1b

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    move-object v3, v0

    if-nez v3, :cond_1b

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    move v3, v0

    if-nez v3, :cond_1b

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    move v3, v0

    if-eqz v3, :cond_1c

    .line 9879
    :cond_1b
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mDebugApp="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "/orig="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mDebugTransient="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mOrigWaitForDebugger="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9883
    :cond_1c
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    move v3, v0

    if-nez v3, :cond_1d

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v3, v0

    if-eqz v3, :cond_1e

    .line 9884
    :cond_1d
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mAlwaysFinishActivities="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mController="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9887
    :cond_1e
    if-eqz p5, :cond_1f

    .line 9888
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  Total persistent processes: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object v0, v3

    move/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9889
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mStartRunning="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mSystemReady="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mBooting="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mBooted="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mFactoryTest="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9894
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mGoingToSleep="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9895
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mLaunchingActivity="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9896
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  mAdjSeq="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " mLruSeq="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruSeq:I

    move v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p2

    move-object v1, v3

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9899
    :cond_1f
    const/4 v3, 0x1

    return v3
.end method

.method dumpProvidersLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z
    .locals 11
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    .line 10129
    const/4 v4, 0x0

    .line 10131
    .local v4, needSep:Z
    if-eqz p5, :cond_4

    .line 10132
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_2

    .line 10133
    if-eqz v4, :cond_0

    const-string v9, " "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10134
    :cond_0
    const-string v9, "  Published content providers (by class):"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10135
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .line 10136
    .local v3, it:Ljava/util/Iterator;
    :goto_0
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_1

    .line 10137
    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/util/Map$Entry;

    .line 10138
    .local v0, e:Ljava/util/Map$Entry;
    invoke-interface {v0}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ContentProviderRecord;

    .line 10139
    .local v7, r:Lcom/android/server/am/ContentProviderRecord;
    const-string v9, "  * "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10140
    const-string v9, "    "

    invoke-virtual {v7, p2, v9}, Lcom/android/server/am/ContentProviderRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_0

    .line 10142
    .end local v0           #e:Ljava/util/Map$Entry;
    .end local v7           #r:Lcom/android/server/am/ContentProviderRecord;
    :cond_1
    const/4 v4, 0x1

    .line 10145
    .end local v3           #it:Ljava/util/Iterator;
    :cond_2
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_4

    .line 10146
    const-string v9, " "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10147
    const-string v9, "  Authority to provider mappings:"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10148
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .line 10149
    .restart local v3       #it:Ljava/util/Iterator;
    :goto_1
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_3

    .line 10150
    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/util/Map$Entry;

    .line 10151
    .restart local v0       #e:Ljava/util/Map$Entry;
    invoke-interface {v0}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ContentProviderRecord;

    .line 10152
    .restart local v7       #r:Lcom/android/server/am/ContentProviderRecord;
    const-string v9, "  "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface {v0}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v9

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/Object;)V

    const-string v9, ": "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10153
    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    goto :goto_1

    .line 10155
    .end local v0           #e:Ljava/util/Map$Entry;
    .end local v7           #r:Lcom/android/server/am/ContentProviderRecord;
    :cond_3
    const/4 v4, 0x1

    .line 10159
    .end local v3           #it:Ljava/util/Iterator;
    :cond_4
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-lez v9, :cond_7

    .line 10160
    if-eqz v4, :cond_5

    const-string v9, " "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10161
    :cond_5
    const-string v9, "  Launching content providers:"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10162
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    const/4 v10, 0x1

    sub-int v1, v9, v10

    .local v1, i:I
    :goto_2
    if-ltz v1, :cond_6

    .line 10163
    const-string v9, "  Launching #"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->print(I)V

    const-string v9, ": "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 10164
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v9, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10162
    add-int/lit8 v1, v1, -0x1

    goto :goto_2

    .line 10166
    :cond_6
    const/4 v4, 0x1

    .line 10169
    .end local v1           #i:I
    :cond_7
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9}, Landroid/util/SparseArray;->size()I

    move-result v9

    if-lez v9, :cond_a

    .line 10170
    invoke-virtual {p2}, Ljava/io/PrintWriter;->println()V

    .line 10171
    const-string v9, "Granted Uri Permissions:"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10172
    const/4 v1, 0x0

    .restart local v1       #i:I
    :goto_3
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9}, Landroid/util/SparseArray;->size()I

    move-result v9

    if-ge v1, v9, :cond_9

    .line 10173
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v8

    .line 10174
    .local v8, uid:I
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/util/HashMap;

    .line 10176
    .local v6, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    const-string v9, "  * UID "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v8}, Ljava/io/PrintWriter;->print(I)V

    .line 10177
    const-string v9, " holds:"

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10178
    invoke-virtual {v6}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .local v2, i$:Ljava/util/Iterator;
    :goto_4
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_8

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/UriPermission;

    .line 10179
    .local v5, perm:Lcom/android/server/am/UriPermission;
    const-string v9, "    "

    invoke-virtual {p2, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10180
    const-string v9, "      "

    invoke-virtual {v5, p2, v9}, Lcom/android/server/am/UriPermission;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_4

    .line 10172
    .end local v5           #perm:Lcom/android/server/am/UriPermission;
    :cond_8
    add-int/lit8 v1, v1, 0x1

    goto :goto_3

    .line 10183
    .end local v2           #i$:Ljava/util/Iterator;
    .end local v6           #perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    .end local v8           #uid:I
    :cond_9
    const/4 v4, 0x1

    .line 10186
    .end local v1           #i:I
    :cond_a
    return v4
.end method

.method protected dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)V
    .locals 8
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    .line 9915
    array-length v6, p3

    if-lt p4, v6, :cond_2

    .line 9916
    const/4 v1, 0x0

    .line 9917
    .local v1, componentNameString:Ljava/lang/String;
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->EMPTY_STRING_ARRAY:[Ljava/lang/String;

    .line 9918
    .local v3, newArgs:[Ljava/lang/String;
    const/4 v4, 0x0

    .line 9928
    .local v4, r:Lcom/android/server/am/ServiceRecord;
    :cond_0
    :goto_0
    if-eqz v4, :cond_4

    .line 9929
    invoke-direct {p0, p1, p2, v4, v3}, Lcom/android/server/am/ActivityManagerService;->dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Lcom/android/server/am/ServiceRecord;[Ljava/lang/String;)V

    .line 9938
    :cond_1
    return-void

    .line 9920
    .end local v1           #componentNameString:Ljava/lang/String;
    .end local v3           #newArgs:[Ljava/lang/String;
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_2
    aget-object v1, p3, p4

    .line 9921
    .restart local v1       #componentNameString:Ljava/lang/String;
    add-int/lit8 p4, p4, 0x1

    .line 9922
    invoke-static {v1}, Landroid/content/ComponentName;->unflattenFromString(Ljava/lang/String;)Landroid/content/ComponentName;

    move-result-object v0

    .line 9923
    .local v0, componentName:Landroid/content/ComponentName;
    if-eqz v0, :cond_3

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v6, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ServiceRecord;

    move-object v4, v6

    .line 9924
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    :goto_1
    array-length v6, p3

    sub-int/2addr v6, p4

    new-array v3, v6, [Ljava/lang/String;

    .line 9925
    .restart local v3       #newArgs:[Ljava/lang/String;
    array-length v6, p3

    const/4 v7, 0x2

    if-le v6, v7, :cond_0

    const/4 v6, 0x0

    array-length v7, p3

    sub-int/2addr v7, p4

    invoke-static {p3, p4, v3, v6, v7}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    goto :goto_0

    .line 9923
    .end local v3           #newArgs:[Ljava/lang/String;
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_3
    const/4 v6, 0x0

    move-object v4, v6

    goto :goto_1

    .line 9931
    .end local v0           #componentName:Landroid/content/ComponentName;
    .restart local v3       #newArgs:[Ljava/lang/String;
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    :cond_4
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v6}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v6

    invoke-interface {v6}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .local v2, i$:Ljava/util/Iterator;
    :cond_5
    :goto_2
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v6

    if-eqz v6, :cond_1

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 9932
    .local v5, r1:Lcom/android/server/am/ServiceRecord;
    if-eqz v1, :cond_6

    iget-object v6, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v6}, Landroid/content/ComponentName;->flattenToString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6, v1}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v6

    if-eqz v6, :cond_5

    .line 9934
    :cond_6
    invoke-direct {p0, p1, p2, v5, v3}, Lcom/android/server/am/ActivityManagerService;->dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Lcom/android/server/am/ServiceRecord;[Ljava/lang/String;)V

    goto :goto_2
.end method

.method dumpServicesLocked(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;IZ)Z
    .locals 9
    .parameter "fd"
    .parameter "pw"
    .parameter "args"
    .parameter "opti"
    .parameter "dumpAll"

    .prologue
    const-string v8, "  * "

    const-string v7, " "

    const-string v6, "    "

    .line 10061
    const/4 v3, 0x0

    .line 10063
    .local v3, needSep:Z
    if-eqz p5, :cond_1

    .line 10064
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_1

    .line 10065
    const-string v5, "  Active services:"

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10066
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .line 10067
    .local v2, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    :goto_0
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_0

    .line 10068
    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 10069
    .local v4, r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * "

    invoke-virtual {p2, v8}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10070
    const-string v5, "    "

    invoke-virtual {v4, p2, v6}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_0

    .line 10072
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_0
    const/4 v3, 0x1

    .line 10076
    .end local v2           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    :cond_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_4

    .line 10077
    if-eqz v3, :cond_2

    const-string v5, " "

    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10078
    :cond_2
    const-string v5, "  Pending services:"

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10079
    const/4 v0, 0x0

    .local v0, i:I
    :goto_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_3

    .line 10080
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 10081
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * Pending "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10082
    const-string v5, "    "

    invoke-virtual {v4, p2, v6}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10079
    add-int/lit8 v0, v0, 0x1

    goto :goto_1

    .line 10084
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_3
    const/4 v3, 0x1

    .line 10087
    .end local v0           #i:I
    :cond_4
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_7

    .line 10088
    if-eqz v3, :cond_5

    const-string v5, " "

    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10089
    :cond_5
    const-string v5, "  Restarting services:"

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10090
    const/4 v0, 0x0

    .restart local v0       #i:I
    :goto_2
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_6

    .line 10091
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 10092
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * Restarting "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10093
    const-string v5, "    "

    invoke-virtual {v4, p2, v6}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10090
    add-int/lit8 v0, v0, 0x1

    goto :goto_2

    .line 10095
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_6
    const/4 v3, 0x1

    .line 10098
    .end local v0           #i:I
    :cond_7
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_a

    .line 10099
    if-eqz v3, :cond_8

    const-string v5, " "

    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10100
    :cond_8
    const-string v5, "  Stopping services:"

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10101
    const/4 v0, 0x0

    .restart local v0       #i:I
    :goto_3
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_9

    .line 10102
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 10103
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * Stopping "

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10104
    const-string v5, "    "

    invoke-virtual {v4, p2, v6}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 10101
    add-int/lit8 v0, v0, 0x1

    goto :goto_3

    .line 10106
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_9
    const/4 v3, 0x1

    .line 10109
    .end local v0           #i:I
    :cond_a
    if-eqz p5, :cond_d

    .line 10110
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_d

    .line 10111
    if-eqz v3, :cond_b

    const-string v5, " "

    invoke-virtual {p2, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10112
    :cond_b
    const-string v5, "  Connection bindings to services:"

    invoke-virtual {p2, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 10113
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 10115
    .local v1, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_4
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_c

    .line 10116
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ConnectionRecord;

    .line 10117
    .local v4, r:Lcom/android/server/am/ConnectionRecord;
    const-string v5, "  * "

    invoke-virtual {p2, v8}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 10118
    const-string v5, "    "

    invoke-virtual {v4, p2, v6}, Lcom/android/server/am/ConnectionRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_4

    .line 10120
    .end local v4           #r:Lcom/android/server/am/ConnectionRecord;
    :cond_c
    const/4 v3, 0x1

    .line 10124
    .end local v1           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_d
    return v3
.end method

.method enableScreenAfterBoot()V
    .locals 3

    .prologue
    .line 5735
    const/16 v0, 0xbea

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    invoke-static {v0, v1, v2}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 5737
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v0}, Lcom/android/server/WindowManagerService;->enableScreenAfterBoot()V

    .line 5738
    return-void
.end method

.method enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V
    .locals 3
    .parameter "permission"
    .parameter "func"

    .prologue
    .line 6367
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v1

    if-nez v1, :cond_0

    .line 6369
    return-void

    .line 6372
    :cond_0
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Permission Denial: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " from pid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ", uid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " requires "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 6376
    .local v0, msg:Ljava/lang/String;
    const-string v1, "ActivityManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6377
    new-instance v1, Ljava/lang/SecurityException;

    invoke-direct {v1, v0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method final ensureBootCompleted()V
    .locals 5

    .prologue
    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 5922
    monitor-enter p0

    .line 5923
    :try_start_0
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 5924
    .local v0, booting:Z
    const/4 v2, 0x0

    iput-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 5925
    iget-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    if-nez v2, :cond_2

    move v1, v4

    .line 5926
    .local v1, enableScreen:Z
    :goto_0
    const/4 v2, 0x1

    iput-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    .line 5927
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 5929
    if-eqz v0, :cond_0

    .line 5930
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->finishBooting()V

    .line 5933
    :cond_0
    if-eqz v1, :cond_1

    .line 5934
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->enableScreenAfterBoot()V

    .line 5936
    :cond_1
    return-void

    .end local v1           #enableScreen:Z
    :cond_2
    move v1, v3

    .line 5925
    goto :goto_0

    .line 5927
    .end local v0           #booting:Z
    :catchall_0
    move-exception v2

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v2
.end method

.method public final enterSafeMode()V
    .locals 5

    .prologue
    .line 8480
    monitor-enter p0

    .line 8483
    :try_start_0
    iget-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    if-nez v2, :cond_0

    .line 8485
    :try_start_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v2

    invoke-interface {v2}, Landroid/content/pm/IPackageManager;->enterSafeMode()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 8489
    :goto_0
    :try_start_2
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-static {v2}, Landroid/view/LayoutInflater;->from(Landroid/content/Context;)Landroid/view/LayoutInflater;

    move-result-object v2

    const v3, 0x1090054

    const/4 v4, 0x0

    invoke-virtual {v2, v3, v4}, Landroid/view/LayoutInflater;->inflate(ILandroid/view/ViewGroup;)Landroid/view/View;

    move-result-object v1

    .line 8491
    .local v1, v:Landroid/view/View;
    new-instance v0, Landroid/view/WindowManager$LayoutParams;

    invoke-direct {v0}, Landroid/view/WindowManager$LayoutParams;-><init>()V

    .line 8492
    .local v0, lp:Landroid/view/WindowManager$LayoutParams;
    const/16 v2, 0x7d6

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->type:I

    .line 8493
    const/4 v2, -0x2

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->width:I

    .line 8494
    const/4 v2, -0x2

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->height:I

    .line 8495
    const/16 v2, 0x53

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->gravity:I

    .line 8496
    invoke-virtual {v1}, Landroid/view/View;->getBackground()Landroid/graphics/drawable/Drawable;

    move-result-object v2

    invoke-virtual {v2}, Landroid/graphics/drawable/Drawable;->getOpacity()I

    move-result v2

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->format:I

    .line 8497
    const/16 v2, 0x18

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->flags:I

    .line 8499
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    const-string v3, "window"

    invoke-virtual {v2, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/view/WindowManager;

    invoke-interface {v2, v1, v0}, Landroid/view/WindowManager;->addView(Landroid/view/View;Landroid/view/ViewGroup$LayoutParams;)V

    .line 8502
    .end local v0           #lp:Landroid/view/WindowManager$LayoutParams;
    .end local v1           #v:Landroid/view/View;
    :cond_0
    monitor-exit p0

    .line 8503
    return-void

    .line 8502
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v2

    .line 8486
    :catch_0
    move-exception v2

    goto :goto_0
.end method

.method public final finishActivity(Landroid/os/IBinder;ILandroid/content/Intent;)Z
    .locals 9
    .parameter "token"
    .parameter "resultCode"
    .parameter "resultData"

    .prologue
    const/4 v8, 0x0

    .line 4293
    if-eqz p3, :cond_0

    invoke-virtual {p3}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v6

    const/4 v7, 0x1

    if-ne v6, v7, :cond_0

    .line 4294
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "File descriptors passed in Intent"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 4297
    :cond_0
    monitor-enter p0

    .line 4298
    :try_start_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    if-eqz v6, :cond_1

    .line 4300
    const/4 v6, 0x0

    invoke-direct {p0, p1, v6}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result-object v1

    .line 4301
    .local v1, next:Lcom/android/server/am/HistoryRecord;
    if-eqz v1, :cond_1

    .line 4303
    const/4 v5, 0x1

    .line 4305
    .local v5, resumeOK:Z
    :try_start_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    iget-object v7, v1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-interface {v6, v7}, Landroid/app/IActivityController;->activityResuming(Ljava/lang/String;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    move-result v5

    .line 4310
    :goto_0
    if-nez v5, :cond_1

    .line 4311
    :try_start_2
    monitor-exit p0

    move v6, v8

    .line 4319
    .end local v1           #next:Lcom/android/server/am/HistoryRecord;
    .end local v5           #resumeOK:Z
    :goto_1
    return v6

    .line 4306
    .restart local v1       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v5       #resumeOK:Z
    :catch_0
    move-exception v6

    move-object v0, v6

    .line 4307
    .local v0, e:Landroid/os/RemoteException;
    const/4 v6, 0x0

    iput-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    goto :goto_0

    .line 4320
    .end local v0           #e:Landroid/os/RemoteException;
    .end local v1           #next:Lcom/android/server/am/HistoryRecord;
    .end local v5           #resumeOK:Z
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v6

    .line 4315
    :cond_1
    :try_start_3
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 4316
    .local v2, origId:J
    const-string v6, "app-request"

    invoke-direct {p0, p1, p2, p3, v6}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v4

    .line 4318
    .local v4, res:Z
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4319
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    move v6, v4

    goto :goto_1
.end method

.method final finishBooting()V
    .locals 22

    .prologue
    .line 5877
    new-instance v20, Landroid/content/IntentFilter;

    invoke-direct/range {v20 .. v20}, Landroid/content/IntentFilter;-><init>()V

    .line 5878
    .local v20, pkgFilter:Landroid/content/IntentFilter;
    const-string v4, "android.intent.action.QUERY_PACKAGE_RESTART"

    move-object/from16 v0, v20

    move-object v1, v4

    invoke-virtual {v0, v1}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V

    .line 5879
    const-string v4, "package"

    move-object/from16 v0, v20

    move-object v1, v4

    invoke-virtual {v0, v1}, Landroid/content/IntentFilter;->addDataScheme(Ljava/lang/String;)V

    .line 5880
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    new-instance v5, Lcom/android/server/am/ActivityManagerService$5;

    move-object v0, v5

    move-object/from16 v1, p0

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService$5;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    move-object v0, v4

    move-object v1, v5

    move-object/from16 v2, v20

    invoke-virtual {v0, v1, v2}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;

    .line 5895
    monitor-enter p0

    .line 5898
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v18

    .line 5899
    .local v18, NP:I
    if-lez v18, :cond_0

    .line 5900
    new-instance v21, Ljava/util/ArrayList;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v4, v0

    move-object/from16 v0, v21

    move-object v1, v4

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    .line 5902
    .local v21, procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    const/16 v19, 0x0

    .local v19, ip:I
    :goto_0
    move/from16 v0, v19

    move/from16 v1, v18

    if-ge v0, v1, :cond_0

    .line 5903
    move-object/from16 v0, v21

    move/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ProcessRecord;

    const-string v5, "on-hold"

    const/4 v6, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    move-object v2, v5

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 5902
    add-int/lit8 v19, v19, 0x1

    goto :goto_0

    .line 5907
    .end local v19           #ip:I
    .end local v21           #procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_0
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    const/4 v5, 0x1

    if-eq v4, v5, :cond_1

    .line 5909
    const/4 v5, 0x0

    const/4 v6, 0x0

    new-instance v7, Landroid/content/Intent;

    const-string v4, "android.intent.action.BOOT_COMPLETED"

    const/4 v8, 0x0

    invoke-direct {v7, v4, v8}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const-string v13, "android.permission.RECEIVE_BOOT_COMPLETED"

    const/4 v14, 0x0

    const/4 v15, 0x0

    sget v16, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v17, 0x3e8

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 5914
    const-string v4, "ActivityManager"

    const-string v5, "!@bootcomplete"

    invoke-static {v4, v5}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 5916
    :cond_1
    monitor-exit p0

    .line 5917
    return-void

    .line 5916
    .end local v18           #NP:I
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4
.end method

.method public finishInstrumentation(Landroid/app/IApplicationThread;ILandroid/os/Bundle;)V
    .locals 6
    .parameter "target"
    .parameter "resultCode"
    .parameter "results"

    .prologue
    .line 13452
    if-eqz p3, :cond_0

    invoke-virtual {p3}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v3

    if-eqz v3, :cond_0

    .line 13453
    new-instance v3, Ljava/lang/IllegalArgumentException;

    const-string v4, "File descriptors passed in Intent"

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 13456
    :cond_0
    monitor-enter p0

    .line 13457
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 13458
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_1

    .line 13459
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "finishInstrumentation: no app for "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 13460
    monitor-exit p0

    .line 13466
    :goto_0
    return-void

    .line 13462
    :cond_1
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 13463
    .local v1, origId:J
    invoke-virtual {p0, v0, p2, p3}, Lcom/android/server/am/ActivityManagerService;->finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V

    .line 13464
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13465
    monitor-exit p0

    goto :goto_0

    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #origId:J
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3
.end method

.method finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V
    .locals 6
    .parameter "app"
    .parameter "resultCode"
    .parameter "results"

    .prologue
    const/4 v3, 0x0

    const/4 v2, 0x0

    .line 13430
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    if-eqz v0, :cond_0

    .line 13433
    :try_start_0
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    invoke-interface {v0, v1, p2, p3}, Landroid/app/IInstrumentationWatcher;->instrumentationFinished(Landroid/content/ComponentName;ILandroid/os/Bundle;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 13440
    :cond_0
    :goto_0
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    .line 13441
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    .line 13442
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    .line 13443
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationProfileFile:Ljava/lang/String;

    .line 13444
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationArguments:Landroid/os/Bundle;

    .line 13446
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    const/4 v2, -0x1

    const/4 v5, 0x1

    move-object v0, p0

    move v4, v3

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 13447
    return-void

    .line 13437
    :catch_0
    move-exception v0

    goto :goto_0
.end method

.method public finishOtherInstances(Landroid/os/IBinder;Landroid/content/ComponentName;)V
    .locals 10
    .parameter "token"
    .parameter "className"

    .prologue
    .line 7642
    monitor-enter p0

    .line 7643
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 7645
    .local v8, origId:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v6

    .line 7646
    .local v6, N:I
    const/4 v7, 0x0

    .line 7647
    .local v7, lastTask:Lcom/android/server/am/TaskRecord;
    const/4 v2, 0x0

    .local v2, i:I
    :goto_0
    if-ge v2, v6, :cond_1

    .line 7648
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 7649
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, p2}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_0

    if-eq v1, p1, :cond_0

    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v7, v0, :cond_0

    .line 7651
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "others"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_0

    .line 7653
    add-int/lit8 v2, v2, -0x1

    .line 7654
    add-int/lit8 v6, v6, -0x1

    .line 7657
    :cond_0
    iget-object v7, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7647
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    .line 7660
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7661
    monitor-exit p0

    .line 7662
    return-void

    .line 7661
    .end local v2           #i:I
    .end local v6           #N:I
    .end local v7           #lastTask:Lcom/android/server/am/TaskRecord;
    .end local v8           #origId:J
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public finishReceiver(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;Z)V
    .locals 10
    .parameter "who"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "resultExtras"
    .parameter "resultAbort"

    .prologue
    .line 12814
    if-eqz p4, :cond_0

    invoke-virtual {p4}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v0

    if-eqz v0, :cond_0

    .line 12815
    new-instance v0, Ljava/lang/IllegalArgumentException;

    const-string v1, "File descriptors passed in Bundle"

    invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 12820
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 12822
    .local v8, origId:J
    monitor-enter p0

    .line 12823
    const/4 v6, 0x1

    move-object v0, p0

    move-object v1, p1

    move v2, p2

    move-object v3, p3

    move-object v4, p4

    move v5, p5

    :try_start_0
    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    move-result v7

    .line 12825
    .local v7, doNext:Z
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 12827
    if-eqz v7, :cond_1

    .line 12828
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->processNextBroadcast(Z)V

    .line 12830
    :cond_1
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 12832
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12833
    return-void

    .line 12825
    .end local v7           #doNext:Z
    :catchall_0
    move-exception v0

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v0
.end method

.method public final finishSubActivity(Landroid/os/IBinder;Ljava/lang/String;I)V
    .locals 10
    .parameter "token"
    .parameter "resultWho"
    .parameter "requestCode"

    .prologue
    .line 4351
    monitor-enter p0

    .line 4352
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v6

    .line 4353
    .local v6, index:I
    if-gez v6, :cond_0

    .line 4354
    monitor-exit p0

    .line 4374
    :goto_0
    return-void

    .line 4356
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 4358
    .local v9, self:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v7

    .line 4361
    .local v7, origId:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    const/4 v3, 0x1

    sub-int v2, v0, v3

    .local v2, i:I
    :goto_1
    if-ltz v2, :cond_4

    .line 4362
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4363
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    if-ne v0, v9, :cond_3

    iget v0, v1, Lcom/android/server/am/HistoryRecord;->requestCode:I

    if-ne v0, p3, :cond_3

    .line 4364
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    if-nez v0, :cond_1

    if-eqz p2, :cond_2

    :cond_1
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    if-eqz v0, :cond_3

    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    invoke-virtual {v0, p2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_3

    .line 4366
    :cond_2
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "request-sub"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 4361
    :cond_3
    add-int/lit8 v2, v2, -0x1

    goto :goto_1

    .line 4372
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4
    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4373
    monitor-exit p0

    goto :goto_0

    .end local v2           #i:I
    .end local v6           #index:I
    .end local v7           #origId:J
    .end local v9           #self:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public forceStopPackage(Ljava/lang/String;)V
    .locals 9
    .parameter "packageName"

    .prologue
    const-string v8, "android.permission.FORCE_STOP_PACKAGES"

    const-string v7, "ActivityManager"

    .line 5118
    const-string v5, "android.permission.FORCE_STOP_PACKAGES"

    invoke-virtual {p0, v8}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v5

    if-eqz v5, :cond_0

    .line 5120
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: forceStopPackage() from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " requires "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "android.permission.FORCE_STOP_PACKAGES"

    invoke-virtual {v5, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 5124
    .local v2, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    invoke-static {v7, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5125
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 5128
    .end local v2           #msg:Ljava/lang/String;
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 5130
    .local v0, callingId:J
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    .line 5131
    .local v4, pm:Landroid/content/pm/IPackageManager;
    const/4 v3, -0x1

    .line 5132
    .local v3, pkgUid:I
    monitor-enter p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 5134
    :try_start_1
    invoke-interface {v4, p1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    move-result v3

    .line 5137
    :goto_0
    const/4 v5, -0x1

    if-ne v3, v5, :cond_1

    .line 5138
    :try_start_2
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Invalid packageName: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5139
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 5144
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5146
    :goto_1
    return-void

    .line 5141
    :cond_1
    :try_start_3
    invoke-direct {p0, p1, v3}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;I)V

    .line 5142
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 5144
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_1

    .line 5142
    :catchall_0
    move-exception v5

    :try_start_4
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    :try_start_5
    throw v5
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    .line 5144
    .end local v3           #pkgUid:I
    .end local v4           #pm:Landroid/content/pm/IPackageManager;
    :catchall_1
    move-exception v5

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v5

    .line 5135
    .restart local v3       #pkgUid:I
    .restart local v4       #pm:Landroid/content/pm/IPackageManager;
    :catch_0
    move-exception v5

    goto :goto_0
.end method

.method foregroundTokenDied(Lcom/android/server/am/ActivityManagerService$ForegroundToken;)V
    .locals 5
    .parameter "token"

    .prologue
    .line 6218
    monitor-enter p0

    .line 6219
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v2
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 6220
    :try_start_1
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    iget v4, p1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    invoke-virtual {v3, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ActivityManagerService$ForegroundToken;

    .line 6222
    .local v0, cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    if-eq v0, p1, :cond_0

    .line 6223
    monitor-exit v2
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    :try_start_2
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 6235
    :goto_0
    return-void

    .line 6225
    :cond_0
    :try_start_3
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    iget v4, p1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    invoke-virtual {v3, v4}, Landroid/util/SparseArray;->remove(I)V

    .line 6226
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    iget v4, p1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    invoke-virtual {v3, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 6227
    .local v1, pr:Lcom/android/server/am/ProcessRecord;
    if-nez v1, :cond_1

    .line 6228
    monitor-exit v2
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    :try_start_4
    monitor-exit p0

    goto :goto_0

    .line 6234
    .end local v0           #cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .end local v1           #pr:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v2

    .line 6230
    .restart local v0       #cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .restart local v1       #pr:Lcom/android/server/am/ProcessRecord;
    :cond_1
    const/4 v3, 0x0

    :try_start_5
    iput-object v3, v1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 6231
    const/4 v3, 0x0

    iput-boolean v3, v1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 6232
    monitor-exit v2
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    .line 6233
    :try_start_6
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 6234
    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    goto :goto_0

    .line 6232
    .end local v0           #cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .end local v1           #pr:Lcom/android/server/am/ProcessRecord;
    :catchall_1
    move-exception v3

    :try_start_7
    monitor-exit v2
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_1

    :try_start_8
    throw v3
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_0
.end method

.method public getActivityClassForToken(Landroid/os/IBinder;)Landroid/content/ComponentName;
    .locals 3
    .parameter "token"

    .prologue
    .line 6056
    monitor-enter p0

    .line 6057
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 6058
    .local v0, index:I
    if-ltz v0, :cond_0

    .line 6059
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 6060
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    monitor-exit p0

    .line 6062
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_0
    return-object v2

    :cond_0
    const/4 v2, 0x0

    monitor-exit p0

    goto :goto_0

    .line 6063
    .end local v0           #index:I
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public getCallingActivity(Landroid/os/IBinder;)Landroid/content/ComponentName;
    .locals 2
    .parameter "token"

    .prologue
    .line 6038
    monitor-enter p0

    .line 6039
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getCallingRecordLocked(Landroid/os/IBinder;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 6040
    .local v0, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_0

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v1

    :goto_0
    monitor-exit p0

    return-object v1

    :cond_0
    const/4 v1, 0x0

    goto :goto_0

    .line 6041
    .end local v0           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1
.end method

.method public getCallingPackage(Landroid/os/IBinder;)Ljava/lang/String;
    .locals 2
    .parameter "token"

    .prologue
    .line 6031
    monitor-enter p0

    .line 6032
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getCallingRecordLocked(Landroid/os/IBinder;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 6033
    .local v0, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_0

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_0

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    :goto_0
    monitor-exit p0

    return-object v1

    :cond_0
    const/4 v1, 0x0

    goto :goto_0

    .line 6034
    .end local v0           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1
.end method

.method public getConfiguration()Landroid/content/res/Configuration;
    .locals 2

    .prologue
    .line 13493
    monitor-enter p0

    .line 13494
    :try_start_0
    new-instance v0, Landroid/content/res/Configuration;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-direct {v0, v1}, Landroid/content/res/Configuration;-><init>(Landroid/content/res/Configuration;)V

    .line 13495
    .local v0, ci:Landroid/content/res/Configuration;
    monitor-exit p0

    .line 13496
    return-object v0

    .line 13495
    .end local v0           #ci:Landroid/content/res/Configuration;
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1
.end method

.method public final getContentProvider(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;
    .locals 3
    .parameter "caller"
    .parameter "name"

    .prologue
    .line 8031
    if-nez p1, :cond_0

    .line 8032
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "null IApplicationThread when getting content provider "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 8034
    .local v0, msg:Ljava/lang/String;
    const-string v1, "ActivityManager"

    invoke-static {v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8035
    new-instance v1, Ljava/lang/SecurityException;

    invoke-direct {v1, v0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 8038
    .end local v0           #msg:Ljava/lang/String;
    :cond_0
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->getContentProviderImpl(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;

    move-result-object v1

    return-object v1
.end method

.method public getDeviceConfigurationInfo()Landroid/content/pm/ConfigurationInfo;
    .locals 3

    .prologue
    .line 13473
    new-instance v0, Landroid/content/pm/ConfigurationInfo;

    invoke-direct {v0}, Landroid/content/pm/ConfigurationInfo;-><init>()V

    .line 13474
    .local v0, config:Landroid/content/pm/ConfigurationInfo;
    monitor-enter p0

    .line 13475
    :try_start_0
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->touchscreen:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqTouchScreen:I

    .line 13476
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->keyboard:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqKeyboardType:I

    .line 13477
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->navigation:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqNavigation:I

    .line 13478
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->navigation:I

    const/4 v2, 0x2

    if-eq v1, v2, :cond_0

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->navigation:I

    const/4 v2, 0x3

    if-ne v1, v2, :cond_1

    .line 13480
    :cond_0
    iget v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    or-int/lit8 v1, v1, 0x2

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    .line 13482
    :cond_1
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->keyboard:I

    if-eqz v1, :cond_2

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->keyboard:I

    const/4 v2, 0x1

    if-eq v1, v2, :cond_2

    .line 13484
    iget v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    or-int/lit8 v1, v1, 0x1

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    .line 13486
    :cond_2
    iget v1, p0, Lcom/android/server/am/ActivityManagerService;->GL_ES_VERSION:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqGlEsVersion:I

    .line 13487
    monitor-exit p0

    .line 13488
    return-object v0

    .line 13487
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1
.end method

.method public getIntentSender(ILjava/lang/String;Landroid/os/IBinder;Ljava/lang/String;ILandroid/content/Intent;Ljava/lang/String;I)Landroid/content/IIntentSender;
    .locals 23
    .parameter "type"
    .parameter "packageName"
    .parameter "token"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "flags"

    .prologue
    .line 6081
    if-eqz p6, :cond_0

    invoke-virtual/range {p6 .. p6}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v5

    const/4 v6, 0x1

    if-ne v5, v6, :cond_0

    .line 6082
    new-instance v5, Ljava/lang/IllegalArgumentException;

    const-string v6, "File descriptors passed in Intent"

    invoke-direct {v5, v6}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 6085
    :cond_0
    const/4 v5, 0x1

    move/from16 v0, p1

    move v1, v5

    if-ne v0, v1, :cond_1

    .line 6086
    invoke-virtual/range {p6 .. p6}, Landroid/content/Intent;->getFlags()I

    move-result v5

    const/high16 v6, 0x800

    and-int/2addr v5, v6

    if-eqz v5, :cond_1

    .line 6087
    new-instance v5, Ljava/lang/IllegalArgumentException;

    const-string v6, "Can\'t use FLAG_RECEIVER_BOOT_UPGRADE here"

    invoke-direct {v5, v6}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 6092
    :cond_1
    monitor-enter p0

    .line 6093
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result v13

    .line 6095
    .local v13, callingUid:I
    if-eqz v13, :cond_2

    const/16 v5, 0x3e8

    if-eq v13, v5, :cond_2

    :try_start_1
    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v5

    if-eqz v5, :cond_2

    .line 6097
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I

    move-result v21

    .line 6099
    .local v21, uid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    move/from16 v0, v21

    move v1, v5

    if-eq v0, v1, :cond_2

    .line 6100
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: getIntentSender() from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", (need uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " is not allowed to send as package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    .line 6105
    .local v17, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v17

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6106
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v17

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 6109
    .end local v17           #msg:Ljava/lang/String;
    .end local v21           #uid:I
    :catch_0
    move-exception v5

    move-object v15, v5

    .line 6110
    .local v15, e:Landroid/os/RemoteException;
    :try_start_2
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v15}, Ljava/lang/SecurityException;-><init>(Ljava/lang/Throwable;)V

    throw v5

    .line 6159
    .end local v13           #callingUid:I
    .end local v15           #e:Landroid/os/RemoteException;
    .end local p2
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v5

    .line 6112
    .restart local v13       #callingUid:I
    .restart local p2
    :cond_2
    const/4 v7, 0x0

    .line 6113
    .local v7, activity:Lcom/android/server/am/HistoryRecord;
    const/4 v5, 0x3

    move/from16 v0, p1

    move v1, v5

    if-ne v0, v1, :cond_4

    .line 6114
    :try_start_3
    move-object/from16 v0, p0

    move-object/from16 v1, p3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v16

    .line 6115
    .local v16, index:I
    if-gez v16, :cond_3

    .line 6116
    const/4 v5, 0x0

    monitor-exit p0

    .line 6158
    .end local v16           #index:I
    .end local p2
    :goto_0
    return-object v5

    .line 6118
    .restart local v16       #index:I
    .restart local p2
    :cond_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    .end local v7           #activity:Lcom/android/server/am/HistoryRecord;
    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 6119
    .restart local v7       #activity:Lcom/android/server/am/HistoryRecord;
    iget-boolean v5, v7, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_4

    .line 6120
    const/4 v5, 0x0

    monitor-exit p0

    goto :goto_0

    .line 6124
    .end local v16           #index:I
    :cond_4
    const/high16 v5, 0x2000

    and-int v5, v5, p8

    if-eqz v5, :cond_6

    const/4 v5, 0x1

    move/from16 v18, v5

    .line 6125
    .local v18, noCreate:Z
    :goto_1
    const/high16 v5, 0x1000

    and-int v5, v5, p8

    if-eqz v5, :cond_7

    const/4 v5, 0x1

    move v14, v5

    .line 6126
    .local v14, cancelCurrent:Z
    :goto_2
    const/high16 v5, 0x800

    and-int v5, v5, p8

    if-eqz v5, :cond_8

    const/4 v5, 0x1

    move/from16 v22, v5

    .line 6127
    .local v22, updateCurrent:Z
    :goto_3
    const v5, -0x38000001

    and-int p8, p8, v5

    .line 6130
    new-instance v4, Lcom/android/server/am/PendingIntentRecord$Key;

    move/from16 v5, p1

    move-object/from16 v6, p2

    move-object/from16 v8, p4

    move/from16 v9, p5

    move-object/from16 v10, p6

    move-object/from16 v11, p7

    move/from16 v12, p8

    invoke-direct/range {v4 .. v12}, Lcom/android/server/am/PendingIntentRecord$Key;-><init>(ILjava/lang/String;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;ILandroid/content/Intent;Ljava/lang/String;I)V

    .line 6134
    .local v4, key:Lcom/android/server/am/PendingIntentRecord$Key;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    move-object v5, v0

    invoke-virtual {v5, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v20

    check-cast v20, Ljava/lang/ref/WeakReference;

    .line 6135
    .local v20, ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    if-eqz v20, :cond_9

    invoke-virtual/range {v20 .. v20}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object p2

    .end local p2
    check-cast p2, Lcom/android/server/am/PendingIntentRecord;

    move-object/from16 v19, p2

    .line 6136
    .local v19, rec:Lcom/android/server/am/PendingIntentRecord;
    :goto_4
    if-eqz v19, :cond_b

    .line 6137
    if-nez v14, :cond_a

    .line 6138
    if-eqz v22, :cond_5

    .line 6139
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/PendingIntentRecord$Key;->requestIntent:Landroid/content/Intent;

    move-object v0, v5

    move-object/from16 v1, p6

    invoke-virtual {v0, v1}, Landroid/content/Intent;->replaceExtras(Landroid/content/Intent;)Landroid/content/Intent;

    .line 6141
    :cond_5
    monitor-exit p0

    move-object/from16 v5, v19

    goto :goto_0

    .line 6124
    .end local v4           #key:Lcom/android/server/am/PendingIntentRecord$Key;
    .end local v14           #cancelCurrent:Z
    .end local v18           #noCreate:Z
    .end local v19           #rec:Lcom/android/server/am/PendingIntentRecord;
    .end local v20           #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    .end local v22           #updateCurrent:Z
    .restart local p2
    :cond_6
    const/4 v5, 0x0

    move/from16 v18, v5

    goto :goto_1

    .line 6125
    .restart local v18       #noCreate:Z
    :cond_7
    const/4 v5, 0x0

    move v14, v5

    goto :goto_2

    .line 6126
    .restart local v14       #cancelCurrent:Z
    :cond_8
    const/4 v5, 0x0

    move/from16 v22, v5

    goto :goto_3

    .line 6135
    .restart local v4       #key:Lcom/android/server/am/PendingIntentRecord$Key;
    .restart local v20       #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    .restart local v22       #updateCurrent:Z
    :cond_9
    const/4 v5, 0x0

    move-object/from16 v19, v5

    goto :goto_4

    .line 6143
    .end local p2
    .restart local v19       #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_a
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v19

    iput-boolean v0, v1, Lcom/android/server/am/PendingIntentRecord;->canceled:Z

    .line 6144
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    move-object v5, v0

    invoke-virtual {v5, v4}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6146
    :cond_b
    if-eqz v18, :cond_c

    .line 6147
    monitor-exit p0

    move-object/from16 v5, v19

    goto/16 :goto_0

    .line 6149
    :cond_c
    new-instance v19, Lcom/android/server/am/PendingIntentRecord;

    .end local v19           #rec:Lcom/android/server/am/PendingIntentRecord;
    move-object/from16 v0, v19

    move-object/from16 v1, p0

    move-object v2, v4

    move v3, v13

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/PendingIntentRecord;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/PendingIntentRecord$Key;I)V

    .line 6150
    .restart local v19       #rec:Lcom/android/server/am/PendingIntentRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    move-object v5, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord;->ref:Ljava/lang/ref/WeakReference;

    move-object v6, v0

    invoke-virtual {v5, v4, v6}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 6151
    const/4 v5, 0x3

    move/from16 v0, p1

    move v1, v5

    if-ne v0, v1, :cond_e

    .line 6152
    iget-object v5, v7, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    if-nez v5, :cond_d

    .line 6153
    new-instance v5, Ljava/util/HashSet;

    invoke-direct {v5}, Ljava/util/HashSet;-><init>()V

    iput-object v5, v7, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    .line 6156
    :cond_d
    iget-object v5, v7, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord;->ref:Ljava/lang/ref/WeakReference;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6158
    :cond_e
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    move-object/from16 v5, v19

    goto/16 :goto_0
.end method

.method public getMemoryInfo(Landroid/app/ActivityManager$MemoryInfo;)V
    .locals 5
    .parameter "outInfo"

    .prologue
    .line 6786
    invoke-static {}, Landroid/os/Process;->getFreeMemory()J

    move-result-wide v0

    iput-wide v0, p1, Landroid/app/ActivityManager$MemoryInfo;->availMem:J

    .line 6787
    sget v0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    int-to-long v0, v0

    iput-wide v0, p1, Landroid/app/ActivityManager$MemoryInfo;->threshold:J

    .line 6788
    iget-wide v0, p1, Landroid/app/ActivityManager$MemoryInfo;->availMem:J

    sget v2, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MEM:I

    sget v4, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    sub-int/2addr v3, v4

    div-int/lit8 v3, v3, 0x2

    add-int/2addr v2, v3

    int-to-long v2, v2

    cmp-long v0, v0, v2

    if-gez v0, :cond_0

    const/4 v0, 0x1

    :goto_0
    iput-boolean v0, p1, Landroid/app/ActivityManager$MemoryInfo;->lowMemory:Z

    .line 6790
    return-void

    .line 6788
    :cond_0
    const/4 v0, 0x0

    goto :goto_0
.end method

.method public getPackageForIntentSender(Landroid/content/IIntentSender;)Ljava/lang/String;
    .locals 4
    .parameter "pendingResult"

    .prologue
    const/4 v3, 0x0

    .line 6196
    instance-of v2, p1, Lcom/android/server/am/PendingIntentRecord;

    if-nez v2, :cond_0

    move-object v2, v3

    .line 6204
    :goto_0
    return-object v2

    .line 6200
    :cond_0
    :try_start_0
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v1, v0

    .line 6201
    .local v1, res:Lcom/android/server/am/PendingIntentRecord;
    iget-object v2, v1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v2, v2, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;
    :try_end_0
    .catch Ljava/lang/ClassCastException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 6202
    .end local v1           #res:Lcom/android/server/am/PendingIntentRecord;
    :catch_0
    move-exception v2

    move-object v2, v3

    .line 6204
    goto :goto_0
.end method

.method public getPackageForToken(Landroid/os/IBinder;)Ljava/lang/String;
    .locals 3
    .parameter "token"

    .prologue
    .line 6067
    monitor-enter p0

    .line 6068
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 6069
    .local v0, index:I
    if-ltz v0, :cond_0

    .line 6070
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 6071
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    monitor-exit p0

    .line 6073
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_0
    return-object v2

    :cond_0
    const/4 v2, 0x0

    monitor-exit p0

    goto :goto_0

    .line 6074
    .end local v0           #index:I
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public getProcessLimit()I
    .locals 1

    .prologue
    .line 6214
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    return v0
.end method

.method public getProcessMemoryInfo([I)[Landroid/os/Debug$MemoryInfo;
    .locals 4
    .parameter "pids"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 5216
    array-length v2, p1

    new-array v1, v2, [Landroid/os/Debug$MemoryInfo;

    .line 5217
    .local v1, infos:[Landroid/os/Debug$MemoryInfo;
    array-length v2, p1

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_0

    .line 5218
    new-instance v2, Landroid/os/Debug$MemoryInfo;

    invoke-direct {v2}, Landroid/os/Debug$MemoryInfo;-><init>()V

    aput-object v2, v1, v0

    .line 5219
    aget v2, p1, v0

    aget-object v3, v1, v0

    invoke-static {v2, v3}, Landroid/os/Debug;->getMemoryInfo(ILandroid/os/Debug$MemoryInfo;)V

    .line 5217
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 5221
    :cond_0
    return-object v1
.end method

.method public getProcessesInErrorState()Ljava/util/List;
    .locals 8
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$ProcessErrorStateInfo;",
            ">;"
        }
    .end annotation

    .prologue
    const/4 v6, 0x1

    .line 9439
    const/4 v1, 0x0

    .line 9441
    .local v1, errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    monitor-enter p0

    .line 9444
    :try_start_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result v5

    sub-int v3, v5, v6

    .local v3, i:I
    move-object v2, v1

    .end local v1           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .local v2, errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :goto_0
    if-ltz v3, :cond_5

    .line 9445
    :try_start_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .line 9446
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    iget-object v5, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v5, :cond_4

    iget-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-nez v5, :cond_0

    iget-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-eqz v5, :cond_4

    .line 9449
    :cond_0
    const/4 v4, 0x0

    .line 9450
    .local v4, report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    iget-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-eqz v5, :cond_2

    .line 9451
    iget-object v4, v0, Lcom/android/server/am/ProcessRecord;->crashingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 9456
    :cond_1
    :goto_1
    if-eqz v4, :cond_3

    .line 9457
    if-nez v2, :cond_6

    .line 9458
    new-instance v1, Ljava/util/ArrayList;

    const/4 v5, 0x1

    invoke-direct {v1, v5}, Ljava/util/ArrayList;-><init>(I)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 9460
    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v1       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :goto_2
    :try_start_2
    invoke-interface {v1, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 9444
    .end local v4           #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :goto_3
    add-int/lit8 v3, v3, -0x1

    move-object v2, v1

    .end local v1           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_0

    .line 9452
    .restart local v4       #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :cond_2
    :try_start_3
    iget-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-eqz v5, :cond_1

    .line 9453
    iget-object v4, v0, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    goto :goto_1

    .line 9462
    :cond_3
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Missing app error report, app = "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " crashing = "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-boolean v7, v0, Lcom/android/server/am/ProcessRecord;->crashing:Z

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " notResponding = "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-boolean v7, v0, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .end local v4           #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :cond_4
    move-object v1, v2

    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v1       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_3

    .line 9468
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :cond_5
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 9470
    return-object v2

    .line 9468
    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .end local v3           #i:I
    .restart local v1       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :catchall_0
    move-exception v5

    :goto_4
    :try_start_4
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v5

    .end local v1           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v3       #i:I
    :catchall_1
    move-exception v5

    move-object v1, v2

    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v1       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_4

    .end local v1           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v4       #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :cond_6
    move-object v1, v2

    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v1       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_2
.end method

.method public getRecentTasks(II)Ljava/util/List;
    .locals 9
    .parameter "maxNum"
    .parameter "flags"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(II)",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$RecentTaskInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 6936
    monitor-enter p0

    .line 6937
    :try_start_0
    const-string v6, "android.permission.GET_TASKS"

    const-string v7, "getRecentTasks()"

    invoke-virtual {p0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6940
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v2

    .line 6942
    .local v2, pm:Landroid/content/pm/IPackageManager;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 6943
    .local v0, N:I
    new-instance v3, Ljava/util/ArrayList;

    if-ge p1, v0, :cond_2

    move v6, p1

    :goto_0
    invoke-direct {v3, v6}, Ljava/util/ArrayList;-><init>(I)V

    .line 6946
    .local v3, res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    const/4 v1, 0x0

    .local v1, i:I
    :goto_1
    if-ge v1, v0, :cond_7

    if-lez p1, :cond_7

    .line 6947
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v6, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/TaskRecord;

    .line 6948
    .local v5, tr:Lcom/android/server/am/TaskRecord;
    and-int/lit8 v6, p2, 0x1

    if-nez v6, :cond_0

    iget-object v6, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v6, :cond_0

    iget-object v6, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v6}, Landroid/content/Intent;->getFlags()I

    move-result v6

    const/high16 v7, 0x80

    and-int/2addr v6, v7

    if-nez v6, :cond_1

    .line 6952
    :cond_0
    new-instance v4, Landroid/app/ActivityManager$RecentTaskInfo;

    invoke-direct {v4}, Landroid/app/ActivityManager$RecentTaskInfo;-><init>()V

    .line 6954
    .local v4, rti:Landroid/app/ActivityManager$RecentTaskInfo;
    iget v6, v5, Lcom/android/server/am/TaskRecord;->numActivities:I

    if-lez v6, :cond_3

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    :goto_2
    iput v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->id:I

    .line 6955
    new-instance v6, Landroid/content/Intent;

    iget-object v7, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v7, :cond_4

    iget-object v7, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    :goto_3
    invoke-direct {v6, v7}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    iput-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->baseIntent:Landroid/content/Intent;

    .line 6957
    iget-object v6, v5, Lcom/android/server/am/TaskRecord;->origActivity:Landroid/content/ComponentName;

    iput-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->origActivity:Landroid/content/ComponentName;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 6959
    and-int/lit8 v6, p2, 0x2

    if-eqz v6, :cond_6

    .line 6962
    :try_start_1
    iget-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->origActivity:Landroid/content/ComponentName;

    if-eqz v6, :cond_5

    .line 6963
    iget-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->origActivity:Landroid/content/ComponentName;

    const/4 v7, 0x0

    invoke-interface {v2, v6, v7}, Landroid/content/pm/IPackageManager;->getActivityInfo(Landroid/content/ComponentName;I)Landroid/content/pm/ActivityInfo;
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    move-result-object v6

    if-nez v6, :cond_6

    .line 6946
    .end local v4           #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    :cond_1
    :goto_4
    add-int/lit8 v1, v1, 0x1

    goto :goto_1

    .end local v1           #i:I
    .end local v3           #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    .end local v5           #tr:Lcom/android/server/am/TaskRecord;
    :cond_2
    move v6, v0

    .line 6943
    goto :goto_0

    .line 6954
    .restart local v1       #i:I
    .restart local v3       #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    .restart local v4       #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    .restart local v5       #tr:Lcom/android/server/am/TaskRecord;
    :cond_3
    const/4 v6, -0x1

    goto :goto_2

    .line 6955
    :cond_4
    :try_start_2
    iget-object v7, v5, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    goto :goto_3

    .line 6966
    :cond_5
    :try_start_3
    iget-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->baseIntent:Landroid/content/Intent;

    if-eqz v6, :cond_6

    .line 6967
    iget-object v6, v4, Landroid/app/ActivityManager$RecentTaskInfo;->baseIntent:Landroid/content/Intent;

    const/4 v7, 0x0

    const/4 v8, 0x0

    invoke-interface {v2, v6, v7, v8}, Landroid/content/pm/IPackageManager;->queryIntentActivities(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0

    move-result-object v6

    if-eqz v6, :cond_1

    .line 6977
    :cond_6
    :goto_5
    :try_start_4
    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 6978
    add-int/lit8 p1, p1, -0x1

    goto :goto_4

    .line 6981
    .end local v4           #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    .end local v5           #tr:Lcom/android/server/am/TaskRecord;
    :cond_7
    monitor-exit p0

    return-object v3

    .line 6982
    .end local v0           #N:I
    .end local v1           #i:I
    .end local v2           #pm:Landroid/content/pm/IPackageManager;
    .end local v3           #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v6

    .line 6972
    .restart local v0       #N:I
    .restart local v1       #i:I
    .restart local v2       #pm:Landroid/content/pm/IPackageManager;
    .restart local v3       #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    .restart local v4       #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    .restart local v5       #tr:Lcom/android/server/am/TaskRecord;
    :catch_0
    move-exception v6

    goto :goto_5
.end method

.method public getRequestedOrientation(Landroid/os/IBinder;)I
    .locals 3
    .parameter "token"

    .prologue
    .line 4033
    monitor-enter p0

    .line 4034
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 4035
    .local v0, index:I
    if-gez v0, :cond_0

    .line 4036
    const/4 v2, -0x1

    monitor-exit p0

    .line 4039
    :goto_0
    return v2

    .line 4038
    :cond_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4039
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v2, v1}, Lcom/android/server/WindowManagerService;->getAppOrientation(Landroid/view/IApplicationToken;)I

    move-result v2

    monitor-exit p0

    goto :goto_0

    .line 4040
    .end local v0           #index:I
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public getRunningAppProcesses()Ljava/util/List;
    .locals 10
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$RunningAppProcessInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 9475
    const/4 v5, 0x0

    .line 9476
    .local v5, runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    monitor-enter p0

    .line 9478
    :try_start_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    move-result v7

    const/4 v8, 0x1

    sub-int v3, v7, v8

    .local v3, i:I
    move-object v6, v5

    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .local v6, runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :goto_0
    if-ltz v3, :cond_8

    .line 9479
    :try_start_1
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 9480
    .local v1, app:Lcom/android/server/am/ProcessRecord;
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v7, :cond_a

    iget-boolean v7, v1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-nez v7, :cond_a

    iget-boolean v7, v1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-nez v7, :cond_a

    .line 9482
    new-instance v2, Landroid/app/ActivityManager$RunningAppProcessInfo;

    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget v8, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v1}, Lcom/android/server/am/ProcessRecord;->getPackageList()[Ljava/lang/String;

    move-result-object v9

    invoke-direct {v2, v7, v8, v9}, Landroid/app/ActivityManager$RunningAppProcessInfo;-><init>(Ljava/lang/String;I[Ljava/lang/String;)V

    .line 9485
    .local v2, currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->uid:I

    .line 9486
    iget v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 9487
    .local v0, adj:I
    sget v7, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    if-lt v0, v7, :cond_2

    .line 9488
    const/16 v7, 0x1f4

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    .line 9502
    :goto_1
    iget v7, v1, Lcom/android/server/am/ProcessRecord;->adjTypeCode:I

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importanceReasonCode:I

    .line 9503
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    instance-of v7, v7, Lcom/android/server/am/ProcessRecord;

    if-eqz v7, :cond_7

    .line 9504
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    check-cast v7, Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->pid:I

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importanceReasonPid:I

    .line 9509
    :cond_0
    :goto_2
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    instance-of v7, v7, Landroid/content/ComponentName;

    if-eqz v7, :cond_1

    .line 9510
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    check-cast v7, Landroid/content/ComponentName;

    iput-object v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importanceReasonComponent:Landroid/content/ComponentName;

    .line 9514
    :cond_1
    if-nez v6, :cond_9

    .line 9515
    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 9517
    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :goto_3
    :try_start_2
    invoke-interface {v5, v2}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 9478
    .end local v0           #adj:I
    .end local v2           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    :goto_4
    add-int/lit8 v3, v3, -0x1

    move-object v6, v5

    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    goto :goto_0

    .line 9489
    .restart local v0       #adj:I
    .restart local v2       #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    :cond_2
    :try_start_3
    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v0, v7, :cond_3

    .line 9490
    const/16 v7, 0x190

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    .line 9491
    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    sub-int v7, v0, v7

    add-int/lit8 v7, v7, 0x1

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->lru:I
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_1

    .line 9520
    .end local v0           #adj:I
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    .end local v2           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    :catchall_0
    move-exception v7

    move-object v5, v6

    .end local v3           #i:I
    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :goto_5
    :try_start_4
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    throw v7

    .line 9492
    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v0       #adj:I
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .restart local v3       #i:I
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :cond_3
    :try_start_5
    sget v7, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    if-lt v0, v7, :cond_4

    .line 9493
    const/16 v7, 0x190

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    .line 9494
    const/4 v7, 0x0

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->lru:I

    goto :goto_1

    .line 9495
    :cond_4
    sget v7, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    if-lt v0, v7, :cond_5

    .line 9496
    const/16 v7, 0x12c

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    goto :goto_1

    .line 9497
    :cond_5
    sget v7, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-lt v0, v7, :cond_6

    .line 9498
    const/16 v7, 0xc8

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    goto :goto_1

    .line 9500
    :cond_6
    const/16 v7, 0x64

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    goto :goto_1

    .line 9505
    :cond_7
    iget-object v7, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    instance-of v7, v7, Lcom/android/server/am/HistoryRecord;

    if-eqz v7, :cond_0

    .line 9506
    iget-object v4, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 9507
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v7, :cond_0

    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->pid:I

    iput v7, v2, Landroid/app/ActivityManager$RunningAppProcessInfo;->importanceReasonPid:I

    goto :goto_2

    .line 9520
    .end local v0           #adj:I
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    .end local v2           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_8
    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 9521
    return-object v6

    .line 9520
    .end local v3           #i:I
    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :catchall_1
    move-exception v7

    goto :goto_5

    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v0       #adj:I
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .restart local v3       #i:I
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :cond_9
    move-object v5, v6

    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    goto :goto_3

    .end local v0           #adj:I
    .end local v2           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :cond_a
    move-object v5, v6

    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    goto :goto_4
.end method

.method public getRunningExternalApplications()Ljava/util/List;
    .locals 13
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List",
            "<",
            "Landroid/content/pm/ApplicationInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 9525
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->getRunningAppProcesses()Ljava/util/List;

    move-result-object v10

    .line 9526
    .local v10, runningApps:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    new-instance v9, Ljava/util/ArrayList;

    invoke-direct {v9}, Ljava/util/ArrayList;-><init>()V

    .line 9527
    .local v9, retList:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ApplicationInfo;>;"
    if-eqz v10, :cond_3

    invoke-interface {v10}, Ljava/util/List;->size()I

    move-result v11

    if-lez v11, :cond_3

    .line 9528
    new-instance v2, Ljava/util/HashSet;

    invoke-direct {v2}, Ljava/util/HashSet;-><init>()V

    .line 9529
    .local v2, extList:Ljava/util/Set;,"Ljava/util/Set<Ljava/lang/String;>;"
    invoke-interface {v10}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v3

    :cond_0
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v11

    if-eqz v11, :cond_1

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/app/ActivityManager$RunningAppProcessInfo;

    .line 9530
    .local v0, app:Landroid/app/ActivityManager$RunningAppProcessInfo;
    iget-object v11, v0, Landroid/app/ActivityManager$RunningAppProcessInfo;->pkgList:[Ljava/lang/String;

    if-eqz v11, :cond_0

    .line 9531
    iget-object v1, v0, Landroid/app/ActivityManager$RunningAppProcessInfo;->pkgList:[Ljava/lang/String;

    .local v1, arr$:[Ljava/lang/String;
    array-length v6, v1

    .local v6, len$:I
    const/4 v4, 0x0

    .local v4, i$:I
    :goto_0
    if-ge v4, v6, :cond_0

    aget-object v7, v1, v4

    .line 9532
    .local v7, pkg:Ljava/lang/String;
    invoke-interface {v2, v7}, Ljava/util/Set;->add(Ljava/lang/Object;)Z

    .line 9531
    add-int/lit8 v4, v4, 0x1

    goto :goto_0

    .line 9536
    .end local v0           #app:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .end local v1           #arr$:[Ljava/lang/String;
    .end local v4           #i$:I
    .end local v6           #len$:I
    .end local v7           #pkg:Ljava/lang/String;
    :cond_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v8

    .line 9537
    .local v8, pm:Landroid/content/pm/IPackageManager;
    invoke-interface {v2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .local v3, i$:Ljava/util/Iterator;
    :cond_2
    :goto_1
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v11

    if-eqz v11, :cond_3

    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/lang/String;

    .line 9539
    .restart local v7       #pkg:Ljava/lang/String;
    const/4 v11, 0x0

    :try_start_0
    invoke-interface {v8, v7, v11}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v5

    .line 9540
    .local v5, info:Landroid/content/pm/ApplicationInfo;
    iget v11, v5, Landroid/content/pm/ApplicationInfo;->flags:I

    const/high16 v12, 0x4

    and-int/2addr v11, v12

    if-eqz v11, :cond_2

    .line 9541
    invoke-interface {v9, v5}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_1

    .line 9543
    .end local v5           #info:Landroid/content/pm/ApplicationInfo;
    :catch_0
    move-exception v11

    goto :goto_1

    .line 9547
    .end local v2           #extList:Ljava/util/Set;,"Ljava/util/Set<Ljava/lang/String;>;"
    .end local v3           #i$:Ljava/util/Iterator;
    .end local v7           #pkg:Ljava/lang/String;
    .end local v8           #pm:Landroid/content/pm/IPackageManager;
    :cond_3
    return-object v9
.end method

.method public getRunningServiceControlPanel(Landroid/content/ComponentName;)Landroid/app/PendingIntent;
    .locals 4
    .parameter "name"

    .prologue
    .line 10778
    monitor-enter p0

    .line 10779
    :try_start_0
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v3, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ServiceRecord;

    .line 10780
    .local v2, r:Lcom/android/server/am/ServiceRecord;
    if-eqz v2, :cond_1

    .line 10781
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .local v1, i$:Ljava/util/Iterator;
    :cond_0
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_1

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ConnectionRecord;

    .line 10782
    .local v0, conn:Lcom/android/server/am/ConnectionRecord;
    iget-object v3, v0, Lcom/android/server/am/ConnectionRecord;->clientIntent:Landroid/app/PendingIntent;

    if-eqz v3, :cond_0

    .line 10783
    iget-object v3, v0, Lcom/android/server/am/ConnectionRecord;->clientIntent:Landroid/app/PendingIntent;

    monitor-exit p0

    .line 10788
    .end local v0           #conn:Lcom/android/server/am/ConnectionRecord;
    .end local v1           #i$:Ljava/util/Iterator;
    :goto_0
    return-object v3

    .line 10787
    :cond_1
    monitor-exit p0

    .line 10788
    const/4 v3, 0x0

    goto :goto_0

    .line 10787
    .end local v2           #r:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3
.end method

.method public getServices(II)Ljava/util/List;
    .locals 7
    .parameter "maxNum"
    .parameter "flags"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(II)",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$RunningServiceInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 10754
    monitor-enter p0

    .line 10755
    :try_start_0
    new-instance v4, Ljava/util/ArrayList;

    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    .line 10758
    .local v4, res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RunningServiceInfo;>;"
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_0

    .line 10759
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .line 10760
    .local v2, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    :goto_0
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v5, p1, :cond_0

    .line 10761
    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ServiceRecord;

    invoke-virtual {p0, v5}, Lcom/android/server/am/ActivityManagerService;->makeRunningServiceInfoLocked(Lcom/android/server/am/ServiceRecord;)Landroid/app/ActivityManager$RunningServiceInfo;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_0

    .line 10774
    .end local v2           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    .end local v4           #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RunningServiceInfo;>;"
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 10765
    .restart local v4       #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RunningServiceInfo;>;"
    :cond_0
    const/4 v0, 0x0

    .local v0, i:I
    :goto_1
    :try_start_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_1

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v5, p1, :cond_1

    .line 10766
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ServiceRecord;

    .line 10767
    .local v3, r:Lcom/android/server/am/ServiceRecord;
    invoke-virtual {p0, v3}, Lcom/android/server/am/ActivityManagerService;->makeRunningServiceInfoLocked(Lcom/android/server/am/ServiceRecord;)Landroid/app/ActivityManager$RunningServiceInfo;

    move-result-object v1

    .line 10769
    .local v1, info:Landroid/app/ActivityManager$RunningServiceInfo;
    iget-wide v5, v3, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    iput-wide v5, v1, Landroid/app/ActivityManager$RunningServiceInfo;->restarting:J

    .line 10770
    invoke-virtual {v4, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 10765
    add-int/lit8 v0, v0, 0x1

    goto :goto_1

    .line 10773
    .end local v1           #info:Landroid/app/ActivityManager$RunningServiceInfo;
    .end local v3           #r:Lcom/android/server/am/ServiceRecord;
    :cond_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    return-object v4
.end method

.method public getTaskForActivity(Landroid/os/IBinder;Z)I
    .locals 1
    .parameter "token"
    .parameter "onlyRoot"

    .prologue
    .line 7547
    monitor-enter p0

    .line 7548
    :try_start_0
    invoke-virtual {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->getTaskForActivityLocked(Landroid/os/IBinder;Z)I

    move-result v0

    monitor-exit p0

    return v0

    .line 7549
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method getTaskForActivityLocked(Landroid/os/IBinder;Z)I
    .locals 6
    .parameter "token"
    .parameter "onlyRoot"

    .prologue
    const/4 v5, -0x1

    .line 7553
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7554
    .local v0, N:I
    const/4 v2, 0x0

    .line 7555
    .local v2, lastTask:Lcom/android/server/am/TaskRecord;
    const/4 v1, 0x0

    .local v1, i:I
    :goto_0
    if-ge v1, v0, :cond_3

    .line 7556
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7557
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    if-ne v3, p1, :cond_2

    .line 7558
    if-eqz p2, :cond_0

    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v2, v4, :cond_1

    .line 7559
    :cond_0
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v4, v4, Lcom/android/server/am/TaskRecord;->taskId:I

    .line 7566
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return v4

    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    move v4, v5

    .line 7561
    goto :goto_1

    .line 7563
    :cond_2
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7555
    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_3
    move v4, v5

    .line 7566
    goto :goto_1
.end method

.method public getTasks(IILandroid/app/IThumbnailReceiver;)Ljava/util/List;
    .locals 23
    .parameter "maxNum"
    .parameter "flags"
    .parameter "receiver"

    .prologue
    .line 6798
    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    .line 6800
    .local v11, list:Ljava/util/ArrayList;
    const/16 v16, 0x0

    .line 6801
    .local v16, pending:Lcom/android/server/am/PendingThumbnailsRecord;
    const/16 v22, 0x0

    .line 6802
    .local v22, topThumbnail:Landroid/app/IApplicationThread;
    const/4 v4, 0x0

    .line 6804
    .local v4, topRecord:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 6809
    :try_start_0
    const-string v2, "android.permission.GET_TASKS"

    move-object/from16 v0, p0

    move-object v1, v2

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result v2

    if-eqz v2, :cond_1

    .line 6811
    if-eqz p3, :cond_0

    .line 6815
    :try_start_1
    invoke-interface/range {p3 .. p3}, Landroid/app/IThumbnailReceiver;->finished()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1

    .line 6819
    :cond_0
    :goto_0
    :try_start_2
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Permission Denial: getTasks() from pid="

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, ", uid="

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " requires "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, "android.permission.GET_TASKS"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    .line 6823
    .local v12, msg:Ljava/lang/String;
    const-string v2, "ActivityManager"

    invoke-static {v2, v12}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6824
    new-instance v2, Ljava/lang/SecurityException;

    invoke-direct {v2, v12}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 6906
    .end local v12           #msg:Ljava/lang/String;
    .end local p2
    :catchall_0
    move-exception v2

    :goto_1
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v2

    .line 6827
    .restart local p2
    :cond_1
    :try_start_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v2, v0

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v18, v2, v3

    .line 6828
    .local v18, pos:I
    if-ltz v18, :cond_9

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v2, v0

    move-object v0, v2

    move/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    .end local p2
    check-cast p2, Lcom/android/server/am/HistoryRecord;
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    move-object/from16 v13, p2

    .line 6830
    .local v13, next:Lcom/android/server/am/HistoryRecord;
    :goto_2
    const/16 v20, 0x0

    .line 6831
    .local v20, top:Lcom/android/server/am/HistoryRecord;
    const/16 v21, 0x0

    .line 6832
    .local v21, topDescription:Ljava/lang/CharSequence;
    const/4 v9, 0x0

    .line 6833
    .local v9, curTask:Lcom/android/server/am/TaskRecord;
    const/4 v14, 0x0

    .line 6834
    .local v14, numActivities:I
    const/4 v15, 0x0

    .local v15, numRunning:I
    move-object/from16 v17, v16

    .line 6835
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .local v17, pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :goto_3
    if-ltz v18, :cond_c

    if-lez p1, :cond_c

    .line 6836
    move-object/from16 v19, v13

    .line 6837
    .local v19, r:Lcom/android/server/am/HistoryRecord;
    add-int/lit8 v18, v18, -0x1

    .line 6838
    if-ltz v18, :cond_a

    :try_start_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v2, v0

    move-object v0, v2

    move/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v13, p2

    .line 6841
    :goto_4
    if-eqz v20, :cond_2

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object v2, v0

    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->INITIALIZING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v2, v3, :cond_3

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v2, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    if-ne v2, v3, :cond_3

    .line 6844
    :cond_2
    move-object/from16 v20, v19

    .line 6845
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    move-object/from16 v21, v0

    .line 6846
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v9, v0

    .line 6847
    const/4 v15, 0x0

    move v14, v15

    .line 6851
    :cond_3
    add-int/lit8 v14, v14, 0x1

    .line 6852
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    if-eqz v2, :cond_4

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    iget-object v2, v2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_4

    .line 6853
    add-int/lit8 v15, v15, 0x1

    .line 6855
    :cond_4
    if-nez v21, :cond_5

    .line 6856
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    move-object/from16 v21, v0

    .line 6865
    :cond_5
    if-eqz v13, :cond_6

    iget-object v2, v13, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v2, v9, :cond_12

    .line 6866
    :cond_6
    new-instance v8, Landroid/app/ActivityManager$RunningTaskInfo;

    invoke-direct {v8}, Landroid/app/ActivityManager$RunningTaskInfo;-><init>()V

    .line 6868
    .local v8, ci:Landroid/app/ActivityManager$RunningTaskInfo;
    iget v2, v9, Lcom/android/server/am/TaskRecord;->taskId:I

    iput v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->id:I

    .line 6869
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v2, v0

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    iput-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->baseActivity:Landroid/content/ComponentName;

    .line 6870
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v2, v0

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    iput-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->topActivity:Landroid/content/ComponentName;

    .line 6871
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    move-object v2, v0

    iput-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->thumbnail:Landroid/graphics/Bitmap;

    .line 6872
    move-object/from16 v0, v21

    move-object v1, v8

    iput-object v0, v1, Landroid/app/ActivityManager$RunningTaskInfo;->description:Ljava/lang/CharSequence;

    .line 6873
    iput v14, v8, Landroid/app/ActivityManager$RunningTaskInfo;->numActivities:I

    .line 6874
    iput v15, v8, Landroid/app/ActivityManager$RunningTaskInfo;->numRunning:I

    .line 6877
    iget-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->thumbnail:Landroid/graphics/Bitmap;

    if-nez v2, :cond_11

    if-eqz p3, :cond_11

    .line 6882
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object v2, v0

    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v2, v3, :cond_7

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object v2, v0

    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v2, v3, :cond_8

    .line 6884
    :cond_7
    move-object/from16 v0, v20

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->idle:Z

    move v2, v0

    if-eqz v2, :cond_b

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    if-eqz v2, :cond_b

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    iget-object v2, v2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_b

    .line 6886
    move-object/from16 v4, v20

    .line 6887
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    move-object v0, v2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v22, v0

    .line 6892
    :cond_8
    :goto_5
    if-nez v17, :cond_10

    .line 6893
    new-instance v16, Lcom/android/server/am/PendingThumbnailsRecord;

    move-object/from16 v0, v16

    move-object/from16 v1, p3

    invoke-direct {v0, v1}, Lcom/android/server/am/PendingThumbnailsRecord;-><init>(Landroid/app/IThumbnailReceiver;)V
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 6895
    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :goto_6
    :try_start_5
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/PendingThumbnailsRecord;->pendingRecords:Ljava/util/HashSet;

    move-object v2, v0

    move-object v0, v2

    move-object/from16 v1, v20

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6897
    :goto_7
    invoke-virtual {v11, v8}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 6898
    add-int/lit8 p1, p1, -0x1

    .line 6899
    const/16 v20, 0x0

    .end local v8           #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    :goto_8
    move-object/from16 v17, v16

    .line 6901
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto/16 :goto_3

    .line 6828
    .end local v9           #curTask:Lcom/android/server/am/TaskRecord;
    .end local v13           #next:Lcom/android/server/am/HistoryRecord;
    .end local v14           #numActivities:I
    .end local v15           #numRunning:I
    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local v19           #r:Lcom/android/server/am/HistoryRecord;
    .end local v20           #top:Lcom/android/server/am/HistoryRecord;
    .end local v21           #topDescription:Ljava/lang/CharSequence;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local p2
    :cond_9
    const/4 v2, 0x0

    move-object v13, v2

    goto/16 :goto_2

    .line 6838
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local p2
    .restart local v9       #curTask:Lcom/android/server/am/TaskRecord;
    .restart local v13       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v14       #numActivities:I
    .restart local v15       #numRunning:I
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v19       #r:Lcom/android/server/am/HistoryRecord;
    .restart local v20       #top:Lcom/android/server/am/HistoryRecord;
    .restart local v21       #topDescription:Ljava/lang/CharSequence;
    :cond_a
    const/4 v2, 0x0

    move-object v13, v2

    goto/16 :goto_4

    .line 6889
    .restart local v8       #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    :cond_b
    const/4 v2, 0x1

    :try_start_6
    move v0, v2

    move-object/from16 v1, v20

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->thumbnailNeeded:Z

    goto :goto_5

    .line 6906
    .end local v8           #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    .end local v19           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_1
    move-exception v2

    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto/16 :goto_1

    .line 6903
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_c
    if-eqz v17, :cond_d

    .line 6904
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    move-object v2, v0

    move-object v0, v2

    move-object/from16 v1, v17

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 6906
    :cond_d
    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    .line 6910
    if-eqz v22, :cond_e

    .line 6913
    :try_start_7
    move-object/from16 v0, v22

    move-object v1, v4

    invoke-interface {v0, v1}, Landroid/app/IApplicationThread;->requestThumbnail(Landroid/os/IBinder;)V
    :try_end_7
    .catch Ljava/lang/Exception; {:try_start_7 .. :try_end_7} :catch_0

    .line 6920
    :cond_e
    :goto_9
    if-nez v17, :cond_f

    if-eqz p3, :cond_f

    .line 6926
    :try_start_8
    invoke-interface/range {p3 .. p3}, Landroid/app/IThumbnailReceiver;->finished()V
    :try_end_8
    .catch Landroid/os/RemoteException; {:try_start_8 .. :try_end_8} :catch_2

    .line 6931
    :cond_f
    :goto_a
    return-object v11

    .line 6914
    :catch_0
    move-exception v10

    .line 6915
    .local v10, e:Ljava/lang/Exception;
    const-string v2, "ActivityManager"

    const-string v3, "Exception thrown when requesting thumbnail"

    invoke-static {v2, v3, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 6916
    const/4 v3, 0x0

    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x1

    move-object/from16 v2, p0

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    goto :goto_9

    .line 6816
    .end local v9           #curTask:Lcom/android/server/am/TaskRecord;
    .end local v10           #e:Ljava/lang/Exception;
    .end local v13           #next:Lcom/android/server/am/HistoryRecord;
    .end local v14           #numActivities:I
    .end local v15           #numRunning:I
    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local v18           #pos:I
    .end local v20           #top:Lcom/android/server/am/HistoryRecord;
    .end local v21           #topDescription:Ljava/lang/CharSequence;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local p2
    :catch_1
    move-exception v2

    goto/16 :goto_0

    .line 6927
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local p2
    .restart local v9       #curTask:Lcom/android/server/am/TaskRecord;
    .restart local v13       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v14       #numActivities:I
    .restart local v15       #numRunning:I
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v18       #pos:I
    .restart local v20       #top:Lcom/android/server/am/HistoryRecord;
    .restart local v21       #topDescription:Ljava/lang/CharSequence;
    :catch_2
    move-exception v2

    goto :goto_a

    .restart local v8       #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    .restart local v19       #r:Lcom/android/server/am/HistoryRecord;
    :cond_10
    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto :goto_6

    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_11
    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto :goto_7

    .end local v8           #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_12
    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto :goto_8
.end method

.method public goingToSleep()V
    .locals 2

    .prologue
    .line 8268
    monitor-enter p0

    .line 8269
    const/4 v0, 0x1

    :try_start_0
    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    .line 8270
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x0

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->setEventDispatching(Z)V

    .line 8272
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v0, :cond_0

    .line 8273
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V

    .line 8277
    :goto_0
    monitor-exit p0

    .line 8278
    return-void

    .line 8275
    :cond_0
    const-string v0, "ActivityManager"

    const-string v1, "goingToSleep with no resumed activity!"

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_0

    .line 8277
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public grantUriPermission(Landroid/app/IApplicationThread;Ljava/lang/String;Landroid/net/Uri;I)V
    .locals 7
    .parameter "caller"
    .parameter "targetPkg"
    .parameter "uri"
    .parameter "modeFlags"

    .prologue
    const-string v0, "ActivityManager"

    .line 6581
    monitor-enter p0

    .line 6582
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v6

    .line 6583
    .local v6, r:Lcom/android/server/am/ProcessRecord;
    if-nez v6, :cond_0

    .line 6584
    new-instance v0, Ljava/lang/SecurityException;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to find app for caller "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " when granting permission to uri "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 6599
    .end local v6           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    .line 6588
    .restart local v6       #r:Lcom/android/server/am/ProcessRecord;
    :cond_0
    if-nez p2, :cond_1

    .line 6589
    :try_start_1
    const-string v0, "ActivityManager"

    const-string v1, "grantUriPermission: null target"

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6590
    monitor-exit p0

    .line 6600
    :goto_0
    return-void

    .line 6592
    :cond_1
    if-nez p3, :cond_2

    .line 6593
    const-string v0, "ActivityManager"

    const-string v1, "grantUriPermission: null uri"

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6594
    monitor-exit p0

    goto :goto_0

    .line 6597
    :cond_2
    iget-object v0, v6, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v1, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    const/4 v5, 0x0

    move-object v0, p0

    move-object v2, p2

    move-object v3, p3

    move v4, p4

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V

    .line 6599
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_0
.end method

.method public handleApplicationCrash(Landroid/os/IBinder;Landroid/app/ApplicationErrorReport$CrashInfo;)V
    .locals 9
    .parameter "app"
    .parameter "crashInfo"

    .prologue
    const/4 v3, 0x0

    .line 9102
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->findAppProcess(Landroid/os/IBinder;)Lcom/android/server/am/ProcessRecord;

    move-result-object v2

    .line 9104
    .local v2, r:Lcom/android/server/am/ProcessRecord;
    const/16 v0, 0x7557

    const/4 v1, 0x7

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v4, 0x0

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v1, v4

    const/4 v4, 0x1

    if-nez p1, :cond_0

    const-string v5, "system"

    :goto_0
    aput-object v5, v1, v4

    const/4 v4, 0x2

    if-nez v2, :cond_2

    const/4 v5, -0x1

    :goto_1
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v1, v4

    const/4 v4, 0x3

    iget-object v5, p2, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionClassName:Ljava/lang/String;

    aput-object v5, v1, v4

    const/4 v4, 0x4

    iget-object v5, p2, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionMessage:Ljava/lang/String;

    aput-object v5, v1, v4

    const/4 v4, 0x5

    iget-object v5, p2, Landroid/app/ApplicationErrorReport$CrashInfo;->throwFileName:Ljava/lang/String;

    aput-object v5, v1, v4

    const/4 v4, 0x6

    iget v5, p2, Landroid/app/ApplicationErrorReport$CrashInfo;->throwLineNumber:I

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v1, v4

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 9112
    const-string v1, "crash"

    move-object v0, p0

    move-object v4, v3

    move-object v5, v3

    move-object v6, v3

    move-object v7, v3

    move-object v8, p2

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/am/ActivityManagerService;->addErrorToDropBox(Ljava/lang/String;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;Ljava/lang/String;Ljava/io/File;Landroid/app/ApplicationErrorReport$CrashInfo;)V

    .line 9114
    invoke-direct {p0, v2, p2}, Lcom/android/server/am/ActivityManagerService;->crashApplication(Lcom/android/server/am/ProcessRecord;Landroid/app/ApplicationErrorReport$CrashInfo;)V

    .line 9115
    return-void

    .line 9104
    :cond_0
    if-nez v2, :cond_1

    const-string v5, "unknown"

    goto :goto_0

    :cond_1
    iget-object v5, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    goto :goto_0

    :cond_2
    iget-object v5, v2, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->flags:I

    goto :goto_1
.end method

.method public handleApplicationWtf(Landroid/os/IBinder;Ljava/lang/String;Landroid/app/ApplicationErrorReport$CrashInfo;)Z
    .locals 11
    .parameter "app"
    .parameter "tag"
    .parameter "crashInfo"

    .prologue
    const/4 v10, 0x1

    const/4 v9, 0x0

    const/4 v3, 0x0

    .line 9126
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->findAppProcess(Landroid/os/IBinder;)Lcom/android/server/am/ProcessRecord;

    move-result-object v2

    .line 9128
    .local v2, r:Lcom/android/server/am/ProcessRecord;
    const/16 v0, 0x7558

    const/4 v1, 0x5

    new-array v1, v1, [Ljava/lang/Object;

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v1, v9

    if-nez p1, :cond_0

    const-string v4, "system"

    :goto_0
    aput-object v4, v1, v10

    const/4 v4, 0x2

    if-nez v2, :cond_2

    const/4 v5, -0x1

    :goto_1
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v1, v4

    const/4 v4, 0x3

    aput-object p2, v1, v4

    const/4 v4, 0x4

    iget-object v5, p3, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionMessage:Ljava/lang/String;

    aput-object v5, v1, v4

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 9133
    const-string v1, "wtf"

    move-object v0, p0

    move-object v4, v3

    move-object v5, p2

    move-object v6, v3

    move-object v7, v3

    move-object v8, p3

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/am/ActivityManagerService;->addErrorToDropBox(Ljava/lang/String;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;Ljava/lang/String;Ljava/io/File;Landroid/app/ApplicationErrorReport$CrashInfo;)V

    .line 9135
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string v1, "wtf_is_fatal"

    invoke-static {v0, v1, v9}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v0

    if-eqz v0, :cond_3

    .line 9137
    invoke-direct {p0, v2, p3}, Lcom/android/server/am/ActivityManagerService;->crashApplication(Lcom/android/server/am/ProcessRecord;Landroid/app/ApplicationErrorReport$CrashInfo;)V

    move v0, v10

    .line 9140
    :goto_2
    return v0

    .line 9128
    :cond_0
    if-nez v2, :cond_1

    const-string v4, "unknown"

    goto :goto_0

    :cond_1
    iget-object v4, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    goto :goto_0

    :cond_2
    iget-object v5, v2, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->flags:I

    goto :goto_1

    :cond_3
    move v0, v9

    .line 9140
    goto :goto_2
.end method

.method isAllowedWhileBooting(Landroid/content/pm/ApplicationInfo;)Z
    .locals 1
    .parameter "ai"

    .prologue
    .line 1986
    iget v0, p1, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v0, v0, 0x8

    if-eqz v0, :cond_0

    const/4 v0, 0x1

    :goto_0
    return v0

    :cond_0
    const/4 v0, 0x0

    goto :goto_0
.end method

.method public isUserAMonkey()Z
    .locals 1

    .prologue
    .line 8462
    monitor-enter p0

    .line 8463
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    if-eqz v0, :cond_0

    const/4 v0, 0x1

    :goto_0
    monitor-exit p0

    return v0

    :cond_0
    const/4 v0, 0x0

    goto :goto_0

    .line 8464
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method killAppAtUsersRequest(Lcom/android/server/am/ProcessRecord;Landroid/app/Dialog;)V
    .locals 4
    .parameter "app"
    .parameter "fromDialog"

    .prologue
    .line 8962
    monitor-enter p0

    .line 8963
    const/4 v0, 0x0

    :try_start_0
    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    .line 8964
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->crashingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8965
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 8966
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8967
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    if-ne v0, p2, :cond_0

    .line 8968
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    .line 8970
    :cond_0
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    if-ne v0, p2, :cond_1

    .line 8971
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    .line 8973
    :cond_1
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v0, :cond_2

    iget v0, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v1, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v0, v1, :cond_2

    .line 8974
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->handleAppCrashLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 8975
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Killing "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " (pid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, "): user\'s request"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8977
    const/16 v0, 0x7547

    const/4 v1, 0x4

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    iget v3, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v3, v1, v2

    const/4 v2, 0x2

    iget v3, p1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x3

    const-string v3, "user\'s request after error"

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 8979
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v0}, Landroid/os/Process;->killProcess(I)V

    .line 8981
    :cond_2
    monitor-exit p0

    .line 8982
    return-void

    .line 8981
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public killApplicationProcess(Ljava/lang/String;I)V
    .locals 5
    .parameter "processName"
    .parameter "uid"

    .prologue
    .line 5225
    if-nez p1, :cond_0

    .line 5249
    :goto_0
    return-void

    .line 5229
    :cond_0
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    .line 5231
    .local v1, callerUid:I
    const/16 v2, 0x3e8

    if-ne v1, v2, :cond_2

    .line 5232
    monitor-enter p0

    .line 5233
    :try_start_0
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result-object v0

    .line 5234
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v0, :cond_1

    .line 5236
    :try_start_1
    iget-object v2, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v2}, Landroid/app/IApplicationThread;->scheduleSuicide()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 5244
    :goto_1
    :try_start_2
    monitor-exit p0

    goto :goto_0

    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v2

    .line 5241
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    :cond_1
    :try_start_3
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Process/uid not found attempting kill of "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " / "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_1

    .line 5246
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    :cond_2
    new-instance v2, Ljava/lang/SecurityException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " cannot kill app process: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 5237
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    :catch_0
    move-exception v2

    goto :goto_1
.end method

.method public killApplicationWithUid(Ljava/lang/String;I)V
    .locals 5
    .parameter "pkg"
    .parameter "uid"

    .prologue
    .line 5153
    if-nez p1, :cond_0

    .line 5174
    :goto_0
    return-void

    .line 5157
    :cond_0
    if-gez p2, :cond_1

    .line 5158
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Invalid uid specified for pkg : "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_0

    .line 5161
    :cond_1
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 5163
    .local v0, callerUid:I
    const/16 v2, 0x3e8

    if-ne v0, v2, :cond_2

    .line 5165
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v3, 0x16

    invoke-virtual {v2, v3}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 5166
    .local v1, msg:Landroid/os/Message;
    iput p2, v1, Landroid/os/Message;->arg1:I

    .line 5167
    const/4 v2, 0x0

    iput v2, v1, Landroid/os/Message;->arg2:I

    .line 5168
    iput-object p1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 5169
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v2, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    goto :goto_0

    .line 5171
    .end local v1           #msg:Landroid/os/Message;
    :cond_2
    new-instance v2, Ljava/lang/SecurityException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " cannot kill pkg: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2
.end method

.method public killBackgroundProcesses(Ljava/lang/String;)V
    .locals 10
    .parameter "packageName"

    .prologue
    const-string v4, "android.permission.KILL_BACKGROUND_PROCESSES"

    const-string v3, "ActivityManager"

    .line 5084
    const-string v0, "android.permission.KILL_BACKGROUND_PROCESSES"

    invoke-virtual {p0, v4}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_0

    const-string v0, "android.permission.RESTART_PACKAGES"

    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_0

    .line 5088
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Permission Denial: killBackgroundProcesses() from pid="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, ", uid="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " requires "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, "android.permission.KILL_BACKGROUND_PROCESSES"

    invoke-virtual {v0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    .line 5092
    .local v8, msg:Ljava/lang/String;
    const-string v0, "ActivityManager"

    invoke-static {v3, v8}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5093
    new-instance v0, Ljava/lang/SecurityException;

    invoke-direct {v0, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 5096
    .end local v8           #msg:Ljava/lang/String;
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 5098
    .local v6, callingId:J
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v9

    .line 5099
    .local v9, pm:Landroid/content/pm/IPackageManager;
    const/4 v2, -0x1

    .line 5100
    .local v2, pkgUid:I
    monitor-enter p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 5102
    :try_start_1
    invoke-interface {v9, p1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    move-result v2

    .line 5105
    :goto_0
    const/4 v0, -0x1

    if-ne v2, v0, :cond_1

    .line 5106
    :try_start_2
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Invalid packageName: "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5107
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 5113
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5115
    :goto_1
    return-void

    .line 5109
    :cond_1
    :try_start_3
    sget v3, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    const/4 v4, 0x0

    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->killPackageProcessesLocked(Ljava/lang/String;IIZZ)Z

    .line 5111
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 5113
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_1

    .line 5111
    :catchall_0
    move-exception v0

    :try_start_4
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    :try_start_5
    throw v0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    .line 5113
    .end local v2           #pkgUid:I
    .end local v9           #pm:Landroid/content/pm/IPackageManager;
    :catchall_1
    move-exception v0

    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v0

    .line 5103
    .restart local v2       #pkgUid:I
    .restart local v9       #pm:Landroid/content/pm/IPackageManager;
    :catch_0
    move-exception v0

    goto :goto_0
.end method

.method public killPids([ILjava/lang/String;)Z
    .locals 13
    .parameter "pids"
    .parameter "pReason"

    .prologue
    const-string v8, "ActivityManager"

    .line 8524
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v8

    const/16 v9, 0x3e8

    if-eq v8, v9, :cond_0

    .line 8525
    new-instance v8, Ljava/lang/SecurityException;

    const-string v9, "killPids only available to the system"

    invoke-direct {v8, v9}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v8

    .line 8527
    :cond_0
    if-nez p2, :cond_2

    const-string v8, "Unknown"

    move-object v4, v8

    .line 8531
    .local v4, reason:Ljava/lang/String;
    :goto_0
    const/4 v2, 0x0

    .line 8532
    .local v2, killed:Z
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v8

    .line 8533
    :try_start_0
    array-length v9, p1

    new-array v6, v9, [I

    .line 8534
    .local v6, types:[I
    const/4 v7, 0x0

    .line 8535
    .local v7, worstType:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_1
    array-length v9, p1

    if-ge v1, v9, :cond_3

    .line 8536
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    aget v10, p1, v1

    invoke-virtual {v9, v10}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 8537
    .local v3, proc:Lcom/android/server/am/ProcessRecord;
    if-eqz v3, :cond_1

    .line 8538
    iget v5, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    .line 8539
    .local v5, type:I
    aput v5, v6, v1

    .line 8540
    if-le v5, v7, :cond_1

    .line 8541
    move v7, v5

    .line 8535
    .end local v5           #type:I
    :cond_1
    add-int/lit8 v1, v1, 0x1

    goto :goto_1

    .end local v1           #i:I
    .end local v2           #killed:Z
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v4           #reason:Ljava/lang/String;
    .end local v6           #types:[I
    .end local v7           #worstType:I
    :cond_2
    move-object v4, p2

    .line 8527
    goto :goto_0

    .line 8548
    .restart local v1       #i:I
    .restart local v2       #killed:Z
    .restart local v4       #reason:Ljava/lang/String;
    .restart local v6       #types:[I
    .restart local v7       #worstType:I
    :cond_3
    sget v9, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    if-ge v7, v9, :cond_4

    sget v9, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-le v7, v9, :cond_4

    .line 8549
    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    .line 8551
    :cond_4
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Killing processes "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " at adjustment "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8552
    const/4 v1, 0x0

    :goto_2
    array-length v9, p1

    if-ge v1, v9, :cond_7

    .line 8553
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    aget v10, p1, v1

    invoke-virtual {v9, v10}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 8554
    .restart local v3       #proc:Lcom/android/server/am/ProcessRecord;
    if-nez v3, :cond_6

    .line 8552
    :cond_5
    :goto_3
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .line 8557
    :cond_6
    iget v0, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    .line 8558
    .local v0, adj:I
    if-lt v0, v7, :cond_5

    iget-boolean v9, v3, Lcom/android/server/am/ProcessRecord;->killedBackground:Z

    if-nez v9, :cond_5

    .line 8559
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Killing "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " (adj "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, "): "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8560
    const/16 v9, 0x7547

    const/4 v10, 0x4

    new-array v10, v10, [Ljava/lang/Object;

    const/4 v11, 0x0

    iget v12, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v10, v11

    const/4 v11, 0x1

    iget-object v12, v3, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v12, v10, v11

    const/4 v11, 0x2

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v10, v11

    const/4 v11, 0x3

    aput-object v4, v10, v11

    invoke-static {v9, v10}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 8562
    const/4 v2, 0x1

    .line 8563
    const/4 v9, 0x1

    iput-boolean v9, v3, Lcom/android/server/am/ProcessRecord;->killedBackground:Z

    .line 8564
    aget v9, p1, v1

    invoke-static {v9}, Landroid/os/Process;->killProcessQuiet(I)V

    goto :goto_3

    .line 8567
    .end local v0           #adj:I
    .end local v1           #i:I
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v6           #types:[I
    .end local v7           #worstType:I
    :catchall_0
    move-exception v9

    monitor-exit v8
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v9

    .restart local v1       #i:I
    .restart local v6       #types:[I
    .restart local v7       #worstType:I
    :cond_7
    :try_start_1
    monitor-exit v8
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8568
    return v2
.end method

.method makeRunningServiceInfoLocked(Lcom/android/server/am/ServiceRecord;)Landroid/app/ActivityManager$RunningServiceInfo;
    .locals 5
    .parameter "r"

    .prologue
    .line 10716
    new-instance v2, Landroid/app/ActivityManager$RunningServiceInfo;

    invoke-direct {v2}, Landroid/app/ActivityManager$RunningServiceInfo;-><init>()V

    .line 10718
    .local v2, info:Landroid/app/ActivityManager$RunningServiceInfo;
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    iput-object v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->service:Landroid/content/ComponentName;

    .line 10719
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_0

    .line 10720
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v3, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->pid:I

    .line 10722
    :cond_0
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->uid:I

    .line 10723
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    iput-object v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->process:Ljava/lang/String;

    .line 10724
    iget-boolean v3, p1, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    iput-boolean v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->foreground:Z

    .line 10725
    iget-wide v3, p1, Lcom/android/server/am/ServiceRecord;->createTime:J

    iput-wide v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->activeSince:J

    .line 10726
    iget-boolean v3, p1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    iput-boolean v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->started:Z

    .line 10727
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v3}, Ljava/util/HashMap;->size()I

    move-result v3

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->clientCount:I

    .line 10728
    iget v3, p1, Lcom/android/server/am/ServiceRecord;->crashCount:I

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->crashCount:I

    .line 10729
    iget-wide v3, p1, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    iput-wide v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->lastActivityTime:J

    .line 10730
    iget-boolean v3, p1, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    if-eqz v3, :cond_1

    .line 10731
    iget v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    or-int/lit8 v3, v3, 0x2

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    .line 10733
    :cond_1
    iget-boolean v3, p1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    if-eqz v3, :cond_2

    .line 10734
    iget v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    or-int/lit8 v3, v3, 0x1

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    .line 10736
    :cond_2
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_3

    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v3, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    sget v4, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne v3, v4, :cond_3

    .line 10737
    iget v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    or-int/lit8 v3, v3, 0x4

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    .line 10739
    :cond_3
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4

    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-boolean v3, v3, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v3, :cond_4

    .line 10740
    iget v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    or-int/lit8 v3, v3, 0x8

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->flags:I

    .line 10742
    :cond_4
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .local v1, i$:Ljava/util/Iterator;
    :cond_5
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_6

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ConnectionRecord;

    .line 10743
    .local v0, conn:Lcom/android/server/am/ConnectionRecord;
    iget v3, v0, Lcom/android/server/am/ConnectionRecord;->clientLabel:I

    if-eqz v3, :cond_5

    .line 10744
    iget-object v3, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v3, v3, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->clientPackage:Ljava/lang/String;

    .line 10745
    iget v3, v0, Lcom/android/server/am/ConnectionRecord;->clientLabel:I

    iput v3, v2, Landroid/app/ActivityManager$RunningServiceInfo;->clientLabel:I

    .line 10749
    .end local v0           #conn:Lcom/android/server/am/ConnectionRecord;
    :cond_6
    return-object v2
.end method

.method public monitor()V
    .locals 1

    .prologue
    .line 14671
    monitor-enter p0

    :try_start_0
    monitor-exit p0

    .line 14672
    return-void

    .line 14671
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public moveActivityTaskToBack(Landroid/os/IBinder;Z)Z
    .locals 5
    .parameter "token"
    .parameter "nonRoot"

    .prologue
    const/4 v4, 0x0

    .line 7436
    monitor-enter p0

    .line 7437
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7438
    .local v0, origId:J
    if-nez p2, :cond_0

    const/4 v3, 0x1

    :goto_0
    invoke-virtual {p0, p1, v3}, Lcom/android/server/am/ActivityManagerService;->getTaskForActivityLocked(Landroid/os/IBinder;Z)I

    move-result v2

    .line 7439
    .local v2, taskId:I
    if-ltz v2, :cond_1

    .line 7440
    const/4 v3, 0x0

    invoke-direct {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->moveTaskToBackLocked(ILcom/android/server/am/HistoryRecord;)Z

    move-result v3

    monitor-exit p0

    .line 7444
    :goto_1
    return v3

    .end local v2           #taskId:I
    :cond_0
    move v3, v4

    .line 7438
    goto :goto_0

    .line 7442
    .restart local v2       #taskId:I
    :cond_1
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7443
    monitor-exit p0

    move v3, v4

    .line 7444
    goto :goto_1

    .line 7443
    .end local v0           #origId:J
    .end local v2           #taskId:I
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3
.end method

.method public moveTaskBackwards(I)V
    .locals 5
    .parameter "task"

    .prologue
    .line 7528
    const-string v2, "android.permission.REORDER_TASKS"

    const-string v3, "moveTaskBackwards()"

    invoke-virtual {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7531
    monitor-enter p0

    .line 7532
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    const-string v4, "Task backwards"

    invoke-virtual {p0, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v2

    if-nez v2, :cond_0

    .line 7534
    monitor-exit p0

    .line 7540
    :goto_0
    return-void

    .line 7536
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7537
    .local v0, origId:J
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->moveTaskBackwardsLocked(I)V

    .line 7538
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7539
    monitor-exit p0

    goto :goto_0

    .end local v0           #origId:J
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public moveTaskToBack(I)V
    .locals 5
    .parameter "task"

    .prologue
    .line 7410
    const-string v2, "android.permission.REORDER_TASKS"

    const-string v3, "moveTaskToBack()"

    invoke-virtual {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7413
    monitor-enter p0

    .line 7414
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v2, :cond_0

    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v2, v2, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v2, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v2, p1, :cond_0

    .line 7415
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    const-string v4, "Task to back"

    invoke-virtual {p0, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v2

    if-nez v2, :cond_0

    .line 7417
    monitor-exit p0

    .line 7424
    :goto_0
    return-void

    .line 7420
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7421
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->moveTaskToBackLocked(ILcom/android/server/am/HistoryRecord;)Z

    .line 7422
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7423
    monitor-exit p0

    goto :goto_0

    .end local v0           #origId:J
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public moveTaskToFront(I)V
    .locals 9
    .parameter "task"

    .prologue
    .line 7313
    const-string v6, "android.permission.REORDER_TASKS"

    const-string v7, "moveTaskToFront()"

    invoke-virtual {p0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7316
    monitor-enter p0

    .line 7317
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    const-string v8, "Task to front"

    invoke-virtual {p0, v6, v7, v8}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v6

    if-nez v6, :cond_0

    .line 7319
    monitor-exit p0

    .line 7342
    :goto_0
    return-void

    .line 7321
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result-wide v3

    .line 7323
    .local v3, origId:J
    :try_start_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7324
    .local v0, N:I
    const/4 v2, 0x0

    .local v2, i:I
    :goto_1
    if-ge v2, v0, :cond_2

    .line 7325
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/TaskRecord;

    .line 7326
    .local v5, tr:Lcom/android/server/am/TaskRecord;
    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, p1, :cond_1

    .line 7327
    const/4 v6, 0x0

    invoke-direct {p0, v5, v6}, Lcom/android/server/am/ActivityManagerService;->moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;Lcom/android/server/am/HistoryRecord;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 7339
    :try_start_2
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    monitor-exit p0

    goto :goto_0

    .line 7341
    .end local v0           #N:I
    .end local v2           #i:I
    .end local v3           #origId:J
    .end local v5           #tr:Lcom/android/server/am/TaskRecord;
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v6

    .line 7324
    .restart local v0       #N:I
    .restart local v2       #i:I
    .restart local v3       #origId:J
    .restart local v5       #tr:Lcom/android/server/am/TaskRecord;
    :cond_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_1

    .line 7331
    .end local v5           #tr:Lcom/android/server/am/TaskRecord;
    :cond_2
    :try_start_3
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x1

    sub-int v2, v6, v7

    :goto_2
    if-ltz v2, :cond_4

    .line 7332
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 7333
    .local v1, hr:Lcom/android/server/am/HistoryRecord;
    iget-object v6, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, p1, :cond_3

    .line 7334
    iget-object v6, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    const/4 v7, 0x0

    invoke-direct {p0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;Lcom/android/server/am/HistoryRecord;)V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 7339
    :try_start_4
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    monitor-exit p0

    goto :goto_0

    .line 7331
    :cond_3
    add-int/lit8 v2, v2, -0x1

    goto :goto_2

    .line 7339
    .end local v1           #hr:Lcom/android/server/am/HistoryRecord;
    :cond_4
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7341
    monitor-exit p0

    goto :goto_0

    .line 7339
    .end local v0           #N:I
    .end local v2           #i:I
    :catchall_1
    move-exception v6

    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v6
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0
.end method

.method final newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;
    .locals 4
    .parameter "thread"
    .parameter "info"
    .parameter "customProcess"

    .prologue
    .line 8188
    if-eqz p3, :cond_0

    move-object v0, p3

    .line 8189
    .local v0, proc:Ljava/lang/String;
    :goto_0
    const/4 v1, 0x0

    .line 8190
    .local v1, ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v3}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v2

    .line 8191
    .local v2, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v2

    .line 8192
    :try_start_0
    iget v3, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v0}, Lcom/android/internal/os/BatteryStatsImpl;->getProcessStatsLocked(ILjava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-result-object v1

    .line 8193
    monitor-exit v2
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 8194
    new-instance v3, Lcom/android/server/am/ProcessRecord;

    invoke-direct {v3, v1, p1, p2, v0}, Lcom/android/server/am/ProcessRecord;-><init>(Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)V

    return-object v3

    .line 8188
    .end local v0           #proc:Ljava/lang/String;
    .end local v1           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    .end local v2           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :cond_0
    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    move-object v0, v3

    goto :goto_0

    .line 8193
    .restart local v0       #proc:Ljava/lang/String;
    .restart local v1       #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    .restart local v2       #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catchall_0
    move-exception v3

    :try_start_1
    monitor-exit v2
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v3
.end method

.method public noteWakeupAlarm(Landroid/content/IIntentSender;)V
    .locals 7
    .parameter "sender"

    .prologue
    .line 8506
    instance-of v6, p1, Lcom/android/server/am/PendingIntentRecord;

    if-nez v6, :cond_0

    .line 8521
    :goto_0
    return-void

    .line 8509
    :cond_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    .line 8510
    .local v4, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v4

    .line 8511
    :try_start_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->isOnBattery()Z

    move-result v6

    if-eqz v6, :cond_1

    .line 8512
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->enforceCallingPermission()V

    .line 8513
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v3, v0

    .line 8514
    .local v3, rec:Lcom/android/server/am/PendingIntentRecord;
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    .line 8515
    .local v1, MY_UID:I
    iget v6, v3, Lcom/android/server/am/PendingIntentRecord;->uid:I

    if-ne v6, v1, :cond_2

    const/16 v6, 0x3e8

    move v5, v6

    .line 8516
    .local v5, uid:I
    :goto_1
    iget-object v6, v3, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v6, v6, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5, v6}, Lcom/android/internal/os/BatteryStatsImpl;->getPackageStatsLocked(ILjava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;

    move-result-object v2

    .line 8518
    .local v2, pkg:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;
    invoke-virtual {v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;->incWakeupsLocked()V

    .line 8520
    .end local v1           #MY_UID:I
    .end local v2           #pkg:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;
    .end local v3           #rec:Lcom/android/server/am/PendingIntentRecord;
    .end local v5           #uid:I
    :cond_1
    monitor-exit v4

    goto :goto_0

    :catchall_0
    move-exception v6

    monitor-exit v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v6

    .line 8515
    .restart local v1       #MY_UID:I
    .restart local v3       #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_2
    :try_start_1
    iget v6, v3, Lcom/android/server/am/PendingIntentRecord;->uid:I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    move v5, v6

    goto :goto_1
.end method

.method public onTransact(ILandroid/os/Parcel;Landroid/os/Parcel;I)Z
    .locals 3
    .parameter "code"
    .parameter "data"
    .parameter "reply"
    .parameter "flags"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 1480
    :try_start_0
    invoke-super {p0, p1, p2, p3, p4}, Landroid/app/ActivityManagerNative;->onTransact(ILandroid/os/Parcel;Landroid/os/Parcel;I)Z
    :try_end_0
    .catch Ljava/lang/RuntimeException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v1

    return v1

    .line 1481
    :catch_0
    move-exception v0

    .line 1484
    .local v0, e:Ljava/lang/RuntimeException;
    instance-of v1, v0, Ljava/lang/SecurityException;

    if-nez v1, :cond_0

    .line 1485
    const-string v1, "ActivityManager"

    const-string v2, "Activity Manager Crash"

    invoke-static {v1, v2, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1487
    :cond_0
    throw v0
.end method

.method public openContentUri(Landroid/net/Uri;)Landroid/os/ParcelFileDescriptor;
    .locals 7
    .parameter "uri"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 8237
    invoke-virtual {p1}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v1

    .line 8238
    .local v1, name:Ljava/lang/String;
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->getContentProviderExternal(Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;

    move-result-object v0

    .line 8239
    .local v0, cph:Landroid/app/IActivityManager$ContentProviderHolder;
    const/4 v2, 0x0

    .line 8240
    .local v2, pfd:Landroid/os/ParcelFileDescriptor;
    if-eqz v0, :cond_0

    .line 8248
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    new-instance v4, Lcom/android/server/am/ActivityManagerService$Identity;

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-direct {v4, p0, v5, v6}, Lcom/android/server/am/ActivityManagerService$Identity;-><init>(Lcom/android/server/am/ActivityManagerService;II)V

    invoke-virtual {v3, v4}, Ljava/lang/ThreadLocal;->set(Ljava/lang/Object;)V

    .line 8251
    :try_start_0
    iget-object v3, v0, Landroid/app/IActivityManager$ContentProviderHolder;->provider:Landroid/content/IContentProvider;

    const-string v4, "r"

    invoke-interface {v3, p1, v4}, Landroid/content/IContentProvider;->openFile(Landroid/net/Uri;Ljava/lang/String;)Landroid/os/ParcelFileDescriptor;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Ljava/io/FileNotFoundException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v2

    .line 8256
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v3}, Ljava/lang/ThreadLocal;->remove()V

    .line 8260
    :goto_0
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->removeContentProviderExternal(Ljava/lang/String;)V

    .line 8264
    :goto_1
    return-object v2

    .line 8252
    :catch_0
    move-exception v3

    .line 8256
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v3}, Ljava/lang/ThreadLocal;->remove()V

    goto :goto_0

    :catchall_0
    move-exception v3

    sget-object v4, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v4}, Ljava/lang/ThreadLocal;->remove()V

    throw v3

    .line 8262
    :cond_0
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Failed to get provider for authority \'"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\'"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_1
.end method

.method public overridePendingTransition(Landroid/os/IBinder;Ljava/lang/String;II)V
    .locals 6
    .parameter "token"
    .parameter "packageName"
    .parameter "enterAnim"
    .parameter "exitAnim"

    .prologue
    .line 4394
    monitor-enter p0

    .line 4395
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 4396
    .local v0, index:I
    if-gez v0, :cond_0

    .line 4397
    monitor-exit p0

    .line 4411
    :goto_0
    return-void

    .line 4399
    :cond_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 4401
    .local v3, self:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 4403
    .local v1, origId:J
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v4, v5, :cond_1

    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v4, v5, :cond_2

    .line 4405
    :cond_1
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v4, p2, p3, p4}, Lcom/android/server/WindowManagerService;->overridePendingAppTransition(Ljava/lang/String;II)V

    .line 4409
    :cond_2
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4410
    monitor-exit p0

    goto :goto_0

    .end local v0           #index:I
    .end local v1           #origId:J
    .end local v3           #self:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4
.end method

.method pauseIfSleepingLocked()V
    .locals 2

    .prologue
    .line 8318
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v0, :cond_0

    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-eqz v0, :cond_2

    .line 8319
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v0

    if-nez v0, :cond_1

    .line 8320
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->acquire()V

    .line 8321
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v0

    if-eqz v0, :cond_1

    .line 8322
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 8323
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v1, 0x10

    invoke-virtual {v0, v1}, Landroid/os/Handler;->removeMessages(I)V

    .line 8330
    :cond_1
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-nez v0, :cond_2

    .line 8333
    const/4 v0, 0x0

    const/4 v1, 0x1

    invoke-direct {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->startPausingLocked(ZZ)V

    .line 8336
    :cond_2
    return-void
.end method

.method public peekService(Landroid/content/Intent;Ljava/lang/String;)Landroid/os/IBinder;
    .locals 6
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    .line 11497
    if-eqz p1, :cond_0

    invoke-virtual {p1}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v3

    const/4 v4, 0x1

    if-ne v3, v4, :cond_0

    .line 11498
    new-instance v3, Ljava/lang/IllegalArgumentException;

    const-string v4, "File descriptors passed in Intent"

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 11501
    :cond_0
    const/4 v2, 0x0

    .line 11503
    .local v2, ret:Landroid/os/IBinder;
    monitor-enter p0

    .line 11504
    :try_start_0
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/Intent;Ljava/lang/String;)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v1

    .line 11506
    .local v1, r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-eqz v1, :cond_2

    .line 11508
    iget-object v3, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    if-nez v3, :cond_1

    .line 11509
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Permission Denial: Accessing service "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v5, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " from pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ", uid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " requires "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->permission:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 11520
    .end local v1           #r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3

    .line 11515
    .restart local v1       #r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    :cond_1
    :try_start_1
    iget-object v3, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v3, v3, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v3, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/IntentBindRecord;

    .line 11516
    .local v0, ib:Lcom/android/server/am/IntentBindRecord;
    if-eqz v0, :cond_2

    .line 11517
    iget-object v2, v0, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    .line 11520
    .end local v0           #ib:Lcom/android/server/am/IntentBindRecord;
    :cond_2
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 11522
    return-object v2
.end method

.method final performAppGcLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 2
    .parameter "app"

    .prologue
    .line 14097
    :try_start_0
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    .line 14098
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_0

    .line 14099
    iget-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    if-eqz v0, :cond_1

    .line 14100
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    .line 14101
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0}, Landroid/app/IApplicationThread;->scheduleLowMemory()V

    .line 14109
    :cond_0
    :goto_0
    return-void

    .line 14103
    :cond_1
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0}, Landroid/app/IApplicationThread;->processInBackground()V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 14106
    :catch_0
    move-exception v0

    goto :goto_0
.end method

.method final performAppGcsIfAppropriateLocked()V
    .locals 1

    .prologue
    .line 14158
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->canGcNowLocked()Z

    move-result v0

    if-eqz v0, :cond_0

    .line 14159
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->performAppGcsLocked()V

    .line 14164
    :goto_0
    return-void

    .line 14163
    :cond_0
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_0
.end method

.method final performAppGcsLocked()V
    .locals 6

    .prologue
    .line 14126
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 14127
    .local v0, N:I
    if-gtz v0, :cond_1

    .line 14152
    :cond_0
    :goto_0
    return-void

    .line 14130
    :cond_1
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->canGcNowLocked()Z

    move-result v2

    if-eqz v2, :cond_0

    .line 14131
    :cond_2
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    if-lez v2, :cond_5

    .line 14132
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    const/4 v3, 0x0

    invoke-virtual {v2, v3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14133
    .local v1, proc:Lcom/android/server/am/ProcessRecord;
    iget v2, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    sget v3, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-gt v2, v3, :cond_3

    iget-boolean v2, v1, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    if-eqz v2, :cond_2

    .line 14134
    :cond_3
    iget-wide v2, v1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    const-wide/32 v4, 0xea60

    add-long/2addr v2, v4

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v4

    cmp-long v2, v2, v4

    if-gtz v2, :cond_4

    .line 14138
    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->performAppGcLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 14139
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_0

    .line 14144
    :cond_4
    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 14150
    .end local v1           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_5
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_0
.end method

.method final performServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)V
    .locals 2
    .parameter "r"

    .prologue
    .line 11183
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_0

    .line 11187
    :goto_0
    return-void

    .line 11186
    :cond_0
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v0}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v0

    invoke-virtual {v0}, Landroid/content/Intent;->getFlags()I

    move-result v0

    const/4 v1, 0x1

    invoke-direct {p0, p1, v0, v1}, Lcom/android/server/am/ActivityManagerService;->bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z

    goto :goto_0
.end method

.method final processStoppingActivitiesLocked(Z)Ljava/util/ArrayList;
    .locals 7
    .parameter "remove"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(Z)",
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/HistoryRecord;",
            ">;"
        }
    .end annotation

    .prologue
    const/4 v6, 0x0

    .line 5693
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 5694
    .local v0, N:I
    if-gtz v0, :cond_0

    const/4 v5, 0x0

    .line 5731
    :goto_0
    return-object v5

    .line 5696
    :cond_0
    const/4 v4, 0x0

    .line 5698
    .local v4, stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_4

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-boolean v5, v5, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-eqz v5, :cond_4

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-boolean v5, v5, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-nez v5, :cond_4

    const/4 v5, 0x1

    move v2, v5

    .line 5701
    .local v2, nowVisible:Z
    :goto_1
    const/4 v1, 0x0

    .local v1, i:I
    :goto_2
    if-ge v1, v0, :cond_5

    .line 5702
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 5706
    .local v3, s:Lcom/android/server/am/HistoryRecord;
    iget-boolean v5, v3, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-eqz v5, :cond_1

    if-eqz v2, :cond_1

    .line 5707
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5708
    iput-boolean v6, v3, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    .line 5709
    iget-boolean v5, v3, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_1

    .line 5716
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v5, v3, v6}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 5719
    :cond_1
    iget-boolean v5, v3, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-nez v5, :cond_3

    if-eqz p1, :cond_3

    .line 5721
    if-nez v4, :cond_2

    .line 5722
    new-instance v4, Ljava/util/ArrayList;

    .end local v4           #stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    .line 5724
    .restart local v4       #stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :cond_2
    invoke-virtual {v4, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 5725
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 5726
    add-int/lit8 v0, v0, -0x1

    .line 5727
    add-int/lit8 v1, v1, -0x1

    .line 5701
    :cond_3
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .end local v1           #i:I
    .end local v2           #nowVisible:Z
    .end local v3           #s:Lcom/android/server/am/HistoryRecord;
    :cond_4
    move v2, v6

    .line 5698
    goto :goto_1

    .restart local v1       #i:I
    .restart local v2       #nowVisible:Z
    :cond_5
    move-object v5, v4

    .line 5731
    goto :goto_0
.end method

.method public profileControl(Ljava/lang/String;ZLjava/lang/String;Landroid/os/ParcelFileDescriptor;)Z
    .locals 10
    .parameter "process"
    .parameter "start"
    .parameter "path"
    .parameter "fd"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 14611
    :try_start_0
    monitor-enter p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 14614
    :try_start_1
    const-string v7, "android.permission.SET_ACTIVITY_WATCHER"

    invoke-virtual {p0, v7}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v7

    if-eqz v7, :cond_1

    .line 14616
    new-instance v7, Ljava/lang/SecurityException;

    const-string v8, "Requires permission android.permission.SET_ACTIVITY_WATCHER"

    invoke-direct {v7, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 14656
    :catchall_0
    move-exception v7

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    :try_start_2
    throw v7
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 14657
    :catch_0
    move-exception v7

    move-object v2, v7

    .line 14658
    .local v2, e:Landroid/os/RemoteException;
    :try_start_3
    new-instance v7, Ljava/lang/IllegalStateException;

    const-string v8, "Process disappeared"

    invoke-direct {v7, v8}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v7
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 14660
    .end local v2           #e:Landroid/os/RemoteException;
    :catchall_1
    move-exception v7

    if-eqz p4, :cond_0

    .line 14662
    :try_start_4
    invoke-virtual {p4}, Landroid/os/ParcelFileDescriptor;->close()V
    :try_end_4
    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_3

    .line 14664
    :cond_0
    :goto_0
    throw v7

    .line 14620
    :cond_1
    if-eqz p2, :cond_2

    if-nez p4, :cond_2

    .line 14621
    :try_start_5
    new-instance v7, Ljava/lang/IllegalArgumentException;

    const-string v8, "null fd"

    invoke-direct {v7, v8}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v7
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 14624
    :cond_2
    const/4 v5, 0x0

    .line 14626
    .local v5, proc:Lcom/android/server/am/ProcessRecord;
    :try_start_6
    invoke-static {p1}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I

    move-result v4

    .line 14627
    .local v4, pid:I
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v8
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0
    .catch Ljava/lang/NumberFormatException; {:try_start_6 .. :try_end_6} :catch_1

    .line 14628
    :try_start_7
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v7, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v7

    move-object v0, v7

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    .line 14629
    monitor-exit v8
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_2

    .line 14633
    .end local v4           #pid:I
    :goto_1
    if-nez v5, :cond_3

    .line 14634
    :try_start_8
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v7}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v1

    .line 14636
    .local v1, all:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;>;"
    invoke-virtual {v1, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/util/SparseArray;

    .line 14637
    .local v6, procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    if-eqz v6, :cond_3

    invoke-virtual {v6}, Landroid/util/SparseArray;->size()I

    move-result v7

    if-lez v7, :cond_3

    .line 14638
    const/4 v7, 0x0

    invoke-virtual {v6, v7}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #proc:Lcom/android/server/am/ProcessRecord;
    check-cast v5, Lcom/android/server/am/ProcessRecord;

    .line 14642
    .end local v1           #all:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;>;"
    .end local v6           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v5       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_3
    if-eqz v5, :cond_4

    iget-object v7, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v7, :cond_5

    .line 14643
    :cond_4
    new-instance v7, Ljava/lang/IllegalArgumentException;

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Unknown process: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-direct {v7, v8}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v7
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_0

    .line 14629
    .restart local v4       #pid:I
    :catchall_2
    move-exception v7

    :try_start_9
    monitor-exit v8
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_2

    :try_start_a
    throw v7
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_0
    .catch Ljava/lang/NumberFormatException; {:try_start_a .. :try_end_a} :catch_1

    .line 14630
    .end local v4           #pid:I
    :catch_1
    move-exception v7

    goto :goto_1

    .line 14646
    :cond_5
    :try_start_b
    const-string v7, "1"

    const-string v8, "ro.secure"

    const-string v9, "0"

    invoke-static {v8, v9}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    .line 14647
    .local v3, isSecure:Z
    if-eqz v3, :cond_6

    .line 14648
    iget-object v7, v5, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v7, v7, 0x2

    if-nez v7, :cond_6

    .line 14649
    new-instance v7, Ljava/lang/SecurityException;

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Process not debuggable: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-direct {v7, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 14653
    :cond_6
    iget-object v7, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v7, p2, p3, p4}, Landroid/app/IApplicationThread;->profilerControl(ZLjava/lang/String;Landroid/os/ParcelFileDescriptor;)V

    .line 14654
    const/4 p4, 0x0

    .line 14655
    const/4 v7, 0x1

    monitor-exit p0
    :try_end_b
    .catchall {:try_start_b .. :try_end_b} :catchall_0

    .line 14660
    if-eqz p4, :cond_7

    .line 14662
    :try_start_c
    throw p4
    :try_end_c
    .catch Ljava/io/IOException; {:try_start_c .. :try_end_c} :catch_2

    .line 14664
    :cond_7
    :goto_2
    return v7

    .line 14663
    :catch_2
    move-exception v8

    goto :goto_2

    .end local v3           #isSecure:Z
    .end local v5           #proc:Lcom/android/server/am/ProcessRecord;
    :catch_3
    move-exception v8

    goto/16 :goto_0
.end method

.method public final publishContentProviders(Landroid/app/IApplicationThread;Ljava/util/List;)V
    .locals 13
    .parameter "caller"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/app/IApplicationThread;",
            "Ljava/util/List",
            "<",
            "Landroid/app/IActivityManager$ContentProviderHolder;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 8109
    .local p2, providers:Ljava/util/List;,"Ljava/util/List<Landroid/app/IActivityManager$ContentProviderHolder;>;"
    if-nez p2, :cond_0

    .line 8159
    :goto_0
    return-void

    .line 8113
    :cond_0
    monitor-enter p0

    .line 8114
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v8

    .line 8115
    .local v8, r:Lcom/android/server/am/ProcessRecord;
    if-nez v8, :cond_1

    .line 8116
    new-instance v10, Ljava/lang/SecurityException;

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Unable to find app for caller "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " (pid="

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v12

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ") when publishing content providers"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-direct {v10, v11}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v10

    .line 8158
    .end local v8           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v10

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v10

    .line 8122
    .restart local v8       #r:Lcom/android/server/am/ProcessRecord;
    :cond_1
    :try_start_1
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 8124
    .local v6, origId:J
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result v0

    .line 8125
    .local v0, N:I
    const/4 v3, 0x0

    .local v3, i:I
    :goto_1
    if-ge v3, v0, :cond_7

    .line 8126
    invoke-interface {p2, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Landroid/app/IActivityManager$ContentProviderHolder;

    .line 8127
    .local v9, src:Landroid/app/IActivityManager$ContentProviderHolder;
    if-eqz v9, :cond_2

    iget-object v10, v9, Landroid/app/IActivityManager$ContentProviderHolder;->info:Landroid/content/pm/ProviderInfo;

    if-eqz v10, :cond_2

    iget-object v10, v9, Landroid/app/IActivityManager$ContentProviderHolder;->provider:Landroid/content/IContentProvider;

    if-nez v10, :cond_3

    .line 8125
    :cond_2
    :goto_2
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    .line 8130
    :cond_3
    iget-object v10, v8, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    iget-object v11, v9, Landroid/app/IActivityManager$ContentProviderHolder;->info:Landroid/content/pm/ProviderInfo;

    iget-object v11, v11, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 8132
    .local v2, dst:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v2, :cond_2

    .line 8133
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v11, v2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v11, v11, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v10, v11, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8134
    iget-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v10, v10, Landroid/content/pm/ProviderInfo;->authority:Ljava/lang/String;

    const-string v11, ";"

    invoke-virtual {v10, v11}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v5

    .line 8135
    .local v5, names:[Ljava/lang/String;
    const/4 v4, 0x0

    .local v4, j:I
    :goto_3
    array-length v10, v5

    if-ge v4, v10, :cond_4

    .line 8136
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    aget-object v11, v5, v4

    invoke-virtual {v10, v11, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8135
    add-int/lit8 v4, v4, 0x1

    goto :goto_3

    .line 8139
    :cond_4
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 8141
    .local v1, NL:I
    const/4 v4, 0x0

    :goto_4
    if-ge v4, v1, :cond_6

    .line 8142
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v10, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v10

    if-ne v10, v2, :cond_5

    .line 8143
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v10, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 8144
    add-int/lit8 v4, v4, -0x1

    .line 8145
    add-int/lit8 v1, v1, -0x1

    .line 8141
    :cond_5
    add-int/lit8 v4, v4, 0x1

    goto :goto_4

    .line 8148
    :cond_6
    monitor-enter v2
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8149
    :try_start_2
    iget-object v10, v9, Landroid/app/IActivityManager$ContentProviderHolder;->provider:Landroid/content/IContentProvider;

    iput-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    .line 8150
    iput-object v8, v2, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 8151
    invoke-virtual {v2}, Ljava/lang/Object;->notifyAll()V

    .line 8152
    monitor-exit v2
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 8153
    :try_start_3
    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_2

    .line 8152
    :catchall_1
    move-exception v10

    :try_start_4
    monitor-exit v2
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    :try_start_5
    throw v10

    .line 8157
    .end local v1           #NL:I
    .end local v2           #dst:Lcom/android/server/am/ContentProviderRecord;
    .end local v4           #j:I
    .end local v5           #names:[Ljava/lang/String;
    .end local v9           #src:Landroid/app/IActivityManager$ContentProviderHolder;
    :cond_7
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8158
    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    goto/16 :goto_0
.end method

.method public publishService(Landroid/os/IBinder;Landroid/content/Intent;Landroid/os/IBinder;)V
    .locals 12
    .parameter "token"
    .parameter "intent"
    .parameter "service"

    .prologue
    const/4 v10, 0x1

    .line 11832
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v9

    if-ne v9, v10, :cond_0

    .line 11833
    new-instance v9, Ljava/lang/IllegalArgumentException;

    const-string v10, "File descriptors passed in Intent"

    invoke-direct {v9, v10}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v9

    .line 11836
    :cond_0
    monitor-enter p0

    .line 11837
    :try_start_0
    instance-of v9, p1, Lcom/android/server/am/ServiceRecord;

    if-nez v9, :cond_1

    .line 11838
    new-instance v9, Ljava/lang/IllegalArgumentException;

    const-string v10, "Invalid service token"

    invoke-direct {v9, v10}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v9

    .line 11884
    :catchall_0
    move-exception v9

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v9

    .line 11840
    :cond_1
    :try_start_1
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v8, v0

    .line 11842
    .local v8, r:Lcom/android/server/am/ServiceRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 11846
    .local v6, origId:J
    if-eqz v8, :cond_4

    .line 11847
    new-instance v4, Landroid/content/Intent$FilterComparison;

    invoke-direct {v4, p2}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 11849
    .local v4, filter:Landroid/content/Intent$FilterComparison;
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v9, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/IntentBindRecord;

    .line 11850
    .local v1, b:Lcom/android/server/am/IntentBindRecord;
    if-eqz v1, :cond_3

    iget-boolean v9, v1, Lcom/android/server/am/IntentBindRecord;->received:Z

    if-nez v9, :cond_3

    .line 11851
    iput-object p3, v1, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    .line 11852
    const/4 v9, 0x1

    iput-boolean v9, v1, Lcom/android/server/am/IntentBindRecord;->requested:Z

    .line 11853
    const/4 v9, 0x1

    iput-boolean v9, v1, Lcom/android/server/am/IntentBindRecord;->received:Z

    .line 11854
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_3

    .line 11855
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .line 11857
    .local v5, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_2
    :goto_0
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_3

    .line 11858
    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ConnectionRecord;

    .line 11859
    .local v2, c:Lcom/android/server/am/ConnectionRecord;
    iget-object v9, v2, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v9, v9, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v9, v9, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v4, v9}, Landroid/content/Intent$FilterComparison;->equals(Ljava/lang/Object;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    move-result v9

    if-eqz v9, :cond_2

    .line 11870
    :try_start_2
    iget-object v9, v2, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    iget-object v10, v8, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-interface {v9, v10, p3}, Landroid/app/IServiceConnection;->connected(Landroid/content/ComponentName;Landroid/os/IBinder;)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0

    goto :goto_0

    .line 11871
    :catch_0
    move-exception v9

    move-object v3, v9

    .line 11872
    .local v3, e:Ljava/lang/Exception;
    :try_start_3
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Failure sending service "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget-object v11, v8, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " to connection "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget-object v11, v2, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v11}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v11

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " (in "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget-object v11, v2, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v11, v11, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v11, v11, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, ")"

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_0

    .line 11880
    .end local v2           #c:Lcom/android/server/am/ConnectionRecord;
    .end local v3           #e:Ljava/lang/Exception;
    .end local v5           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_3
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9, v8}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v9

    invoke-virtual {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11882
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11884
    .end local v1           #b:Lcom/android/server/am/IntentBindRecord;
    .end local v4           #filter:Landroid/content/Intent$FilterComparison;
    :cond_4
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 11885
    return-void
.end method

.method public registerActivityWatcher(Landroid/app/IActivityWatcher;)V
    .locals 1
    .parameter "watcher"

    .prologue
    .line 8468
    monitor-enter p0

    .line 8469
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v0, p1}, Landroid/os/RemoteCallbackList;->register(Landroid/os/IInterface;)Z

    .line 8470
    monitor-exit p0

    .line 8471
    return-void

    .line 8470
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public registerReceiver(Landroid/app/IApplicationThread;Landroid/content/IIntentReceiver;Landroid/content/IntentFilter;Ljava/lang/String;)Landroid/content/Intent;
    .locals 30
    .parameter "caller"
    .parameter "receiver"
    .parameter "filter"
    .parameter "permission"

    .prologue
    .line 12208
    monitor-enter p0

    .line 12209
    const/4 v6, 0x0

    .line 12210
    .local v6, callerApp:Lcom/android/server/am/ProcessRecord;
    if-eqz p1, :cond_0

    .line 12211
    :try_start_0
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v6

    .line 12212
    if-nez v6, :cond_0

    .line 12213
    new-instance v5, Ljava/lang/SecurityException;

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to find app for caller "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " (pid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ") when registering receiver "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v5, v7}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 12289
    .end local p1
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 12220
    .restart local p1
    :cond_0
    const/16 v25, 0x0

    .line 12223
    .local v25, allSticky:Ljava/util/List;
    :try_start_1
    invoke-virtual/range {p3 .. p3}, Landroid/content/IntentFilter;->actionsIterator()Ljava/util/Iterator;

    move-result-object v24

    .line 12224
    .local v24, actions:Ljava/util/Iterator;
    if-eqz v24, :cond_1

    .line 12225
    :goto_0
    invoke-interface/range {v24 .. v24}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_2

    .line 12226
    invoke-interface/range {v24 .. v24}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Ljava/lang/String;

    .line 12227
    .local v23, action:Ljava/lang/String;
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    move-object/from16 v2, p3

    move-object/from16 v3, v25

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->getStickiesLocked(Ljava/lang/String;Landroid/content/IntentFilter;Ljava/util/List;)Ljava/util/List;

    move-result-object v25

    .line 12228
    goto :goto_0

    .line 12230
    .end local v23           #action:Ljava/lang/String;
    :cond_1
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    move-object/from16 v2, p3

    move-object/from16 v3, v25

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->getStickiesLocked(Ljava/lang/String;Landroid/content/IntentFilter;Ljava/util/List;)Ljava/util/List;

    move-result-object v25

    .line 12235
    :cond_2
    if-eqz v25, :cond_3

    const/4 v5, 0x0

    move-object/from16 v0, v25

    move v1, v5

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    .end local p1
    check-cast p1, Landroid/content/Intent;

    move-object/from16 v29, p1

    .line 12240
    .local v29, sticky:Landroid/content/Intent;
    :goto_1
    if-nez p2, :cond_4

    .line 12241
    monitor-exit p0

    .line 12288
    :goto_2
    return-object v29

    .line 12235
    .end local v29           #sticky:Landroid/content/Intent;
    .restart local p1
    :cond_3
    const/4 v5, 0x0

    move-object/from16 v29, v5

    goto :goto_1

    .line 12244
    .end local p1
    .restart local v29       #sticky:Landroid/content/Intent;
    :cond_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    move-object v5, v0

    invoke-interface/range {p2 .. p2}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v7

    invoke-virtual {v5, v7}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ReceiverList;

    .line 12246
    .local v4, rl:Lcom/android/server/am/ReceiverList;
    if-nez v4, :cond_5

    .line 12247
    new-instance v4, Lcom/android/server/am/ReceiverList;

    .end local v4           #rl:Lcom/android/server/am/ReceiverList;
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v7

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v8

    move-object/from16 v5, p0

    move-object/from16 v9, p2

    invoke-direct/range {v4 .. v9}, Lcom/android/server/am/ReceiverList;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;IILandroid/content/IIntentReceiver;)V

    .line 12250
    .restart local v4       #rl:Lcom/android/server/am/ReceiverList;
    iget-object v5, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v5, :cond_8

    .line 12251
    iget-object v5, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v5, v4}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 12260
    :goto_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    move-object v5, v0

    invoke-interface/range {p2 .. p2}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v7

    invoke-virtual {v5, v7, v4}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 12262
    :cond_5
    new-instance v26, Lcom/android/server/am/BroadcastFilter;

    move-object/from16 v0, v26

    move-object/from16 v1, p3

    move-object v2, v4

    move-object/from16 v3, p4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/BroadcastFilter;-><init>(Landroid/content/IntentFilter;Lcom/android/server/am/ReceiverList;Ljava/lang/String;)V

    .line 12263
    .local v26, bf:Lcom/android/server/am/BroadcastFilter;
    move-object v0, v4

    move-object/from16 v1, v26

    invoke-virtual {v0, v1}, Lcom/android/server/am/ReceiverList;->add(Ljava/lang/Object;)Z

    .line 12264
    invoke-virtual/range {v26 .. v26}, Lcom/android/server/am/BroadcastFilter;->debugCheck()Z

    move-result v5

    if-nez v5, :cond_6

    .line 12265
    const-string v5, "ActivityManager"

    const-string v7, "==> For Dynamic broadast"

    invoke-static {v5, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12267
    :cond_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v26

    invoke-virtual {v0, v1}, Lcom/android/server/IntentResolver;->addFilter(Landroid/content/IntentFilter;)V

    .line 12271
    if-eqz v25, :cond_9

    .line 12272
    new-instance v14, Ljava/util/ArrayList;

    invoke-direct {v14}, Ljava/util/ArrayList;-><init>()V

    .line 12273
    .local v14, receivers:Ljava/util/ArrayList;
    move-object v0, v14

    move-object/from16 v1, v26

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 12275
    invoke-interface/range {v25 .. v25}, Ljava/util/List;->size()I

    move-result v22

    .line 12276
    .local v22, N:I
    const/16 v28, 0x0

    .local v28, i:I
    :goto_4
    move/from16 v0, v28

    move/from16 v1, v22

    if-ge v0, v1, :cond_9

    .line 12277
    move-object/from16 v0, v25

    move/from16 v1, v28

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/content/Intent;

    .line 12278
    .local v8, intent:Landroid/content/Intent;
    new-instance v7, Lcom/android/server/am/BroadcastRecord;

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, -0x1

    const/4 v12, -0x1

    const/4 v13, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, 0x0

    const/16 v19, 0x0

    const/16 v20, 0x1

    const/16 v21, 0x1

    invoke-direct/range {v7 .. v21}, Lcom/android/server/am/BroadcastRecord;-><init>(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;IILjava/lang/String;Ljava/util/List;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;ZZZ)V

    .line 12281
    .local v7, r:Lcom/android/server/am/BroadcastRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-nez v5, :cond_7

    .line 12282
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 12284
    :cond_7
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 12276
    add-int/lit8 v28, v28, 0x1

    goto :goto_4

    .line 12254
    .end local v7           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v8           #intent:Landroid/content/Intent;
    .end local v14           #receivers:Ljava/util/ArrayList;
    .end local v22           #N:I
    .end local v26           #bf:Lcom/android/server/am/BroadcastFilter;
    .end local v28           #i:I
    :cond_8
    :try_start_2
    invoke-interface/range {p2 .. p2}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v5

    const/4 v7, 0x0

    invoke-interface {v5, v4, v7}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 12258
    const/4 v5, 0x1

    :try_start_3
    iput-boolean v5, v4, Lcom/android/server/am/ReceiverList;->linkedToDeath:Z

    goto/16 :goto_3

    .line 12255
    :catch_0
    move-exception v5

    move-object/from16 v27, v5

    .line 12256
    .local v27, e:Landroid/os/RemoteException;
    monitor-exit p0

    goto/16 :goto_2

    .line 12288
    .end local v27           #e:Landroid/os/RemoteException;
    .restart local v26       #bf:Lcom/android/server/am/BroadcastFilter;
    :cond_9
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto/16 :goto_2
.end method

.method public removeContentProvider(Landroid/app/IApplicationThread;Ljava/lang/String;)V
    .locals 8
    .parameter "caller"
    .parameter "name"

    .prologue
    const/4 v7, 0x1

    .line 8050
    monitor-enter p0

    .line 8051
    :try_start_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v4, p2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 8052
    .local v1, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v1, :cond_0

    .line 8056
    monitor-exit p0

    .line 8086
    :goto_0
    return-void

    .line 8058
    :cond_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v3

    .line 8059
    .local v3, r:Lcom/android/server/am/ProcessRecord;
    if-nez v3, :cond_1

    .line 8060
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to find app for caller "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " when removing content provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 8085
    .end local v1           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v3           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 8065
    .restart local v1       #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v3       #r:Lcom/android/server/am/ProcessRecord;
    :cond_1
    :try_start_1
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v5, v1, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v5, v5, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 8070
    .local v2, localCpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v4, v2, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v4, v3, :cond_2

    .line 8072
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "removeContentProvider called on local provider: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v1, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v6, v6, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " in process "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8074
    monitor-exit p0

    goto :goto_0

    .line 8076
    :cond_2
    iget-object v4, v3, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v4, v2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/lang/Integer;

    .line 8077
    .local v0, cnt:Ljava/lang/Integer;
    if-eqz v0, :cond_3

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v4

    if-gt v4, v7, :cond_4

    .line 8078
    :cond_3
    iget-object v4, v2, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    invoke-virtual {v4, v3}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 8079
    iget-object v4, v3, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    invoke-virtual {v4, v2}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 8084
    :goto_1
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 8085
    monitor-exit p0

    goto/16 :goto_0

    .line 8081
    :cond_4
    iget-object v4, v3, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashMap;

    new-instance v5, Ljava/lang/Integer;

    invoke-virtual {v0}, Ljava/lang/Integer;->intValue()I

    move-result v6

    sub-int/2addr v6, v7

    invoke-direct {v5, v6}, Ljava/lang/Integer;-><init>(I)V

    invoke-virtual {v4, v2, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_1
.end method

.method removeReceiverLocked(Lcom/android/server/am/ReceiverList;)V
    .locals 4
    .parameter "rl"

    .prologue
    .line 12330
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    iget-object v3, p1, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    invoke-interface {v3}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 12331
    invoke-virtual {p1}, Lcom/android/server/am/ReceiverList;->size()I

    move-result v0

    .line 12332
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_0
    if-ge v1, v0, :cond_0

    .line 12333
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    invoke-virtual {p1, v1}, Lcom/android/server/am/ReceiverList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/IntentFilter;

    invoke-virtual {v3, v2}, Lcom/android/server/IntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 12332
    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    .line 12335
    :cond_0
    return-void
.end method

.method removeRequestedPss(Lcom/android/server/am/ProcessRecord;)V
    .locals 2
    .parameter "proc"

    .prologue
    .line 8618
    const/4 v0, 0x0

    .line 8619
    .local v0, callback:Ljava/lang/Runnable;
    monitor-enter p0

    .line 8620
    :try_start_0
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_0

    .line 8621
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-nez v1, :cond_0

    .line 8622
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssCallback:Ljava/lang/Runnable;

    .line 8623
    const/4 v1, 0x0

    iput-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssCallback:Ljava/lang/Runnable;

    .line 8626
    :cond_0
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 8628
    if-eqz v0, :cond_1

    .line 8629
    invoke-interface {v0}, Ljava/lang/Runnable;->run()V

    .line 8631
    :cond_1
    return-void

    .line 8626
    :catchall_0
    move-exception v1

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v1
.end method

.method reportActivityLaunchedLocked(ZLcom/android/server/am/HistoryRecord;JJ)V
    .locals 5
    .parameter "timeout"
    .parameter "r"
    .parameter "thisTime"
    .parameter "totalTime"

    .prologue
    .line 3646
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityLaunched:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 3647
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityLaunched:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/app/IActivityManager$WaitResult;

    .line 3648
    .local v1, w:Landroid/app/IActivityManager$WaitResult;
    iput-boolean p1, v1, Landroid/app/IActivityManager$WaitResult;->timeout:Z

    .line 3649
    if-eqz p2, :cond_0

    .line 3650
    new-instance v2, Landroid/content/ComponentName;

    iget-object v3, p2, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v4, p2, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v2, v3, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    iput-object v2, v1, Landroid/app/IActivityManager$WaitResult;->who:Landroid/content/ComponentName;

    .line 3652
    :cond_0
    iput-wide p3, v1, Landroid/app/IActivityManager$WaitResult;->thisTime:J

    .line 3653
    iput-wide p5, v1, Landroid/app/IActivityManager$WaitResult;->totalTime:J

    .line 3646
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 3655
    .end local v1           #w:Landroid/app/IActivityManager$WaitResult;
    :cond_1
    invoke-virtual {p0}, Ljava/lang/Object;->notify()V

    .line 3656
    return-void
.end method

.method reportActivityVisibleLocked(Lcom/android/server/am/HistoryRecord;)V
    .locals 6
    .parameter "r"

    .prologue
    .line 3659
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityVisible:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 3660
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingActivityVisible:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/app/IActivityManager$WaitResult;

    .line 3661
    .local v1, w:Landroid/app/IActivityManager$WaitResult;
    const/4 v2, 0x0

    iput-boolean v2, v1, Landroid/app/IActivityManager$WaitResult;->timeout:Z

    .line 3662
    if-eqz p1, :cond_0

    .line 3663
    new-instance v2, Landroid/content/ComponentName;

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v2, v3, v4}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    iput-object v2, v1, Landroid/app/IActivityManager$WaitResult;->who:Landroid/content/ComponentName;

    .line 3665
    :cond_0
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v2

    iget-wide v4, v1, Landroid/app/IActivityManager$WaitResult;->thisTime:J

    sub-long/2addr v2, v4

    iput-wide v2, v1, Landroid/app/IActivityManager$WaitResult;->totalTime:J

    .line 3666
    iget-wide v2, v1, Landroid/app/IActivityManager$WaitResult;->totalTime:J

    iput-wide v2, v1, Landroid/app/IActivityManager$WaitResult;->thisTime:J

    .line 3659
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 3668
    .end local v1           #w:Landroid/app/IActivityManager$WaitResult;
    :cond_1
    invoke-virtual {p0}, Ljava/lang/Object;->notify()V

    .line 3669
    return-void
.end method

.method public reportPss(Landroid/app/IApplicationThread;I)V
    .locals 4
    .parameter "caller"
    .parameter "pss"

    .prologue
    .line 8575
    monitor-enter p0

    .line 8576
    if-nez p1, :cond_1

    .line 8577
    :try_start_0
    monitor-exit p0

    .line 8591
    :cond_0
    :goto_0
    return-void

    .line 8579
    :cond_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 8580
    .local v0, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_2

    .line 8581
    monitor-exit p0

    goto :goto_0

    .line 8586
    .end local v0           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3

    .line 8583
    .restart local v0       #callerApp:Lcom/android/server/am/ProcessRecord;
    :cond_2
    :try_start_1
    iput p2, v0, Lcom/android/server/am/ProcessRecord;->lastPss:I

    .line 8584
    move-object v2, v0

    .line 8585
    .local v2, req:Lcom/android/server/Watchdog$PssRequestor;
    iget-object v1, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    .line 8586
    .local v1, name:Ljava/lang/String;
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8587
    invoke-static {}, Lcom/android/server/Watchdog;->getInstance()Lcom/android/server/Watchdog;

    move-result-object v3

    invoke-virtual {v3, v2, v1, p2}, Lcom/android/server/Watchdog;->reportPss(Lcom/android/server/Watchdog$PssRequestor;Ljava/lang/String;I)V

    .line 8588
    iget-boolean v3, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v3, :cond_0

    .line 8589
    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->removeRequestedPss(Lcom/android/server/am/ProcessRecord;)V

    goto :goto_0
.end method

.method public reportThumbnail(Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;)V
    .locals 8
    .parameter "token"
    .parameter "thumbnail"
    .parameter "description"

    .prologue
    .line 7671
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 7672
    .local v6, origId:J
    const/4 v1, 0x0

    const/4 v5, 0x1

    move-object v0, p0

    move-object v2, p1

    move-object v3, p2

    move-object v4, p3

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    .line 7673
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7674
    return-void
.end method

.method public requestPss(Ljava/lang/Runnable;)V
    .locals 6
    .parameter "completeCallback"

    .prologue
    const/4 v5, 0x1

    .line 8595
    monitor-enter p0

    .line 8596
    :try_start_0
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssCallback:Ljava/lang/Runnable;

    .line 8597
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->clear()V

    .line 8598
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    sub-int v0, v4, v5

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_1

    .line 8599
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 8600
    .local v2, proc:Lcom/android/server/am/ProcessRecord;
    iget-boolean v4, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v4, :cond_0

    .line 8601
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 8598
    :cond_0
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 8604
    .end local v2           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_1
    new-instance v3, Ljava/util/ArrayList;

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-direct {v3, v4}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    .line 8605
    .local v3, procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 8607
    invoke-static {}, Landroid/os/Process;->myTid()I

    move-result v4

    invoke-static {v4}, Landroid/os/Process;->getThreadPriority(I)I

    move-result v1

    .line 8608
    .local v1, oldPri:I
    const/16 v4, 0xa

    invoke-static {v4}, Landroid/os/Process;->setThreadPriority(I)V

    .line 8609
    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v4

    sub-int v0, v4, v5

    :goto_1
    if-ltz v0, :cond_2

    .line 8610
    invoke-virtual {v3, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 8611
    .restart local v2       #proc:Lcom/android/server/am/ProcessRecord;
    const/4 v4, 0x0

    iput v4, v2, Lcom/android/server/am/ProcessRecord;->lastPss:I

    .line 8612
    invoke-virtual {v2}, Lcom/android/server/am/ProcessRecord;->requestPss()V

    .line 8609
    add-int/lit8 v0, v0, -0x1

    goto :goto_1

    .line 8605
    .end local v0           #i:I
    .end local v1           #oldPri:I
    .end local v2           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v3           #procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :catchall_0
    move-exception v4

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v4

    .line 8614
    .restart local v0       #i:I
    .restart local v1       #oldPri:I
    .restart local v3       #procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_2
    invoke-static {v1}, Landroid/os/Process;->setThreadPriority(I)V

    .line 8615
    return-void
.end method

.method public resumeAppSwitches()V
    .locals 2

    .prologue
    .line 8367
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_0

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v1

    if-eq v0, v1, :cond_1

    :cond_0
    const-string v0, "android.permission.STOP_APP_SWITCHES"

    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_1

    .line 8372
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Requires permission android.permission.STOP_APP_SWITCHES"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 8378
    :cond_1
    monitor-enter p0

    .line 8382
    const-wide/16 v0, 0x0

    :try_start_0
    iput-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 8383
    monitor-exit p0

    .line 8384
    return-void

    .line 8383
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public revokeUriPermission(Landroid/app/IApplicationThread;Landroid/net/Uri;I)V
    .locals 8
    .parameter "caller"
    .parameter "uri"
    .parameter "modeFlags"

    .prologue
    const-string v5, "ActivityManager"

    .line 6729
    monitor-enter p0

    .line 6730
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v4

    .line 6731
    .local v4, r:Lcom/android/server/am/ProcessRecord;
    if-nez v4, :cond_0

    .line 6732
    new-instance v5, Ljava/lang/SecurityException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unable to find app for caller "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " when revoking permission to uri "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 6768
    .end local v4           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .line 6736
    .restart local v4       #r:Lcom/android/server/am/ProcessRecord;
    :cond_0
    if-nez p2, :cond_1

    .line 6737
    :try_start_1
    const-string v5, "ActivityManager"

    const-string v6, "revokeUriPermission: null uri"

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6738
    monitor-exit p0

    .line 6769
    :goto_0
    return-void

    .line 6741
    :cond_1
    and-int/lit8 p3, p3, 0x3

    .line 6743
    if-nez p3, :cond_2

    .line 6744
    monitor-exit p0

    goto :goto_0

    .line 6747
    :cond_2
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    .line 6749
    .local v3, pm:Landroid/content/pm/IPackageManager;
    invoke-virtual {p2}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v0

    .line 6750
    .local v0, authority:Ljava/lang/String;
    const/4 v2, 0x0

    .line 6751
    .local v2, pi:Landroid/content/pm/ProviderInfo;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v5, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 6753
    .local v1, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v1, :cond_3

    .line 6754
    iget-object v2, v1, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    .line 6762
    :goto_1
    if-nez v2, :cond_4

    .line 6763
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "No content provider found for: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6764
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_0

    .line 6757
    :cond_3
    const/16 v5, 0x800

    :try_start_2
    invoke-interface {v3, v0, v5}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    move-result-object v2

    goto :goto_1

    .line 6767
    :cond_4
    :try_start_3
    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v5, p2, p3}, Lcom/android/server/am/ActivityManagerService;->revokeUriPermissionLocked(ILandroid/net/Uri;I)V

    .line 6768
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_0

    .line 6759
    :catch_0
    move-exception v5

    goto :goto_1
.end method

.method final scheduleAppGcLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 6
    .parameter "app"

    .prologue
    .line 14212
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    .line 14213
    .local v0, now:J
    iget-wide v2, p1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    const-wide/32 v4, 0xea60

    add-long/2addr v2, v4

    cmp-long v2, v2, v0

    if-lez v2, :cond_1

    .line 14220
    :cond_0
    :goto_0
    return-void

    .line 14216
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_0

    .line 14217
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 14218
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_0
.end method

.method final scheduleAppGcsLocked()V
    .locals 12

    .prologue
    const-wide/16 v10, 0x1388

    const/4 v8, 0x5

    const/4 v7, 0x0

    .line 14170
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v8}, Landroid/os/Handler;->removeMessages(I)V

    .line 14172
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    if-lez v6, :cond_1

    .line 14174
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 14175
    .local v3, proc:Lcom/android/server/am/ProcessRecord;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v8}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 14177
    .local v0, msg:Landroid/os/Message;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ProcessRecord;

    iget-wide v6, v6, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    const-wide/32 v8, 0xea60

    add-long v4, v6, v8

    .line 14178
    .local v4, when:J
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    .line 14179
    .local v1, now:J
    add-long v6, v1, v10

    cmp-long v6, v4, v6

    if-gez v6, :cond_0

    .line 14180
    add-long v4, v1, v10

    .line 14182
    :cond_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v0, v4, v5}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 14184
    .end local v0           #msg:Landroid/os/Message;
    .end local v1           #now:J
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v4           #when:J
    :cond_1
    return-void
.end method

.method sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V
    .locals 8
    .parameter "callingUid"
    .parameter "r"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "resultCode"
    .parameter "data"

    .prologue
    .line 4326
    if-lez p1, :cond_0

    .line 4327
    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-direct {p0, p1, v0, p6, p2}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V

    .line 4334
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v0, p2, :cond_1

    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_1

    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_1

    .line 4336
    :try_start_0
    new-instance v7, Ljava/util/ArrayList;

    invoke-direct {v7}, Ljava/util/ArrayList;-><init>()V

    .line 4337
    .local v7, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ResultInfo;>;"
    new-instance v0, Landroid/app/ResultInfo;

    invoke-direct {v0, p3, p4, p5, p6}, Landroid/app/ResultInfo;-><init>(Ljava/lang/String;IILandroid/content/Intent;)V

    invoke-virtual {v7, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4339
    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0, p2, v7}, Landroid/app/IApplicationThread;->scheduleSendResult(Landroid/os/IBinder;Ljava/util/List;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 4347
    .end local v7           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ResultInfo;>;"
    :goto_0
    return-void

    .line 4341
    :catch_0
    move-exception v0

    move-object v6, v0

    .line 4342
    .local v6, e:Ljava/lang/Exception;
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Exception thrown sending result to "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 4346
    .end local v6           #e:Ljava/lang/Exception;
    :cond_1
    const/4 v1, 0x0

    move-object v0, p2

    move-object v2, p3

    move v3, p4

    move v4, p5

    move-object v5, p6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/HistoryRecord;->addResultLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    goto :goto_0
.end method

.method final sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V
    .locals 11
    .parameter "r"
    .parameter "token"
    .parameter "thumbnail"
    .parameter "description"
    .parameter "always"

    .prologue
    .line 7678
    const/4 v8, 0x0

    .line 7679
    .local v8, task:Lcom/android/server/am/TaskRecord;
    const/4 v6, 0x0

    .line 7683
    .local v6, receivers:Ljava/util/ArrayList;
    monitor-enter p0

    .line 7684
    if-nez p1, :cond_1

    .line 7685
    :try_start_0
    invoke-direct {p0, p2}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v4

    .line 7686
    .local v4, index:I
    if-gez v4, :cond_0

    .line 7687
    monitor-exit p0

    .line 7741
    .end local v4           #index:I
    :goto_0
    return-void

    .line 7689
    .restart local v4       #index:I
    :cond_0
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v9, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    move-object v0, v9

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    move-object p1, v0

    .line 7691
    .end local v4           #index:I
    :cond_1
    if-nez p3, :cond_2

    .line 7692
    iget-object p3, p1, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    .line 7693
    iget-object p4, p1, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    .line 7695
    :cond_2
    if-nez p3, :cond_3

    if-nez p5, :cond_3

    .line 7699
    monitor-exit p0

    goto :goto_0

    .line 7723
    :catchall_0
    move-exception v9

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v9

    .line 7701
    :cond_3
    :try_start_1
    iget-object v8, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7703
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    move-result v1

    .line 7704
    .local v1, N:I
    const/4 v3, 0x0

    .local v3, i:I
    move-object v7, v6

    .line 7705
    .end local v6           #receivers:Ljava/util/ArrayList;
    .local v7, receivers:Ljava/util/ArrayList;
    :goto_2
    if-ge v3, v1, :cond_6

    .line 7706
    :try_start_2
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v9, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/PendingThumbnailsRecord;

    .line 7709
    .local v5, pr:Lcom/android/server/am/PendingThumbnailsRecord;
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->pendingRecords:Ljava/util/HashSet;

    invoke-virtual {v9, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    move-result v9

    if-eqz v9, :cond_4

    .line 7710
    if-nez v7, :cond_a

    .line 7711
    new-instance v6, Ljava/util/ArrayList;

    invoke-direct {v6}, Ljava/util/ArrayList;-><init>()V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 7713
    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    :goto_3
    :try_start_3
    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7714
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->pendingRecords:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->size()I

    move-result v9

    if-nez v9, :cond_5

    .line 7715
    const/4 v9, 0x1

    iput-boolean v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->finished:Z

    .line 7716
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v9, v3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 7717
    add-int/lit8 v1, v1, -0x1

    move-object v7, v6

    .line 7718
    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    goto :goto_2

    :cond_4
    move-object v6, v7

    .line 7721
    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    :cond_5
    add-int/lit8 v3, v3, 0x1

    move-object v7, v6

    .line 7722
    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    goto :goto_2

    .line 7723
    .end local v5           #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_6
    :try_start_4
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    .line 7725
    if-eqz v7, :cond_9

    .line 7726
    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 7727
    const/4 v3, 0x0

    :goto_4
    if-ge v3, v1, :cond_9

    .line 7729
    :try_start_5
    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/PendingThumbnailsRecord;

    .line 7731
    .restart local v5       #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->receiver:Landroid/app/IThumbnailReceiver;

    if-eqz v8, :cond_8

    iget v10, v8, Lcom/android/server/am/TaskRecord;->taskId:I

    :goto_5
    invoke-interface {v9, v10, p3, p4}, Landroid/app/IThumbnailReceiver;->newThumbnail(ILandroid/graphics/Bitmap;Ljava/lang/CharSequence;)V

    .line 7733
    iget-boolean v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->finished:Z

    if-eqz v9, :cond_7

    .line 7734
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->receiver:Landroid/app/IThumbnailReceiver;

    invoke-interface {v9}, Landroid/app/IThumbnailReceiver;->finished()V
    :try_end_5
    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_0

    .line 7727
    .end local v5           #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_7
    :goto_6
    add-int/lit8 v3, v3, 0x1

    goto :goto_4

    .line 7731
    .restart local v5       #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_8
    const/4 v10, -0x1

    goto :goto_5

    .line 7736
    .end local v5           #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :catch_0
    move-exception v9

    move-object v2, v9

    .line 7737
    .local v2, e:Ljava/lang/Exception;
    const-string v9, "ActivityManager"

    const-string v10, "Exception thrown when sending thumbnail"

    invoke-static {v9, v10, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_6

    .end local v2           #e:Ljava/lang/Exception;
    :cond_9
    move-object v6, v7

    .line 7741
    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    goto/16 :goto_0

    .line 7723
    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    :catchall_1
    move-exception v9

    move-object v6, v7

    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    goto :goto_1

    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v5       #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    :cond_a
    move-object v6, v7

    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    goto :goto_3
.end method

.method public serviceDoneExecuting(Landroid/os/IBinder;III)V
    .locals 9
    .parameter "token"
    .parameter "type"
    .parameter "startId"
    .parameter "res"

    .prologue
    const/4 v7, 0x1

    const-string v6, "ActivityManager"

    .line 11928
    monitor-enter p0

    .line 11929
    :try_start_0
    instance-of v6, p1, Lcom/android/server/am/ServiceRecord;

    if-nez v6, :cond_0

    .line 11930
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "Invalid service token"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 11997
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v6

    .line 11932
    :cond_0
    :try_start_1
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v4, v0

    .line 11933
    .local v4, r:Lcom/android/server/am/ServiceRecord;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v1

    .line 11934
    .local v1, inStopping:Z
    if-eqz v4, :cond_4

    .line 11938
    if-eq v4, p1, :cond_1

    .line 11939
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Done executing service "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v4, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " with incorrect token: given "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ", expected "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11942
    monitor-exit p0

    .line 11998
    :goto_0
    return-void

    .line 11945
    :cond_1
    if-ne p2, v7, :cond_3

    .line 11948
    const/4 v6, 0x1

    iput-boolean v6, v4, Lcom/android/server/am/ServiceRecord;->callStart:Z

    .line 11949
    packed-switch p4, :pswitch_data_0

    .line 11982
    new-instance v6, Ljava/lang/IllegalArgumentException;

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unknown service start result: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 11953
    :pswitch_0
    const/4 v6, 0x1

    invoke-virtual {v4, p3, v6}, Lcom/android/server/am/ServiceRecord;->findDeliveredStart(IZ)Lcom/android/server/am/ServiceRecord$StartItem;

    .line 11955
    const/4 v6, 0x0

    iput-boolean v6, v4, Lcom/android/server/am/ServiceRecord;->stopIfKilled:Z

    .line 11985
    :cond_2
    :goto_1
    if-nez p4, :cond_3

    .line 11986
    const/4 v6, 0x0

    iput-boolean v6, v4, Lcom/android/server/am/ServiceRecord;->callStart:Z

    .line 11990
    :cond_3
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 11991
    .local v2, origId:J
    invoke-virtual {p0, v4, v1}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11992
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11997
    .end local v2           #origId:J
    :goto_2
    monitor-exit p0

    goto :goto_0

    .line 11960
    :pswitch_1
    const/4 v6, 0x1

    invoke-virtual {v4, p3, v6}, Lcom/android/server/am/ServiceRecord;->findDeliveredStart(IZ)Lcom/android/server/am/ServiceRecord$StartItem;

    .line 11961
    iget v6, v4, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    if-ne v6, p3, :cond_2

    .line 11964
    const/4 v6, 0x1

    iput-boolean v6, v4, Lcom/android/server/am/ServiceRecord;->stopIfKilled:Z

    goto :goto_1

    .line 11972
    :pswitch_2
    const/4 v6, 0x0

    invoke-virtual {v4, p3, v6}, Lcom/android/server/am/ServiceRecord;->findDeliveredStart(IZ)Lcom/android/server/am/ServiceRecord$StartItem;

    move-result-object v5

    .line 11973
    .local v5, si:Lcom/android/server/am/ServiceRecord$StartItem;
    if-eqz v5, :cond_2

    .line 11974
    const/4 v6, 0x0

    iput v6, v5, Lcom/android/server/am/ServiceRecord$StartItem;->deliveryCount:I

    .line 11975
    iget v6, v5, Lcom/android/server/am/ServiceRecord$StartItem;->doneExecutingCount:I

    add-int/lit8 v6, v6, 0x1

    iput v6, v5, Lcom/android/server/am/ServiceRecord$StartItem;->doneExecutingCount:I

    .line 11977
    const/4 v6, 0x1

    iput-boolean v6, v4, Lcom/android/server/am/ServiceRecord;->stopIfKilled:Z

    goto :goto_1

    .line 11994
    .end local v5           #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :cond_4
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Done executing unknown service "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v4, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " with token "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_2

    .line 11949
    nop

    :pswitch_data_0
    .packed-switch 0x0
        :pswitch_0
        :pswitch_0
        :pswitch_1
        :pswitch_2
    .end packed-switch
.end method

.method public serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V
    .locals 3
    .parameter "r"
    .parameter "inStopping"

    .prologue
    .line 12001
    iget v0, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    const/4 v1, 0x1

    sub-int/2addr v0, v1

    iput v0, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    .line 12002
    iget v0, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    if-gtz v0, :cond_2

    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_2

    .line 12003
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v0, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 12004
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v0}, Ljava/util/HashSet;->size()I

    move-result v0

    if-nez v0, :cond_0

    .line 12005
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v1, 0xc

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 12007
    :cond_0
    if-eqz p2, :cond_1

    .line 12008
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 12010
    :cond_1
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 12012
    :cond_2
    return-void
.end method

.method serviceTimeout(Lcom/android/server/am/ProcessRecord;)V
    .locals 13
    .parameter "proc"

    .prologue
    .line 12015
    const/4 v0, 0x0

    .line 12017
    .local v0, anrMessage:Ljava/lang/String;
    monitor-enter p0

    .line 12018
    :try_start_0
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->size()I

    move-result v9

    if-eqz v9, :cond_0

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v9, :cond_2

    .line 12019
    :cond_0
    monitor-exit p0

    .line 12048
    :cond_1
    :goto_0
    return-void

    .line 12021
    :cond_2
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v9

    const-wide/16 v11, 0x7530

    sub-long v2, v9, v11

    .line 12022
    .local v2, maxTime:J
    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 12023
    .local v1, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    const/4 v8, 0x0

    .line 12024
    .local v8, timeout:Lcom/android/server/am/ServiceRecord;
    const-wide/16 v5, 0x0

    .line 12025
    .local v5, nextTime:J
    :cond_3
    :goto_1
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_4

    .line 12026
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ServiceRecord;

    .line 12027
    .local v7, sr:Lcom/android/server/am/ServiceRecord;
    iget-wide v9, v7, Lcom/android/server/am/ServiceRecord;->executingStart:J

    cmp-long v9, v9, v2

    if-gez v9, :cond_5

    .line 12028
    move-object v8, v7

    .line 12035
    .end local v7           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_4
    if-eqz v8, :cond_6

    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v9, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v9

    if-eqz v9, :cond_6

    .line 12036
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Timeout executing service: "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12037
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Executing service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v8, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 12043
    :goto_2
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 12045
    if-eqz v0, :cond_1

    .line 12046
    const/4 v9, 0x0

    const/4 v10, 0x0

    invoke-virtual {p0, p1, v9, v10, v0}, Lcom/android/server/am/ActivityManagerService;->appNotResponding(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;)V

    goto :goto_0

    .line 12031
    .restart local v7       #sr:Lcom/android/server/am/ServiceRecord;
    :cond_5
    :try_start_1
    iget-wide v9, v7, Lcom/android/server/am/ServiceRecord;->executingStart:J

    cmp-long v9, v9, v5

    if-lez v9, :cond_3

    .line 12032
    iget-wide v5, v7, Lcom/android/server/am/ServiceRecord;->executingStart:J

    goto :goto_1

    .line 12039
    .end local v7           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_6
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v10, 0xc

    invoke-virtual {v9, v10}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v4

    .line 12040
    .local v4, msg:Landroid/os/Message;
    iput-object p1, v4, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 12041
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v10, 0x7530

    add-long/2addr v10, v5

    invoke-virtual {v9, v4, v10, v11}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    goto :goto_2

    .line 12043
    .end local v1           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    .end local v2           #maxTime:J
    .end local v4           #msg:Landroid/os/Message;
    .end local v5           #nextTime:J
    .end local v8           #timeout:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v9

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v9
.end method

.method public setActivityController(Landroid/app/IActivityController;)V
    .locals 2
    .parameter "controller"

    .prologue
    .line 8452
    const-string v0, "android.permission.SET_ACTIVITY_WATCHER"

    const-string v1, "setActivityController()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 8454
    monitor-enter p0

    .line 8455
    :try_start_0
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 8456
    monitor-exit p0

    .line 8457
    return-void

    .line 8456
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public setAlwaysFinish(Z)V
    .locals 3
    .parameter "enabled"

    .prologue
    .line 8439
    const-string v0, "android.permission.SET_ALWAYS_FINISH"

    const-string v1, "setAlwaysFinish()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 8442
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string v1, "always_finish_activities"

    if-eqz p1, :cond_0

    const/4 v2, 0x1

    :goto_0
    invoke-static {v0, v1, v2}, Landroid/provider/Settings$System;->putInt(Landroid/content/ContentResolver;Ljava/lang/String;I)Z

    .line 8446
    monitor-enter p0

    .line 8447
    :try_start_0
    iput-boolean p1, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    .line 8448
    monitor-exit p0

    .line 8449
    return-void

    .line 8442
    :cond_0
    const/4 v2, 0x0

    goto :goto_0

    .line 8448
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public setDebugApp(Ljava/lang/String;ZZ)V
    .locals 9
    .parameter "packageName"
    .parameter "waitForDebugger"
    .parameter "persistent"

    .prologue
    const/4 v3, 0x1

    const/4 v2, 0x0

    .line 8406
    const-string v0, "android.permission.SET_DEBUG_APP"

    const-string v1, "setDebugApp()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 8412
    if-eqz p3, :cond_0

    .line 8413
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v8

    .line 8414
    .local v8, resolver:Landroid/content/ContentResolver;
    const-string v0, "debug_app"

    invoke-static {v8, v0, p1}, Landroid/provider/Settings$System;->putString(Landroid/content/ContentResolver;Ljava/lang/String;Ljava/lang/String;)Z

    .line 8417
    const-string v0, "wait_for_debugger"

    if-eqz p2, :cond_3

    move v1, v3

    :goto_0
    invoke-static {v8, v0, v1}, Landroid/provider/Settings$System;->putInt(Landroid/content/ContentResolver;Ljava/lang/String;I)Z

    .line 8422
    .end local v8           #resolver:Landroid/content/ContentResolver;
    :cond_0
    monitor-enter p0

    .line 8423
    if-nez p3, :cond_1

    .line 8424
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    .line 8425
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    .line 8427
    :cond_1
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 8428
    iput-boolean p2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 8429
    if-nez p3, :cond_4

    move v0, v3

    :goto_1
    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    .line 8430
    if-eqz p1, :cond_2

    .line 8431
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 8432
    .local v6, origId:J
    const/4 v2, -0x1

    const/4 v3, 0x0

    const/4 v4, 0x0

    const/4 v5, 0x1

    move-object v0, p0

    move-object v1, p1

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 8433
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8435
    .end local v6           #origId:J
    :cond_2
    monitor-exit p0

    .line 8436
    return-void

    .restart local v8       #resolver:Landroid/content/ContentResolver;
    :cond_3
    move v1, v2

    .line 8417
    goto :goto_0

    .end local v8           #resolver:Landroid/content/ContentResolver;
    :cond_4
    move v0, v2

    .line 8429
    goto :goto_1

    .line 8435
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public setPersistent(Landroid/os/IBinder;Z)V
    .locals 9
    .parameter "token"
    .parameter "isPersistent"

    .prologue
    const/4 v7, 0x1

    const-string v8, "android.permission.PERSISTENT_ACTIVITY"

    .line 4974
    const-string v6, "android.permission.PERSISTENT_ACTIVITY"

    invoke-virtual {p0, v8}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v6

    if-eqz v6, :cond_0

    .line 4976
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: setPersistent() from pid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", uid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "android.permission.PERSISTENT_ACTIVITY"

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 4980
    .local v2, msg:Ljava/lang/String;
    const-string v6, "ActivityManager"

    invoke-static {v6, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4981
    new-instance v6, Ljava/lang/SecurityException;

    invoke-direct {v6, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 4984
    .end local v2           #msg:Ljava/lang/String;
    :cond_0
    monitor-enter p0

    .line 4985
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v1

    .line 4986
    .local v1, index:I
    if-gez v1, :cond_1

    .line 4987
    monitor-exit p0

    .line 5033
    :goto_0
    return-void

    .line 4989
    :cond_1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 4990
    .local v5, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 4995
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-eqz p2, :cond_5

    .line 4996
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-eqz v6, :cond_2

    .line 4999
    monitor-exit p0

    goto :goto_0

    .line 5032
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #index:I
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v6

    .line 5001
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v1       #index:I
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    :cond_2
    const/4 v6, 0x1

    :try_start_1
    iput-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    .line 5002
    iget v6, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    add-int/lit8 v6, v6, 0x1

    iput v6, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    .line 5004
    iget v6, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-le v6, v7, :cond_3

    .line 5007
    monitor-exit p0

    goto :goto_0

    .line 5009
    :cond_3
    iget-boolean v6, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v6, :cond_4

    .line 5012
    monitor-exit p0

    goto :goto_0

    .line 5017
    :cond_4
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 5018
    .local v3, origId:J
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 5019
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5032
    :goto_1
    monitor-exit p0

    goto :goto_0

    .line 5022
    .end local v3           #origId:J
    :cond_5
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-nez v6, :cond_6

    .line 5024
    monitor-exit p0

    goto :goto_0

    .line 5026
    :cond_6
    const/4 v6, 0x0

    iput-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    .line 5027
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 5028
    .restart local v3       #origId:J
    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->decPersistentCountLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 5029
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_1
.end method

.method public setProcessForeground(Landroid/os/IBinder;IZ)V
    .locals 8
    .parameter "token"
    .parameter "pid"
    .parameter "isForeground"

    .prologue
    .line 6238
    const-string v4, "android.permission.SET_PROCESS_LIMIT"

    const-string v5, "setProcessForeground()"

    invoke-virtual {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6240
    monitor-enter p0

    .line 6241
    const/4 v0, 0x0

    .line 6243
    .local v0, changed:Z
    :try_start_0
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 6244
    :try_start_1
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v5, p2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 6245
    .local v3, pr:Lcom/android/server/am/ProcessRecord;
    if-nez v3, :cond_0

    .line 6246
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "setProcessForeground called on unknown pid: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6247
    monitor-exit v4
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    :try_start_2
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 6280
    :goto_0
    return-void

    .line 6249
    :cond_0
    :try_start_3
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    invoke-virtual {v5, p2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ActivityManagerService$ForegroundToken;

    .line 6250
    .local v2, oldToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    if-eqz v2, :cond_1

    .line 6251
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->token:Landroid/os/IBinder;

    const/4 v6, 0x0

    invoke-interface {v5, v2, v6}, Landroid/os/IBinder;->unlinkToDeath(Landroid/os/IBinder$DeathRecipient;I)Z

    .line 6252
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    invoke-virtual {v5, p2}, Landroid/util/SparseArray;->remove(I)V

    .line 6253
    const/4 v5, 0x0

    iput-object v5, v3, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 6254
    const/4 v0, 0x1

    .line 6256
    :cond_1
    if-eqz p3, :cond_2

    if-eqz p1, :cond_2

    .line 6257
    new-instance v1, Lcom/android/server/am/ActivityManagerService$6;

    invoke-direct {v1, p0}, Lcom/android/server/am/ActivityManagerService$6;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    .line 6262
    .local v1, newToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    iput p2, v1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    .line 6263
    iput-object p1, v1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->token:Landroid/os/IBinder;
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 6265
    const/4 v5, 0x0

    :try_start_4
    invoke-interface {p1, v1, v5}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V

    .line 6266
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    invoke-virtual {v5, p2, v1}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 6267
    iput-object p1, v3, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_0

    .line 6268
    const/4 v0, 0x1

    .line 6274
    .end local v1           #newToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    :cond_2
    :goto_1
    :try_start_5
    monitor-exit v4
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    .line 6276
    if-eqz v0, :cond_3

    .line 6277
    :try_start_6
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 6279
    :cond_3
    monitor-exit p0

    goto :goto_0

    .end local v2           #oldToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .end local v3           #pr:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    throw v4

    .line 6274
    :catchall_1
    move-exception v5

    :try_start_7
    monitor-exit v4
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_1

    :try_start_8
    throw v5
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_0

    .line 6269
    .restart local v1       #newToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .restart local v2       #oldToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .restart local v3       #pr:Lcom/android/server/am/ProcessRecord;
    :catch_0
    move-exception v5

    goto :goto_1
.end method

.method public setProcessLimit(I)V
    .locals 2
    .parameter "max"

    .prologue
    .line 6208
    const-string v0, "android.permission.SET_PROCESS_LIMIT"

    const-string v1, "setProcessLimit()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6210
    iput p1, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    .line 6211
    return-void
.end method

.method public setRequestedOrientation(Landroid/os/IBinder;I)V
    .locals 9
    .parameter "token"
    .parameter "requestedOrientation"

    .prologue
    const/4 v8, 0x0

    .line 4011
    monitor-enter p0

    .line 4012
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v1

    .line 4013
    .local v1, index:I
    if-gez v1, :cond_0

    .line 4014
    monitor-exit p0

    .line 4030
    :goto_0
    return-void

    .line 4016
    :cond_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 4017
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 4018
    .local v2, origId:J
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v5, v4, p2}, Lcom/android/server/WindowManagerService;->setAppOrientation(Landroid/view/IApplicationToken;I)V

    .line 4019
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v4, v7}, Lcom/android/server/am/HistoryRecord;->mayFreezeScreenLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v7

    if-eqz v7, :cond_2

    move-object v7, v4

    :goto_1
    invoke-virtual {v5, v6, v7}, Lcom/android/server/WindowManagerService;->updateOrientationFromAppTokens(Landroid/content/res/Configuration;Landroid/os/IBinder;)Landroid/content/res/Configuration;

    move-result-object v0

    .line 4022
    .local v0, config:Landroid/content/res/Configuration;
    if-eqz v0, :cond_1

    .line 4023
    const/4 v5, 0x1

    iput-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->frozenBeforeDestroy:Z

    .line 4024
    invoke-virtual {p0, v0, v4}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    move-result v5

    if-nez v5, :cond_1

    .line 4025
    const/4 v5, 0x0

    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 4028
    :cond_1
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4029
    monitor-exit p0

    goto :goto_0

    .end local v0           #config:Landroid/content/res/Configuration;
    .end local v1           #index:I
    .end local v2           #origId:J
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v5

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v5

    .restart local v1       #index:I
    .restart local v2       #origId:J
    .restart local v4       #r:Lcom/android/server/am/HistoryRecord;
    :cond_2
    move-object v7, v8

    .line 4019
    goto :goto_1
.end method

.method public setServiceForeground(Landroid/content/ComponentName;Landroid/os/IBinder;ILandroid/app/Notification;Z)V
    .locals 6
    .parameter "className"
    .parameter "token"
    .parameter "id"
    .parameter "notification"
    .parameter "removeNotification"

    .prologue
    .line 11572
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 11574
    .local v0, origId:J
    :try_start_0
    monitor-enter p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    .line 11575
    :try_start_1
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/ComponentName;Landroid/os/IBinder;)Lcom/android/server/am/ServiceRecord;

    move-result-object v2

    .line 11576
    .local v2, r:Lcom/android/server/am/ServiceRecord;
    if-eqz v2, :cond_2

    .line 11577
    if-eqz p3, :cond_3

    .line 11578
    if-nez p4, :cond_0

    .line 11579
    new-instance v3, Ljava/lang/IllegalArgumentException;

    const-string v4, "null notification"

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 11607
    .end local v2           #r:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    :try_start_2
    throw v3
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 11609
    :catchall_1
    move-exception v3

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v3

    .line 11581
    .restart local v2       #r:Lcom/android/server/am/ServiceRecord;
    :cond_0
    :try_start_3
    iget v3, v2, Lcom/android/server/am/ServiceRecord;->foregroundId:I

    if-eq v3, p3, :cond_1

    .line 11582
    invoke-virtual {v2}, Lcom/android/server/am/ServiceRecord;->cancelNotification()V

    .line 11583
    iput p3, v2, Lcom/android/server/am/ServiceRecord;->foregroundId:I

    .line 11585
    :cond_1
    iget v3, p4, Landroid/app/Notification;->flags:I

    or-int/lit8 v3, v3, 0x40

    iput v3, p4, Landroid/app/Notification;->flags:I

    .line 11586
    iput-object p4, v2, Lcom/android/server/am/ServiceRecord;->foregroundNoti:Landroid/app/Notification;

    .line 11587
    const/4 v3, 0x1

    iput-boolean v3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    .line 11588
    invoke-virtual {v2}, Lcom/android/server/am/ServiceRecord;->postNotification()V

    .line 11589
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_2

    .line 11590
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v4, 0x1

    invoke-virtual {p0, v3, v4}, Lcom/android/server/am/ActivityManagerService;->updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 11607
    :cond_2
    :goto_0
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 11609
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11611
    return-void

    .line 11593
    :cond_3
    :try_start_4
    iget-boolean v3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    if-eqz v3, :cond_4

    .line 11594
    const/4 v3, 0x0

    iput-boolean v3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    .line 11595
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4

    .line 11596
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v4, 0x0

    const/4 v5, 0x1

    invoke-direct {p0, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->updateLruProcessLocked(Lcom/android/server/am/ProcessRecord;ZZ)V

    .line 11597
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v4, 0x1

    invoke-virtual {p0, v3, v4}, Lcom/android/server/am/ActivityManagerService;->updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 11600
    :cond_4
    if-eqz p5, :cond_2

    .line 11601
    invoke-virtual {v2}, Lcom/android/server/am/ServiceRecord;->cancelNotification()V

    .line 11602
    const/4 v3, 0x0

    iput v3, v2, Lcom/android/server/am/ServiceRecord;->foregroundId:I

    .line 11603
    const/4 v3, 0x0

    iput-object v3, v2, Lcom/android/server/am/ServiceRecord;->foregroundNoti:Landroid/app/Notification;
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    goto :goto_0
.end method

.method public setWindowManager(Lcom/android/server/WindowManagerService;)V
    .locals 0
    .parameter "wm"

    .prologue
    .line 1278
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    .line 1279
    return-void
.end method

.method public showWaitingForDebugger(Landroid/app/IApplicationThread;Z)V
    .locals 3
    .parameter "who"
    .parameter "waiting"

    .prologue
    .line 6772
    monitor-enter p0

    .line 6773
    if-eqz p1, :cond_0

    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v2

    move-object v0, v2

    .line 6775
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    :goto_0
    if-nez v0, :cond_1

    monitor-exit p0

    .line 6783
    :goto_1
    return-void

    .line 6773
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    :cond_0
    const/4 v2, 0x0

    move-object v0, v2

    goto :goto_0

    .line 6777
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    :cond_1
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v1

    .line 6778
    .local v1, msg:Landroid/os/Message;
    const/4 v2, 0x6

    iput v2, v1, Landroid/os/Message;->what:I

    .line 6779
    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 6780
    if-eqz p2, :cond_2

    const/4 v2, 0x1

    :goto_2
    iput v2, v1, Landroid/os/Message;->arg1:I

    .line 6781
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v2, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 6782
    monitor-exit p0

    goto :goto_1

    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #msg:Landroid/os/Message;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2

    .line 6780
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v1       #msg:Landroid/os/Message;
    :cond_2
    const/4 v2, 0x0

    goto :goto_2
.end method

.method public shutdown(I)Z
    .locals 9
    .parameter "timeout"

    .prologue
    .line 8281
    const-string v5, "android.permission.SHUTDOWN"

    invoke-virtual {p0, v5}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v5

    if-eqz v5, :cond_0

    .line 8283
    new-instance v5, Ljava/lang/SecurityException;

    const-string v6, "Requires permission android.permission.SHUTDOWN"

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 8287
    :cond_0
    const/4 v4, 0x0

    .line 8289
    .local v4, timedout:Z
    monitor-enter p0

    .line 8290
    const/4 v5, 0x1

    :try_start_0
    iput-boolean v5, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    .line 8291
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Lcom/android/server/WindowManagerService;->setEventDispatching(Z)V

    .line 8293
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_2

    .line 8294
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V

    .line 8295
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v5

    int-to-long v7, p1

    add-long v2, v5, v7

    .line 8296
    .local v2, endTime:J
    :goto_0
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-nez v5, :cond_1

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_2

    .line 8297
    :cond_1
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v5

    sub-long v0, v2, v5

    .line 8298
    .local v0, delay:J
    const-wide/16 v5, 0x0

    cmp-long v5, v0, v5

    if-gtz v5, :cond_3

    .line 8299
    const-string v5, "ActivityManager"

    const-string v6, "Activity manager shutdown timed out"

    invoke-static {v5, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8300
    const/4 v4, 0x1

    .line 8309
    .end local v0           #delay:J
    .end local v2           #endTime:J
    :cond_2
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 8311
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    invoke-virtual {v5}, Lcom/android/server/am/UsageStatsService;->shutdown()V

    .line 8312
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v5}, Lcom/android/server/am/BatteryStatsService;->shutdown()V

    .line 8314
    return v4

    .line 8304
    .restart local v0       #delay:J
    .restart local v2       #endTime:J
    :cond_3
    :try_start_1
    invoke-virtual {p0}, Ljava/lang/Object;->wait()V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Ljava/lang/InterruptedException; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_0

    .line 8305
    :catch_0
    move-exception v5

    goto :goto_0

    .line 8309
    .end local v0           #delay:J
    .end local v2           #endTime:J
    :catchall_0
    move-exception v5

    :try_start_2
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v5
.end method

.method public signalPersistentProcesses(I)V
    .locals 4
    .parameter "sig"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 14587
    const/16 v2, 0xa

    if-eq p1, v2, :cond_0

    .line 14588
    new-instance v2, Ljava/lang/SecurityException;

    const-string v3, "Only SIGNAL_USR1 is allowed"

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 14591
    :cond_0
    monitor-enter p0

    .line 14592
    :try_start_0
    const-string v2, "android.permission.SIGNAL_PERSISTENT_PROCESSES"

    invoke-virtual {p0, v2}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v2

    if-eqz v2, :cond_1

    .line 14594
    new-instance v2, Ljava/lang/SecurityException;

    const-string v3, "Requires permission android.permission.SIGNAL_PERSISTENT_PROCESSES"

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 14604
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2

    .line 14598
    :cond_1
    :try_start_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_3

    .line 14599
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 14600
    .local v1, r:Lcom/android/server/am/ProcessRecord;
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_2

    iget-boolean v2, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v2, :cond_2

    .line 14601
    iget v2, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v2, p1}, Landroid/os/Process;->sendSignal(II)V

    .line 14598
    :cond_2
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 14604
    .end local v1           #r:Lcom/android/server/am/ProcessRecord;
    :cond_3
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 14605
    return-void
.end method

.method skipCurrentReceiverLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 9
    .parameter "app"

    .prologue
    const/4 v6, 0x1

    .line 9070
    const/4 v8, 0x0

    .line 9071
    .local v8, reschedule:Z
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 9072
    .local v7, r:Lcom/android/server/am/BroadcastRecord;
    if-eqz v7, :cond_0

    .line 9076
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 9077
    iget-object v1, v7, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    iget v2, v7, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v3, v7, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v4, v7, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v5, v7, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 9079
    const/4 v8, 0x1

    .line 9081
    :cond_0
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 9082
    if-eqz v7, :cond_1

    iget-object v0, v7, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    if-ne v0, p1, :cond_1

    .line 9085
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 9086
    iget-object v1, v7, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    iget v2, v7, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v3, v7, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v4, v7, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v5, v7, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 9088
    const/4 v8, 0x1

    .line 9090
    :cond_1
    if-eqz v8, :cond_2

    .line 9091
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 9093
    :cond_2
    return-void
.end method

.method public final startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZ)I
    .locals 13
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"
    .parameter "debug"

    .prologue
    .line 3790
    const/4 v11, 0x0

    const/4 v12, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object/from16 v3, p3

    move-object/from16 v4, p4

    move/from16 v5, p5

    move-object/from16 v6, p6

    move-object/from16 v7, p7

    move/from16 v8, p8

    move/from16 v9, p9

    move/from16 v10, p10

    invoke-direct/range {v0 .. v12}, Lcom/android/server/am/ActivityManagerService;->startActivityMayWait(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZLandroid/app/IActivityManager$WaitResult;Landroid/content/res/Configuration;)I

    move-result v0

    return v0
.end method

.method public final startActivityAndWait(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZ)Landroid/app/IActivityManager$WaitResult;
    .locals 13
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"
    .parameter "debug"

    .prologue
    .line 3800
    new-instance v11, Landroid/app/IActivityManager$WaitResult;

    invoke-direct {v11}, Landroid/app/IActivityManager$WaitResult;-><init>()V

    .line 3801
    .local v11, res:Landroid/app/IActivityManager$WaitResult;
    const/4 v12, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object/from16 v3, p3

    move-object/from16 v4, p4

    move/from16 v5, p5

    move-object/from16 v6, p6

    move-object/from16 v7, p7

    move/from16 v8, p8

    move/from16 v9, p9

    move/from16 v10, p10

    invoke-direct/range {v0 .. v12}, Lcom/android/server/am/ActivityManagerService;->startActivityMayWait(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZLandroid/app/IActivityManager$WaitResult;Landroid/content/res/Configuration;)I

    .line 3804
    return-object v11
.end method

.method public final startActivityInPackage(ILandroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IZ)I
    .locals 21
    .parameter "uid"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"

    .prologue
    .line 3947
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v18

    .line 3948
    .local v18, callingUid:I
    if-eqz v18, :cond_0

    invoke-static {}, Landroid/os/Process;->myUid()I

    move-result v4

    move/from16 v0, v18

    move v1, v4

    if-eq v0, v1, :cond_0

    .line 3949
    new-instance v4, Ljava/lang/SecurityException;

    const-string v5, "startActivityInPackage only available to the system"

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 3953
    :cond_0
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    if-eqz v4, :cond_2

    const/4 v4, 0x1

    move/from16 v17, v4

    .line 3956
    .local v17, componentSpecified:Z
    :goto_0
    new-instance v6, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    .line 3961
    .end local p2
    .local v6, intent:Landroid/content/Intent;
    :try_start_0
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    const v5, 0x10400

    move-object v0, v4

    move-object v1, v6

    move-object/from16 v2, p3

    move v3, v5

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->resolveIntent(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v20

    .line 3965
    .local v20, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v20, :cond_3

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-object v10, v4

    .line 3970
    .end local v20           #rInfo:Landroid/content/pm/ResolveInfo;
    .local v10, aInfo:Landroid/content/pm/ActivityInfo;
    :goto_1
    if-eqz v10, :cond_1

    .line 3975
    new-instance v4, Landroid/content/ComponentName;

    iget-object v5, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 3979
    :cond_1
    monitor-enter p0

    .line 3980
    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v14, -0x1

    move-object/from16 v4, p0

    move-object/from16 v7, p3

    move-object/from16 v11, p4

    move-object/from16 v12, p5

    move/from16 v13, p6

    move/from16 v15, p1

    move/from16 v16, p7

    :try_start_1
    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    move-result v4

    monitor-exit p0

    return v4

    .line 3953
    .end local v6           #intent:Landroid/content/Intent;
    .end local v10           #aInfo:Landroid/content/pm/ActivityInfo;
    .end local v17           #componentSpecified:Z
    .restart local p2
    :cond_2
    const/4 v4, 0x0

    move/from16 v17, v4

    goto :goto_0

    .line 3965
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v17       #componentSpecified:Z
    .restart local v20       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_3
    const/4 v4, 0x0

    move-object v10, v4

    goto :goto_1

    .line 3966
    .end local v20           #rInfo:Landroid/content/pm/ResolveInfo;
    :catch_0
    move-exception v4

    move-object/from16 v19, v4

    .line 3967
    .local v19, e:Landroid/os/RemoteException;
    const/4 v10, 0x0

    .restart local v10       #aInfo:Landroid/content/pm/ActivityInfo;
    goto :goto_1

    .line 3983
    .end local v19           #e:Landroid/os/RemoteException;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v4
.end method

.method public startActivityIntentSender(Landroid/app/IApplicationThread;Landroid/content/IntentSender;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;III)I
    .locals 12
    .parameter "caller"
    .parameter "intent"
    .parameter "fillInIntent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "flagsMask"
    .parameter "flagsValues"

    .prologue
    .line 3822
    if-eqz p3, :cond_0

    invoke-virtual {p3}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v2

    if-eqz v2, :cond_0

    .line 3823
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "File descriptors passed in Intent"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 3826
    :cond_0
    invoke-virtual {p2}, Landroid/content/IntentSender;->getTarget()Landroid/content/IIntentSender;

    move-result-object v11

    .line 3827
    .local v11, sender:Landroid/content/IIntentSender;
    instance-of v2, v11, Lcom/android/server/am/PendingIntentRecord;

    if-nez v2, :cond_1

    .line 3828
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "Bad PendingIntent object"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 3831
    :cond_1
    move-object v0, v11

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v1, v0

    .line 3833
    .local v1, pir:Lcom/android/server/am/PendingIntentRecord;
    monitor-enter p0

    .line 3836
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v2, :cond_2

    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v2, v2, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v2, v2, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    if-ne v2, v3, :cond_2

    .line 3839
    const-wide/16 v2, 0x0

    iput-wide v2, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 3841
    :cond_2
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 3843
    const/4 v2, 0x0

    const/4 v5, 0x0

    move-object v3, p3

    move-object/from16 v4, p4

    move-object/from16 v6, p5

    move-object/from16 v7, p6

    move/from16 v8, p7

    move/from16 v9, p8

    move/from16 v10, p9

    invoke-virtual/range {v1 .. v10}, Lcom/android/server/am/PendingIntentRecord;->sendInner(ILandroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;Landroid/os/IBinder;Ljava/lang/String;III)I

    move-result v2

    return v2

    .line 3841
    :catchall_0
    move-exception v2

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v2
.end method

.method public final startActivityWithConfig(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZLandroid/content/res/Configuration;)I
    .locals 13
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"
    .parameter "debug"
    .parameter "config"

    .prologue
    .line 3812
    const/4 v11, 0x0

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object/from16 v3, p3

    move-object/from16 v4, p4

    move/from16 v5, p5

    move-object/from16 v6, p6

    move-object/from16 v7, p7

    move/from16 v8, p8

    move/from16 v9, p9

    move/from16 v10, p10

    move-object/from16 v12, p11

    invoke-direct/range {v0 .. v12}, Lcom/android/server/am/ActivityManagerService;->startActivityMayWait(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZLandroid/app/IActivityManager$WaitResult;Landroid/content/res/Configuration;)I

    move-result v0

    return v0
.end method

.method startAppProblemLocked(Lcom/android/server/am/ProcessRecord;)V
    .locals 3
    .parameter "app"

    .prologue
    .line 9064
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->flags:I

    invoke-static {v0, v1, v2}, Landroid/app/ApplicationErrorReport;->getErrorReportReceiver(Landroid/content/Context;Ljava/lang/String;I)Landroid/content/ComponentName;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    .line 9066
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->skipCurrentReceiverLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 9067
    return-void
.end method

.method public startInstrumentation(Landroid/content/ComponentName;Ljava/lang/String;ILandroid/os/Bundle;Landroid/app/IInstrumentationWatcher;)Z
    .locals 17
    .parameter "className"
    .parameter "profileFile"
    .parameter "flags"
    .parameter "arguments"
    .parameter "watcher"

    .prologue
    .line 13351
    if-eqz p4, :cond_0

    invoke-virtual/range {p4 .. p4}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v4

    if-eqz v4, :cond_0

    .line 13352
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Bundle"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 13355
    :cond_0
    monitor-enter p0

    .line 13356
    const/4 v12, 0x0

    .line 13357
    .local v12, ii:Landroid/content/pm/InstrumentationInfo;
    const/4 v10, 0x0

    .line 13359
    .local v10, ai:Landroid/content/pm/ApplicationInfo;
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    const/16 v5, 0x400

    move-object v0, v4

    move-object/from16 v1, p1

    move v2, v5

    invoke-virtual {v0, v1, v2}, Landroid/content/pm/PackageManager;->getInstrumentationInfo(Landroid/content/ComponentName;I)Landroid/content/pm/InstrumentationInfo;

    move-result-object v12

    .line 13361
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    const/16 v6, 0x400

    invoke-virtual {v4, v5, v6}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v10

    .line 13365
    :goto_0
    if-nez v12, :cond_1

    .line 13366
    :try_start_1
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unable to find instrumentation info for: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    move-object/from16 v0, p0

    move-object/from16 v1, p5

    move-object/from16 v2, p1

    move-object v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V

    .line 13368
    const/4 v4, 0x0

    monitor-exit p0

    .line 13402
    :goto_1
    return v4

    .line 13370
    :cond_1
    if-nez v10, :cond_2

    .line 13371
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unable to find instrumentation target package: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    move-object/from16 v0, p0

    move-object/from16 v1, p5

    move-object/from16 v2, p1

    move-object v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V

    .line 13373
    const/4 v4, 0x0

    monitor-exit p0

    goto :goto_1

    .line 13400
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v4

    .line 13376
    :cond_2
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    iget-object v6, v12, Landroid/content/pm/InstrumentationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5, v6}, Landroid/content/pm/PackageManager;->checkSignatures(Ljava/lang/String;Ljava/lang/String;)I

    move-result v13

    .line 13378
    .local v13, match:I
    if-gez v13, :cond_3

    const/4 v4, -0x1

    if-eq v13, v4, :cond_3

    .line 13379
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Permission Denial: starting instrumentation "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " from pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ", uid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " not allowed because package "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " does not have a signature matching the target "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    .line 13386
    .local v14, msg:Ljava/lang/String;
    move-object/from16 v0, p0

    move-object/from16 v1, p5

    move-object/from16 v2, p1

    move-object v3, v14

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V

    .line 13387
    new-instance v4, Ljava/lang/SecurityException;

    invoke-direct {v4, v14}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 13390
    .end local v14           #msg:Ljava/lang/String;
    :cond_3
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v15

    .line 13391
    .local v15, origId:J
    iget-object v5, v12, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    const/4 v6, -0x1

    const/4 v7, 0x1

    const/4 v8, 0x0

    const/4 v9, 0x1

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/am/ActivityManagerService;->forceStopPackageLocked(Ljava/lang/String;IZZZ)Z

    .line 13392
    move-object/from16 v0, p0

    move-object v1, v10

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;

    move-result-object v11

    .line 13393
    .local v11, app:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, p1

    move-object v1, v11

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    .line 13394
    iput-object v10, v11, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    .line 13395
    move-object/from16 v0, p2

    move-object v1, v11

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationProfileFile:Ljava/lang/String;

    .line 13396
    move-object/from16 v0, p4

    move-object v1, v11

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationArguments:Landroid/os/Bundle;

    .line 13397
    move-object/from16 v0, p5

    move-object v1, v11

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    .line 13398
    move-object/from16 v0, p1

    move-object v1, v11

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationResultClass:Landroid/content/ComponentName;

    .line 13399
    invoke-static/range {v15 .. v16}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13400
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 13402
    const/4 v4, 0x1

    goto/16 :goto_1

    .line 13363
    .end local v11           #app:Lcom/android/server/am/ProcessRecord;
    .end local v13           #match:I
    .end local v15           #origId:J
    :catch_0
    move-exception v4

    goto/16 :goto_0
.end method

.method public startNextMatchingActivity(Landroid/os/IBinder;Landroid/content/Intent;)Z
    .locals 28
    .parameter "callingActivity"
    .parameter "intent"

    .prologue
    .line 3850
    if-eqz p2, :cond_0

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    const/4 v5, 0x1

    if-ne v4, v5, :cond_0

    .line 3851
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 3854
    :cond_0
    monitor-enter p0

    .line 3855
    :try_start_0
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v20

    .line 3856
    .local v20, index:I
    if-gez v20, :cond_1

    .line 3857
    const/4 v4, 0x0

    monitor-exit p0

    .line 3937
    .end local p1
    :goto_0
    return v4

    .line 3859
    .restart local p1
    :cond_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v20

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Lcom/android/server/am/HistoryRecord;

    .line 3860
    .local v23, r:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-eqz v4, :cond_2

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v4, :cond_3

    .line 3862
    :cond_2
    const/4 v4, 0x0

    monitor-exit p0

    goto :goto_0

    .line 3938
    .end local v20           #index:I
    .end local v23           #r:Lcom/android/server/am/HistoryRecord;
    .end local p1
    :catchall_0
    move-exception v4

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 3864
    .restart local v20       #index:I
    .restart local v23       #r:Lcom/android/server/am/HistoryRecord;
    .restart local p1
    :cond_3
    :try_start_1
    new-instance v6, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 3866
    .end local p2
    .local v6, intent:Landroid/content/Intent;
    :try_start_2
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v4

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getType()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v6, v4, v5}, Landroid/content/Intent;->setDataAndType(Landroid/net/Uri;Ljava/lang/String;)Landroid/content/Intent;

    .line 3868
    const/4 v4, 0x0

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 3870
    const/4 v10, 0x0

    .line 3872
    .local v10, aInfo:Landroid/content/pm/ActivityInfo;
    :try_start_3
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resolvedType:Ljava/lang/String;

    move-object v5, v0

    const v7, 0x10400

    invoke-interface {v4, v6, v5, v7}, Landroid/content/pm/IPackageManager;->queryIntentActivities(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;

    move-result-object v26

    .line 3878
    .local v26, resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-eqz v26, :cond_5

    invoke-interface/range {v26 .. v26}, Ljava/util/List;->size()I

    move-result v4

    move/from16 v18, v4

    .line 3879
    .local v18, N:I
    :goto_2
    const/16 v19, 0x0

    .local v19, i:I
    :goto_3
    move/from16 v0, v19

    move/from16 v1, v18

    if-ge v0, v1, :cond_4

    .line 3880
    move-object/from16 v0, v26

    move/from16 v1, v19

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v24

    check-cast v24, Landroid/content/pm/ResolveInfo;

    .line 3881
    .local v24, rInfo:Landroid/content/pm/ResolveInfo;
    move-object/from16 v0, v24

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_6

    move-object/from16 v0, v24

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_6

    .line 3885
    add-int/lit8 v19, v19, 0x1

    .line 3886
    move/from16 v0, v19

    move/from16 v1, v18

    if-ge v0, v1, :cond_4

    .line 3887
    move-object/from16 v0, v26

    move/from16 v1, v19

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    .end local p1
    check-cast p1, Landroid/content/pm/ResolveInfo;

    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v10, v0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0

    .line 3895
    .end local v18           #N:I
    .end local v19           #i:I
    .end local v24           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v26           #resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_4
    :goto_4
    if-nez v10, :cond_7

    .line 3897
    const/4 v4, 0x0

    :try_start_4
    monitor-exit p0

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_0

    .line 3878
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v26       #resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local p1
    :cond_5
    const/4 v4, 0x0

    move/from16 v18, v4

    goto :goto_2

    .line 3879
    .restart local v18       #N:I
    .restart local v19       #i:I
    .restart local v24       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_6
    add-int/lit8 v19, v19, 0x1

    goto :goto_3

    .line 3900
    .end local v18           #N:I
    .end local v19           #i:I
    .end local v24           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v26           #resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local p1
    :cond_7
    new-instance v4, Landroid/content/ComponentName;

    iget-object v5, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 3902
    invoke-virtual {v6}, Landroid/content/Intent;->getFlags()I

    move-result v4

    const v5, -0x1e000001

    and-int/2addr v4, v5

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 3913
    move-object/from16 v0, v23

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move/from16 v27, v0

    .line 3914
    .local v27, wasFinishing:Z
    const/4 v4, 0x1

    move v0, v4

    move-object/from16 v1, v23

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    .line 3917
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v11, v0

    .line 3918
    .local v11, resultTo:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object v12, v0

    .line 3919
    .local v12, resultWho:Ljava/lang/String;
    move-object/from16 v0, v23

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move v13, v0

    .line 3920
    .local v13, requestCode:I
    const/4 v4, 0x0

    move-object v0, v4

    move-object/from16 v1, v23

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3921
    if-eqz v11, :cond_8

    .line 3922
    move-object v0, v11

    move-object/from16 v1, v23

    move-object v2, v12

    move v3, v13

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/HistoryRecord;->removeResultsLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    .line 3925
    :cond_8
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v21

    .line 3928
    .local v21, origId:J
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resolvedType:Ljava/lang/String;

    move-object v7, v0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v14, -0x1

    move-object/from16 v0, v23

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchedFromUid:I

    move v15, v0

    const/16 v16, 0x0

    const/16 v17, 0x0

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    move-result v25

    .line 3931
    .local v25, res:I
    invoke-static/range {v21 .. v22}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 3933
    move/from16 v0, v27

    move-object/from16 v1, v23

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    .line 3934
    if-eqz v25, :cond_9

    .line 3935
    const/4 v4, 0x0

    monitor-exit p0

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_0

    .line 3937
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    :cond_9
    const/4 v4, 0x1

    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_0

    .line 3938
    .end local v10           #aInfo:Landroid/content/pm/ActivityInfo;
    .end local v11           #resultTo:Lcom/android/server/am/HistoryRecord;
    .end local v12           #resultWho:Ljava/lang/String;
    .end local v13           #requestCode:I
    .end local v21           #origId:J
    .end local v25           #res:I
    .end local v27           #wasFinishing:Z
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    :catchall_1
    move-exception v4

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_1

    .line 3892
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v10       #aInfo:Landroid/content/pm/ActivityInfo;
    :catch_0
    move-exception v4

    goto/16 :goto_4
.end method

.method public final startRunning(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
    .locals 2
    .parameter "pkg"
    .parameter "cls"
    .parameter "action"
    .parameter "data"

    .prologue
    const/4 v1, 0x0

    .line 8690
    monitor-enter p0

    .line 8691
    :try_start_0
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    if-eqz v0, :cond_0

    .line 8692
    monitor-exit p0

    .line 8705
    :goto_0
    return-void

    .line 8694
    :cond_0
    const/4 v0, 0x1

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    .line 8695
    if-eqz p1, :cond_1

    if-eqz p2, :cond_1

    new-instance v0, Landroid/content/ComponentName;

    invoke-direct {v0, p1, p2}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    :goto_1
    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    .line 8697
    if-eqz p3, :cond_2

    move-object v0, p3

    :goto_2
    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8698
    iput-object p4, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    .line 8699
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    if-nez v0, :cond_3

    .line 8700
    monitor-exit p0

    goto :goto_0

    .line 8702
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    :cond_1
    move-object v0, v1

    .line 8695
    goto :goto_1

    .line 8697
    :cond_2
    :try_start_1
    const-string v0, "android.intent.action.MAIN"

    goto :goto_2

    .line 8702
    :cond_3
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8704
    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->systemReady(Ljava/lang/Runnable;)V

    goto :goto_0
.end method

.method public startService(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;)Landroid/content/ComponentName;
    .locals 9
    .parameter "caller"
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    .line 11429
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v0

    const/4 v1, 0x1

    if-ne v0, v1, :cond_0

    .line 11430
    new-instance v0, Ljava/lang/IllegalArgumentException;

    const-string v1, "File descriptors passed in Intent"

    invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 11433
    :cond_0
    monitor-enter p0

    .line 11434
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v4

    .line 11435
    .local v4, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    .line 11436
    .local v5, callingUid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .local v6, origId:J
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 11437
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->startServiceLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/ComponentName;

    move-result-object v8

    .line 11439
    .local v8, res:Landroid/content/ComponentName;
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11440
    monitor-exit p0

    return-object v8

    .line 11441
    .end local v4           #callingPid:I
    .end local v5           #callingUid:I
    .end local v6           #origId:J
    .end local v8           #res:Landroid/content/ComponentName;
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method startServiceInPackage(ILandroid/content/Intent;Ljava/lang/String;)Landroid/content/ComponentName;
    .locals 9
    .parameter "uid"
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    .line 11446
    monitor-enter p0

    .line 11447
    :try_start_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 11448
    .local v6, origId:J
    const/4 v1, 0x0

    const/4 v4, -0x1

    move-object v0, p0

    move-object v2, p2

    move-object v3, p3

    move v5, p1

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->startServiceLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/ComponentName;

    move-result-object v8

    .line 11450
    .local v8, res:Landroid/content/ComponentName;
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11451
    monitor-exit p0

    return-object v8

    .line 11452
    .end local v6           #origId:J
    .end local v8           #res:Landroid/content/ComponentName;
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method startServiceLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/ComponentName;
    .locals 6
    .parameter "caller"
    .parameter "service"
    .parameter "resolvedType"
    .parameter "callingPid"
    .parameter "callingUid"

    .prologue
    const/4 v4, 0x1

    const-string v3, "!"

    .line 11379
    monitor-enter p0

    .line 11383
    if-eqz p1, :cond_0

    .line 11384
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 11385
    .local v0, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_0

    .line 11386
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unable to find app for caller "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " (pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ") when starting service "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 11423
    .end local v0           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3

    .line 11393
    :cond_0
    :try_start_1
    invoke-direct {p0, p2, p3, p4, p5}, Lcom/android/server/am/ActivityManagerService;->retrieveServiceLocked(Landroid/content/Intent;Ljava/lang/String;II)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v2

    .line 11396
    .local v2, res:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-nez v2, :cond_1

    .line 11397
    const/4 v3, 0x0

    monitor-exit p0

    .line 11422
    :goto_0
    return-object v3

    .line 11399
    :cond_1
    iget-object v3, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    if-nez v3, :cond_3

    .line 11400
    new-instance v3, Landroid/content/ComponentName;

    const-string v4, "!"

    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->permission:Ljava/lang/String;

    if-eqz v5, :cond_2

    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->permission:Ljava/lang/String;

    :goto_1
    invoke-direct {v3, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    monitor-exit p0

    goto :goto_0

    :cond_2
    const-string v5, "private to package"

    goto :goto_1

    .line 11403
    :cond_3
    iget-object v1, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    .line 11404
    .local v1, r:Lcom/android/server/am/ServiceRecord;
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z

    move-result v3

    if-eqz v3, :cond_4

    .line 11408
    :cond_4
    const/4 v3, 0x1

    iput-boolean v3, v1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 11409
    const/4 v3, 0x0

    iput-boolean v3, v1, Lcom/android/server/am/ServiceRecord;->callStart:Z

    .line 11410
    iget v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    add-int/lit8 v3, v3, 0x1

    iput v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    .line 11411
    iget v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    if-ge v3, v4, :cond_5

    .line 11412
    const/4 v3, 0x1

    iput v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    .line 11414
    :cond_5
    iget-object v3, v1, Lcom/android/server/am/ServiceRecord;->pendingStarts:Ljava/util/ArrayList;

    new-instance v4, Lcom/android/server/am/ServiceRecord$StartItem;

    iget v5, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    invoke-direct {v4, v5, p2}, Lcom/android/server/am/ServiceRecord$StartItem;-><init>(ILandroid/content/Intent;)V

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11415
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    iput-wide v3, v1, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    .line 11416
    iget-object v3, v1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v3}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v3

    monitor-enter v3
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 11417
    :try_start_2
    iget-object v4, v1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->startRunningLocked()V

    .line 11418
    monitor-exit v3
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 11419
    :try_start_3
    invoke-virtual {p2}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/4 v4, 0x0

    invoke-direct {p0, v1, v3, v4}, Lcom/android/server/am/ActivityManagerService;->bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z

    move-result v3

    if-nez v3, :cond_6

    .line 11420
    new-instance v3, Landroid/content/ComponentName;

    const-string v4, "!"

    const-string v5, "Service process is bad"

    invoke-direct {v3, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_0

    .line 11418
    :catchall_1
    move-exception v4

    :try_start_4
    monitor-exit v3
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    :try_start_5
    throw v4

    .line 11422
    :cond_6
    iget-object v3, v1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    goto :goto_0
.end method

.method public stopAppSwitches()V
    .locals 5

    .prologue
    const-wide/16 v3, 0x1388

    .line 8350
    const-string v1, "android.permission.STOP_APP_SWITCHES"

    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v1

    if-eqz v1, :cond_0

    .line 8352
    new-instance v1, Ljava/lang/SecurityException;

    const-string v2, "Requires permission android.permission.STOP_APP_SWITCHES"

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 8356
    :cond_0
    monitor-enter p0

    .line 8357
    :try_start_0
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    add-long/2addr v1, v3

    iput-wide v1, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 8359
    const/4 v1, 0x0

    iput-boolean v1, p0, Lcom/android/server/am/ActivityManagerService;->mDidAppSwitch:Z

    .line 8360
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v2, 0x15

    invoke-virtual {v1, v2}, Landroid/os/Handler;->removeMessages(I)V

    .line 8361
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v2, 0x15

    invoke-virtual {v1, v2}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 8362
    .local v0, msg:Landroid/os/Message;
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v2, 0x1388

    invoke-virtual {v1, v0, v2, v3}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 8363
    monitor-exit p0

    .line 8364
    return-void

    .line 8363
    .end local v0           #msg:Landroid/os/Message;
    :catchall_0
    move-exception v1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v1
.end method

.method public stopService(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;)I
    .locals 7
    .parameter "caller"
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    const/4 v6, 0x1

    const/4 v5, 0x0

    .line 11458
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    if-ne v4, v6, :cond_0

    .line 11459
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 11462
    :cond_0
    monitor-enter p0

    .line 11466
    :try_start_0
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 11467
    .local v0, callerApp:Lcom/android/server/am/ProcessRecord;
    if-eqz p1, :cond_1

    if-nez v0, :cond_1

    .line 11468
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to find app for caller "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ") when stopping service "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 11490
    .end local v0           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 11475
    .restart local v0       #callerApp:Lcom/android/server/am/ProcessRecord;
    :cond_1
    :try_start_1
    invoke-direct {p0, p2, p3}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/Intent;Ljava/lang/String;)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v3

    .line 11476
    .local v3, r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-eqz v3, :cond_3

    .line 11477
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    if-eqz v4, :cond_2

    .line 11478
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    monitor-enter v4
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 11479
    :try_start_2
    iget-object v5, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v5, v5, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v5}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopRunningLocked()V

    .line 11480
    monitor-exit v4
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    .line 11481
    :try_start_3
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 11482
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/ServiceRecord;->callStart:Z

    .line 11483
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 11484
    .local v1, origId:J
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    const/4 v5, 0x0

    invoke-direct {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11485
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11486
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    move v4, v6

    .line 11492
    .end local v1           #origId:J
    :goto_0
    return v4

    .line 11480
    :catchall_1
    move-exception v5

    :try_start_4
    monitor-exit v4
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    :try_start_5
    throw v5

    .line 11488
    :cond_2
    const/4 v4, -0x1

    monitor-exit p0

    goto :goto_0

    .line 11490
    :cond_3
    monitor-exit p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    move v4, v5

    .line 11492
    goto :goto_0
.end method

.method public stopServiceToken(Landroid/content/ComponentName;Landroid/os/IBinder;I)Z
    .locals 7
    .parameter "className"
    .parameter "token"
    .parameter "startId"

    .prologue
    const/4 v6, 0x0

    .line 11527
    monitor-enter p0

    .line 11530
    :try_start_0
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/ComponentName;Landroid/os/IBinder;)Lcom/android/server/am/ServiceRecord;

    move-result-object v2

    .line 11531
    .local v2, r:Lcom/android/server/am/ServiceRecord;
    if-eqz v2, :cond_4

    .line 11532
    if-ltz p3, :cond_3

    .line 11536
    const/4 v4, 0x0

    invoke-virtual {v2, p3, v4}, Lcom/android/server/am/ServiceRecord;->findDeliveredStart(IZ)Lcom/android/server/am/ServiceRecord$StartItem;

    move-result-object v3

    .line 11537
    .local v3, si:Lcom/android/server/am/ServiceRecord$StartItem;
    if-eqz v3, :cond_1

    .line 11538
    :cond_0
    iget-object v4, v2, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    if-lez v4, :cond_1

    .line 11539
    iget-object v4, v2, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    const/4 v5, 0x0

    invoke-virtual {v4, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v4

    if-ne v4, v3, :cond_0

    .line 11545
    :cond_1
    iget v4, v2, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    if-eq v4, p3, :cond_2

    .line 11546
    monitor-exit p0

    move v4, v6

    .line 11567
    .end local v3           #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :goto_0
    return v4

    .line 11549
    .restart local v3       #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :cond_2
    iget-object v4, v2, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    if-lez v4, :cond_3

    .line 11550
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "stopServiceToken startId "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " is last, but have "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v2, Lcom/android/server/am/ServiceRecord;->deliveredStarts:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " remaining args"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11556
    .end local v3           #si:Lcom/android/server/am/ServiceRecord$StartItem;
    :cond_3
    iget-object v4, v2, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    monitor-enter v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 11557
    :try_start_1
    iget-object v5, v2, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v5}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopRunningLocked()V

    .line 11558
    const/4 v5, 0x0

    iput-boolean v5, v2, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 11559
    const/4 v5, 0x0

    iput-boolean v5, v2, Lcom/android/server/am/ServiceRecord;->callStart:Z

    .line 11560
    monitor-exit v4
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 11561
    :try_start_2
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 11562
    .local v0, origId:J
    const/4 v4, 0x0

    invoke-direct {p0, v2, v4}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11563
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11564
    const/4 v4, 0x1

    monitor-exit p0

    goto :goto_0

    .line 11566
    .end local v0           #origId:J
    .end local v2           #r:Lcom/android/server/am/ServiceRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v4

    .line 11560
    .restart local v2       #r:Lcom/android/server/am/ServiceRecord;
    :catchall_1
    move-exception v5

    :try_start_3
    monitor-exit v4
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    :try_start_4
    throw v5

    .line 11566
    :cond_4
    monitor-exit p0
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    move v4, v6

    .line 11567
    goto :goto_0
.end method

.method public systemReady(Ljava/lang/Runnable;)V
    .locals 30
    .parameter "goingCallback"

    .prologue
    .line 8739
    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v3

    if-nez v3, :cond_0

    .line 8740
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    .line 8741
    const-string v3, "android.intent.action.MAIN"

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8744
    :cond_0
    monitor-enter p0

    .line 8745
    :try_start_0
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v3, v0

    if-eqz v3, :cond_2

    .line 8746
    if-eqz p1, :cond_1

    invoke-interface/range {p1 .. p1}, Ljava/lang/Runnable;->run()V

    .line 8747
    :cond_1
    monitor-exit p0

    .line 8910
    :goto_0
    return-void

    .line 8751
    :cond_2
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDidUpdate:Z

    move v3, v0

    if-nez v3, :cond_a

    .line 8752
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingUpdate:Z

    move v3, v0

    if-eqz v3, :cond_3

    .line 8753
    monitor-exit p0

    goto :goto_0

    .line 8805
    :catchall_0
    move-exception v3

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3

    .line 8755
    :cond_3
    :try_start_1
    new-instance v6, Landroid/content/Intent;

    const-string v3, "android.intent.action.PRE_BOOT_COMPLETED"

    invoke-direct {v6, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 8756
    .local v6, intent:Landroid/content/Intent;
    const/16 v29, 0x0

    .line 8758
    .local v29, ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :try_start_2
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-interface {v3, v6, v4, v5}, Landroid/content/pm/IPackageManager;->queryIntentReceivers(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_2

    move-result-object v29

    .line 8762
    :goto_1
    if-eqz v29, :cond_8

    .line 8763
    :try_start_3
    invoke-interface/range {v29 .. v29}, Ljava/util/List;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v22, v3, v4

    .local v22, i:I
    :goto_2
    if-ltz v22, :cond_5

    .line 8764
    move-object/from16 v0, v29

    move/from16 v1, v22

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    iget-object v3, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v3, v3, 0x1

    if-nez v3, :cond_4

    .line 8766
    move-object/from16 v0, v29

    move/from16 v1, v22

    invoke-interface {v0, v1}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 8763
    :cond_4
    add-int/lit8 v22, v22, -0x1

    goto :goto_2

    .line 8769
    :cond_5
    const/high16 v3, 0x800

    invoke-virtual {v6, v3}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 8770
    const/16 v22, 0x0

    :goto_3
    invoke-interface/range {v29 .. v29}, Ljava/util/List;->size()I

    move-result v3

    move/from16 v0, v22

    move v1, v3

    if-ge v0, v1, :cond_8

    .line 8771
    move-object/from16 v0, v29

    move/from16 v1, v22

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    move-object v0, v3

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object/from16 v18, v0

    .line 8772
    .local v18, ai:Landroid/content/pm/ActivityInfo;
    new-instance v3, Landroid/content/ComponentName;

    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object v4, v0

    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    move-object v5, v0

    invoke-direct {v3, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v3}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 8773
    const/4 v8, 0x0

    .line 8774
    .local v8, finisher:Landroid/content/IIntentReceiver;
    invoke-interface/range {v29 .. v29}, Ljava/util/List;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int/2addr v3, v4

    move/from16 v0, v22

    move v1, v3

    if-ne v0, v1, :cond_6

    .line 8775
    new-instance v8, Lcom/android/server/am/ActivityManagerService$7;

    .end local v8           #finisher:Landroid/content/IIntentReceiver;
    move-object v0, v8

    move-object/from16 v1, p0

    move-object/from16 v2, p1

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService$7;-><init>(Lcom/android/server/am/ActivityManagerService;Ljava/lang/Runnable;)V

    .line 8787
    .restart local v8       #finisher:Landroid/content/IIntentReceiver;
    :cond_6
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Sending system update to: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v6}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8788
    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x1

    const/4 v14, 0x0

    sget v15, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v16, 0x3e8

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v16}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 8790
    if-eqz v8, :cond_7

    .line 8791
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mWaitingUpdate:Z

    .line 8770
    :cond_7
    add-int/lit8 v22, v22, 0x1

    goto :goto_3

    .line 8795
    .end local v8           #finisher:Landroid/content/IIntentReceiver;
    .end local v18           #ai:Landroid/content/pm/ActivityInfo;
    .end local v22           #i:I
    :cond_8
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingUpdate:Z

    move v3, v0

    if-eqz v3, :cond_9

    .line 8796
    monitor-exit p0

    goto/16 :goto_0

    .line 8798
    :cond_9
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mDidUpdate:Z

    .line 8801
    .end local v6           #intent:Landroid/content/Intent;
    .end local v29           #ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_a
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    .line 8802
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    move v3, v0

    if-nez v3, :cond_b

    .line 8803
    monitor-exit p0

    goto/16 :goto_0

    .line 8805
    :cond_b
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 8807
    const/16 v26, 0x0

    .line 8808
    .local v26, procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v3, v0

    monitor-enter v3

    .line 8809
    :try_start_4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/util/SparseArray;->size()I
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    move-result v4

    const/4 v5, 0x1

    sub-int v22, v4, v5

    .restart local v22       #i:I
    move-object/from16 v27, v26

    .end local v26           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .local v27, procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :goto_4
    if-ltz v22, :cond_c

    .line 8810
    :try_start_5
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v22

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v25

    check-cast v25, Lcom/android/server/am/ProcessRecord;

    .line 8811
    .local v25, proc:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    move-object/from16 v0, p0

    move-object v1, v4

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->isAllowedWhileBooting(Landroid/content/pm/ApplicationInfo;)Z

    move-result v4

    if-nez v4, :cond_17

    .line 8812
    if-nez v27, :cond_16

    .line 8813
    new-instance v26, Ljava/util/ArrayList;

    invoke-direct/range {v26 .. v26}, Ljava/util/ArrayList;-><init>()V
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_5

    .line 8815
    .end local v27           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v26       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :goto_5
    :try_start_6
    move-object/from16 v0, v26

    move-object/from16 v1, v25

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    .line 8809
    :goto_6
    add-int/lit8 v22, v22, -0x1

    move-object/from16 v27, v26

    .end local v26           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v27       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    goto :goto_4

    .line 8818
    .end local v25           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_c
    :try_start_7
    monitor-exit v3
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_5

    .line 8820
    if-eqz v27, :cond_e

    .line 8821
    monitor-enter p0

    .line 8822
    :try_start_8
    invoke-virtual/range {v27 .. v27}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v22, v3, v4

    :goto_7
    if-ltz v22, :cond_d

    .line 8823
    move-object/from16 v0, v27

    move/from16 v1, v22

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v25

    check-cast v25, Lcom/android/server/am/ProcessRecord;

    .line 8824
    .restart local v25       #proc:Lcom/android/server/am/ProcessRecord;
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Removing system update proc: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, v25

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8825
    const/4 v3, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v25

    move v2, v3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_2

    .line 8822
    add-int/lit8 v22, v22, -0x1

    goto :goto_7

    .line 8818
    .end local v22           #i:I
    .end local v25           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v27           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v26       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :catchall_1
    move-exception v4

    :goto_8
    :try_start_9
    monitor-exit v3
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_1

    throw v4

    .line 8827
    .end local v26           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v22       #i:I
    .restart local v27       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_d
    :try_start_a
    monitor-exit p0
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_2

    .line 8830
    :cond_e
    const-string v3, "ActivityManager"

    const-string v4, "System now ready"

    invoke-static {v3, v4}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8831
    const/16 v3, 0xbe0

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v4

    invoke-static {v3, v4, v5}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 8834
    monitor-enter p0

    .line 8837
    :try_start_b
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v3, v0

    const/4 v4, 0x1

    if-ne v3, v4, :cond_f

    .line 8838
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v3

    new-instance v4, Landroid/content/Intent;

    const-string v5, "android.intent.action.FACTORY_TEST"

    invoke-direct {v4, v5}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    const/16 v5, 0x400

    invoke-virtual {v3, v4, v5}, Landroid/content/pm/PackageManager;->resolveActivity(Landroid/content/Intent;I)Landroid/content/pm/ResolveInfo;

    move-result-object v28

    .line 8841
    .local v28, ri:Landroid/content/pm/ResolveInfo;
    const/16 v21, 0x0

    .line 8842
    .local v21, errorMsg:Ljava/lang/CharSequence;
    if-eqz v28, :cond_13

    .line 8843
    move-object/from16 v0, v28

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object/from16 v18, v0

    .line 8844
    .restart local v18       #ai:Landroid/content/pm/ActivityInfo;
    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v19, v0

    .line 8845
    .local v19, app:Landroid/content/pm/ApplicationInfo;
    move-object/from16 v0, v19

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->flags:I

    move v3, v0

    and-int/lit8 v3, v3, 0x1

    if-eqz v3, :cond_12

    .line 8846
    const-string v3, "android.intent.action.FACTORY_TEST"

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8847
    const/4 v3, 0x0

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    .line 8848
    new-instance v3, Landroid/content/ComponentName;

    move-object/from16 v0, v19

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object v4, v0

    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    move-object v5, v0

    invoke-direct {v3, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    .line 8858
    .end local v18           #ai:Landroid/content/pm/ActivityInfo;
    .end local v19           #app:Landroid/content/pm/ApplicationInfo;
    :goto_9
    if-eqz v21, :cond_f

    .line 8859
    const/4 v3, 0x0

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8860
    const/4 v3, 0x0

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    .line 8861
    const/4 v3, 0x0

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    .line 8862
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v24

    .line 8863
    .local v24, msg:Landroid/os/Message;
    const/4 v3, 0x3

    move v0, v3

    move-object/from16 v1, v24

    iput v0, v1, Landroid/os/Message;->what:I

    .line 8864
    invoke-virtual/range {v24 .. v24}, Landroid/os/Message;->getData()Landroid/os/Bundle;

    move-result-object v3

    const-string v4, "msg"

    move-object v0, v3

    move-object v1, v4

    move-object/from16 v2, v21

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putCharSequence(Ljava/lang/String;Ljava/lang/CharSequence;)V

    .line 8865
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 8868
    .end local v21           #errorMsg:Ljava/lang/CharSequence;
    .end local v24           #msg:Landroid/os/Message;
    .end local v28           #ri:Landroid/content/pm/ResolveInfo;
    :cond_f
    monitor-exit p0
    :try_end_b
    .catchall {:try_start_b .. :try_end_b} :catchall_3

    .line 8870
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->retrieveSettings()V

    .line 8872
    if-eqz p1, :cond_10

    invoke-interface/range {p1 .. p1}, Ljava/lang/Runnable;->run()V

    .line 8874
    :cond_10
    monitor-enter p0

    .line 8875
    :try_start_c
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v3, v0
    :try_end_c
    .catchall {:try_start_c .. :try_end_c} :catchall_4

    const/4 v4, 0x1

    if-eq v3, v4, :cond_14

    .line 8877
    :try_start_d
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    const/16 v4, 0x400

    invoke-interface {v3, v4}, Landroid/content/pm/IPackageManager;->getPersistentApplications(I)Ljava/util/List;

    move-result-object v20

    .line 8879
    .local v20, apps:Ljava/util/List;
    if-eqz v20, :cond_14

    .line 8880
    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v17

    .line 8882
    .local v17, N:I
    const/16 v22, 0x0

    :goto_a
    move/from16 v0, v22

    move/from16 v1, v17

    if-ge v0, v1, :cond_14

    .line 8883
    move-object/from16 v0, v20

    move/from16 v1, v22

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Landroid/content/pm/ApplicationInfo;

    .line 8885
    .local v23, info:Landroid/content/pm/ApplicationInfo;
    if-eqz v23, :cond_11

    move-object/from16 v0, v23

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object v3, v0

    const-string v4, "android"

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_11

    .line 8887
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;
    :try_end_d
    .catchall {:try_start_d .. :try_end_d} :catchall_4
    .catch Landroid/os/RemoteException; {:try_start_d .. :try_end_d} :catch_0

    .line 8882
    :cond_11
    add-int/lit8 v22, v22, 0x1

    goto :goto_a

    .line 8827
    .end local v17           #N:I
    .end local v20           #apps:Ljava/util/List;
    .end local v23           #info:Landroid/content/pm/ApplicationInfo;
    :catchall_2
    move-exception v3

    :try_start_e
    monitor-exit p0
    :try_end_e
    .catchall {:try_start_e .. :try_end_e} :catchall_2

    throw v3

    .line 8851
    .restart local v18       #ai:Landroid/content/pm/ActivityInfo;
    .restart local v19       #app:Landroid/content/pm/ApplicationInfo;
    .restart local v21       #errorMsg:Ljava/lang/CharSequence;
    .restart local v28       #ri:Landroid/content/pm/ResolveInfo;
    :cond_12
    :try_start_f
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v3

    const v4, 0x104039c

    invoke-virtual {v3, v4}, Landroid/content/res/Resources;->getText(I)Ljava/lang/CharSequence;

    move-result-object v21

    goto/16 :goto_9

    .line 8855
    .end local v18           #ai:Landroid/content/pm/ActivityInfo;
    .end local v19           #app:Landroid/content/pm/ApplicationInfo;
    :cond_13
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v3

    const v4, 0x104039d

    invoke-virtual {v3, v4}, Landroid/content/res/Resources;->getText(I)Ljava/lang/CharSequence;

    move-result-object v21

    goto/16 :goto_9

    .line 8868
    .end local v21           #errorMsg:Ljava/lang/CharSequence;
    .end local v28           #ri:Landroid/content/pm/ResolveInfo;
    :catchall_3
    move-exception v3

    monitor-exit p0
    :try_end_f
    .catchall {:try_start_f .. :try_end_f} :catchall_3

    throw v3

    .line 8891
    :catch_0
    move-exception v3

    .line 8897
    :cond_14
    const/4 v3, 0x1

    :try_start_10
    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBooting:Z
    :try_end_10
    .catchall {:try_start_10 .. :try_end_10} :catchall_4

    .line 8900
    :try_start_11
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    invoke-interface {v3}, Landroid/content/pm/IPackageManager;->hasSystemUidErrors()Z

    move-result v3

    if-eqz v3, :cond_15

    .line 8901
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v24

    .line 8902
    .restart local v24       #msg:Landroid/os/Message;
    const/16 v3, 0xe

    move v0, v3

    move-object/from16 v1, v24

    iput v0, v1, Landroid/os/Message;->what:I

    .line 8903
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z
    :try_end_11
    .catchall {:try_start_11 .. :try_end_11} :catchall_4
    .catch Landroid/os/RemoteException; {:try_start_11 .. :try_end_11} :catch_1

    .line 8908
    .end local v24           #msg:Landroid/os/Message;
    :cond_15
    :goto_b
    const/4 v3, 0x0

    :try_start_12
    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 8909
    monitor-exit p0

    goto/16 :goto_0

    :catchall_4
    move-exception v3

    monitor-exit p0
    :try_end_12
    .catchall {:try_start_12 .. :try_end_12} :catchall_4

    throw v3

    .line 8905
    :catch_1
    move-exception v3

    goto :goto_b

    .line 8818
    :catchall_5
    move-exception v4

    move-object/from16 v26, v27

    .end local v27           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v26       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    goto/16 :goto_8

    .line 8760
    .end local v22           #i:I
    .end local v26           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v29       #ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :catch_2
    move-exception v3

    goto/16 :goto_1

    .end local v6           #intent:Landroid/content/Intent;
    .end local v29           #ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local v22       #i:I
    .restart local v25       #proc:Lcom/android/server/am/ProcessRecord;
    .restart local v27       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_16
    move-object/from16 v26, v27

    .end local v27           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v26       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    goto/16 :goto_5

    .end local v26           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v27       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_17
    move-object/from16 v26, v27

    .end local v27           #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v26       #procsToKill:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    goto/16 :goto_6
.end method

.method public testIsSystemReady()Z
    .locals 1

    .prologue
    .line 8733
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    return v0
.end method

.method public unbindBackupAgent(Landroid/content/pm/ApplicationInfo;)V
    .locals 5
    .parameter "appInfo"

    .prologue
    const-string v3, "ActivityManager"

    .line 12137
    if-nez p1, :cond_0

    .line 12138
    const-string v2, "ActivityManager"

    const-string v2, "unbind backup agent for null app"

    invoke-static {v3, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12170
    :goto_0
    return-void

    .line 12142
    :cond_0
    monitor-enter p0

    .line 12143
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    if-nez v2, :cond_1

    .line 12144
    const-string v2, "ActivityManager"

    const-string v3, "Unbinding backup agent with no active backup"

    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12145
    monitor-exit p0

    goto :goto_0

    .line 12169
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2

    .line 12148
    :cond_1
    :try_start_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    iget-object v3, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_2

    .line 12149
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unbind of "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " but is not the current backup target"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 12150
    monitor-exit p0

    goto :goto_0

    .line 12153
    :cond_2
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    iget-object v1, v2, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 12154
    .local v1, proc:Lcom/android/server/am/ProcessRecord;
    const/4 v2, 0x0

    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    .line 12155
    const/4 v2, 0x0

    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    .line 12158
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 12161
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    if-eqz v2, :cond_3

    .line 12163
    :try_start_2
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v2, p1}, Landroid/app/IApplicationThread;->scheduleDestroyBackupAgent(Landroid/content/pm/ApplicationInfo;)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_0

    .line 12169
    :cond_3
    :goto_1
    :try_start_3
    monitor-exit p0

    goto :goto_0

    .line 12164
    :catch_0
    move-exception v2

    move-object v0, v2

    .line 12165
    .local v0, e:Ljava/lang/Exception;
    const-string v2, "ActivityManager"

    const-string v3, "Exception when unbinding backup agent:"

    invoke-static {v2, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 12166
    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_1
.end method

.method public unbindFinished(Landroid/os/IBinder;Landroid/content/Intent;Z)V
    .locals 8
    .parameter "token"
    .parameter "intent"
    .parameter "doRebind"

    .prologue
    const/4 v7, 0x1

    .line 11889
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v6

    if-ne v6, v7, :cond_0

    .line 11890
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "File descriptors passed in Intent"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 11893
    :cond_0
    monitor-enter p0

    .line 11894
    :try_start_0
    instance-of v6, p1, Lcom/android/server/am/ServiceRecord;

    if-nez v6, :cond_1

    .line 11895
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "Invalid service token"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 11924
    :catchall_0
    move-exception v6

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v6

    .line 11897
    :cond_1
    :try_start_1
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v5, v0

    .line 11899
    .local v5, r:Lcom/android/server/am/ServiceRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 11901
    .local v3, origId:J
    if-eqz v5, :cond_3

    .line 11902
    new-instance v2, Landroid/content/Intent$FilterComparison;

    invoke-direct {v2, p2}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 11904
    .local v2, filter:Landroid/content/Intent$FilterComparison;
    iget-object v6, v5, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v6, v2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/IntentBindRecord;

    .line 11908
    .local v1, b:Lcom/android/server/am/IntentBindRecord;
    if-eqz v1, :cond_2

    .line 11909
    iget-object v6, v1, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v6}, Ljava/util/HashMap;->size()I

    move-result v6

    if-lez v6, :cond_4

    .line 11912
    const/4 v6, 0x1

    invoke-direct {p0, v5, v1, v6}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z

    .line 11920
    :cond_2
    :goto_0
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v6

    invoke-virtual {p0, v5, v6}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 11922
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11924
    .end local v1           #b:Lcom/android/server/am/IntentBindRecord;
    .end local v2           #filter:Landroid/content/Intent$FilterComparison;
    :cond_3
    monitor-exit p0

    .line 11925
    return-void

    .line 11916
    .restart local v1       #b:Lcom/android/server/am/IntentBindRecord;
    .restart local v2       #filter:Landroid/content/Intent$FilterComparison;
    :cond_4
    const/4 v6, 0x1

    iput-boolean v6, v1, Lcom/android/server/am/IntentBindRecord;->doRebind:Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_0
.end method

.method public unbindService(Landroid/app/IServiceConnection;)Z
    .locals 7
    .parameter "connection"

    .prologue
    .line 11805
    monitor-enter p0

    .line 11806
    :try_start_0
    invoke-interface {p1}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    .line 11808
    .local v0, binder:Landroid/os/IBinder;
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v4, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ConnectionRecord;

    .line 11809
    .local v3, r:Lcom/android/server/am/ConnectionRecord;
    if-nez v3, :cond_0

    .line 11810
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unbind failed: could not find connection for "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-interface {p1}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11812
    const/4 v4, 0x0

    monitor-exit p0

    .line 11827
    :goto_0
    return v4

    .line 11815
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 11817
    .local v1, origId:J
    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-direct {p0, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V

    .line 11819
    iget-object v4, v3, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v4, v4, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v4, :cond_1

    .line 11821
    iget-object v4, v3, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v4, v4, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11824
    :cond_1
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11825
    monitor-exit p0

    .line 11827
    const/4 v4, 0x1

    goto :goto_0

    .line 11825
    .end local v0           #binder:Landroid/os/IBinder;
    .end local v1           #origId:J
    .end local v3           #r:Lcom/android/server/am/ConnectionRecord;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4
.end method

.method public final unbroadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;)V
    .locals 6
    .parameter "caller"
    .parameter "intent"

    .prologue
    const-string v4, "android.permission.BROADCAST_STICKY"

    .line 12728
    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    const/4 v5, 0x1

    if-ne v4, v5, :cond_0

    .line 12729
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 12732
    :cond_0
    monitor-enter p0

    .line 12733
    :try_start_0
    const-string v4, "android.permission.BROADCAST_STICKY"

    invoke-virtual {p0, v4}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v4

    if-eqz v4, :cond_1

    .line 12735
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Permission Denial: unbroadcastIntent() from pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ", uid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " requires "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "android.permission.BROADCAST_STICKY"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 12739
    .local v3, msg:Ljava/lang/String;
    const-string v4, "ActivityManager"

    invoke-static {v4, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12740
    new-instance v4, Ljava/lang/SecurityException;

    invoke-direct {v4, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 12753
    .end local v3           #msg:Ljava/lang/String;
    :catchall_0
    move-exception v4

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v4

    .line 12742
    :cond_1
    :try_start_1
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/util/ArrayList;

    .line 12743
    .local v2, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    if-eqz v2, :cond_2

    .line 12744
    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 12746
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_0
    if-ge v1, v0, :cond_2

    .line 12747
    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/Intent;

    invoke-virtual {p2, v4}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v4

    if-eqz v4, :cond_3

    .line 12748
    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 12753
    .end local v0           #N:I
    .end local v1           #i:I
    :cond_2
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 12754
    return-void

    .line 12746
    .restart local v0       #N:I
    .restart local v1       #i:I
    :cond_3
    add-int/lit8 v1, v1, 0x1

    goto :goto_0
.end method

.method public unhandledBack()V
    .locals 9

    .prologue
    const/4 v2, 0x1

    .line 8220
    const-string v0, "android.permission.FORCE_BACK"

    const-string v1, "unhandledBack()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 8223
    monitor-enter p0

    .line 8224
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v6

    .line 8227
    .local v6, count:I
    if-le v6, v2, :cond_0

    .line 8228
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v7

    .line 8229
    .local v7, origId:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    sub-int v1, v6, v2

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    sub-int v2, v6, v2

    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "unhandled-back"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 8231
    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8233
    .end local v7           #origId:J
    :cond_0
    monitor-exit p0

    .line 8234
    return-void

    .line 8233
    .end local v6           #count:I
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public unregisterActivityWatcher(Landroid/app/IActivityWatcher;)V
    .locals 1
    .parameter "watcher"

    .prologue
    .line 8474
    monitor-enter p0

    .line 8475
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v0, p1}, Landroid/os/RemoteCallbackList;->unregister(Landroid/os/IInterface;)Z

    .line 8476
    monitor-exit p0

    .line 8477
    return-void

    .line 8476
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public unregisterReceiver(Landroid/content/IIntentReceiver;)V
    .locals 13
    .parameter "receiver"

    .prologue
    const/4 v12, 0x0

    .line 12295
    const/4 v7, 0x0

    .line 12297
    .local v7, doNext:Z
    monitor-enter p0

    .line 12298
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    invoke-interface {p1}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/am/ReceiverList;

    .line 12300
    .local v11, rl:Lcom/android/server/am/ReceiverList;
    if-eqz v11, :cond_2

    .line 12301
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    if-eqz v0, :cond_0

    .line 12302
    iget-object v10, v11, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 12303
    .local v10, r:Lcom/android/server/am/BroadcastRecord;
    invoke-interface {p1}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v1

    iget v2, v10, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v3, v10, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v4, v10, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v5, v10, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    const/4 v6, 0x1

    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    move-result v7

    .line 12308
    .end local v10           #r:Lcom/android/server/am/BroadcastRecord;
    :cond_0
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_1

    .line 12309
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v0, v11}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 12311
    :cond_1
    invoke-virtual {p0, v11}, Lcom/android/server/am/ActivityManagerService;->removeReceiverLocked(Lcom/android/server/am/ReceiverList;)V

    .line 12312
    iget-boolean v0, v11, Lcom/android/server/am/ReceiverList;->linkedToDeath:Z

    if-eqz v0, :cond_2

    .line 12313
    const/4 v0, 0x0

    iput-boolean v0, v11, Lcom/android/server/am/ReceiverList;->linkedToDeath:Z

    .line 12314
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    invoke-interface {v0}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    const/4 v1, 0x0

    invoke-interface {v0, v11, v1}, Landroid/os/IBinder;->unlinkToDeath(Landroid/os/IBinder$DeathRecipient;I)Z

    .line 12317
    :cond_2
    monitor-exit p0

    .line 12319
    if-nez v7, :cond_3

    .line 12327
    :goto_0
    return-void

    .line 12317
    .end local v11           #rl:Lcom/android/server/am/ReceiverList;
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    .line 12323
    .restart local v11       #rl:Lcom/android/server/am/ReceiverList;
    :cond_3
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 12324
    .local v8, origId:J
    invoke-direct {p0, v12}, Lcom/android/server/am/ActivityManagerService;->processNextBroadcast(Z)V

    .line 12325
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 12326
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_0
.end method

.method public updateConfiguration(Landroid/content/res/Configuration;)V
    .locals 4
    .parameter "values"

    .prologue
    .line 13500
    const-string v2, "android.permission.CHANGE_CONFIGURATION"

    const-string v3, "updateConfiguration()"

    invoke-virtual {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 13503
    monitor-enter p0

    .line 13504
    if-nez p1, :cond_0

    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    if-eqz v2, :cond_0

    .line 13506
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v2}, Lcom/android/server/WindowManagerService;->computeNewConfiguration()Landroid/content/res/Configuration;

    move-result-object p1

    .line 13509
    :cond_0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 13510
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-virtual {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    .line 13511
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 13512
    monitor-exit p0

    .line 13513
    return-void

    .line 13512
    .end local v0           #origId:J
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2
.end method

.method public updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z
    .locals 29
    .parameter "values"
    .parameter "starting"

    .prologue
    .line 13524
    const/16 v24, 0x0

    .line 13526
    .local v24, changes:I
    const/16 v26, 0x1

    .line 13528
    .local v26, kept:Z
    if-eqz p1, :cond_7

    .line 13529
    new-instance v28, Landroid/content/res/Configuration;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v4, v0

    move-object/from16 v0, v28

    move-object v1, v4

    invoke-direct {v0, v1}, Landroid/content/res/Configuration;-><init>(Landroid/content/res/Configuration;)V

    .line 13530
    .local v28, newConfig:Landroid/content/res/Configuration;
    move-object/from16 v0, v28

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Landroid/content/res/Configuration;->updateFrom(Landroid/content/res/Configuration;)I

    move-result v24

    .line 13531
    if-eqz v24, :cond_7

    .line 13536
    const/16 v4, 0xa9f

    move v0, v4

    move/from16 v1, v24

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(II)I

    .line 13538
    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    move-object v4, v0

    if-eqz v4, :cond_0

    .line 13539
    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    move-object v4, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    move-object v5, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    invoke-virtual {v5, v6}, Ljava/util/Locale;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_5

    const/4 v5, 0x1

    :goto_0
    move-object/from16 v0, p1

    iget-boolean v0, v0, Landroid/content/res/Configuration;->userSetLocale:Z

    move v6, v0

    move-object/from16 v0, p0

    move-object v1, v4

    move v2, v5

    move v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->saveLocaleLocked(Ljava/util/Locale;ZZ)V

    .line 13544
    :cond_0
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    move v4, v0

    add-int/lit8 v4, v4, 0x1

    move v0, v4

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    .line 13545
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    move v4, v0

    if-gtz v4, :cond_1

    .line 13546
    const/4 v4, 0x1

    move v0, v4

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    .line 13548
    :cond_1
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfigurationSeq:I

    move v4, v0

    move v0, v4

    move-object/from16 v1, v28

    iput v0, v1, Landroid/content/res/Configuration;->seq:I

    .line 13549
    move-object/from16 v0, v28

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    .line 13550
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Config changed: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, v28

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 13552
    invoke-static {}, Lcom/android/server/AttributeCache;->instance()Lcom/android/server/AttributeCache;

    move-result-object v22

    .line 13553
    .local v22, ac:Lcom/android/server/AttributeCache;
    if-eqz v22, :cond_2

    .line 13554
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v4, v0

    move-object/from16 v0, v22

    move-object v1, v4

    invoke-virtual {v0, v1}, Lcom/android/server/AttributeCache;->updateConfiguration(Landroid/content/res/Configuration;)V

    .line 13557
    :cond_2
    invoke-static/range {v24 .. v24}, Landroid/provider/Settings$System;->hasInterestingConfigurationChanges(I)Z

    move-result v4

    if-eqz v4, :cond_3

    .line 13558
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v4, v0

    const/4 v5, 0x4

    invoke-virtual {v4, v5}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v27

    .line 13559
    .local v27, msg:Landroid/os/Message;
    new-instance v4, Landroid/content/res/Configuration;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v5, v0

    invoke-direct {v4, v5}, Landroid/content/res/Configuration;-><init>(Landroid/content/res/Configuration;)V

    move-object v0, v4

    move-object/from16 v1, v27

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 13560
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v27

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 13563
    .end local v27           #msg:Landroid/os/Message;
    :cond_3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    const/4 v5, 0x1

    sub-int v25, v4, v5

    .local v25, i:I
    :goto_1
    if-ltz v25, :cond_6

    .line 13564
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLruProcesses:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v25

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Lcom/android/server/am/ProcessRecord;

    .line 13566
    .local v23, app:Lcom/android/server/am/ProcessRecord;
    :try_start_0
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v4, v0

    if-eqz v4, :cond_4

    .line 13569
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v4, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v5, v0

    invoke-interface {v4, v5}, Landroid/app/IApplicationThread;->scheduleConfigurationChanged(Landroid/content/res/Configuration;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 13563
    :cond_4
    :goto_2
    add-int/lit8 v25, v25, -0x1

    goto :goto_1

    .line 13539
    .end local v22           #ac:Lcom/android/server/AttributeCache;
    .end local v23           #app:Lcom/android/server/am/ProcessRecord;
    .end local v25           #i:I
    :cond_5
    const/4 v5, 0x0

    goto/16 :goto_0

    .line 13574
    .restart local v22       #ac:Lcom/android/server/AttributeCache;
    .restart local v25       #i:I
    :cond_6
    new-instance v7, Landroid/content/Intent;

    const-string v4, "android.intent.action.CONFIGURATION_CHANGED"

    invoke-direct {v7, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 13575
    .local v7, intent:Landroid/content/Intent;
    const/high16 v4, 0x6000

    invoke-virtual {v7, v4}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 13577
    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    sget v16, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v17, 0x3e8

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 13579
    and-int/lit8 v4, v24, 0x4

    if-eqz v4, :cond_7

    .line 13580
    const/4 v9, 0x0

    const/4 v10, 0x0

    new-instance v11, Landroid/content/Intent;

    const-string v4, "android.intent.action.LOCALE_CHANGED"

    invoke-direct {v11, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, 0x0

    const/16 v19, 0x0

    sget v20, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    const/16 v21, 0x3e8

    move-object/from16 v8, p0

    invoke-direct/range {v8 .. v21}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 13588
    .end local v7           #intent:Landroid/content/Intent;
    .end local v22           #ac:Lcom/android/server/AttributeCache;
    .end local v25           #i:I
    .end local v28           #newConfig:Landroid/content/res/Configuration;
    :cond_7
    if-eqz v24, :cond_8

    if-nez p2, :cond_8

    .line 13592
    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object p2

    .line 13595
    :cond_8
    if-eqz p2, :cond_9

    .line 13596
    move-object/from16 v0, p0

    move-object/from16 v1, p2

    move/from16 v2, v24

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivityConfigurationLocked(Lcom/android/server/am/HistoryRecord;I)Z

    move-result v26

    .line 13597
    if-eqz v26, :cond_9

    .line 13603
    move-object/from16 v0, p0

    move-object/from16 v1, p2

    move/from16 v2, v24

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 13607
    :cond_9
    if-eqz p1, :cond_a

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v4, v0

    if-eqz v4, :cond_a

    .line 13608
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v4, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v5, v0

    invoke-virtual {v4, v5}, Lcom/android/server/WindowManagerService;->setNewConfiguration(Landroid/content/res/Configuration;)V

    .line 13611
    :cond_a
    return v26

    .line 13571
    .restart local v22       #ac:Lcom/android/server/AttributeCache;
    .restart local v23       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v25       #i:I
    .restart local v28       #newConfig:Landroid/content/res/Configuration;
    :catch_0
    move-exception v4

    goto/16 :goto_2
.end method

.method updateCpuStats()V
    .locals 6

    .prologue
    .line 1492
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    .line 1493
    .local v0, now:J
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:Ljava/util/concurrent/atomic/AtomicLong;

    invoke-virtual {v2}, Ljava/util/concurrent/atomic/AtomicLong;->get()J

    move-result-wide v2

    const-wide/16 v4, 0x1388

    sub-long v4, v0, v4

    cmp-long v2, v2, v4

    if-ltz v2, :cond_1

    .line 1501
    :cond_0
    :goto_0
    return-void

    .line 1496
    :cond_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsMutexFree:Ljava/util/concurrent/atomic/AtomicBoolean;

    const/4 v3, 0x1

    const/4 v4, 0x0

    invoke-virtual {v2, v3, v4}, Ljava/util/concurrent/atomic/AtomicBoolean;->compareAndSet(ZZ)Z

    move-result v2

    if-eqz v2, :cond_0

    .line 1497
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    monitor-enter v2

    .line 1498
    :try_start_0
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    invoke-virtual {v3}, Ljava/lang/Object;->notify()V

    .line 1499
    monitor-exit v2

    goto :goto_0

    :catchall_0
    move-exception v3

    monitor-exit v2
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v3
.end method

.method updateCpuStatsNow()V
    .locals 25

    .prologue
    .line 1504
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    move-object/from16 v20, v0

    monitor-enter v20

    .line 1505
    :try_start_0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsMutexFree:Ljava/util/concurrent/atomic/AtomicBoolean;

    move-object/from16 v21, v0

    const/16 v22, 0x0

    invoke-virtual/range {v21 .. v22}, Ljava/util/concurrent/atomic/AtomicBoolean;->set(Z)V

    .line 1506
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v11

    .line 1507
    .local v11, now:J
    const/4 v6, 0x0

    .line 1509
    .local v6, haveNewCpuStats:Z
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:Ljava/util/concurrent/atomic/AtomicLong;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Ljava/util/concurrent/atomic/AtomicLong;->get()J

    move-result-wide v21

    const-wide/16 v23, 0x1388

    sub-long v23, v11, v23

    cmp-long v21, v21, v23

    if-gez v21, :cond_1

    .line 1511
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:Ljava/util/concurrent/atomic/AtomicLong;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move-wide v1, v11

    invoke-virtual {v0, v1, v2}, Ljava/util/concurrent/atomic/AtomicLong;->set(J)V

    .line 1512
    const/4 v6, 0x1

    .line 1513
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->update()V

    .line 1519
    const-string v21, "true"

    const-string v22, "events.cpu"

    invoke-static/range {v22 .. v22}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v22

    invoke-virtual/range {v21 .. v22}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v21

    if-eqz v21, :cond_1

    .line 1520
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastUserTime()I

    move-result v19

    .line 1521
    .local v19, user:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastSystemTime()I

    move-result v17

    .line 1522
    .local v17, system:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastIoWaitTime()I

    move-result v9

    .line 1523
    .local v9, iowait:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastIrqTime()I

    move-result v10

    .line 1524
    .local v10, irq:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastSoftIrqTime()I

    move-result v15

    .line 1525
    .local v15, softIrq:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastIdleTime()I

    move-result v8

    .line 1527
    .local v8, idle:I
    add-int v21, v19, v17

    add-int v21, v21, v9

    add-int v21, v21, v10

    add-int v21, v21, v15

    add-int v18, v21, v8

    .line 1528
    .local v18, total:I
    if-nez v18, :cond_0

    const/16 v18, 0x1

    .line 1530
    :cond_0
    const/16 v21, 0xaa1

    const/16 v22, 0x6

    move/from16 v0, v22

    new-array v0, v0, [Ljava/lang/Object;

    move-object/from16 v22, v0

    const/16 v23, 0x0

    add-int v24, v19, v17

    add-int v24, v24, v9

    add-int v24, v24, v10

    add-int v24, v24, v15

    mul-int/lit8 v24, v24, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    const/16 v23, 0x1

    mul-int/lit8 v24, v19, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    const/16 v23, 0x2

    mul-int/lit8 v24, v17, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    const/16 v23, 0x3

    mul-int/lit8 v24, v9, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    const/16 v23, 0x4

    mul-int/lit8 v24, v10, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    const/16 v23, 0x5

    mul-int/lit8 v24, v15, 0x64

    div-int v24, v24, v18

    invoke-static/range {v24 .. v24}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v24

    aput-object v24, v22, v23

    invoke-static/range {v21 .. v22}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 1540
    .end local v8           #idle:I
    .end local v9           #iowait:I
    .end local v10           #irq:I
    .end local v15           #softIrq:I
    .end local v17           #system:I
    .end local v18           #total:I
    .end local v19           #user:I
    :cond_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->getLastCpuSpeedTimes()[J

    move-result-object v5

    .line 1541
    .local v5, cpuSpeedTimes:[J
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    .line 1542
    .local v4, bstats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_2

    .line 1543
    :try_start_1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object/from16 v21, v0

    monitor-enter v21
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    .line 1544
    if-eqz v6, :cond_4

    .line 1545
    :try_start_2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v22, v0

    invoke-virtual/range {v22 .. v22}, Lcom/android/server/am/BatteryStatsService;->isOnBattery()Z

    move-result v22

    if-eqz v22, :cond_4

    .line 1546
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v22, v0

    invoke-virtual/range {v22 .. v22}, Lcom/android/server/ProcessStats;->countWorkingStats()I

    move-result v3

    .line 1547
    .local v3, N:I
    const/4 v7, 0x0

    .local v7, i:I
    :goto_0
    if-ge v7, v3, :cond_4

    .line 1548
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v22, v0

    move-object/from16 v0, v22

    move v1, v7

    invoke-virtual {v0, v1}, Lcom/android/server/ProcessStats;->getWorkingStats(I)Lcom/android/server/ProcessStats$Stats;

    move-result-object v16

    .line 1550
    .local v16, st:Lcom/android/server/ProcessStats$Stats;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object/from16 v22, v0

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->pid:I

    move/from16 v23, v0

    invoke-virtual/range {v22 .. v23}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/am/ProcessRecord;

    .line 1551
    .local v13, pr:Lcom/android/server/am/ProcessRecord;
    if-eqz v13, :cond_3

    .line 1552
    iget-object v14, v13, Lcom/android/server/am/ProcessRecord;->batteryStats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    .line 1553
    .local v14, ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_utime:I

    move/from16 v22, v0

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_stime:I

    move/from16 v23, v0

    move-object v0, v14

    move/from16 v1, v22

    move/from16 v2, v23

    invoke-virtual {v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addCpuTimeLocked(II)V

    .line 1554
    invoke-virtual {v14, v5}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addSpeedStepTimes([J)V

    .line 1547
    :cond_2
    :goto_1
    add-int/lit8 v7, v7, 0x1

    goto :goto_0

    .line 1556
    .end local v14           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    :cond_3
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/ProcessStats$Stats;->name:Ljava/lang/String;

    move-object/from16 v22, v0

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->pid:I

    move/from16 v23, v0

    move-object v0, v4

    move-object/from16 v1, v22

    move/from16 v2, v23

    invoke-virtual {v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl;->getProcessStatsLocked(Ljava/lang/String;I)Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-result-object v14

    .line 1558
    .restart local v14       #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    if-eqz v14, :cond_2

    .line 1559
    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_utime:I

    move/from16 v22, v0

    move-object/from16 v0, v16

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_stime:I

    move/from16 v23, v0

    move-object v0, v14

    move/from16 v1, v22

    move/from16 v2, v23

    invoke-virtual {v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addCpuTimeLocked(II)V

    .line 1560
    invoke-virtual {v14, v5}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addSpeedStepTimes([J)V

    goto :goto_1

    .line 1566
    .end local v3           #N:I
    .end local v7           #i:I
    .end local v13           #pr:Lcom/android/server/am/ProcessRecord;
    .end local v14           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    .end local v16           #st:Lcom/android/server/ProcessStats$Stats;
    :catchall_0
    move-exception v22

    monitor-exit v21
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    :try_start_3
    throw v22

    .line 1572
    :catchall_1
    move-exception v21

    monitor-exit v4
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    :try_start_4
    throw v21

    .line 1573
    .end local v4           #bstats:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v5           #cpuSpeedTimes:[J
    .end local v6           #haveNewCpuStats:Z
    .end local v11           #now:J
    :catchall_2
    move-exception v21

    monitor-exit v20
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_2

    throw v21

    .line 1566
    .restart local v4       #bstats:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v5       #cpuSpeedTimes:[J
    .restart local v6       #haveNewCpuStats:Z
    .restart local v11       #now:J
    :cond_4
    :try_start_5
    monitor-exit v21
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 1568
    :try_start_6
    move-object/from16 v0, p0

    iget-wide v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastWriteTime:J

    move-wide/from16 v21, v0

    const-wide/32 v23, 0x1b7740

    sub-long v23, v11, v23

    cmp-long v21, v21, v23

    if-gez v21, :cond_5

    .line 1569
    move-wide v0, v11

    move-object/from16 v2, p0

    iput-wide v0, v2, Lcom/android/server/am/ActivityManagerService;->mLastWriteTime:J

    .line 1570
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v21

    invoke-virtual/range {v21 .. v21}, Lcom/android/internal/os/BatteryStatsImpl;->writeLocked()V

    .line 1572
    :cond_5
    monitor-exit v4
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_1

    .line 1573
    :try_start_7
    monitor-exit v20
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_2

    .line 1574
    return-void
.end method

.method public updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V
    .locals 4
    .parameter "proc"
    .parameter "oomAdj"

    .prologue
    .line 11614
    const/4 v0, 0x0

    .line 11615
    .local v0, anyForeground:Z
    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v3}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .local v1, i$:Ljava/util/Iterator;
    :cond_0
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_1

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ServiceRecord;

    .line 11616
    .local v2, sr:Lcom/android/server/am/ServiceRecord;
    iget-boolean v3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    if-eqz v3, :cond_0

    .line 11617
    const/4 v0, 0x1

    .line 11621
    .end local v2           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_1
    iget-boolean v3, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    if-eq v0, v3, :cond_2

    .line 11622
    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 11623
    if-eqz p2, :cond_2

    .line 11624
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 11627
    :cond_2
    return-void
.end method

.method public wakingUp()V
    .locals 2

    .prologue
    .line 8339
    monitor-enter p0

    .line 8340
    :try_start_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v0

    if-eqz v0, :cond_0

    .line 8341
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 8343
    :cond_0
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x1

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->setEventDispatching(Z)V

    .line 8344
    const/4 v0, 0x0

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    .line 8345
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 8346
    monitor-exit p0

    .line 8347
    return-void

    .line 8346
    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public willActivityBeVisible(Landroid/os/IBinder;)Z
    .locals 4
    .parameter "token"

    .prologue
    const/4 v3, 0x1

    .line 4377
    monitor-enter p0

    .line 4379
    :try_start_0
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_0
    if-ltz v0, :cond_2

    .line 4380
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4381
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    if-ne v1, p1, :cond_0

    .line 4382
    monitor-exit p0

    move v2, v3

    .line 4388
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1
    return v2

    .line 4384
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_0
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    if-eqz v2, :cond_1

    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_1

    .line 4385
    const/4 v2, 0x0

    monitor-exit p0

    goto :goto_1

    .line 4389
    .end local v0           #i:I
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_0
    move-exception v2

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v2

    .line 4379
    .restart local v0       #i:I
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1
    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    .line 4388
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_2
    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    move v2, v3

    goto :goto_1
.end method
